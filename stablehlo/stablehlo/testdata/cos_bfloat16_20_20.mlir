// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.cosine %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x69C05B40384096BDF23F32C095BF94BF59405B3F7B409E3F0D40023EF83F94BF87BE66C01FC0B9BF6BC0063F0D3F714074C0E3C0AD3EE5BE9DBF99BE46402CBF92BF03BFF13EE83F25400F40F9C037C0ADBE1440F93FB5BF6D3F8A3F87BE2E403C40D03F09C0CBBE9EC050408BC05FC078BFCC3FEDBF8EC0F83E3640764059BD59BE8BBF71C074C0A53FC93F47C0633FDC40BEBF5E3F39C0D53E6B402A403B406840A73F4440B74072BE9C40FD3F984036C0A1BFEC3FBEC0B93EE03F1B40C2BFC73F0741864083BFA4BF9D3F603FC2C0903F89BFB04033C0014090408CC01E4025C099C019BD9240A6C07940AEC05F3F973FFDBF0C3F273F03C0083FA7BE31C06EC01EBF1F40AF3F11C0034022C0F1BF7CC0FC40D23FBD3FF23F274080407EC07A40443FA0C0323F774001C0B93E6EBF6B3C5E4002C003C0B83CD3BF42C0B7BFE4C060C0DBBF9D4032C0A14086BF02C068BF033F674015BFF33F89C0B5C08DC0A33E2640C73F07C06D4003C0F0BF1F4033C0664083C09E3FD23FBD408FBF09C0B73DE5BEE53F1040B2BF8F4044C0C0BF003F2CC0673EE43F66C0C54053C0A7BFA3BF55C0A8BF47BF833F45408E403ABF9740483F44409BC0893FDF3F4DC002407C3F4C40C5BF94BFCCBE18BF2040CF3FBEBF2BBE2A407040E2BEF9BF913ECF4012BFB33F0EBFC1BFF1BE8FC0EBC0DABFD03F2640DE3F68C085BF9D3FDD3F0A40FE3E8440003F9B4085407A3F813F164020C0ED3F02C09D3F97C0553F1AC01C4048BF05BF78409B4008C0CB3F683F1AC0AC4046BE0740EDBFEE3F1CBF0FC0A73F5FC064BE0F3F12C06340F93E3C3F86C0E43E3440F83F0740344040BEC13E11C0CC3EB53E4C404A3FA4BF71C0BA3EDD403A3FD1BF34C07E3F564088C012C0E4405BBF58C06B40A13F92C09C3F553F2540CAC0A9C04EC092BFDEC00FC029BE8B40A0BD94C003C02A403240FB3F1FBF573F17BF88C0DE3DDD3F8340B8BFF2BF0CC1833F4040A6C080C08C3FC0BFB1C036404540BEBF174088400CBF68406A40943F2A3F4940E9BF81C0B5C0BDBF16401540BD403040953F3DC0C83F5840C240043F9E40C53F99BE513FE1C01A401E40D84033C08DBFE73F3FC03FC0E53DC9BD43C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x61BF76BF77BF7F3FA1BE70BFCB3ECE3E78BF283F36BFA93E17BF7E3FB8BECE3E773F66BF4BBF003E5DBF5E3F5A3F50BF49BF303F723F673FAD3E753F80BF483FD63E5F3F643F75BE58BF1EBF953D76BF723F2DBFBBBE203E1A3FF23E773F69BF7BBF5EBD0ABF6C3F653E7EBFB8BE71BF113FBCBC8EBE8BBE633F75BF43BF803F7A3FEF3E50BF49BF8E3EFE3980BF223F543FB13D263F78BF6A3F5DBF62BF7ABF63BF873E7FBF583F793F263ECABE1A3D75BF9E3E8ABE713F6F3F37BE41BF623D843C0DBF00BF053F923EAD3E243F7A3FDD3EF63E353F71BFDCBE58BEA9BE48BF58BF8D3D803F19BEEA3E3BBF2A3F253FC33ECABE5B3F4B3FEBBE5D3F733F6EBF57BF513F4BBF4F3E24BFEBBE52BF9DBE33BFACBC8FBDC13DA1BE5DBF27BF2DBF39BF393F913E453F41BFDCBE6F3F193F803F72BFE4BEEBBE803F9FBD7EBF103E2B3F70BF0FBE453E70BFA13E003FE4BE1E3F5F3F64BF563FA5BED6BE4F3F9ABE733F5BBF843C03BF59BFEBBE99BE4BBF71BF66BF14BFA93E8FBD6E3FE03E0ABF7F3F673F5EBE21BF373E77BE7FBF913D613F66BF7A3F56BE66BF7E3F7DBF873E963E7CBF833E363F053F7FBF8BBE3F3FD03B363F7FBF063EF63E2FBE80BFE4BE0E3F80BF023DCE3E6C3F543F4DBF3EBDB13D7C3F62BF52BF673FBBBE763F7C3F573F303E5A3F813D643F77BEFA3E07BE5EBD5BBF27BE63BF023FAD3E1FBE0DBF613F0EBF613F063E07BF0F3F093F33BF4DBF8EBEE4BEAD3ED03B2C3F3EBF43BF363F5E3F3EBF063E07BF78BC1E3F3EBF1D3F7B3F03BF8EBE92BE523F1EBF873E71BF7A3F593F27BF6BBF623F3E3F00BF673F72BFB8BE03BF72BF7C3F6E3F24BF6C3F703F80BF343F923E50BF6F3F503F3F3F7EBD72BF0C3F7BBFE4BE27BF2B3F283F79BF5DBF9E3E19BEB13E2C3F58BF803F0A3F7FBFD63E4B3F1EBF7D3FB8BE7F3FB3BDEBBE62BF70BFC3BE503F2B3F553FE4BE7E3F1FBE14BF083EA1BE48BF053F7DBFEA3E27BFEB3E913D3B3F75BF7FBFB13D36BFE4BE5B3F63BF5FBFCE3E4A3F80BF7DBE21BF4F3FC13D33BF30BF6E3F6DBFCB3E7BBF083C79BF7A3F5F3F653E023D753F2F3F3C3F3EBF48BF653F71BFE83E6DBE7DBF7DBF7E3F7F3F7FBF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
