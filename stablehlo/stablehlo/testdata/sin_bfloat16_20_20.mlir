// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.sine %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE93E85BFFCC0B6C05940044003C08140B33F4CBE174061C0CA40D93F8A400840D5BF714014C051C0C54027C0D93FE53F8940BCBFE9BF80C01C4082BF8DC03A40FC3F7140F7BF04C0BB3F07C013C005C085BFD5BF693F0DC0ED3FDABF46C035401EBF57402240A9BF7BBF6F3F21C0BFBF1D3F8C40D1C0D7BF503FB0C00640A8C0DBC069C06CC08E3F27C0B5BFB5BEA040EE3F93BF354071BF34C093BFE63FC0C00F40A240A6BD1EBF08C0FEBA7640DEBF01C06ABF3FC0A3C05EC0E6C01B40C8BFA04016C156C049BFD43FBE3F5E40B7C0C23EDE3F3040F7BF95C0BBBF90C07F3F8F3F514084401540244051C08C40CA3F2EC0253F643D6E4034C1F2BFD83F34C09CBFE34082C0CDBF8C40D53F0A40D7BF194012C0D24080C09A40733F2A405A40054094C03D3F853F4CBD4740374031C089C0843FFCBF903F05C1D7BFF8C0CFBDB6BFE2BF9D40213F9BC003403CBFD9BFAE404CC072C00A406AC0DABFB6408E3FBDBFB9BF38C010C133C0633F8740DABF7B3F42C019C0674058C00340474022C056C004404040EDBFCC3F19406BC002C083C0CCBF2BBF15BF3FC0BEBE8D3EC3BF1AC0AE3ED03FAE402740B7C068BF9AC0163F8F400CC03440AA3F7BC0693F35C07E40A83F53C0AABF2DC009404DBEC6BFB3BF213F1B408ABEA43F48BD9D3FAD3F0BC09A4003C0B7BEB640BBBEE4BF1D400540A4403C3F213FEE3F8A3D5ABFBD3FC1C09B3FA840B63E1CC03B3E9CBE16C08D40F0BF1CC08F3FBF401A3F99BF123F0A3F5DC0E13F484095C03A4022402540224099BF943F18408DC0164065C0CEBF3C40A8C0CDBFDA3FD53F723FD6BEA5BE1ABE0FC0553FE83F0140B0BE08C192C091C051401E3FEB3FB4BFD7BFA0BE5C401CC0883F8EBE8240A0BE633F07C0183FAFC058C0E83FC63E864027C00341E63F3940304015C09DC04FBFFDC07C3E9EBF9AC0DEBFBF3FC4BFB7C001C00C3DEDBFC1BDB13F6140B8BF8AC035C08BBF003F03C03AC0384024C0A4BE913F4640CDBFA3C0CABF0AC084402A3D3F4003C082BF423F1CC0ADBFA94018C00EC01DC03DC0E73E484028C02240E33FD73FFA3F1140353F5B3E0AC03BC0133F27C08B404A3E00C019C077BF40BFC5C0C4BFC7BF5F3F"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE13E5DBF80BF103F7CBE623F64BF47BF7C3F4BBE343FBB3EF03C7E3F6CBF5A3F7FBF16BF3DBFFD3D02BE02BF7E3F7A3F69BF7FBF78BF423F263F5ABF743F6F3E6C3F16BF70BF62BF7E3F5CBF3FBF60BF5DBF7FBF4A3F4FBF763F7EBF44BD9E3E14BF5DBE133F78BF55BF4E3F16BF7FBF133F72BF7BBE7EBF3A3F353F5E3F5C3F08BFF53E053F653F02BF7DBFB1BE75BF753F6ABF9E3E4FBFA5BE6ABF793F8F3E4A3F70BFA6BD14BF5ABFFEBA25BF7DBF67BF4BBF20BE6E3FA53E49BF293F80BF75BF4CBD4E3E35BF7F3F7F3FA5BE093FBD3E7D3FC33E70BF803F7EBF7A3F573F663FFDBD55BF3A3F0C3FFD3D72BF803FD2BE1A3F643D0CBF783F73BF7E3FA5BE70BF3A3F4C3F80BF72BF7F3F553F7EBF2F3F42BF8D3E423F7FBF503FEF3E86BE603F7F3F2C3F5D3F4CBD043D8F3EBCBE693F5C3F6CBF673F66BF7EBF7FBFCFBD7DBF7BBF7BBF173F7E3F643F2CBF7EBF40BF3C3D193F553FFC3E7EBF10BF653F7FBF7EBF87BED3BEADBE463F61BF7EBF553FE2BD2FBFE7BE6D3E643F043D13BF4E3E623F113E76BF803F2F3F013F65BF513F80BF1FBF0DBF20BEBABE8B3E80BF2CBFAB3E803F40BF023F093F4ABF7F3F0E3F78BF51BFA53E783F343F4A3F9EBE3CBF783F1E3E78BFD9BE583F4CBE80BF7CBF173F293F88BE753F48BD713F7A3F53BF7FBF64BFB3BE10BFB7BE7ABF233F603F6BBF2C3F173F753F8A3D41BF7F3F7F3E703F5CBFB23E26BF3A3E9ABE37BF74BF74BF26BF663F9EBE113F6EBF0A3F033F9D3E7C3F883C803F6F3E133F093F133F6EBF6A3F323F743F373FD83E80BF503E5C3F80BF7E3F7F3F503FD0BEA2BE19BE4ABF3D3F793F673FADBE4CBF7D3F7C3FFDBD143F773F7DBF7EBF9DBE95BE26BF603F8CBE4CBF9DBE463F5CBF0F3F3A3F6D3E793FC13E5EBF02BF723F793F7E3EC33E3ABF7B3F39BF80BF793E72BF7F3F7DBF7F3F80BF093F67BF0C3D76BFC1BD7B3FBBBE7EBF6C3F9EBE62BFF53E64BF6FBE873E0CBFA1BE683F443D80BF6E3F80BF55BF55BF2A3D203E64BF5ABF303F26BF7ABF58BF32BF4CBF23BF40BEDF3E883CFDBE133F7B3F7E3F6E3F453F263F593E55BF5FBE0B3F02BF6FBF493E69BF2FBF52BF2EBF023E80BF80BF443F"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
