// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.acosh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    %cst = stablehlo.constant dense<(0.000000e+00,1.000000e+00)> : tensor<complex<f32>>
    %3 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<complex<f32>>) -> tensor<20x20xcomplex<f32>>
    %4 = stablehlo.multiply %3, %2 : tensor<20x20xcomplex<f32>>
    %5 = stablehlo.real %4 : (tensor<20x20xcomplex<f32>>) -> tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<0.000000e+00> : tensor<f32>
    %6 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f32>) -> tensor<20x20xf32>
    %7 = stablehlo.compare  GT, %5, %6,  FLOAT : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %8 = stablehlo.negate %4 : tensor<20x20xcomplex<f32>>
    %9 = stablehlo.select %7, %4, %8 : tensor<20x20xi1>, tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%9, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %9 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x370A2340BEDCBD40A4971F40CA60F23F59254E40A5980E3FEE173B3F46ADA8C0B4C2B2BF095547403419AFBE8BB949402D6BC4BD8B7A0E3EA03528C07F0D0B40EFD783BF3919AC3ECF648B401FDB7EC06148A13F97CA1EBF7E70903F8D5675BFD8DEA63F3AE32E3F42907FC0D0EAD6BE5E0A354088A721C0988EBBBFE4940E400DF80EBE11F81DC08230FDBFACFE0AC0CDC08F3FAD8005406AC7203FFCA7513F160861407D1C32C069AC71BF2F41F7BF341B5340A1245FC0CB4683407EC02641A24739C01A7C8940A905A3C0986EB540A81681C04FC401C0F8098440F28B993E9D185EBF7DCC064072BC1D40EEA0AABE98F28C3FBE7416C0D77498C036643AC0BD57034012744E40012E98BFC72D0340B5C55840EA46CAC0EA54C23C083E9040C190FA406C91F7BFC9DC00407EFE43C03BE2D53F609D8FBF3FEAA1C0B8304D401281A1407BC2B3BFB6C884BE2EF221C033EAD7BFA61858BF821C8CC0E79709BD796480BFFCADC8C06A865DC0DC59C1BF73BFD43E6506D23F28D3CE3EF70B9FBF5CC58D40596D6FBFB8CEAF40E95675C0BDC216406F8BD93FA1802A405937C23F6486AD3EAA244ABFEB862BC0B37DF13FCAC712C0C5D7473EEE7828BFD5F0603F23C0D640C5C2B4C0A80EA33F5C16894014048D40D7DF044091D50E3F864B164147E30DBFD98CC7C06AAF05C0D9E2224054E8BBBFCA62CE40868854C07C8338C058FC3C3F0F92DEBF6792453FD514AB3F8DA0093C7BB4C33ECBD1223D34E3CE3E21530940068CC23F6A342EC0B611B93F26DF773F33CF80BFA53407BE35289A3D5956014090F834C09B9EEA3FF3CC664046F0A040EBD1763FE821A6BE1C75D83E61654B402DFD00C015746FC0CCC7754080C6CFBFA3B35FBF83F88AC0D493E13F923CDE3E0E594B40D413EEBF857166C037F5A0BF06E72FBF088291BFDEB884C069943E40846E94BFC8F6F63E2522A3BF02248E3F45205540957D144011076C3F46D1F93EFD16ADBF11CE8C4079AA9EC034C1E73F833AB93FC84D52C0520864C0DE457D40CBE3CD3FCFDD87BFE247FCBFC15B073FC1784FC0FED590C000B6F03F6DA3453FFF5C15C15D6983C0A60B4FC0C0C5CDBF87B2163EADB2E8BBA09390C0AF97813FCEC39C404B2BEDBF3BDEE43F25F54B3F31D5973F1633C6BEEEF3594095BDFBBFEFE1F03F6BF99EC03B9EB940B0E7B83EAC3D8C3F6538A340E6AD9C3E2565E7BEDA9663409C9DD4BFB4EA8BC03549354014F226C0CA6C7940284D89BEF3BA3B3FCA910E40A6967B3FCEE0BA3F98683340C5507BBE940330C0A9D245407E1C2140FB9659401B492440DD4E26C0408A1BBF180290404B3BC93F4408A5C0891BA63D2FAF3E4024C3A3BF77B503C0B40288BDBA6BA9C0F323E3C09D98D23F9E730BC0B5B00A3EA1934D40F7C2563FD0B7A840D2FAF83F339F37C0A7F0CDBEE75946C0032A45BE9FE30B41A041683F0E188B3EBAF32D4063FB44C03E7CB9BF74520C40F6D9424024B6EC3FF2DC0DC05516AA40319247C0308E68C0320C79BF37039A40FB1534C003D5F1BFE6F2A3C02C82A8BFFED49E3FD5C912C0399AC6BE931E3BC058EF5E3FA2D713402298B6402AD251C0337ABF3F0CF5DDBFE42186409C765F40DB223EBED45206C180FB82BF687DFC3FB122D6BF80976EC0A6F15ABF3617943F13DB72BDD295E5BF416818BFFBDA674039EB03C006F0EA3FE11840BF4D2151C07447563F705036BFCEBABA3EEA77D5BF2921494004506FC072392D3FC62E973F46494EC0EF696FBF2A750DC074140E3F2293B23F5AA1DB3E86A5593FAEFB70C0B81306C04E801BBF538E0C415097EB3F57C8503F93F09F3F06DD9DC0C0529A3FFC9600400C6C0CC083047EC0305EB4BF4B14AAC05A83CA3EDA378E40953E65409EF87F3FCD32D8BE8AEF20BFD81EBEBE8D1E30BEBE5181BF99612AC0FFCDCD3FDF1A93C0DB45E9BF5B7690BFB01EB83F903BA940FCB24F3F644A3240F909743FD40BB5BEB3F1F13EC382863F775D8DBE0F8B5A3E911669C044D165BF1FA016405A3728C0F7622840094195402B6F0940E2480CC0D40B8940593941C0B118AB3F4FBC0BBF6C2E5B3FDF35423F8895803F769EBBBF5BB30040023665BE6BCF0E3FC13103C0796919C0C7A54040F0050040F1FB033F04186DC0C4359240FA3280BFCB2B1BC0F1988DC0DFA73DC04FE584C0AAD8BE3F864AF4BF5BA79BBD3C7E4940613687BEE7BA44C1D5BA1F3F04876140E99A3D3FD1322CBD813294BFA00E743F54EE3040D25114401FE044C054B744406E0D8B40690FD0BF39BB5F3FF68034C024DBD7BEF2454FBDE8172CC0A9552140F49EBABFFF3EF83F765068BFD87F18406853233FA03C2AC084338240E21BC0C0002B923DBF4F6D3F4D3948C0866992BF69780D40B9CF64BFB57701C1A712D4BF279E34C096D94EC0D87118C0D3887BC0FBA98240D8717FBFDC3B5ABD1EC7C340599E9B40EE484EBE313D4DC0841171403FB93C4043F639C0A3C5EC3E5C51A4C0C9DC74408937DDBD7DE10340DCD15F40E6361C40001672BFC5A4BB3FDB847940E75443407E0F6E40CC3CACBF5270873FE65A4340E96394C080AE12C009C483BEC2E34CC0AF25973F2872F3BFDC9B9940ECD3E63F69FD67407A531040BC91B6BE3DE3653F765594BD047F4BC0FAD4A9C05C35EBBFDD770BC026A4A43F7A20353F868DF63F5B9DC53F43D85D3FC463C1BF354A1040E4A29A3FFFEF0E3D207400C012910CC0EC7D20C0076BB3C02CA6D33F259DA3C0C0F594BFA586B73FCBC55B40D8E5523F622FEF3F1C9E2740F91489BD01042E3D9F015CBFE388E0BFE2197340CE052EBF2A525B3E931905BDFA1DB6BF9D6FE73F31A338401897B1C06C81D1BD2C0304C0CBC38740936AAEC0E98084402DB70CC0FFBC9B3E745921C06619CABFEDEC26BF8134CCBF15DF953FBE95193FDC12443F12F987400F97E63F4A4C2CBE11E43CC00329E73F063E8B401C18F13E3F7955C04A8668406F26C140B9F6A83F33561ABF3A1DD93F9224B13FE78A6840D9F4A1C01ACC70C0066B2A3F277EDBBF036B0D3F6A8453C03058DF3F61A10AC00CBF01BFE5F824BFC8135C3FE99B5BC0DE7897BF981B5440465E87BFE0F488C064D31C40FC5AC0BF869097BF9AC7773E51EF9F404E31193F6D47B73F3D1163C05BC2C9BF7E42083F064FED3FF9AF4240216DA0BFD4AE5C3F207199405555A6400FE894BEFC39A8C05BC680BE7CA5ACC0422286BF69F0203F59B5D43E0AD734C004B28FC0EB1E3BC017843BC032DD91C0D3A4EE40CB6B1FC0A1EA623F44AD72406963A33E384364C07AE41EBE8B3F63C0E7CD8D3FB39D843FA231DFBF7BB7DCBF036D02404D24733FF2B610409FD24BC0602C16C0A78E04405965C63F04F24DBE19DA09409063FCBE71355A3FA04316C0B062EEBE04BB17BF7DDEF43F6E1D45C0664CABBFE491783FC375B9C0C6032440B43DD3BF9DD6C0BEC31A10400BE2F540496A4C3F138294C05A2021C025C0CABF940FC7BF6F3BAB40E2D2EE40536415C0F49457C0A7B51DC09DE68EBE9A4ED8C0AAAE52BF1F95AF3FE2387BBE123E1E404066EDBF8C378AC08973373FE3FCC8BF2C9D3B3F6658793FA6C64E3E35E6BD3FE0DA18C0CF7586BFBFE85E4085A458406FBB6340ED33D23F61D2DDBF1FD7BD3F0C54AEC0CBF286C0DCD28ABD587F6AC0AAD9493EC0263F4005E4ADBFA472413FAD3B823DE24FF0BF1E3D84C012C0FABFD5ECCD40263504C0BA82DC3F74C377BFFD2153C012A807C007C163C09115993F7194A1BFA0A9234039894ABF0F75463D4F1AD4BF99F48DBECDFB924057CB33BF1A0BCABF55FD8DBFBD9E18402567803E5C182BC0393402BF872719405EE62A4018319A3F4BFF49BE3804843FBD48D1BFC65524C009268FBF86A290BF8387A5403E62A23DFC860D403C2D3ABF7213D0BDF418334068D6B6BE9E6122BF6EBB15406E6B463F737FCCBE74DD46C014C5693FF456BE3F70093D3FF4DC9A3F30491540EF511BBF4A6B2BC0542060BE419236400ECFD63FC66094403D2684BF4E25D040DDE100411F90D53FA94B21BF4F36583F3A62F9C0F46E25C1FA30E63FFEBC86BF3DD0C6BE989638404E7D68C0223946BF3508D7C0AFDB2A4080C114C0D3777C3F918B34C09958EC3F7B8E89BE0CF99A3F7B6F9ABF76528B3F690B4FC0A85A29C065063240F836383F23AD14C0C5E52DBFE788E94056598840481B20C00BF9C93F1DBD4D40B356BB3FA36C4540B5354E40D9575540E27C64C07FB46140E8C3EEBD35BB923F124B18C0A1157CBF3DA72D40B58227C0CD5578C0883DA9BFEF74CBBF4F1A93BF7574BC3E0F9A84C05C3CA5406DEB75BE4F84B34008DE4640EF08334033E914C069D83FBFF80C1A3F17DD8540A84C9040226F8140850BBF3F1C2DA6BF7DFC47BF0F8771C077D70D3FDE961CBE3F576A3F8D080140015FBFBFE73EB13FCD55173FB5940740B6AD4D4077F2973F53B091406A81B73F0F247EBE1BDDDFBE0F8DB03F40EEA9BFCFBF8CBE"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x27B3953F06FF23C0C2AB2C3F3D0EEABF17F7373EE16CEDBF2CBAB73F5EE417401E0DFD3F8FB3F7BF5C42D63FD76CEFBFFF3CD53FF0A90EBE4A7C1B40934FF5BFFACC26400C621EBF1D6C3F3F5EF11D4094EC143F1039783F846A513FEE108B3F6B90183F927083BF852442408E550440F8093F3F4A93014097C90740B030D8BF82C4CF3FD97DD13FF6FB11406727E33F66438E3FEF60CABF86AA8B3FC07253BF00862E3F693A0C40D74CFE3F7E0ABF3F87EC523F4CCC1040203C993F3C1347C0B0EE094024DE15C00F1B1340A8612EC0399C2A40D35E0C406E1C993DBF4B06C0B424F73F4B72C6BF3317163EC810C83F0864943FA2E6D53F0B7C254040341A40E079823F70AC02C00ADC03406622CABFDA9C8A3F079F2A408067C83F0E810DC038D3793EC7BF3140C2C0803F0DF6FF3F68E9263F8AE0AF3F46822440A3BD1EC0866B8D3E0DD91540B33BD53F9AD2D43F1C4C2740A0FCA43FBF8E48405D050A40BA1EDD3FCA0B2340AADF2D406BA5004090A3AD3F5026A5BF77EFA83F7EB0883FA2435A3EAD4B0C40154E1D3FBFF72540F462273FC129E0BF7EA10A3F7776E6BF3D17A73F08333F3F6C5F204075C0EFBFD50843400108BDBFD19D0340317860BFBBEF333F594E37400FEAA43F98D90CC0E8ABE53E174511C0AA82C13F77033CC07344D43F0D272240D4160F40EFEBF1BFA665E53F2E9A25C07A7B1A40CF0C0B4009479B3FF950B03F2CEC8F3F64A197BFBE0EC83FCC3BBFBE0258C43FECC3C9BEADCB263FD225D3BFA25A284046F9E6BFFFC86C3F68E6863F93F6D93F975C9BBD2C2E783FB219F93F7E688E3F616306C008A9453E475214C0D19EEF3F94D8DBBECADC143FDDB70040F767154014DB17C0990C25405B6DA23FB2DE2F40E7B30EC0A176B83F87C8F0BFEE450240117E0640784821405266803F8973EA3FDD740A40A716C73E121EEB3F5F72A33F817C8C3F3859A13F4E82FBBFE212D13EFE1ACABF646DA43FEB5F923F4CC1593F6E762540AC84383F9368C3BF53881340F970114058B4CA3ED4A908C0DCB10140DE86C33F5140B53FB4ADF33F82602F407D9E11C04A8FBE3FAEB83B4026C91D4052161640DFA44140BDE287BF2442C93FE6A50D401A78AF3F1DFA13C0BE8615406FE3D1BFC5BE893FC8B98DBF50F9D63F7AF9F8BF520C164096EDD8BF5A961140F5842EC0581AAA3F932878BF14467A3D7D2314C02AA7D83F877CFEBF1B96F63FFEA30F4053D7423F9E960240E487913D83810240B877A33FEC61CABFAEE0853F3CAAA5BF1440BF3DCAFAD83FDF241240AC5F07C0D056723FA4F108C06F6A4F3F1FA3FE3F79D7D93FB6F00DC018CAA33F1AA518405BC2C53F83F7E7BF18D30540849BCC3FB9A3CA3F58981740B8593A4084312BC034984440826BB5BF8ED5883EBDBAEFBFF3A3B73E56751AC0E7923F40D80FDD3F46DE4440E754E63FF921D53DF04437C07715BD3F0B5DDDBF14CA2B4088B2F33FEA95763F805E01C0788A673F4843E13F294F093F478A20404FBA37406E280040DA40093F81151A407599F53FAD691940E6D51340EB22A5BF1F383D400FDABE3FC9863540B88EE4BF3E67983FADFA20C0E4B22C406335FBBF0B33FA3F41AF0DC06514633DF343F63FB33E41401CC9344008A33D3F60D7D13F24213A407337014043FECC3DBE27103FB258314026D3A23FC9A9073F1E42074028ECE03E259FAA3FAA4B3840E6D5F1BF563A11403E6DEBBE3EBE0240E59CFCBF3C323D40C6BD00C081C69D3FE0A6F83FDDA5F83FB0A3CC3FE465A03F28AF96BF8B769F3FB2864EBFD6D12740386609409DD7D13F62CA37C06C13F03E3126ADBFE6E1A93F84081540D8B1883F85A4C8BF5B340440108A0D40A3B8E93FC6E7194053F9BD3FECDA0CC0CB66903E3DD5FEBFACE9F63FDF03213F52E8F83F651F3C3EA50AF53F3E97E13FD1D09E3FAF3412402C3E224052A1B73FF598A73F20B219C056AFA63F1135E4BF0A971E3FF797133FE8D29F3F01A474BF85FFEB3F492061BE440A3940C6E4FF3FD43D5C3FF974FA3F6A43883F600C18C04075523FEC70E83F42691F3FE02C1640AB56FE3E7E027B3FAA0D683F86F95ABF32BE843F3FACA63F9652023EBA92AA3FD831AA3F6B00BF3FD9870E40B1DE02C04946923E17ACAEBFE9AE0F407CDD1DC06829F83F1F73D73FC8C422406E311740AC763240A9BA0AC0B31246401DC2A13F6B9FB43DADB0E83F68CE454018EE4CC0A5875C3E9067FABF3D94CC3F1F2C7D3F6CB6A03F52FAE4BF64EC703F69FB0240A7A1763F878F17C047182540B290A2BF1AEF3E404EEFDA3FCB51CB3FCA90DB3F84100D3FB3C0DF3F3DDFF73E1AE1B53F7FB5913EE593C7BF96F9084056D711C0534A48405CA01EC041BCA53F8993F23F712001404380D0BF0A0AD73F39CC3240023F054051FBF13F2C741F406E0C0540C6131540BE681BC0420C3A4029B4683E7AF42C3FCDE42FC0ECBAD03F871AF13F92C52C3F8D6010C0D0553E40EA34DFBF27B41F406D1723C05818CF3FCA57BCBF71571F3F95E508C00AE8044012EEA4BF67952C3F519712C08F26B73E7D9403405B25A03F9434F1BF62332B40662D1540F0DDD23FEE08F13FF847873FD4F2C23FC244BB3EAB8514C08CAD113FD2DF08C035DFEA3F08C954BFCBD7CB3F0CDFEF3FF2683340BC671A406FA024409653CDBF8753A03F8961BABF137B163F3E519DBF596308401E50DABF9A14523DD80323BF8022124051C2E43F5C45FE3F96D0204050A9A13FC16C184092D60B40C6FEA9BF6EF27A3EF4E2F7BFC82D793FB762EFBFD1A0D13F795A2EBD457DFD3FC0ADB33F83983B3E60C10140C272AD3FB63B083DEA5F0C400626C5BF915C8C3F81EE21407AC5CE3FC571BC3FFD176A3F19212840D5D6FE3EBCD70E4011C1BA3FE796D43FBE552B4097BE953F46761C40C25BAEBF569E8C3F836347BF0EBCD13E30B80DC0B3F7CF3FF4F4E63F38B4973F0D1110C03AD8B73FF2CFF63FD245843F647629C029760A3FB6497F3F76943C3F332EBCBF2447743F7E9421408C753D40D91901C03A98314069CD9BBF90FF2840521A00C016B138401FF8B83F08500340531A5CBF3906334086CEFB3F029AA43E681EF63FF73427405F2812C062F519403397AA3F59FDC23F870A14C0EA179E3F0C199ABF7F7D2D4003770240EB2BA93F1BB8B3BF50DAD03E6710EF3FEEBFB23F285412C03946693DEC5A154016F245408A101640BC943C4051EC18402467793FF861F7BE4EF8074070691740BACB1540BD4B07402A750740D43437C0679B31405896D1BFD52EB23DA4C500C0D72946407308F93F9F043540C6F0FEBFC0AD8A3F5042B73F874E0F40045DD7BF5CA6993F2E44CFBFCA6E1F40511704406EE52D3FC846D1BF20E2D33F38C0C1BF62B4F83F7FEB51BFD5513B407601C33F1F9DEB3F5CEBB7BF18BE2D406ADAF13F501CB43FCE221E4038F0183FA80EE63F0584DC3FD9DCC7BFCED9D53DE4F12EC023C32840528A1640F6271440C129BF3FAF99733FF8553AC0D36F0A408BFC0640B92E4140DD98C73F58394140E3CB26404F907D3E58CE613F0E512B3FAE57E83F7B423E409E100AC092542840C3BE98BF0202F23E043DDCBE7863853F45F1DE3FB347ED3F710100C01E18523F1F4312C05D025B3FDEC5C83FAF89A73F80921B40CC004840A58E0740B47C45407BB1FCBF21F2E33EFBE0EE3F8A2E383FC352C5BDE580FE3FB3AF0D407E7FEE3FC6A426C0015E1A40AACDD6BF5533EC3FC207F93FD61B0640D9C50740FE63643F1F55A13FB0A7A43E8AFDD23FA3DBC53FC9B9A33F709AD03FE8C90EC089DFF73FCDDEA53FCC7DFD3FE381D7BFC4D6BD3F904FDB3F73EAE13F93E8CFBFF2D3E43E6CDCDFBF8A9BDA3FEB0069BF3E4F07408BC1E83F84581040EEF6953F10F17F3CF6F014C0896DB23EE705C03FCC6FCD3F2C6AE0BF3FB8EF3F508C1F3FA1BDB13E84E0C7BF42A8D83F03F1ED3F78E68A3FB24BA5BFA1BB8E3F2AB28DBF58628E3E5854C43F3F7143409DA6D23F2A680D3F328FF0BFB54D653E17700F4057CE643F63FB41C07DE0D83EF13E9B3FB65ABB3F7A653040C4FD3D4044AE42C036622540F2262E3F6235693FB1BD0E400397D73F760B2740457B3C3F573EFA3FAB1BA03FCB9DE73F4E7B2E3ED2CE9E3FC6085E3F01A79E3FFD18A13F1307F83F711E14404C8A02C05561A53F7DCFCE3F57D5D43F64222CC08C3B0A3FC84A1240768F903F768CFDBF1F66923FD4A7F7BF9962503F5C910EC0A18D1640B99913C06EDDD23F72BE7BBF121A2E40CE68CE3F06F5483F70480140EA70334014E5054092D91C40C215AD3FDE08BE3FEF7C08403306423D07E4144007D3023FE21623C0DF68363FF5ABFD3F0BA40D402DC331BF8A58543FE3A820C01E9BB93EB63909C01E691F40E437893F52663F40F0F600C00A7DD73F0E1753BF825D2D3F9F50CD3FB4F3003FC40E84BF4668803F401103C08A19A93F021910C0F01B6D3E3A15703FF68EE93F698293BFD0753640472E5A3F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
