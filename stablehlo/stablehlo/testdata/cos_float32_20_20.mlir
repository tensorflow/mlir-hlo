// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.cosine %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x787B203FCE211BC000AF26BF3D0C1FC01CAD23BECE9DF0BE586658C01878D3BF3DC39CBF609213BF50B998C0B25B8F403A7BDC3F8225EC3FDD711AC0846746409B79E3BF7023BB3FE519B040D82F3CC0D4279EBF748A0540087E72C0B3D285BF0415853FC01697407E14943FFA144F40C0F8DF3FD893E23F2DBD54BECEAA953CC41363BFCDCBB53FC6779C40ED378EC04C6C87BFE6412DC04FC16240F14882BFEA64133F4097823F6F072AC0CA8C0AC00EAF98405BFAA7BF398BF83F9A7A7040E3446D40C74D074071D6B44075EC7ABFD5A382C015761140A932F13F91360BC0B3BA3C401169C5C0215639C088464D3FBB240DC0512F5940D7D37CC0744C403FB83C9940E6069A3FB054BB3E21D63F40A7C211BF3DBE694021939340348893BF269ABBC05002D43F40BBB1BD2F6C2FC06A9C533F2739B9BF475434C038130EC051539BBFB0828BC0E79590BE5EC5694058B4DEBFE8579B3F693E613F7CA5764066651440625F4DC0ED9CB63E22DAC840BB517F40A14277C05955ADC04AF0A7BF349B6140644B1940501BD7BF76F38B3FEE7A7040C99B18C0DCA5DCBF4C4BBF3EC97434C0D23EBAC0F39D444047269FC02DE961BF0D308A4074EF3BC0CFE19FC0FF10943E68B9903E7CBA95C0729F1CBE5599734032C6ED3F8AD820C004168FC0B2D55B3FD2B8853F82E00D3F33CDBD3EFB402A4059BE5840268AE63F028912C04CD486C067920F3FA4C1EC3F6D314BC0D3270AC09E07ACC03E8DA33FC7E50C3FF48400C0C911B13F5A5D1741E01C86BF44E27940E3E7E83EEAE20D3CCEA0ADC08CE46F40F69388BEA6BAEFBF256A834000B88AC0E692993F123904404BDEBABD2F2AEDBF4079D23FDE9B15BF5DA63040290931C0AF76A73FCC22E5C027525C3EC6B0E7C09D63F2BF19ABF5BF25041340BB246FC0B41B11C0751F2340101454408F58783F889860BFD0EC4840A578AEBFBAAFCE3D0374713F493FC73FC31919BE01BC9E40A3E0644033966F408E6FF03E788326C0ACF50A4015CC343E718E013F81C408418505693F6B07B9C0255782404A411B3F2EAEDA3FF7919B3E3C8BD2BF75FF01BF0D6A26C018D8CB3F05B0F13F84A915C0B7C4DDBF1F73C340D7493FC0B83EBCBE0D4460C06A1D673EFDA5634083CC47BE261FF6BF912A5E401BB3DF3F351FB2C0F9FC52BFF5B1BA40BF1BA1BFA6351EC0D92A5EBF6B6BC540063D1CBD2FE8A7C01B2D503F9C5517BF3B3152BF4E4CB0BF8F362BC0C934223FDEFF85BF779FD24034D103C0DD5B3BBFF9F223BE753980BF763521C02023EE3F234353C0BB744E40BC2C48BE3258BE3F5E5EF23F96DBF4BE3DBF363E137407BF52BB7640E1E52AC0D94213407C02F0BD2C26714066B61C40F5612CC05AD71FBFDC6E44C03EAFE5BFEA4C11C0EA45B3BF7BC3B43E596FCA3F0F13963FFA128BC032F8F2BF5AF7C7C03E31DCBFDC4BAABFBECAE7BF501EFE3F9949474042591EC077674A4021340D4071570FC0681333C086D8883FF5F92BC0932C63C0FA4C70BF8D181FBF758A5CC0CB752140F57CD9C0164C1F4002E908C0F6926040DF0898C03D65BF3F495B01402F1F3240FB5F2F4038190740AE287DBF0F927A40F12886404F13CD3F8FC210C01CB3633F882D8B40F37BECBE4837EABF3FDA3EC0C49D1A3F7BA49EC08F75C4C05B79DC40AB9DC43E28D8923F5564F8BF10FEDD3FBEEC9ABFCB424E405652463FFD98A53F0F28EFBEEE370F4088241E4085432EBF30783E3F950A04BCCB0ED73F34BC87404BA22740D4DF5FBF77F11B4015F167400CCA8A4076A22140F7246CC02B11F23DAEF242C0E8BADBBFEEB956BFFD72BEBFF2B4C6BF3BD30AC01695D63DFFCB9340F7B2BFC06B34113F945A8E40B8EFBCBEB9E172C04BD3B0BEF72C0740A3C45740F733483F5680D73F679BD83FAEE280BF1BBBAC3F4EA148BF7A3C9EC0CD679E40CE8EAD3FF7D1423E36895FBF6469813FA487A23F0AEF2FC085C10FBD5453F9BF8B905D402614593F1166FFBF2C3EE73F2A7326C0237650BF1E3423C0417217C0CEAC1940F0D231C0C1B090C087ACBCBE1AFC08C07F10E9C04E52F33FD325E7BF5B6350400B0BC0BE6D7117C0E8374540E31058C0B1C566BFE1137EC04B557B40A502253FD9620F40043610C0C4EFA0C07F50053FF16C514037BC86C037E558403C8EB6C057754FC0CD48B2C0754F40C072B9F13FB844D1402B426240B0AAA340459F10C0DBAEB63F5E9E9FBF9921B8404FDA94BF847F75BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xF2524F3F91DB40BF2EA04B3F6CCA4ABF99BC7C3F303F643FFEAE78BFE254A6BD4FAEAD3E7DA1563FD58F763D01E36BBE96C21ABE71968ABEEB093FBF82C77FBFEECE51BE4356DE3D4FFD353F55D67ABFEA6DA83E6486FCBE14354CBFB960003F63A8013F84B7153C74EDCD3E4ADE7EBF104D36BE87C64ABEC57E7A3F10F57F3FB5B8213F9E8B193E6889343E289C87BEDB32FB3EF03768BF6FA56BBF3D73063F41BA563FDDED053F737D62BFC0490FBF2A71713D0BDE823E069AB9BE61F650BF161D58BF2D5904BF3D8D4E3FBF8F0E3F5DCC16BF685125BF0AED9DBE897A11BF02437BBFCA557E3F9B4F78BFF803323FD1C317BF64EB77BF24BA30BFD11B3B3F3F0E9C3D36EFB73E1D0E6F3F4D587DBFDD9C573F95575FBF9ED7CDBDBCEECF3EA9AF693FB1F0AEBD5F097F3FF5BA6BBF91682D3FCCC5FC3D34AF72BFEBBF1ABFE713B33ED8DAB0BE32DC753FA4495FBF06512CBEB402B33E7B23233F6EC341BFB91A2EBF676B7FBF90E36F3F97FE7F3F4E6229BF5A2640BF92C1253FF804833E63676DBFF9F13BBFF943E0BD3743EB3E9FF550BF4B123ABFB3131CBEC8566E3F78D872BFA80B653F01627FBFF622843EBD9F223F688FC4BE5FA27ABFB36C8F3E975E753F3FD7753F7EAD08BDE9027D3FE58149BF0FD890BE85194FBF945A74BE3545273F7E8D003F72AE593F419C6E3F63E862BF855A78BF23BE69BE119328BF3201F5BEE1C8583F41EF8CBEABDB7FBF62FA0DBF4BAC1D3F0AE7933EFD315A3F8BD6D8BE54D13E3EAED67FBF94C0FF3E530E39BF7CF7653F8BFD7F3FCC8B273FDE4E52BF1AF2763FB35398BE24BF11BF10B0BCBEF09FB93EEA4CF3BE61EF7E3F16818EBE9C7396BD8383553FEE996DBFEF2B6EBFF7DA843EF1A3233FED187A3F696B133F9C73A2BE0BD6AEBE87042ABFA70054BFBD3C24BF4F5254BF80377CBFFEB1103F2FA3233FDAFF7FBFD432533E8AB27E3F0B54163FD346683CDF247D3FC66A7B3E2E3368BFF10053BFA849643FEA985BBFA7A410BF2A057C3F2BE95F3F97BD23BF00121D3FDD88603F6EBA18BFD558523FC7800CBEF245743F939297BD4CB25F3F96645BBFC10BB2BCBBC99FBE69C831BF2BEE24BEAC127C3F51057DBF27E46E3F9D5B6FBFE281793F223A6ABF77247B3F108AB0BE063572BFB32834BE1BFD403FBADD2D3F42A1663F503B9D3E1BBA48BF637F253FEE577E3F54D07F3F3D74023F67EB2F3F8F8E543F0E732E3F9AE0443EA7A864BFDB4E4E3F8912003F80A8743F8A70F0BEEB713E3FD0B97C3F80F0093F27F34FBF723C92BE63C17CBF5F177FBFCC1F7B3F4447AB3DB55FA2BE5747633F21EF7B3F3AFE5C3F4E8A41BFD41664BFB8BF2ABF7A3E7E3FFF664FBFAEF444BF5DB966BF0DB34F3FA9547FBFCD1363BE8BD324BF53782D3ED135703F52BE2FBC5599C63EF163B7BECCA6A4BE96D97F3F697918BE09C3733E467C73BE6133CEBED0E67FBF631249BF96F17FBF67F517BF37C11EBFC40A71BF6739F63EF00366BF7BFC6ABF7642173F5E22503FEF3B74BFD38850BFB5015F3FE6654BBF67CE09BFF4EA6EBF64731E3D3A849A3D0AE3DEBEE4BA6FBFE7A76BBF0BA503BF14B30C3FBB2537BFB45AFEBE296900BD982A23BF103D213F03D7B5BECD2C653F5F2383BEE9BF7CBFDEB5523FCD90783E3F5B7D3FB952523FDE5A6D3F7771D23E0209B9BEE5B226BE0F94B43EE2277FBF55F2363F9E0C8C3E9393643F415E1EBF958F48BF6AF1463F2D5A3C3FDFFD7F3FDC7CDFBD682EE8BEF5DD5DBF0F31243FD5F942BF5BC662BF85A3BBBE44F050BFDD7D5ABFBF367E3F2FD57EBF06D114BE9D1A2B3F109CA93DFBB7963CE73210BF99987E3F4EB1BFBDBE1E753F6AE9573F368585BE49C46E3FA1434BBF4BE2703FC3E803BF6D4579BF2DA0353F5A8AE6BD5E1CF8BDEBD2083F66CD603E0E53353F2DEF6B3E6633713EEF575A3E7C617B3F7A73243FE9EE073F9ECF973E28856CBFA4D77F3F1D83BCBEC7F972BFD358293FB6E0D2BE65376FBE5D775BBF52B62F3F6F8054BF1AD936BFB1F93CBF3C4F6FBF633542BE65D06E3FBE0E0ABFEE4C0A3FEEFBA5BEFC796EBE16537EBFBA336E3FC8D636BFDA897FBF44FF78BF25D71E3F65132DBFC70035BFADA24C3FFFE41EBFE07721BF658A9F3EA6105E3F32D17DBF4253F6BEA03478BF945E563FF5B87EBF18D7413F3D9C7DBF8DED9FBEB1A0773F576A6CBFF06AC83EBABD22BFC986123E5BE4A23E3FFF5C3F0D18CB3E1C09133F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
