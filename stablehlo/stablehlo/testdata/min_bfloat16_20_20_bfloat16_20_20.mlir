// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.minimum %0#0, %0#1 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}, tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8640683E90C05F3F11C07EC09540B9BEF73FA2C08D3FA440D43EB2BF06C051401840B4C0B93F65C0D9BF8EBF6F3FC7403A405340B6BF863FE8BE9240953FE8BF2340D0BFAF3EDDBE80C0E5BF29C0CF3E72C05DC08CBF6FC026C038C0A0404540E43F5D40CE3FA24040C0394008401C3FA540DBBE55C0E7BF8940AD3FA0BFF93E16C046402BC04EC0D93F8AC0043F52BF8EC009C0B9405ABF1040F53FE93F683F8EC0C0C04FC0F0BF23BF4BBF8B40B2BCB2BFD1BF42400A40FF3F76C0214050BF7DC07EC0E43F8E3FB3C034C0A43FA040A93FB6BF06C05B4036BF263FD23F5740A2BFC03EA840D4BF01C020C003C03B3F4040A13F48C0C13F353EEB4053BFE3BEA93F023EB83F11C15340FF3E5B3F9640664039C0873D3F401BC0F5BF3AC043C0A03FCA3EE7BFE3BFA33F853F35409CC078C097C0194080C048C0294016BF61BF71C0F03E51C0A740073F5CBFDEBE833FFEC0A840E93FFC3F42408F40DC3EBB4026C01A40233FC1BE04C005C03F3FFCBF4DC020BFC33ECABF89C00E4002402BC052401E3F4AC0C1BF4F4056C058C0BCBF45C0A0BD9440C84002C00DC046C081401B40B2C06240E13E943F59C0E43E173FCE3FB3BF8840DD3E5B400F402A3F0740923E89406F3E884037BF6AC068C03DC0263E60C0AD40DCBFCFC0B0BE6BC0D83FC7BF6340B53F47C013C091BE083FF33FFEBF303F1940B8BE58BD04C0FBBF55C0A6C0EB3FC4C09B3F3A4022C0D63E89C0E5C09D3FA5C0943F2A3F1EBFB33F7A40C2BEF2BF14401F41CF3F70C064C000C06DBF2B406FBFDFC0C4C06CC0933F33C01D3E74C0353FCDBF65C0334003408AC061BF4C405740B5BFC43FD1BFD8BF8D3FBA3F2640803ECDBF8B3E83C08EBFB63ED9C0E73E234006C0074029C0E0BF40BE4240DB3FA33F5BC02B3FA23F24C019BE69BF58C0AD3DD5403EBF0B400940D43FC240BA3FECBFBF3E31C07C408840CB3EC9406D407F4081406FBFEE3FCC40A1C026C01FC03BC098405E4073C05B40B93FB8C062C090C051C09FBD264085BFC0405CC09140233F1DC05FBE5A40B43F7640A240FFBF9D3F34400EC080C030BFB13FE03FC0BF1040C240CD3DF43F51BF96BF86C090BCE2BF973F98BFDA3FA1BF54C0"> : tensor<20x20xbf16>
    %cst_0 = stablehlo.constant dense<"0x4640A63F8DC0FC3EAC3FBC3FAEBF14408D3FEFBF5EC0973F974096C0DE3F29BDC1BFD43FCABF94BF7BC0A6C094C03B3FBC3F48C0873F4540A3C014C0893F9C3F284002C09C3FADBF833F73C0A03FB8BF4C40234016BF72BF6E3F0D40903F853F9FBF0B3F38BF0040E23E9340A03F4B4036403E3F704013BF803F344047BF06C15A3F673F923FB43EEFBFAA3F8D3F7140B340B3C07F3F353FC43DC73F21C04140164054C02FC0F43FF6BF99BFE6BF2D3FA9BCA0C01E40933F7FC0B23F87BEB9BFA2BE3ABFEE40A6BE69405640B43F6DBF873DE43C53C082BFB1BEA9406FBEC6BF104059BFE5C0A7C0AC3F8140D63F13401B41163F1240B2BE8B40F53F4EC08B409B408C4097BF14BFAFBF9AC019C08FC0AB40FC3FFBBEA23F9CBF13407F401ABF9D40AF3F1D3F24C028C0C240823F0BC08140E2BFD8BFA0C09F40A54063C0563FD93F9ABF08C03640DEBF90BEB03F0AC010C01EC0EDBF03409640973E75C0E1BFEFBE2C403440F03F7D40773F003F90BF2640263F06BF90C03EBF143EC3C0AD40E1C0BAC011C0AFC0793F04404F3E33BFD23EE83FDDBF143F413F14BE10C01441244088C04D40C9C01D408BBF86408BC0233F62C016C08DC0A3409F3E3BC0FA3FA63F77400F400F3FAFC0DF3F95C0D53FE23F8FBF834062404740C840ECBF893F3540EDBFAE3F61BE02C094BEACC0BF3F363F743F31C08BBF7740C43DF2BE0D4068BFA9BF24BDF03F7A406640AA3F3CC0C5C0E6BFD4BFFC40D13FACC0E3BFAD3FAEBF8CC0333EA6BFC63FABC04A3F68404A4020409AC0933FC5C006C026402DC0CC3FA8BEF0BFF8BF793FFDC08E3F6D3F8E3DAFC0883F86400340094191C0483FE6BF153F323E93BF373E2C409B4050C0BA40C3BE6DC008C08B40E0BF13C0BBC084BE943E983F1840AA3FEF402CC013C0BF40A8BFB6C09240CEC0CDC0593ED2C00EBF053F70BFB94071C0B43F8B3F143F1E40A140CD3FD7BEAAC04FC06EBEAFBE414088BF6FC0354002407C3F973FC0BFD23F463FF03F973F0F41403F93BF6D40A9C0B1BF71C011C0C8BD443FB1401B4013BF713F4AC07040C63E10C00A407E3F0EC0883E60BD2B404C4023BFF2401D4081C027404DBFAD3E5BC080407540A03F"> : tensor<20x20xbf16>
    return %cst, %cst_0 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4640683E90C0FC3E11C07EC0AEBFB9BE8D3FA2C05EC0973FD43E96C006C029BDC1BFB4C0CABF65C07BC0A6C094C03B3FBC3F48C0B6BF863FA3C014C0893FE8BF234002C0AF3EADBF80C073C029C0B8BF72C05DC08CBF6FC026C038C0903F853F9FBF0B3F38BF004040C03940A03F1C3F3640DBBE55C0E7BF803FAD3FA0BF06C116C0673F2BC04EC0EFBF8AC0043F52BF8EC0B3C07F3F5ABFC43DC73F21C0683F8EC0C0C04FC0F0BFF6BF99BFE6BFB2BCB2BFA0C01E40933F7FC076C087BEB9BF7DC07EC0E43FA6BEB3C034C0A43F6DBF873DB6BF53C082BF36BF263F6FBEC6BFA2BF59BFE5C0A7C001C020C003C03B3F4040163F48C0B2BE353EF53F4EC0E3BEA93F023E97BF11C1AFBF9AC019C08FC0664039C0FBBEA23F1BC0F5BF3AC043C0A03FCA3EE7BF24C028C0853F823F9CC078C097C0D8BFA0C048C0294063C061BF71C09ABF51C03640DEBF5CBFDEBE0AC0FEC01EC0EDBFFC3F4240973E75C0E1BF26C01A40233FC1BE04C005C0003FFCBF4DC020BF06BF90C089C0143EC3C02BC0E1C0BAC04AC0AFC0793F56C058C0BCBF45C0A0BDDDBF143F02C00DC046C081401B40B2C04D40C9C0943F59C0E43E8BC0233F62C016C08DC05B409F3E3BC0FA3F923E77406F3E0F3FAFC06AC095C03DC0263E60C08340DCBFCFC0B0BE6BC0893FC7BFEDBFAE3F47C013C094BEACC0BF3FFEBF303F31C08BBF58BD04C0FBBF55C0A6C0A9BFC4C09B3F3A4022C0D63E89C0E5C0E6BFA5C0943F2A3FACC0E3BFAD3FAEBF8CC0333EA6BFC63FABC064C000C06DBF20409AC0DFC0C5C06CC0933F33C01D3E74C0F0BFF8BF65C0FDC08E3F8AC061BFAFC0883FB5BFC43FD1BF91C0483FE6BF153F323ECDBF373E83C08EBF50C0D9C0C3BE6DC008C0074029C013C0BBC084BE943E983F5BC02B3FA23F2CC013C069BF58C0B6C09240CEC0CDC0593ED2C00EBF053FECBFBF3E71C0B43F8B3FCB3E1E406D40CD3FD7BEAAC04FC06EBEA1C026C01FC06FC03540024073C0973FC0BFB8C062C090C051C09FBD403F93BF6D40A9C0B1BF71C01DC05FBE443FB43F1B4013BFFFBF4AC034400EC080C030BF7E3F0EC0C0BF60BD2B40CD3D23BF51BF96BF86C090BCE2BFAD3E5BC0DA3FA1BF54C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
