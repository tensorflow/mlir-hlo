// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%0, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %0 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCEF2FB3FE3EF8FC0F814ACC0CBE8973FC140494020458440032B3EC0E1E50640B5C657C0647B834002AF35C0CBB6154189EFC63F5A351E4000E022C09BA35F40E2972FBF345DCEBEA9DA1B4061A426C0EB3806BF57CD8E40E2F22E3FA1F878BF7ADA9BC0D9EC9540F3C7E0BF049842C000AE28C07A607D40F4573EBF077C94BFA948F6BFC5D81840348C8DBF476B77408D54EEBF9FC14F40E7CFDCBF5D4347C01EB49CC05FC3F6C0B7C11F3DC28A1740F24E5B3FA1170ABF659E8D3EFFAF26BE4C9B4EC0806770BD0F3381C010433EC08110273FDFCADD3E91DA343F3B90733F3297B3C018A4FB3F0E223FBE9D44E33FACB2B93FA9D25740F1B98FBFF3297840086014BF41BF45BE2EDD5BBF3F8D344065A2FD3F5CA151C074D06A402486683F2C9BC2C040D23CC00631E43F74182540E08E15BF8D9F873FBBFCD83F066C97C0C27D8D3FC0DD0AC0800838C097A44ABF05EB603FC35D973F5020EDBFB6478BC07FF627C0392707BFD2F28AC0B1FB1CC069D7DF40C5915DBF14546540AB1004400EEAAB3EC086B04013B53F40962DDDBEAF01CABF026A6CBF392A1340EC2F8E3D464E7DC04EE01AC0395400C02BF2A7C00207CFBFB4380E3FBCEDF3BE7BBEB03F501489BF1C36A13FF9DD3D3FEE6260BE514DF83F7F95A3C0E5A192C06E69CABE7CD8AFBF4652A03F3F1BC5C08E35F6BDEF3603BF69FE5E3F3A0485BF1B8C18BE8D149DBC50BD323FB2DE67407367E43FF63DC13DA2130940029DD6BE6742CFBF0CE2523F556A57BF034F83BFDCDFC03FE8D150C0E39F7440DC3113C06F151DC024C9CB3F7E9ACA4046270DBF4B20C2C081930640327517C02AB13D4072A219BF6DF33340F3E9633F6F72913F5AC1243CFFA2233F1CB9AEC0C6BE9E3F4B6F6340B50E8A3F2E2969BE6CB98BC0310160C0C894D9C05F42B9BFFAABF2BFA1AE2740882682C022D442C0B6823F3FEA3E1640229EB3C034954EC07CC6A53C5B539E4009AD0A3F9C21AB3F551320C083460D40B6AF5CC0889D9C40C8486DBF919D31C02B1D123E3E1A2C407DFE133FCC6FE03FBDBE954071AEB53F42C171407426D7BF7C18893EC1515EBE904EFC3FA7C4BABFF27AFD3BDA581F418BD2833F03374040F70541BFE47F9F4036215FBF7EBCBB40EBA31DC086888AC01E5140C0BBA277BFDEA6E6BF227D0F3FE260A6C0F7C5F23FFE129A40430DC3BD2EF1E03F03FE7BBE6FBE00C0147E8DC01443DA3E9E2A483F2EB98DC0C4A142C08D472A3FE5992840A7F27DBF8071B4C0C97C1D4030585BC0D4C31E403F16934022D503C05E6739C04EA360C010F4A1BEA29F02C0447015C07D5BD3BF1406C03EA4058D404B67014095B33E40EC18F4BE54140C3F5764A4BF608647BD34ACDC40AB7B9EC0FF8BFF3FC856E6BF897A823F1B7992C0089558C07B9D96C0BE1105C0843B1CC0981E3EC0F0B6F43F0A5E983FBB06784034A1EFBF0348ADC06BDA70406754A53F3ED15AC08D3E1C400ABA05C104E72E3EDFD74B4059A31D4035DE6E40364AEDBFA6868F3F245631BF69E208C06DBBE8BF4829D2BF39E926C002A58F40152327BF17F6DFBE9C2C73BF71609640C8AAF9BFEFD85ABF44493D40D10C7A4000BA71BF3F4396C09F6A59C09DB474C06A19D3BF4F243FC0BDFA85C08AD28AC0E0E505C0EFC1FDBFC2C64EBE2B9CDCC0E7A05F409E064DBF8CDD0FC167CA633EE03048BFF94657400F5486BE5AD52FC08B6634C0F88817C0E23A8A3FDF45AD40968787C012C4F2BF6C52914023FFC03E78B2423F4C6909407FF0C53F1B593E40994B9D406643373FA3696D40512482C050702CC0FEE388BFE7E3D33F7AAA57C04A1721C033B407BF7A7E80C017D08ABD25E34CBF30D28A4022C7A53F3D118FC0266DC63F74DA9D3C991BCB3FDAD736408B50084018ACD7BF540646409C7DDBBF5F0E773FDED2DB3FDAC839BF9733C7BFAFE4623DC3524BBE3C4FF4BF8145F53FDF3A28C0BD4FE6BF451996C0DD852BC0C9622840214730C02FA7E1BF9C7AA14031B9CDBF9E3A913F55BF4A3F0BF53A403203214076ABC2BD9210FDBE7E80853EE1CFC43F0EA7C23F8199CABECAA7C9C0FEF06AC08237B8BF6A224040EED48F3F8F3FB640546CF53ED9B711BEB5A34EC0D7C80F40E533433FE0790140094125C0E9E5D53E2041384076830AC0289804BF276ED93FC5A4833F689662BEFF796FC0F4A923C022C3A8BFC66961C08E468CC09C144E40164FCA3F6A29E4C09F878940E8A5C03F31516040FF1900BF94D19B40300127C04CC40B40CE701940A81C0C406E48DBBC0B0BB4C0287A20C0CC2B3AC0C93486C0938D38403CF86B3F92EE2AC083AA0B408DE8653E276D8FBE766E844048F73F40FC2ABCC08E817EC0748E8440EDEB894078CA7D3F355642BF34CBA440EECEA9BE1F3983407BADB3BFCF522D3F1927E13F0C675B40CF0B31C04A12F2BE4C620E4053C4103F26ACC9BF45855B40C5ABA2BFFF7331C00D2094BFAE4A573FC5FBB53E0934AF3F04827A403412A140711A8C3F055D39BFDA1635C0A36BA5BF74273FBEA7B925402F5A9BC0794E88BF95E4093F65B6B73F5D8EE53FD4CB47C06939613F8EC84ABFA258E9BFC0837AC0D7A3B73F92DAE63F2D490EBF5AD903BF8CBB67408CEA783FEA3365C04144AB3C97E08A401FAE014032CF7F3EBD67294075CD82BFCB9A0B3E3EF60CC1055E71BFC69017400245593F0327194079BBA73EC52D9A40162892C0AE61A93F2A07A1BF35C0FCBFE4EDAEBDE02942C0D35644C0C749403FA94733BE108DFC3F9CADD940D872A8C0A6E1A1C0566C394070CBA140E31B093FCBCDAABFE7B7D8BFA024EEBE638ED2BDB1D3C34037BF47C090B103C0AB38D5C0C10854C087F997BF4DCAA6C03F73083F256BF3BF5565423F1C0040C0EE57FD3FF8D953BF9C7E20C0500E04BED3F635C08CC15C405129E33F14555BBE9E353EC00FD789C09773DDBE8C988340B98AA83E568EF03E43C96C40B9944C4082BCBB3E66BDF93FF575843F12EC1240A159FD3FA98CFCBF2A2A81C0D26E5EC0A70CE5BF389F9BBF0873254015A37ABF55664AC047A4DC3ED31720C0BB0B04C07E9AAB3E6E483E3F523779C0F474ABBD9461763E779090C0772725C0FDFF07C0E2479540D73902C0FECE28C0AC327A40BF5E00C0D5D3083EDFAEA040F7C1124074721D3FD58AD7C0A546AD4092D5BEC0C70F03C1449E1CBF865DC7BE418417C0C24009C0C122D8C0F96006C021369A4090E5E1BEDC221CBE082E853F994D48C06DFB7C3F7307ADBEE4BC44408FF176C0C86ACD3F85B0FD3FCF3A8A40B54B0AC0E159BBBECBEB703FA7F52F402EE5FD3E7D5B2540A09EAA40AC3000C161A911C0C5C9923E7E6230C03D60C9BF3BC7893F39D853C06C93E6C0F9C129BE7F9BE03FF34B5DC0051697BE1A85CE3F53850BC0CC327540BF2012C0F44FBDBFCCD011C05B5FC4405CF4D13F947F0BC038BA3A407835373FFAADE8BF89747B40158581C06B7FD83F45015140FA136E40D159BD3E9D92873F877B3C4068A6E93F81E714C087C9073EDFFFB4C0E18E15BF73B05EC00F0C82C09CCA913F7BB530400BF089BF90E2563EFA194EBE19D0883FD17C5540972F074018F287C057FD1E40AD340A3FA5C00FC00A842F3ED37D833FDB2E84BFE131DF3F1346CDC0A1DAF73F7B0B6540FA59BCBF6AFE3A401EAA09C0D5E92FBF118AC2BD863A093F3504273F7ED1E33FCCD068BF65A99DC0435CDBBFB13AD23F5E703740B9778BC00F47C63F4EBF7CC07FEEE8BF16EBB9C06072E34062E907405E2928BF6E3810404E2045C051FFBFC02F528F3F3A23513F9994C4BFB1DFD6BF72FAE43FB12AAB40D582EB3E4123413F77DAA540155E24C07FE97F40F702183F3ED815406DAAB2C050D9623FB040CA3F68ED30C0ABFDD0BE498193BFA666A73F18D2873FAF2C384096DBF23F99E6E63FECAC87BF80BD953DA16DF53F4C855A40E80CC2BD0D67FB3FCD29D9BFC1BEE03FDA5854C01D3A5E40A06DD63FF6475040B29F4CBF562D2AC0DE81C73FFD8C923F76745BC0FC8305C00DEF4640531BBD3F2808CBBF26B34E4000A84E3EABFF13C09E3D22C0A75821402E66E6BFF3CD74BDFAA21C3D4FB607C00B5DAFC081F699C070C0D63EE690E340A06361C03DAB76BFE16DD13D223551C0459FF13FBDF02C406FA48D3EA23D46403FD1FCBFA6FD98BF94E724C0441EA8BF5F2EB040FB8C2E40AD68AAC0B5344C40CB0350BFE3993B40A77CA0BFAF81C6BF1AE325BE77DA9940556AD23F51F2C03FCB6967C092F5DABED0767F3F234FB3BF30D0DB3F28B4224015C13D4058DC673F042D4D4099056F3F9A7196C01B5601C0C721B9BFC1D29CC0D0C9A7BE3F1093C08FA893C063D581C027352B4028AF3EC091688E40FF477A4021EC2FC036B31E40B9D401C07093104024A216C04313DD40530D0BC02911363F2C8AB1BFEC46AEBF176D41C0AFED16BF3ABB0DBF52B70DBF75DF963DA307A23CB6E268BF487640BF68DF8DBEF168BEC0FA59A4C0C0DA7C3F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCEF2FB3FE3EF8FC0F814ACC0CBE8973FC140494020458440032B3EC0E1E50640B5C657C0647B834002AF35C0CBB6154189EFC63F5A351E4000E022C09BA35F40E2972FBF345DCEBEA9DA1B4061A426C0EB3806BF57CD8E40E2F22E3FA1F878BF7ADA9BC0D9EC9540F3C7E0BF049842C000AE28C07A607D40F4573EBF077C94BFA948F6BFC5D81840348C8DBF476B77408D54EEBF9FC14F40E7CFDCBF5D4347C01EB49CC05FC3F6C0B7C11F3DC28A1740F24E5B3FA1170ABF659E8D3EFFAF26BE4C9B4EC0806770BD0F3381C010433EC08110273FDFCADD3E91DA343F3B90733F3297B3C018A4FB3F0E223FBE9D44E33FACB2B93FA9D25740F1B98FBFF3297840086014BF41BF45BE2EDD5BBF3F8D344065A2FD3F5CA151C074D06A402486683F2C9BC2C040D23CC00631E43F74182540E08E15BF8D9F873FBBFCD83F066C97C0C27D8D3FC0DD0AC0800838C097A44ABF05EB603FC35D973F5020EDBFB6478BC07FF627C0392707BFD2F28AC0B1FB1CC069D7DF40C5915DBF14546540AB1004400EEAAB3EC086B04013B53F40962DDDBEAF01CABF026A6CBF392A1340EC2F8E3D464E7DC04EE01AC0395400C02BF2A7C00207CFBFB4380E3FBCEDF3BE7BBEB03F501489BF1C36A13FF9DD3D3FEE6260BE514DF83F7F95A3C0E5A192C06E69CABE7CD8AFBF4652A03F3F1BC5C08E35F6BDEF3603BF69FE5E3F3A0485BF1B8C18BE8D149DBC50BD323FB2DE67407367E43FF63DC13DA2130940029DD6BE6742CFBF0CE2523F556A57BF034F83BFDCDFC03FE8D150C0E39F7440DC3113C06F151DC024C9CB3F7E9ACA4046270DBF4B20C2C081930640327517C02AB13D4072A219BF6DF33340F3E9633F6F72913F5AC1243CFFA2233F1CB9AEC0C6BE9E3F4B6F6340B50E8A3F2E2969BE6CB98BC0310160C0C894D9C05F42B9BFFAABF2BFA1AE2740882682C022D442C0B6823F3FEA3E1640229EB3C034954EC07CC6A53C5B539E4009AD0A3F9C21AB3F551320C083460D40B6AF5CC0889D9C40C8486DBF919D31C02B1D123E3E1A2C407DFE133FCC6FE03FBDBE954071AEB53F42C171407426D7BF7C18893EC1515EBE904EFC3FA7C4BABFF27AFD3BDA581F418BD2833F03374040F70541BFE47F9F4036215FBF7EBCBB40EBA31DC086888AC01E5140C0BBA277BFDEA6E6BF227D0F3FE260A6C0F7C5F23FFE129A40430DC3BD2EF1E03F03FE7BBE6FBE00C0147E8DC01443DA3E9E2A483F2EB98DC0C4A142C08D472A3FE5992840A7F27DBF8071B4C0C97C1D4030585BC0D4C31E403F16934022D503C05E6739C04EA360C010F4A1BEA29F02C0447015C07D5BD3BF1406C03EA4058D404B67014095B33E40EC18F4BE54140C3F5764A4BF608647BD34ACDC40AB7B9EC0FF8BFF3FC856E6BF897A823F1B7992C0089558C07B9D96C0BE1105C0843B1CC0981E3EC0F0B6F43F0A5E983FBB06784034A1EFBF0348ADC06BDA70406754A53F3ED15AC08D3E1C400ABA05C104E72E3EDFD74B4059A31D4035DE6E40364AEDBFA6868F3F245631BF69E208C06DBBE8BF4829D2BF39E926C002A58F40152327BF17F6DFBE9C2C73BF71609640C8AAF9BFEFD85ABF44493D40D10C7A4000BA71BF3F4396C09F6A59C09DB474C06A19D3BF4F243FC0BDFA85C08AD28AC0E0E505C0EFC1FDBFC2C64EBE2B9CDCC0E7A05F409E064DBF8CDD0FC167CA633EE03048BFF94657400F5486BE5AD52FC08B6634C0F88817C0E23A8A3FDF45AD40968787C012C4F2BF6C52914023FFC03E78B2423F4C6909407FF0C53F1B593E40994B9D406643373FA3696D40512482C050702CC0FEE388BFE7E3D33F7AAA57C04A1721C033B407BF7A7E80C017D08ABD25E34CBF30D28A4022C7A53F3D118FC0266DC63F74DA9D3C991BCB3FDAD736408B50084018ACD7BF540646409C7DDBBF5F0E773FDED2DB3FDAC839BF9733C7BFAFE4623DC3524BBE3C4FF4BF8145F53FDF3A28C0BD4FE6BF451996C0DD852BC0C9622840214730C02FA7E1BF9C7AA14031B9CDBF9E3A913F55BF4A3F0BF53A403203214076ABC2BD9210FDBE7E80853EE1CFC43F0EA7C23F8199CABECAA7C9C0FEF06AC08237B8BF6A224040EED48F3F8F3FB640546CF53ED9B711BEB5A34EC0D7C80F40E533433FE0790140094125C0E9E5D53E2041384076830AC0289804BF276ED93FC5A4833F689662BEFF796FC0F4A923C022C3A8BFC66961C08E468CC09C144E40164FCA3F6A29E4C09F878940E8A5C03F31516040FF1900BF94D19B40300127C04CC40B40CE701940A81C0C406E48DBBC0B0BB4C0287A20C0CC2B3AC0C93486C0938D38403CF86B3F92EE2AC083AA0B408DE8653E276D8FBE766E844048F73F40FC2ABCC08E817EC0748E8440EDEB894078CA7D3F355642BF34CBA440EECEA9BE1F3983407BADB3BFCF522D3F1927E13F0C675B40CF0B31C04A12F2BE4C620E4053C4103F26ACC9BF45855B40C5ABA2BFFF7331C00D2094BFAE4A573FC5FBB53E0934AF3F04827A403412A140711A8C3F055D39BFDA1635C0A36BA5BF74273FBEA7B925402F5A9BC0794E88BF95E4093F65B6B73F5D8EE53FD4CB47C06939613F8EC84ABFA258E9BFC0837AC0D7A3B73F92DAE63F2D490EBF5AD903BF8CBB67408CEA783FEA3365C04144AB3C97E08A401FAE014032CF7F3EBD67294075CD82BFCB9A0B3E3EF60CC1055E71BFC69017400245593F0327194079BBA73EC52D9A40162892C0AE61A93F2A07A1BF35C0FCBFE4EDAEBDE02942C0D35644C0C749403FA94733BE108DFC3F9CADD940D872A8C0A6E1A1C0566C394070CBA140E31B093FCBCDAABFE7B7D8BFA024EEBE638ED2BDB1D3C34037BF47C090B103C0AB38D5C0C10854C087F997BF4DCAA6C03F73083F256BF3BF5565423F1C0040C0EE57FD3FF8D953BF9C7E20C0500E04BED3F635C08CC15C405129E33F14555BBE9E353EC00FD789C09773DDBE8C988340B98AA83E568EF03E43C96C40B9944C4082BCBB3E66BDF93FF575843F12EC1240A159FD3FA98CFCBF2A2A81C0D26E5EC0A70CE5BF389F9BBF0873254015A37ABF55664AC047A4DC3ED31720C0BB0B04C07E9AAB3E6E483E3F523779C0F474ABBD9461763E779090C0772725C0FDFF07C0E2479540D73902C0FECE28C0AC327A40BF5E00C0D5D3083EDFAEA040F7C1124074721D3FD58AD7C0A546AD4092D5BEC0C70F03C1449E1CBF865DC7BE418417C0C24009C0C122D8C0F96006C021369A4090E5E1BEDC221CBE082E853F994D48C06DFB7C3F7307ADBEE4BC44408FF176C0C86ACD3F85B0FD3FCF3A8A40B54B0AC0E159BBBECBEB703FA7F52F402EE5FD3E7D5B2540A09EAA40AC3000C161A911C0C5C9923E7E6230C03D60C9BF3BC7893F39D853C06C93E6C0F9C129BE7F9BE03FF34B5DC0051697BE1A85CE3F53850BC0CC327540BF2012C0F44FBDBFCCD011C05B5FC4405CF4D13F947F0BC038BA3A407835373FFAADE8BF89747B40158581C06B7FD83F45015140FA136E40D159BD3E9D92873F877B3C4068A6E93F81E714C087C9073EDFFFB4C0E18E15BF73B05EC00F0C82C09CCA913F7BB530400BF089BF90E2563EFA194EBE19D0883FD17C5540972F074018F287C057FD1E40AD340A3FA5C00FC00A842F3ED37D833FDB2E84BFE131DF3F1346CDC0A1DAF73F7B0B6540FA59BCBF6AFE3A401EAA09C0D5E92FBF118AC2BD863A093F3504273F7ED1E33FCCD068BF65A99DC0435CDBBFB13AD23F5E703740B9778BC00F47C63F4EBF7CC07FEEE8BF16EBB9C06072E34062E907405E2928BF6E3810404E2045C051FFBFC02F528F3F3A23513F9994C4BFB1DFD6BF72FAE43FB12AAB40D582EB3E4123413F77DAA540155E24C07FE97F40F702183F3ED815406DAAB2C050D9623FB040CA3F68ED30C0ABFDD0BE498193BFA666A73F18D2873FAF2C384096DBF23F99E6E63FECAC87BF80BD953DA16DF53F4C855A40E80CC2BD0D67FB3FCD29D9BFC1BEE03FDA5854C01D3A5E40A06DD63FF6475040B29F4CBF562D2AC0DE81C73FFD8C923F76745BC0FC8305C00DEF4640531BBD3F2808CBBF26B34E4000A84E3EABFF13C09E3D22C0A75821402E66E6BFF3CD74BDFAA21C3D4FB607C00B5DAFC081F699C070C0D63EE690E340A06361C03DAB76BFE16DD13D223551C0459FF13FBDF02C406FA48D3EA23D46403FD1FCBFA6FD98BF94E724C0441EA8BF5F2EB040FB8C2E40AD68AAC0B5344C40CB0350BFE3993B40A77CA0BFAF81C6BF1AE325BE77DA9940556AD23F51F2C03FCB6967C092F5DABED0767F3F234FB3BF30D0DB3F28B4224015C13D4058DC673F042D4D4099056F3F9A7196C01B5601C0C721B9BFC1D29CC0D0C9A7BE3F1093C08FA893C063D581C027352B4028AF3EC091688E40FF477A4021EC2FC036B31E40B9D401C07093104024A216C04313DD40530D0BC02911363F2C8AB1BFEC46AEBF176D41C0AFED16BF3ABB0DBF52B70DBF75DF963DA307A23CB6E268BF487640BF68DF8DBEF168BEC0FA59A4C0C0DA7C3F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
