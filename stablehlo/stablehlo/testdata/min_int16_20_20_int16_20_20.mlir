// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.minimum %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0400FDFFFDFFFFFF03000500010000000400FBFF0200FCFF08000200FFFF00000000FEFF00000000FCFFFFFFFFFF0100020000000000FDFF0000FCFF00000300FFFF03000300020000000100FCFF0000FFFFFDFFFFFF03000000F7FF0300FFFF0600FBFFFBFF0300060006000000040001000100FFFF030002000200000002000000010001000300FEFFFCFF0000FAFFFEFFFFFF0100FFFF0000040000000200000000000200010000000000FFFF0000FDFF000000000000FFFF0200FDFFFEFF030002000200FDFF04000400FDFFFEFF000002000100FDFFFDFF010000000300FCFFFEFFFEFFFEFF00000400FFFFFBFFFEFF0300FFFF0400040002000200FDFFFFFF0300FFFF030002000000FFFF0000010005000000FEFF0000FDFFFEFFFFFF0400FCFF0100000003000000FDFF0200FFFF00000800FEFFFDFF0200FEFFFAFF00000300050001000300000001000500020003000000FFFF00000000010002000500FCFFFEFFFFFF0300FAFFFFFF000003000000050000000200FCFF0000FDFFFBFF0100020000000000FFFF01000000FFFF0000020007000400000000000000010002000200FCFF0900FFFFFFFFFEFFFBFFFFFF0300FFFF0000FDFF0100FFFF0100FDFF00000000FFFF0000000000000500030000000100000000000400000000000000FDFFFFFF00000200F8FF0000FDFF0000FFFF00000200FEFFFBFF000000000000FBFF0000FDFF040003000000FFFF00000400000000000000FFFF0000FAFFFFFF0200FEFF0000FFFFFCFF00000500FBFFFEFFFDFFFEFF080004000000FFFF0400FCFF0600FFFF0300010000000200000006000000000001000400FFFF0300040002000000FEFFFEFF00000300F8FFFEFFFCFF0300FEFFFDFF010003000000FFFF00000200FFFF0000FDFF000002000300FDFF000002000000FDFF000002000000FFFFFBFF0700030002000100FFFFFFFF0100020001000000FEFFFEFF0000FDFFFFFF02000500FEFF0000010002000300FFFF0600FAFFFAFF0100FDFF020000000000FEFF02000000FDFF0100FEFF000001000500000002000000FAFF070004000500FFFF0100F9FFFFFFFDFFFFFF07000000FEFF0100040000000400"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0xFCFF0300FFFF000001000100000001000000FBFF01000200020006000300FFFFFFFF00000000FBFFFBFF0400000000000000FDFF040001000000FCFF0000FFFF0000FDFF0700FEFFFAFF010004000000FFFFFFFF00000100FEFFFDFF01000000FFFF02000300FEFFFFFFFFFF0100FBFF000003000300FFFF020000000000020004000000FEFF01000000FFFFFDFF00000000FEFF01000100010002000000FFFF0000000004000300030000000100FBFFFDFFFFFF020000000100FFFF00000000030000000000FFFF0400FBFFFFFFFFFF00000000FFFF0000FFFF02000200FCFF020003000200000004000500FEFFFAFF05000400FFFFFDFFFEFFFFFF0000FDFF03000000FEFFFDFF0100FDFF0200FEFF01000000FFFFFFFF0000FDFFFEFF0100FFFF000001000300030000000000FDFFFFFF00000000FFFFFEFF01000000FFFFFFFF0000FCFFF9FF000000000000020003000500FFFFFFFFFFFFFCFF0400FFFF010001000300FFFF0000000002000000FCFFFEFFFFFF0100000000000100FDFFFBFFFEFF00000000FCFF0400050000000200FEFFFFFF030005000000040002000600FCFF0100FFFFFCFF040003000000FEFF02000100FEFFFFFFFFFF020002000100FCFFFEFFFFFFFFFF00000400FDFF06000100FBFF00000300000000000400FCFFF9FFFDFFFEFF0000FDFF0100FDFF000005000200FCFFFEFF01000000FEFF0000050000000700040002000200FFFF04000200FCFF0400FCFF0000020003000000FFFF0100FEFF020002000100FDFF01000100020000000000FBFFFFFF04000300FFFFFCFF00000500FEFF00000200FEFF0000FCFF0100FDFFFEFF000000000000FEFFFEFFFEFFFFFFFFFF03000000FFFFFEFF02000000010000000200FCFFFCFF01000300FFFF00000200000002000000FBFFFEFF0300FDFF010001000200020003000000FEFF03000100FDFFFEFF000000000000FCFF040000000200FEFF0000FEFFFDFFFEFF0100040000000200030008000200FEFFFFFFFFFF0100000001000300010000000500FDFF0000FDFF01000000000000000000F9FFFFFF020001000000FBFFFEFFFFFFFEFFFDFFFFFF040000000400FCFFFDFF0000FDFFFDFF"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFCFFFDFFFDFFFFFF01000100000000000000FBFF0100FCFF02000200FFFFFFFFFFFFFEFF0000FBFFFBFFFFFFFFFF00000000FDFF0000FDFF0000FCFF0000FFFFFFFFFDFF0300FEFFFAFF0100FCFF0000FFFFFDFFFFFF0100FEFFF7FF0100FFFFFFFFFBFFFBFFFEFFFFFFFFFF0000FBFF00000100FFFFFFFF020000000000020000000000FEFF0100FEFFFCFFFDFFFAFFFEFFFEFF0100FFFF000002000000FFFF000000000200010000000000FFFFFBFFFDFFFFFF00000000FFFFFFFFFDFFFEFF030000000000FDFF0400FBFFFDFFFEFF00000000FFFFFDFFFDFF01000000FCFFFCFFFEFFFEFFFEFF00000400FEFFFAFFFEFF0300FFFFFDFFFEFFFFFF0000FDFFFFFF0000FEFFFDFF0100FDFFFFFFFEFF01000000FFFFFEFF0000FDFFFEFFFFFFFFFFFCFF0100000003000000FDFFFDFFFFFF00000000FEFFFDFF0100FEFFFAFFFFFF0000FCFFF9FF000000000000020002000300FFFFFFFFFFFFFCFF0100FFFF0100FCFFFEFFFFFF0000FAFFFFFF0000FCFFFEFFFFFF00000000FCFF0000FDFFFBFFFEFF00000000FCFFFFFF01000000FFFFFEFFFFFF030004000000000000000100FCFF0100FCFFFCFFFFFFFFFFFEFFFBFFFFFF0100FEFFFFFFFDFF0100FFFF0100FCFFFEFFFFFFFFFF00000000FDFF05000100FBFF00000000000000000000FCFFF9FFFDFFFEFF0000FDFFF8FFFDFFFDFF0000FFFFFCFFFEFFFEFFFBFFFEFF00000000FBFF0000FDFF02000200FFFFFFFF0000FCFF0000FCFF0000FFFF0000FAFFFFFF0100FEFF0000FFFFFCFFFDFF0100FBFFFEFFFDFFFEFFFBFFFFFF0000FFFFFFFFFCFF0000FFFFFEFF00000000FEFF0000FCFF0000FDFFFEFF0000FFFF0000FEFFFEFFFEFFFEFFFEFF00000000F8FFFEFFFCFF0000FEFFFDFF0100FCFFFCFFFFFF0000FFFFFFFF0000FDFF00000000FBFFFDFF0000FDFF0000FDFF000002000000FFFFFBFF03000100FDFFFEFFFFFFFFFF0000FCFF01000000FEFFFEFF0000FDFFFDFFFEFF0100FEFF0000010002000300FFFFFEFFFAFFFAFF0100FDFF010000000000FEFF0200FDFFFDFFFDFFFEFF0000000000000000F9FFFFFFFAFF01000000FBFFFEFFFFFFF9FFFDFFFDFFFFFF00000000FCFFFDFF0000FDFFFDFF"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
