// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.log_plus_one %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC1B20DC9ABD90A40A4FE4A233F53FC3FF0A965DB26320C40FD1B6F42791EE9BFA65464FC1E75DD3FCA68B8489C22E83FF6414101FA4AF53F969B73FB9B6CEA3FA9396FE06106EABFDE764AEA30AFFE3FCC9951616E3FD1BF9AA2EFC7BABEC1BF501C02656F0FFD3F53E501D1D51CFA3F9F64E06F622806C06A60B1BF6295F4BF7692B5B3426AF13F728FC44BFFA3D63FF4AA54ED451CF53F59887614140F04C01EF66295E04918405E67321A120F0440B00F69D57844E5BF74B214FDECC3CABF54398256744D11C0ADA593EDC0E2D63F64FC7EC7934C004038A14E9D0D8315C02A07EE197389104083EAACA744FA10404B0DF82720CC16404E98639C851508405D96A9C440570BC066E64CAFF074F83FD256CF28B48DD93FE6FD0EC57CF9F73F45CC1E2D2226F0BF67E9A4CE182F144042B5EB6A4D48FD3F41A44B1D8D1E064000FA9DA701AA07C0C7E65D12FA4D08C05688A9312BF802C00673D93913C7F4BF2056864BCFAEF73FCEA089942CD61640422D3AA81E8E09C03068E58BE4AA084039A85A7B0179E9BF0E9F24EA2F799B3F50DD921B949C06401A4C8870DCF4FDBF807B6230062CE3BFB72B301ABC4A0A4012FAC4013E2A0C40781252AF2CE001C02674994ADF81F8BF8F22DBB34830D6BFD2DE9896F205C9BFDDBE4CC39EA1E2BF59236B6F41200440AD673CF2EF17D8BFC428C6F857FFDDBF24F03DA54C91F43FD526BE1198A215402391927B3A3A1140A1BEB769BA62024033307501DCEDF63FD682492F7A4103401D2C714E42F413C06C9DAA516E80F03FEEFCDF82539B1A4099870586F6E403C0E900D9D99652F53F201A527D74290B40BE9886A97FAFED3F6644CE1536AD0140A6B63D195B4FEEBFD21CE023EFCCFFBF8CFFCBB75316FFBFD22D92352C16A5BF38983D16F6F402C0848432EBDAF8F5BF28775CAF1328FEBF966353C5EC51FC3F2AE428D34135A83F0089B74BF55FF9BFD7DA16274F77F2BF4948C30551C519C0DCDEBA2A152307402A1206F820407C3F9E2DB45BAFDDFFBF8FE550298C951040FBD8D6B93EA7F63FB3D252AB9DEE0340C80E16F6ADA7F83FB819CCD4FA2C0040BEB0F1EFAA4E00C0DCCE88FF01910740A646564B97AD004022B0E71245FFE4BF40A007D9A1E3B4BF1F356C54821201C0E6413D98EACD07C05AF5D92BD99E0EC067854B8DA4E9FE3FA92BAC8E54341140EA235EB564C50140AE177089CCF017C07AD7C7E5D5EDEE3FFA20CDED8748DB3F6518C5297FC80B408201503D3EC9DF3FF0F61D1EA10AF8BFF5ED4109943411C07EC572754908FD3FD63ACB6B0E18F63F32F00C336480C1BF4B51D482CFA41CC02E04372E6DAEB23F6359765DB89ACF3F32D9A159014F0640F83CDB10F0D61140C44220D625C3D9BFE59D3B8242E511C0B4867E107E3EF8BFDD11E600D541FFBF1EEC330C98740F40CC816980F91ED23FA85186B95F74D1BFC00E8EA5D407F4BFB6BB271A7709FFBF02C6000C48600E40CA4F7246A3370CC0780E905D89A0F23F1609947EF363FD3F90A3F4BAC4A40F40FC83CD97E4390040028C41CE267D13C0AB38092875FBF7BFDAD9EA4B35BF0840FECF48EF504A1BC0FBB6089CD45301408A01EB61BB06004012D1B4942754E73FE6259A76667112C076E419B2CC23BB3FA4456F8CB3F115C09297E693B383E8BF0963CA052D4FDABFC24070E89827E33FF03308788830FE3F7F130468F0D3FEBFC8A2F9ADC1E3F8BFBAA843EA374D0740B5BF1351290315C0E21F028803A114C0FCB495A1688604C06BAD285E4614E3BFD31FC6E5FF9B07C04E3144FEF66F1540A01549D1723EF53F1422202778F40A40B765D5C69D211740F6AA9F44AAE0F5BFDC68DDE3B6E7E7BF7E7B5A04572406C0A0781B64601F0340A2A2F327FA00EA3F13372813D4FED93F661FD34890F81040A13F9E79596F044016494415A36F1DC0B5E4FBF55A11E4BF28E2ADD34EC0EFBF60041456403512C06241DF35C851D03FD480288AAF2CF4BF58363D14C1B906409A5EC55E842E00C08E5E89216152F3BFB898124F2200E43F7279E1E66926E23F1407337564DFC53FB78952545BCFE73F54F1AFDFE105E33F22D06DF5585A0040BA057856A27CFBBFC2C40C71DA3CB3BFE388544FDD93D13F6E6B7E8ED83E1FC0807FFFF32D041C401F388716E7780140C9DCA44DE2360340834410F7ED79FA3F60194A73A62C0B40407A156C261C0E409E740A29051F0F400895F9547035BF3FAB6407F11F5CE3BFA0130CAB8472D7BFBA76FC0E92570640A1CA34DA52BBF9BFF59FD2091FBFFFBF6A86802895950FC0A3A15CFECDE2F43FFECF54A62ED724409EEDB84CAFAB1640E786A69365F102C0E61415FEACD617C0E1D0D2B93F81913F097FC7284E71A03F8EA3ACB6FDB8903F2FE352582C1201C054DDF6AEC65D0DC0C44D44E726EB15408AAA55373C1115C0FA23F15D0DB6FABF07AAB714317817C0B8A959AD9AE5F13F460BDBFCBA4AF7BF5E3A870C405ABB3F8CF227EEC1C312401015A2FC49270A406AD960E2B249DA3FDC3B139716DFFE3F1DFC842991C9FCBF3EB5435E4667F3BF7860A8DFB3DFF0BF493FEB3CDF51F13F0F31E15F6D2FF53FBA3BF22E3227883FA6BA8BD1A16115C0FB4D716881CAEBBF42D6A2567DEA12C00E3A8EC326D912C03EF01C5AD14CA93FE26DD0C767DEFEBF5EA23C044554FF3F9736BB6682810740DBBF6BC1A19DECBFD20675CE3EA50A4084B2C5F8FE31D4BFD031B1068F401A403CE7174676E40E407E85F13299921140DD15A9D99FE4F23F125E9DE8D16E1440F69F42C52446F33F37BEF747DC8AC03FCCE5A11CB83A0240028EB0C62431B83F1F8C77616C73164046326EBEC9D4F93FCD8A67B25DB70BC0E226F8289B67074056F1D465C23F064038524B51D63A0FC05917A8163CFCD13F1DF1877ADF60FEBFE02965E36FDDC93FDEF6EF53FDB60840B9AF9B91D2FAD4BF4E7594EFB7FE00C01296AA872314F4BFC34974257154FE3F84AAE500C9E60CC0160EE5A2521D0F409D3234EE756FE0BF821741BFA8DA09406767245C649007C045A4284B2A0AE43F8C62F5B19875DF3FDA4B50DF5D6B1640B03543FEEE4DF23F80F31A75358A0A406C32AFD0D0C7E1BF7CDCDC58DC2B19400F17878A71D51040D898AC05D626F43F57DDD6245E5DFD3F56FF5AB9000FF63F867B95EDF0D014C0CED21AC6228C0740AA8264D6DD7EB23F0E208B60A519E93F667C20A52B4B05C0806BDCA13868F4BF1249B429C3F0F4BFA54D683445C4F5BFA848E75CC4240EC0728A6EF6C9ACCC3FD66698A76EF52140CEC8978ED9E6CD3FEE83B5C01267F13FEB898265D7BD19C0318EA8A1DFD10AC088FC3ED0405810C04796922B479706C053CA22A1EA331B40D00FFC5678F1E63F4C96EEADBFCA10C0B81E8514ADAED03F46CEDFD5B45AFCBF699C518F967414C093E5B7920EC90F40B599C9F4225714C09C8AD08F40F9FCBF123CB95756111C4011F900A268770640EEAF9D7C35A20C40B49E7CBB3BAD0FC09AF139404E82FDBFA25DE94F06C3F4BFAE53C41DCF7BE93F1AAB35F0B1E3BDBF28F851A189C60040FEEBAC835DA605C09D19E5D7CBB01140C8552151873A0FC0069FC79FD29F074093B9B39AE1BFDDBF85C120EBE7691440C2529A241B340EC0ED0D111472081540581887E083D6E33F78755B2E2A90004025FC25EF39FFF43F2BE79BC56C9EBABF8067740AC53F0140DAF8164A3EE3F4BF8097D143FFD419C0B53300B9CF2701C0B9F5544BCD7BEF3F4E5738E1085BD5BF8241410ADAB4C4BFE00554D3EEC7E43FB888D039A14E07C02E636F70B55409C0D33CE2BE839FE73F4C6DA81F28261CC054DB68AE1C88F9BF160D49B54A8F03C04C6A858DE3FDDD3FF803A6B74A6CCCBFABC416C5F40F15C0657B8C4420701B409773D0C586530240AB1A231C7645C13F5E65CFC54F1EFF3F7F65FC021184FABFC60AAA389EE9FABF8FCB11CBB389FEBF64C4087DA442CABF900A5FB9D42E0A40D343013811E5F9BFCB7F2D046B2B02405B7928726804D03F50C90BAFDD8409409689AC68084F0040DAC3FCE4B9ED12C02E5B9A1AE23F0540BF992931252BF7BFCF8796F7A9CF05C0F385F0882F7416407EE3015576F1F93FA1D8B8CB364207C0AEAE42A9092BFA3F164D92DB1163ED3F8B81166863881F40AFCA740937A71AC0ACE3E82E7E3B0EC03C261DDA62D00EC04AC82FCBEB860B4045BD52E606AAD9BFACA203F648C5F03FE4BC1EDF353D14C0532B141B0B8610C0E0E0102CA5A0FABFCCFA4051924112405641A5AEABAF0740DC4AC04E537812C0DAA4DEBC06F0FDBF75F9E75D966605C0A4B397B39C70DC3FAA4311F1A30505402AA11981BE2AE5BF4051FDB63D700C407CF70E97A32D03400FCC762DB26102C046989B8C07F2DA3FD7D50FFB53CE16C0BADBBA50AEFEFD3F428A376DD8A1ED3F7CD757E0E635AF3F68C3B544AE12FF3F4DEC36471F12E7BF2AAC648B0D01EF3F81C88B5D302A1240EA83279E85D91C40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x061E0FF3C08BF73F4D283972AD4DF03F538D3426EE26F83F2205CB9D7597F8BFA8F64F195F3BD83F8B8F594920FCE13FAA47629A2E14EB3F4CDA007F8B43E33F21843298A9D9FABF73A65A361422F13F89BB21CBEC18D4BF9B394DBB1F1AC3BFFEEB4DEF0C91F03F69E04E0BE2F7EE3F000000000000F87F000000000000F87F9DD081B3BD90E73F0AB259527A62D33FE5AB3E3E02ECEA3F000000000000F87FEBE7F38E724CFF3F4BE47B7FEB13F43FFEEA4CA3B37AF1BF8446D25F0307CEBF000000000000F87FC828AFFBC490D33F2441EEE3A6C6F13F000000000000F87FED1F3F6EC42CFA3F66E70F97BB83FA3FBCA3BE39A16EFE3F74CA67300239F63F000000000000F87F4CDC2B9246AFED3F143E0DF84280D53F53B67FBB0A4DED3F000000000000F87FA3E6B03253CAFC3F4FDAA77E31A5F03F42361D702C36F53F000000000000F87F000000000000F87F000000000000F87F000000000000F87F141C69E80A11ED3F22584007A074FE3F000000000000F87FB97D0F3CD482F63FBAE54A75926FF9BF6CF1353B7E1C9B3F4D21E8A19478F53F000000000000F87F5473466F5540EDBF32EED56D9949F73FB14253B46E23F83F000000000000F87F000000000000F87F0ED1C118E73EDBBFA642E594EBD7CBBF1E4A6B3228EEEBBF2749CD21B51DF43F692E3D4BE23ADEBF2FC094CF013DE4BF00A61FAD4973EA3F38140C9403B9FD3F7D38F16A3AB4FA3F2333359A1418F33FC17CFAB9F373EC3F6B733B56F99CF33F000000000000F87FAEB63340B2ADE63F8E74394687470040000000000000F87F99EB3430B61AEB3F84E5E46338B0F73F1848E4858500E53F77B82A2481A8F23F369A83D9298707C0000000000000F87F000000000000F87FF13F89CC7B88A5BF000000000000F87F000000000000F87F000000000000F87FA8FB964C334DF03FE43743CA35A7A73F000000000000F87F000000000000F87F000000000000F87FD2704D4C49BEF53FEABCA3724D277C3F000000000000F87FDEFE21882E36FA3FC3F53631B339EC3FB8D92C0C5F01F43FA46DED934FD7ED3F88DFEA11CBB1F13F000000000000F87FBCE75FDF62F6F53FFE64AEDE0906F23F7C74F832D014F1BFED4EA40E75CAB5BF000000000000F87F000000000000F87F000000000000F87F7716C7281036F13F64060CB5C7AFFA3F3EC8A1A88BB7F23F000000000000F87FA4EA820205A4E53F1AA68E98B6B9D63FFE3E3854F5F7F73F93C1275398CED93F000000000000F87F000000000000F87F6E16CCF5828EF03F86CB3BBE4AC2EB3FF9422A1ED5D1C2BF000000000000F87F2201E5E7FA07B23F782244FCD73ECC3FF2741F33D54FF53F9E8604E3AC28FB3FB74AE24A617BE0BF000000000000F87F000000000000F87F000000000000F87F07CBECB91C88F93F0F50161069E9CF3F442935618F61D4BF000000000000F87F000000000000F87FC10B88278016F93F000000000000F87F600B68899DB4E83F13F74A78F3AEF03F3C13ECFE999BF93FDDF66F9D54BAF13F000000000000F87F000000000000F87FA7A40B62C48CF63F000000000000F87FB95BE50E6D70F23FB1779AC56698F13F52BC10F69485E13F000000000000F87F8B853F8DA2CBB93F000000000000F87F011E98FD833EF7BFD1D45C6069F1E0BF88B0C1970706DE3F557E932970F6F03F000000000000F87F000000000000F87FD29DD58CE1D3F53F000000000000F87F000000000000F87F000000000000F87F14EAFCAB4D05EDBF000000000000F87FEA353AA44A99FD3FAD4DBECB6C09EB3FECE1BADE0998F73F1ED8CDCC5BA1FE3F000000000000F87FFACB16ECF9FDF5BF000000000000F87F2EEAA01BE888F33F1A8D88366108E33FACC13E76E8D0D53FE328AAB56E82FA3FA3CA92CD744AF43F000000000000F87F8A60F1845D91EFBF8EC82EE56A6D13C0000000000000F87F7948C7028F12CD3F000000000000F87F1766573ECD87F53F000000000000F87F000000000000F87FB6999099B912DF3F3F38F15210C1DC3FA786B3295531C43FF0C91C7587CCE13FC9862451CBDBDD3F1FFB8D83B5CFF13F000000000000F87F48C23A72B9FFB3BF945FB4BDDC0FCF3F000000000000F87FE230C5AABDA300403082F85BC787F23FCF01BC2AC096F33FBFCC7C90513EEF3F7AB9EC86ACB1F73FE40CCBF3FEF9F83F50E4122F4365F93FC54E4411BA72BD3F66EC4BBA35B9EDBF986EFCDCB733DDBF836016195A54F53F000000000000F87F000000000000F87F000000000000F87F1FC015C04DBAEA3F7E118007AE7B034022647ADA365BFE3F000000000000F87F000000000000F87FA10E3F98605B913FFC7444EE202FA03F8E5D73496996903F000000000000F87F000000000000F87F33355F510DE6FD3F000000000000F87F000000000000F87F000000000000F87FA48EF18B0406E83F000000000000F87F514AF30AD9FCB93F0003855499D2FB3FA1560B0A0739F73FA4B54CC91006D63F414399397632F13F000000000000F87F000000000000F87F000000000000F87F850D6E195A79E73FB8FC612F82FCEA3FAA20C6F60403883F000000000000F87F40FFE47F683A00C0000000000000F87F000000000000F87FBE1323C9E0B1A83F000000000000F87F4DAA68C9445AF13FC9A453E585EEF53F586511370BF901C070C0951C9D73F73F143EBA5BDC43D8BF903AE442AA2F004020F99B213E4DF93FEDE364EC4CF6FA3FAE7DE30D4CF3E83FA936FAB344F4FC3F110FCD003F4CE93F0A5A81A56D1DBF3FD357604EBFFFF23F50F47506BD1DB73FE56E27985239FE3F4412A5F6F3C0EE3F000000000000F87F1CB875DB58E1F53F04262BCBC647F53F000000000000F87F646361A637B3CF3F000000000000F87FA836FC81CB8EC73FE3DB79E3BF88F63F8758AFFDEE6BD9BF000000000000F87F000000000000F87FF6D894AADB02F13F000000000000F87F154A68749164F93F1C315EB44510E7BF5D29D35EF814F73F000000000000F87F0EC572F9101FDF3F3FD7B54A9C96D93F88D025407234FE3F70C8EAE1EB67E83F69A1F5CE1B67F73F269457CCB9F4E9BF029B7E514FCAFF3F013876988C67FA3FEAA2B3B59615EA3F83CC6038A1ACF03FC55C93E8AEBAEB3F000000000000F87FBFC82481EAF3F53FA117EBC7A3DBB13F5726B8A9C087E23F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F138101DBD2DFC93F05E50E7A766702400F0405BB67DFCA3FF4A61F29B08DE73F000000000000F87F000000000000F87F000000000000F87F000000000000F87F7A1A8674076F004005AB698A4E4CE13F000000000000F87FE47AE7B643A6CD3F000000000000F87F000000000000F87FCD5159A638AAF93F000000000000F87F000000000000F87F259A01A906A70040689185471B65F53FE496F5B12A58F83F000000000000F87F000000000000F87F000000000000F87F4B013AC294BEE23F98A40B4E83C8BFBF726371492E16F23F000000000000F87F3F83AFF7A20CFB3F000000000000F87F8B8EA778E3FDF53FE63C14BB7F01E4BF6D0E00940CF1FC3F000000000000F87F61FF46C2A757FD3F2B74450B6CDFDE3F8E21C060EAF2F13F23775F6EECD2EA3F42BABED75A1BBCBFE4AE97C2BB63F23F000000000000F87F000000000000F87F000000000000F87F5BC1BB01E5EBE53F7565E7D0B1FBD9BF823DCB6B4C96C6BFC881E29F6603E03F000000000000F87F000000000000F87F727C003A0DB1E13F000000000000F87F000000000000F87F000000000000F87FC11CD48BC398D83FCB6668620212D0BF000000000000F87F79240E7F687E00406D1B4A17DA0EF33F6908553D8B33C03F5945B6AEFC47F13F000000000000F87F000000000000F87F000000000000F87FFA87CD8DF463CDBFFC9215268F3CF73F000000000000F87F0DE98B2367F6F23F3A7C52190597CC3F6D5C8F8F38ECF63FD9F669BC44C8F13F000000000000F87FACF4C97325BEF43F000000000000F87F000000000000F87F09EFAFA2C839FE3FAD4627DBDBD6EE3F000000000000F87F63FBECFBAA02EF3FB648FAEBC6D8E43F81071B5C29790140000000000000F87F000000000000F87F000000000000F87F6E87DF1288DAF73FE3FF82536266E0BFBB7BC06635F1E63F000000000000F87F000000000000F87F000000000000F87F9D251FA50F76FB3F1A9CB117E605F63F000000000000F87F000000000000F87F000000000000F87F6BF17AEBFE87D73FD59B0574299EF43FB07DDA758654F1BF09DD36DC4842F83FF2FF78CB4F91F33F000000000000F87F64F81B0FF47CD63F000000000000F87F024DDF0622E5F03F1F4EC28C6FF9E43F4958E79ED74BAE3F7764941F0944F13F495887BE2A6CF4BF51746834C9ADE53F545713793765FB3F809F39085ED80040"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
