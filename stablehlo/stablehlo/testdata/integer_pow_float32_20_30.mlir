// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x30xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x30xf32>
    %1 = call @expected() : () -> tensor<20x30xf32>
    %2 = stablehlo.multiply %0, %0 : tensor<20x30xf32>
    %3 = stablehlo.multiply %2, %0 : tensor<20x30xf32>
    stablehlo.custom_call @check.expect_close(%3, %1) {has_side_effect = true} : (tensor<20x30xf32>, tensor<20x30xf32>) -> ()
    return %3 : tensor<20x30xf32>
  }
  func.func private @inputs() -> (tensor<20x30xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x49C60940FB3D61BE91F011BC491B7F40B9EF5340281F6B40791452BEFDC64540C9C7504078CBBC3FD9F2B23EA1B3B6BF4FEF47C040FF7FC0ACC201BE2EBACABF20A05A3F9A0A983FA88CBA3FC89D3EC090E183BFFA9193401546B3C0B8436AC03E866140CC471240B6564AC015761FC0E080B3BFB9918F40523E463E67675B3FF32B153FDB8A07C0D039BEBFB6F9DBC080D395C008BB8D407D6FAEC035A40E418BA0E940DE818140397788C040900B401B324C3E78900B4082E7FB3F8FB9DABFFA24B2406986E1BF78D42A3F6FFC2C3F9BAE85BF5A4AEF3F2225BD3F1F95813F12FE90BF26F45B407FE4F43F0C42834050DD964055FE09C0ABF4883F117BB3C09288C13E6224F5BF661B9CBFFE13DB3E7CBC8140046747C0E5A63440F61487C0F19D40BFBFFD013F4BDD60403B07453F5EF6883F8B6B91C02F1F373BDDF44D409C4BC1BFBF86A340683B00BF5D0319C17E88AC402BD155BFD353513F870064C05F811B401F08D5C01639B3BD043D98C0D1EE92C06EBA9AC04C04A4BF229084C0808DD43D3A19BA408CD7FEBEEB7722BFE8FC78C054A1D6C00307474074D6ADC0B266C9404732AD3F26CF894047CA3640B7DB633F97C200C010979C3DFFA3BDBF7EBF843E0BB8B43F9D54C8BF684B9EBF6E9989C09F71D13EA30B0940CD3C11BF68A82240B763CB40FB51ABBEF2F985BF58C2D8BFEB9A7C3F4298543F995CF4BF8E1071404A8923BEDB15F7BEA8F62C402C4B0DBFC19C01C0F05801BF5796453E5ABD943FC944FC3F9780BBBF5F71773F22372A40D48F07BF4AFEB43FD34F303FB1178E3F52DC23C09E792B40A5C4423F55AA1640DF38D1BE3B0081C0E24E01C0A8EF703FF8321B40F41E7440A3D225BF0CCA09BFD9A1F2BF66C563C036390E400470C14052B9C03C44C48A402B7CEC408972A340F29A5740625D803F2A6E97C0B9F5843FD6D810402278A9BFF61794C0899409C12A4A1BBF68976D3F128B98C03212D63F4A3C88C0F555FEBF07E133C0BB99ABBFC0A0E0BF563D0DBF261FACBFF6616140E6CC4A3F677F85405D4C92407061CE3F12C23340D0CB3440FC11F2BEA5FB663FE1439C3E077E813F32DC853E24F39CBF60F26E401A53E4BF6B9FEA3F83D2A53FBFCABABFA9959D4019059940DA673BC0DE90264087D6823FAC3ECBBE6354A7BFC96A9CBFF3FAB5BFAA9A984056DF80C03D39DBBEA490C43F293F6940C8E9ADBE40F849C0730092C0E5A9873F8296983F9174D7BC2798D83FCD0E6640DEC7CC3ED282C6BE6CB895C074D000402679EFBFE80121BFF0E585BD51AA97C0E9A3653F6F4D49409FB36ABFB36EF23F68A700C060E811C06D6D63402A7C59C034AFE6BF7F54C240495A813FC0DFDD4064B3A93FA5D7A33F5EFA884035F1E93FB3F3423F250EEDBF9FEB59C059E90CBF33FF85C0C60217C07DE4ABC099448B40BBAD04BE15BB1A3EDF201940B1B4CF3F437014C0AF381440CECF13BE85F9C2BD1A24043F557152C0E59D2A3FB9A377C0BBCB15BFEC6639C09E6454C0FDF99EBFF2D964402487753F84A838C0B7B12BC01918C0BFB219F7C0AEA72A40776F5640A1002D401D8977C0AD6E53C02BF3A2C04B8102BEC390FCBF977D413F573935BFEFE9D13E8700094034869CBF9E4A82BEAF894B40649DAABFD12FF93F146C01BE60B9773FD3C82740296E93BEBE5DA5BFCB5DFD3F2AD4403ECA1094BD7EF7BBC0BCF2383F9E2E4840C09E13407086394086AFFA3F8F0001BEE2F384C0400401C02F680840AC76413BE35C2C408F9B2EBFD5B924C065821F4087D9F63FC03A61C04E89063D9C02CA406A8EECC009190D3F1AFC8D40F00D083FEDE85FC0CF0CD8C07D0FFC3EBA56723F8A55BF404A5A373D263F08C0EE1933BF881CC63F7A0956C04AA8ED3EA8E3D0BF1237813D4E91264094702B403B1B81400F920540FB783D4019C721C036C203C0FAA24D4041BF1140AE464640FA8541C08F68BCC0621AADC0F85DED400D2EA2C0D348B0BFA9DE2BC0C3A0B33FA4871E3FFE99873F8D0C203DE068D940A97356C09DBDF1BF196A7F3F6AFB9DC06F8242400954864038AB0BBFBF395FBF7B98413FFB93CF3B86E59740632CB6BF44E6AD3F115AD5C096A116BCEED6B93F937374BF7410C63FB5FA1540945D29BF51B2E1C00B04FCBE409A3E4089F1CBBE935436C07ECB40400E0481C0A530E13F1A0B6BBF43512F4096D4933F578F5C4017A55B40E54853BF3F0EE13F6CBFCA3FBF23D8BE134C95400EC63DBF8E110340A12D0340414138C06A64DA3F303EFABF501503C00D286DBDD3ED5CBFF7D1B1C0B4D3E3BE9778A0BF50906CBC7099533E66D4A14051A246403F35F6BFCD6FE2BF7C670840C33E8C3F9BAF9440522646C0740C2DC0DDB88CBFACE7DABF3B9393C04F63FABEA9F9CF3E72DB8DC073C3E33FC6B24A403EE187C0E076343F217F2E40C18DEABE997761C0AF1E973F91DB61C0CF70E03FDFF02F3EEF9105BFF6296D3EACC703C07FD256400BD6193F5DB9B940DF9901C005210B3F1A8FEEBE97B7A2408BB7313FFC612EBF32220DC04CD72CBF0C773DC0E4B528C0B540E9C0FBBF9E40FD20F4C0E4E989C076000ABE0D14B03F13A0D1BEBB730E40DFCB9EC0C18E88C06B4A57C0F23344BFDB8FDF3E490963C0C7EA01401DA8C53F0854CEC0E784E6BF37940E405A0559403A145E4069AD91C074ED67BE23ECBCBFFEF683BF3D1C813FAC6A8340AD14B43ECB6693C0268E4C40906D89C003BCDC3F79FA50BFFE28F6BF625EF3BE7D8B8D40A154C33EE5B993C0B79F7AC0C63619C0F174064099A5843F4E4F98C0EE2230C0D812203EE42BE93F7513D23F1C5FD8C023B56ABFB092ABC0EBF556C0836B9840E21E48C000B3903FF295163D171072C006CA2F3FF5945D409D518A404576163F2528BDC069A8953E3AD6D54079BF19C0F1E90140731848BF5152B03F9220D13E133A913FD470F9C0B8FB00C06F455AC0D1686BC0FA93DEBFB1178AC0DCB634C0D05686C0A1EC60BE98882CC0782A6D3FE1AEA8C05A8D4DC05848E9408C26E9BF8D50A5BE4EE5023FF88E75404E377B40678B45409A77D0BFBA46D93DB2821D408BDE063FD9A028C0A184683F09F948C0FCAE1F3F67B844BF36FB26BF4DF492C052C0EABFFAD8A8BF072495BEFA137AC0D7CFC13F91DD183FF947904017F0EBBED357643DD29F2AC019443D40DA8BFBBF94CC86C0CCC7C03FF6C4973FCD016AC02CB114C0208091C0E6E9C73E2E145A40E6995DC09A9814C15AE05ABF10994840C04D64C08E54CC3F9BD91BC0621C29BE2C078240B33A51405DAFDF3FD27A36400C61474043CA8E3D5D2D03BF8FB91FC0196258BF828D5C406B1481C019E090C0955AB33FFD0213BF042EC63F436E3A40B0162D40"> : tensor<20x30xf32>
    return %cst : tensor<20x30xf32>
  }
  func.func private @expected() -> (tensor<20x30xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB29E1F416B5E2EBCEAB63DB53F547D42C5411142A155464220790DBC4A17EC4128DD0A42AE5C4D40C4E02E3D081D3AC0E6E6F3C1C0FD7FC2B25A05BBD6437EC002731F3FDD84D63F231F46401B5DD3C1FAFF8BBF0225C4423BD52FC3562C44C273062F42E50B3F4149CEFCC1AF7B77C1728230C08A9EB442A5C3ED3B9328213F92994A3E99FC17C13D1152C0D16BA2C34047CDC2B7C4AD423EFA21C3E42331448693C24349938442281D9BC232EB25414BEA013CFAEB254194E8F340AEAA9FC0E9872C43D706AFC0BA23983E24F99D3E65D091BF7612D140D2814E4073CE843F570BBABF7F5F2242431AE0405F068A426B93D142CF6120C175CA9C3F517130C389375D3DD4C9E0C02C31E8BF0B71A03D9F4785426EF5F1C15BEBB341597196C2C416DABE2711063E3F7E2D422C6BE93E4BD09C3FFCB1BBC27A66BB32174E0542C1665CC0C97205438BB200BE8EA85AC456BC1C43802815BF51F50B3F81DB34C2868465414B8593C301AF2FBA885AD7C2369DC1C20918E2C215A706C0CF2E8EC22187923A42B04443A88AFCBD06E082BEE1886BC2CBDD96C39B98F041625120C3CF4E7943D68C1E4084BD9F424862BA41F583343F3E4B02C1B15AEA39702250C069C78E3C9D1E3440605A75C03417F2BFFE029FC21E318C3D65191D4138FD3ABE57558341E9618043077419BD79C792BF87669BC02DF3753F629D123FFCA5DEC0D7C15542037985BB362DE6BD51E99D418C2A2CBEEDE504C1BF1504BE3D69EB3B3ED8C83FEBF7F4404F2C49C0572D673FDF809641540D18BEF8F03440C742A73E671AAF3FB74486C1A3DE9941527AE13E3DBF504148BF8BBDB80683C2F3F603C15F6A553F0D2A6441A6FD5D425E268BBEC7AB1FBE4EF4D9C0F04E34C270962F4160E35C43D1735A37D317A342FACDC9435441054391EE1842F218813F5BF1D3C2AD768F3F277C3941738814C0293DC6C207F21EC46A9064BE7AA64C3F70A6D8C2C0B095408A549AC2290AFBC0B09EB1C125351AC042F2ACC0FEF72BBEED9D1BC008B22E424B8AFE3E26369142CA1DBF42592186400C43B141C059B4418271D8BD540B3C3FFCE5E83C7F87843FC765923C0FF9EBBF312C504248A0B5C00F13C5400D260B4038E546C012D9EE42FEAFDA42BBDCC8C169078D4144B4883FD11B80BD52FA0EC01D94E9BFE0EA37C0E8E8D84296A282C2EEC2A0BDAFC667409AA04142E28620BDDD6CFBC1E0F4BDC21C65983F30D7D83FF59C98B7DA0B9B4031CB3942F608833D72BA6EBD08D8CCC258750241378DD1C091C07EBEC08592B951EED4C2B1C8383F0BF1F841FC4545BF946AD940CAF801C1F9963DC1557E334287F71CC2DF50BBC0B4F55F43E019843FC1A9A643782415403A39064009DE9C42565DC340E61DE23E9544CBC056E91DC2EBC52ABEBED892C2B02F52C108FF1AC3F3DDA442218E0EBBE51A623B28275B4111BB884096A047C1AFC04641F31B45BB283262BA4ED40C3E0E350EC21992973E94BA67C253274DBE037DC2C1A43212C2A93BF5BFD2E23642EED9613F3528C0C1D8759AC15F5158C0F137E6C32FAC9741BD741642A3049E41E86F67C2103910C2C20A04C3C7A907BB84D5F5C0E311DD3E4CA2B5BE41238D3D34F31C41070FEABF8BFF86BCDEA90042C19017C07A19EC406B5004BB61F7673F9C2590415396C3BCE6000AC01E2EF84026CFDA3B5D20C6B9F9AB4AC34310C13EDFCEF441F557444143E0C241B662F040B70703BBB9708FC2F71203C1E6E91A412EFADC329D459C412175A2BE1F6888C107B57741C584E540EB562EC29FA014388F937B43B3FCC9C387732B3E7CB4AE4239B7193E064B2BC25DE199C3C95CF43D1B2A593FB1C255432B1CBC38415E1AC17153AFBE274A6D40769E15C21ED2CC3DCC148BC019AE833985088D414EC699410F59834210731141EE94CF41883681C13A9C0BC155AF0442DAF63C41BBE1ED41A42EDDC1921A4CC33F4B1EC33212CC43D52D02C3DC2E27C045EF9AC194E03040FA2B733E8A2F983FDA3A7A38C7CD9C43937D16C2808FD7C0523F7E3FEAA8F0C2AE94E04159F09342744B26BE35BA29BF1C6EDD3E817A883412E8D542EC8038C0267D2040CA2F94C3E59A50B556DE4340D0E45EBFC21E6D4092E84D41AA4294BE256DAFC3813BF4BD5C51D341346F81BD22FBB8C1A3B1DA415F1283C2743FAE40E52246BF6072A441142FC53F24B82342A8B02142CDEB0FBFA7EFAD4090577E4065129ABD921CCB42A792D0BE9D6D0941FFC509418BE6BEC180F09E40401DEFC06F7909C141874BB9E68A24BF29972BC3EB70B4BDEE36FCBF90014AB6A490103C69560143252CEF41B8BBE3C07028B1C084E71A41A35CA83F93A0C842566DEDC10C259EC1E015AABFC00FA0C0012AC4C2B987EFBD7243893D0B3CAEC24F4AB440F827FE41EC1F99C2075CB33ED425A2418FE6C4BD5DE42EC250A4D23F66CD2FC29E83AC401C35A63BA77211BE2C8C4B3C97AD0BC1924517429E345E3EEA8043430EDD04C1B85F243E2529CFBD227A0343B84AAB3EA2D4A1BEED942BC17C939DBE938ECFC1FE8B92C174A4C1C39A2FF4423403DEC3931AA0C23B6920BBE39826407A8E8CBD886F30417C66F4C2736D9BC2754318C2637FE6BEEC7EAA3DA39132C27FD60541CAA86B40370786C3E7E9BAC057E83041D3F61B421E2027427CB1BCC2525C3EBC5BC74DC045448CBF225C833FAE868A42DC37323D0279C3C2489A02421A6B9EC2B21BA44064420BBFBA99E3C0EDF1DBBD1316AD42D46F633D58C4C4C23F3570C23F855BC12C5D1441EC738E3F2EA8D7C223C3A6C15F587A3BA170C14013778D407B919AC3CE4945BF29221AC3729017C21520D8422A95F4C1F2EAB83F8C6A50386D6C58C21CC7A53E6E012642E084A14222E74F3EAF8B4EC35796CC3C17339543DFD25DC1E9D30541947DF4BEDF4927409C8E8B3DB0F2BA3F74D2ECC3F9F802C1E5AC1EC2431047C22E41A8C04BBAA0C2131BB4C186F993C2C0A12DBC9DBC9CC17B8D4B3FBA7912C37D8504C27AB7C1435563C1C0E2DF09BD9BE2083E8AEF614225EA71422742EB41663D8AC0EF839C3AE0826E41D1BB153E2F5592C183D13F3F6FB8F7C1FD84783E7353E8BE34168EBEE5B2C1C20366C5C07FE712C04C79CABC54A46EC2482C5E40AD065A3ECE51B7423268C8BD8EAB35393B9797C14EE7CE41B7DEF2C0048095C20FA55A409D5ED53FEC8643C2EBA648C1BA01BCC218D3733D93411E428A0C26C2844348C4B1FF1FBF3656F641849335C2172C8240130C67C1B69793BB532E8642F2C20B420CC7AA40A36FB941B3DFF141D1B1B13928C509BE5FB678C1E2971ABF10B42342454483C20E98B9C294113040FFEC41BEFF886D405CBEC5411D419E41"> : tensor<20x30xf32>
    return %cst : tensor<20x30xf32>
  }
}
