// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.abs %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC9421942B1B276BCC3437B44D0C3C13789C40DB893BDD0C0443C7C41A2443D35303B4DC0CDC53BB5F640223FC739B842B1C136317B3EEA3B3735E3C4C441083FCC46B242C9C4CB3C27BC1130E1429F3F56B4A1AC2542523FFABFE43CD1C022C2A2C257C2F4400FC4153BE73C504409BE9E40F944EB4777C1EDACC8BF0F417DC10E3AE43C0BB717BD8C42193CE7C172B737C4993812C68BC072BD3745F4C4213DAC301ABE65C537C3593C4AAF633C133A6AC6C243ECBCF33C34BDA8BEE7442BBD4FB11BBC423CB7BAA645D8BDBA42A738E922213DB5C5354085C128383B3BC7AAAB3B5FBC1847EA3D45BC43B5EFC5B0412CBF7C3C6634D3BDC9C64844E3B9C14507B8B3BF28430943DD4850B440C51AC4F8394DB6743738B9553580C255C45DBC8C3715BF52B0033C01BD534548405D31AAB8BB3C16C1413D1D3BAC406BBD15411B405E465E383D40D346EFBC96C06D3D7DBE9D400D44FB3D7FB8F2BD80AEE6406BC3F04153BF03C2A5C325BCD34061B55FBF1A3D25404CC483B8673CCE2E5A429B4120BDBD46AEC70C3B53420D3FFCBA6242BD4294C50EBF5ABA44C2CC36094027C4183D86C345B38A423CB8A5B83A44D1BEB0C218BCF0C3FC39BFB69644E136C33CD2C028414F3A73414231EFB76AAECDC1BD3E10C1DB3E5F3FD53EF13D34BF993F59C076B23B3C4A43CABD14BBA7BF5EC215C197BCAF3DC4441C38533D642D3740E04269C0F2BEEC31B9B6E0C0D3BE67BED4BBA84388C4ADB90A364F44F6466F427C4231C6DCC72CC4DC31D7431440774455C09826A4C0B43D124029C545410639AE40E9C22E3EDEBD6DC06AC799C0C3BDD6C4D9C2313BF1BF6FBFFAC4E5B7AD3CB1BCACBEE731DAC3C7A964C389C3FA4251BC7F3E3EB8183D63C0CBB335C2DBB0FC446DC06436BD3EA33096AAC13C33AEBDC325C3C8C176BC96BE18C41C4475B7284383B8E045E6BE4231D5348E3A453EA6C22C41D5BC2F43AB41D9BC404648450F3DAA397E4051AB8DC11AB8D4BC03C09343EABE7844A5C3BE3955BFD3455CB06CC580C4AD3D3D4183302C41BD31DD3ECD446F462EBA21B968C235C5B643F33FAE429B40BC42993C01C00B268AC210360F4498C099ADE9C50344AD44703F"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC9421942B132763CC3437B44D043C13789440D38933DD040443C7C41A2443D35303B4D40CD453B35F640223FC739B842B14136317B3EEA3B3735E344C441083FCC46B242C944CB3C273C1130E1429F3F5634A12C2542523FFA3FE43CD1402242A2425742F4400F44153BE73C5044093E9E40F944EB477741ED2CC83F0F417D410E3AE43C0B37173D8C42193CE74172373744993812468B40723D3745F444213DAC301A3E65453743593C4A2F633C133A6A46C243EC3CF33C343DA83EE7442B3D4F311B3C423CB73AA645D83DBA42A738E922213DB5453540854128383B3BC72AAB3B5F3C1847EA3D453C4335EF45B0412C3F7C3C6634D33DC9464844E339C1450738B33F28430943DD48503440451A44F8394D36743738395535804255445D3C8C37153F5230033C013D534548405D31AA38BB3C1641413D1D3BAC406B3D15411B405E465E383D40D346EF3C96406D3D7D3E9D400D44FB3D7F38F23D802EE6406B43F041533F0342A543253CD34061355F3F1A3D25404C448338673CCE2E5A429B41203DBD46AE470C3B53420D3FFC3A6242BD4294450E3F5A3A4442CC3609402744183D864345338A423C38A5383A44D13EB042183CF043FC39BF369644E136C33CD24028414F3A73414231EF376A2ECD41BD3E1041DB3E5F3FD53EF13D343F993F594076323B3C4A43CA3D143BA73F5E421541973CAF3DC4441C38533D642D3740E0426940F23EEC31B936E040D33E673ED43BA8438844AD390A364F44F6466F427C423146DC472C44DC31D7431440774455409826A440B43D1240294545410639AE40E9422E3EDE3D6D406A479940C33DD644D942313BF13F6F3FFA44E537AD3CB13CAC3EE731DA43C72964438943FA42513C7F3E3E38183D6340CB333542DB30FC446D406436BD3EA330962AC13C332EBD432543C841763C963E18441C44753728438338E045E63E4231D5348E3A453EA6422C41D53C2F43AB41D93C404648450F3DAA397E40512B8D411A38D43C03409343EA3E7844A543BE39553FD3455C306C458044AD3D3D4183302C41BD31DD3ECD446F462E3A213968423545B643F33FAE429B40BC42993C01400B268A4210360F449840992DE9450344AD44703F"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
