// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%0, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %0 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x48D3E348603DE1BF0DCDE6EA6926E0BF6E0349108A62F93F8A4203A8BFD90540393544CFF610FCBF69DBC00FDD9F0C4030DBDA43EDD80940DC9E3B5815E801404805BB36C8E412401741422C3161F03F1A3E5F4F8B52014021DAD1395EBFE3BF2E1D5FB23523DE3FF0EF9B1B487D0CC02E9B3D2F14070A40481DA5564598FCBF76842A905D080BC02B36F99856A20140754229BAC8F8E0BF38CE90AE160E11C0DA8DEDF796AEFEBFFAC224352F5FD33FE778FD2B24C1D03FF24D20815AA81440EC6CD925C3E903C02FE6BF97D8F514C05872F8E65051F83FC20D4767450DFB3F657A6900811AF33FA26D5BF370210040D40CFEDC180917C02E446C3267560740398FFB9F6D7C0240B784EFCD9B550E403F4C6E8D311003C024798980E2ACFF3F0EE624451C4905C02CC4A9585E13CBBF42393600496516406838B7B950CC0EC072A4C6DC3A141A4014D89B27B39F07C09525E06F901413C095F583570D1A014089E7ABD64A3BF2BF4F1E52C1AD3716C0D1D583FAB173F5BF66E0102AD2772340A894B8477F1E01C00A2CE1810F42EFBF5429712A7AA80440B5462C8AFA23DD3F8C7B678AFE9E0440636C03B0D35AF53F8C90C812A996FEBF3BF6D3C15C3A174095963E7E0A27C93FDE1757A0A95DD0BF81A907501D98E43F587C3CA8545EF93FD47F3EFD0D12F3BF92365B35049F094018562698DBFAE9BF8A7A34C37C2BBF3F5A973F9CBA73F53F8B91EBE30BFDE43FE45ABAB559A208404726D57AD2FAE53FD371DF16A653F9BF1CB70D282C89DE3F9471409AC3B3DE3FB06F115A25F5F0BFD4E269F34BE70D40EB0C7BA4E2F80EC0C88585F12F441C4000504210641EE93F30398A9724D5DBBFAC07E11A7F88C5BF4B41F74B1C98E4BFECF739ED3515D53F0879796E755009C0221C61D24A810AC0AC9DB07822D005C0660BC28BA7D902C0847652B4CB1EFCBFDE4EF606403AF43F14F17466608E0DC0584C272440C87EBFAAB0D02D3EA3F23F26ABF67975AE0740F8A195E6438A16C02B1BDEB098BD12C081B3FAFD0D3CECBF38DB73BA59C10DC0EB184158C5970A401EBF5BCB771609C012BF2CD9A0C5FDBFB38A2CD95F4CB23FDEB8483A09FEF43F4625E23575EC0EC0469EFF323DB0CDBF0DB6A4452A6BD53F388C09EA637DE0BFFCF4B7F35F1902406D7D71E990F5F23F00DC22060A5D1540F536760A2EC9F23F162C545014B5B3BF727297845B740C403A4ED0B71DE11340C8CCD48F8996F23F9E4447AAD5F9E63F8380C91D929C06C02D0A6E2AF2931C408A8154BE8602C7BF2C63DCD7E43406405AD9FB26122001402480EBC463AD1CC02884D3301DC80640C93F17CAA956E1BFB5137CD5216A0A4017BC7AB3BB590140B380D2D1E056F53F87D02B72716F0AC0116CBCDE3C470BC02685C356387C18C050A687340724FDBF3AE281B992331240C15FB4D9C25516404A05DAC3CD8A0B40C2333C0B28AF0440F48F1C02F47209C064997D0CE4060B40163BF780979BC1BF70ADF3D4C04DF13F24C41070879CF5BFFE1E19E4F927D7BF5D756114FD89044020666CE4847711C0A460B4646A53E83F442873EF64320EC018C8F7A11FD50040EAD53674C9E2FC3F36637FB593520B4094B25DF90FC2FDBFED989A77668BFB3FD45BFB243F50FE3FAADD1C29ACB40B4052BF6A1BA1C0F33FE8C246BEA72010C0B0022A16020CDE3F9D8D86590C730E40F211FF4FACC7DEBFE152E6407D481440ACD72826202510C0A9167843B791E53FCD79B81D4362E93F742A81DE80D6CB3F5A4AFA4FA2E7F9BFD7F5C2D56995E93F22CE1052FA3313C0BE0A5E93EC40D7BF9B525E09DBE7C23FD44F61A5C758F1BFE6596171A05DE6BFF2F6A541E398F53F56D1AB698FB30AC0C76F42732CF0DA3F42ADC37F304BF43FE739ABDEA99A11C02218790C399C0FC022E52BE9B92109400A9B1658D1010DC034352F9B56DDEF3F9C3317DF5A270340B9DDD25C49B817407EB4AA7EF1BFEBBF93B0D04807CBFB3F09C59CD5E7F41B408C681A103F7DF93FA839D7EE6096F9BF886F125A21B701402CA82004ECC600C03CA75F7010A90C40436D232BBC2AF7BF6AFB635850B0D1BFC65C4D13EF50F5BF97A45948E5EEC2BFC890F571A0B403401434F795DF610440314735A1DD83E53FAA61A5267794094065C016E3D4BAF23F1134E7A9AAF70340CE5FD0694945E63FE0AC363EE506F93FC062ABFF97220740D4889574FA16FC3F7DF6C2F3020AF5BFCF9397ED12EB03406A38696E4075FEBF29D0A72D3CE00A4089558EAB757500403B3328B81E2A03C048ABF0AF43B8FDBFC250A411B7DF124072407E451FD2E0BFAA6DC3C833D60BC02BEF2E6CF56121C07A0A25021A550AC0B4BD928FE67CE73F48CDFE4740DB08400FFBF34E9F58034007530EDCFBDB0CC02787F65B5432E8BFC3902065901C0F40740CDACAE67411C02069DCCFF28F0A40BE5BEC668DB3D43FD41179C3A4DD08C09CA3C510C61AE9BFD364C52C7FDBE23F1426E9611377AF3F7250975820DEFD3FA9AFD7A5C5FD17C072B3390571D6F9BF3CEF7016921FFCBF6AC0D1643996CA3F80EB57D5170E1040C68BB06CB526EABF2F6FC53F711202C0EC8BDF4E28CC17C0289317D1FF9FE5BFF8C8599BD480FE3F4C1C0D1025E8D03FEEDB01DF0FB50C40D8F0AACA9168F23F8F3537635B26B7BFB9AB18260DF418401EF8152144DD0840A4A78CE8E71C0CC0BA33C7B532C5F33F740F57D729C109C0A272345B781704C052CC898FE6B70EC0364BBB68358D16404D318301D1BF1DC070D1F0C7F553F93F23F9F871C4B3E83F9E0946BB7153D9BFB0C88003E46DD23FD8E43A0CA15AF13FE790D9D950BCDE3F0AE45ABF5ED0713F4944DA740971D63FE8514AAD3C1F0AC09B39EBA98A07174074FBE3C336221240B62F9278C7681AC03E7625328CFAF33FD4A8FE7D032507408A8ACDB868B5D73F90F17173951FFF3FF0EA353E7F24F43FD3F29A726CC1CC3F28072C7D0A6B09C02CD6BA6D81AA11405DE2AA3810F809C081B7EB25B3EFD83FFFC368D705E5B53FFA08F547560E18401EEE1038F2EE05C01EA6FC92D884F43F182A50A9EBCF0B40F96315D6031A21C0309A9F66DEB61CC0F9A6CDFCC5FEF33F50B934178BA3DE3F56E0CCE980FAF73FB0CDC56ED8C0114061B771F924ABD5BF9D13775D78AFC7BFBE3896F22238C93FB7CB010E36880B40E9D70A1C62C8FA3FF14DEC14F24907C0203F243621BAD73F2FF00357369705C019DDD5EB7ED20AC0DC323EE0EA8307C0A6F850EE86079FBF6C0449B00B10F53FE0293C6439E201C014E26F3D363D1DC0BF6778497C6DD3BF5B826E060AD2F03FBC2A277D179609C022D68F928F9805400FC22F62B22E03C083E291D388010140315FD5BEEF98F7BFDB6FB03BF74307C05303AA6CD24B06C0D082B3E765A8F7BFBA3416DBF89702402DD92462FFCD1340D4AD3D939156E1BF149646A10704F5BF8CA5988A28E3EB3F32CF65F47CB2D9BFFC26B6F878A41240CE5D91E1FEB3ECBFAA06BF73F88C0AC0008A8C54CE10FBBF7A454259413AE93FAAD2FB75E6060DC0F271FED0212006C0F4AD7071A45705C0C4F3AADDBA82ED3FFCC3CAF3DB4300405CD2B45EC779F0BFEC202D9F63F1F03FF4CD386AE77620407641E223D9680B40FE83089CCE67FDBFC8FA8EC040F219400ED52A0069D7154032C152EF697409C02850FAB2060CB23FFA028A05C029FC3F44DB95EE1029FA3F98DFCFF5CA24F43F4068FA0921F203401332841E74DC0BC002D69B9FD67107C0475B351470D0D23FFAB38A72676BCC3F2BC16F7F77060340BA898A0034AAE43F0B4515F2DF960F40654C37160887D0BF1DD89AF9B500FDBF6A210D89251AD03F6059802616F40940FD920167739DD53F0236C381D506114051B225BC272400400B36AD9334F41340ECE032606248FEBFD7CE3DF76BE614C0B6E80A556763F0BF89D150FF504FFBBF2F8FE8E2C56013C04081BB31B4540AC0F858878F7ECDFE3F5F430C8C5B491340D8EF6925E00B0B4010AE82C44E580BC000E00FAF4DB60EC014BDBF19986F1240941B8BE23B1C01407F59A31E79D3F8BFE0EF2ACE5D011B40D80C589F0D88FB3FA6DAEA81BEDCDBBFAC54B93B3CC3E83FFDF1D1CE4BD80640D877A436D41A14C0D9FD71C1D0DC0DC0048DF0318C0D04C0AFC8634E31BADA3F7C8C7A4E4495E8BFF43DD1AB02390AC0EBB734C229D9D23F3A50904086E1D9BF27869D5E1A0813405CBD2362A082FABF44684391500C0A403D0EE0D02E6EF7BF28EAFF18674EFDBFA06EDEF960F6FDBF4B9A3067DF7808C0EF573226F080F53FF2FC80C5722E10C05636608B4684014085A0837F79B6ECBF5E80E8FFC193014098BC33997392E23FF2C76F63F10BC6BFC94A461F323B0540705148DC4498F5BFE2A1D0D93F2907C03C2E00BE37DB0DC0DC6792F516FE08C03652447FCE420340D8F8043BA72BFFBF130EAD6E5266F93F731E46AEB93AE3BFC981E76AD61E0C40BF9900C8602F0840"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x48D3E348603DE1BF0DCDE6EA6926E0BF6E0349108A62F93F8A4203A8BFD90540393544CFF610FCBF69DBC00FDD9F0C4030DBDA43EDD80940DC9E3B5815E801404805BB36C8E412401741422C3161F03F1A3E5F4F8B52014021DAD1395EBFE3BF2E1D5FB23523DE3FF0EF9B1B487D0CC02E9B3D2F14070A40481DA5564598FCBF76842A905D080BC02B36F99856A20140754229BAC8F8E0BF38CE90AE160E11C0DA8DEDF796AEFEBFFAC224352F5FD33FE778FD2B24C1D03FF24D20815AA81440EC6CD925C3E903C02FE6BF97D8F514C05872F8E65051F83FC20D4767450DFB3F657A6900811AF33FA26D5BF370210040D40CFEDC180917C02E446C3267560740398FFB9F6D7C0240B784EFCD9B550E403F4C6E8D311003C024798980E2ACFF3F0EE624451C4905C02CC4A9585E13CBBF42393600496516406838B7B950CC0EC072A4C6DC3A141A4014D89B27B39F07C09525E06F901413C095F583570D1A014089E7ABD64A3BF2BF4F1E52C1AD3716C0D1D583FAB173F5BF66E0102AD2772340A894B8477F1E01C00A2CE1810F42EFBF5429712A7AA80440B5462C8AFA23DD3F8C7B678AFE9E0440636C03B0D35AF53F8C90C812A996FEBF3BF6D3C15C3A174095963E7E0A27C93FDE1757A0A95DD0BF81A907501D98E43F587C3CA8545EF93FD47F3EFD0D12F3BF92365B35049F094018562698DBFAE9BF8A7A34C37C2BBF3F5A973F9CBA73F53F8B91EBE30BFDE43FE45ABAB559A208404726D57AD2FAE53FD371DF16A653F9BF1CB70D282C89DE3F9471409AC3B3DE3FB06F115A25F5F0BFD4E269F34BE70D40EB0C7BA4E2F80EC0C88585F12F441C4000504210641EE93F30398A9724D5DBBFAC07E11A7F88C5BF4B41F74B1C98E4BFECF739ED3515D53F0879796E755009C0221C61D24A810AC0AC9DB07822D005C0660BC28BA7D902C0847652B4CB1EFCBFDE4EF606403AF43F14F17466608E0DC0584C272440C87EBFAAB0D02D3EA3F23F26ABF67975AE0740F8A195E6438A16C02B1BDEB098BD12C081B3FAFD0D3CECBF38DB73BA59C10DC0EB184158C5970A401EBF5BCB771609C012BF2CD9A0C5FDBFB38A2CD95F4CB23FDEB8483A09FEF43F4625E23575EC0EC0469EFF323DB0CDBF0DB6A4452A6BD53F388C09EA637DE0BFFCF4B7F35F1902406D7D71E990F5F23F00DC22060A5D1540F536760A2EC9F23F162C545014B5B3BF727297845B740C403A4ED0B71DE11340C8CCD48F8996F23F9E4447AAD5F9E63F8380C91D929C06C02D0A6E2AF2931C408A8154BE8602C7BF2C63DCD7E43406405AD9FB26122001402480EBC463AD1CC02884D3301DC80640C93F17CAA956E1BFB5137CD5216A0A4017BC7AB3BB590140B380D2D1E056F53F87D02B72716F0AC0116CBCDE3C470BC02685C356387C18C050A687340724FDBF3AE281B992331240C15FB4D9C25516404A05DAC3CD8A0B40C2333C0B28AF0440F48F1C02F47209C064997D0CE4060B40163BF780979BC1BF70ADF3D4C04DF13F24C41070879CF5BFFE1E19E4F927D7BF5D756114FD89044020666CE4847711C0A460B4646A53E83F442873EF64320EC018C8F7A11FD50040EAD53674C9E2FC3F36637FB593520B4094B25DF90FC2FDBFED989A77668BFB3FD45BFB243F50FE3FAADD1C29ACB40B4052BF6A1BA1C0F33FE8C246BEA72010C0B0022A16020CDE3F9D8D86590C730E40F211FF4FACC7DEBFE152E6407D481440ACD72826202510C0A9167843B791E53FCD79B81D4362E93F742A81DE80D6CB3F5A4AFA4FA2E7F9BFD7F5C2D56995E93F22CE1052FA3313C0BE0A5E93EC40D7BF9B525E09DBE7C23FD44F61A5C758F1BFE6596171A05DE6BFF2F6A541E398F53F56D1AB698FB30AC0C76F42732CF0DA3F42ADC37F304BF43FE739ABDEA99A11C02218790C399C0FC022E52BE9B92109400A9B1658D1010DC034352F9B56DDEF3F9C3317DF5A270340B9DDD25C49B817407EB4AA7EF1BFEBBF93B0D04807CBFB3F09C59CD5E7F41B408C681A103F7DF93FA839D7EE6096F9BF886F125A21B701402CA82004ECC600C03CA75F7010A90C40436D232BBC2AF7BF6AFB635850B0D1BFC65C4D13EF50F5BF97A45948E5EEC2BFC890F571A0B403401434F795DF610440314735A1DD83E53FAA61A5267794094065C016E3D4BAF23F1134E7A9AAF70340CE5FD0694945E63FE0AC363EE506F93FC062ABFF97220740D4889574FA16FC3F7DF6C2F3020AF5BFCF9397ED12EB03406A38696E4075FEBF29D0A72D3CE00A4089558EAB757500403B3328B81E2A03C048ABF0AF43B8FDBFC250A411B7DF124072407E451FD2E0BFAA6DC3C833D60BC02BEF2E6CF56121C07A0A25021A550AC0B4BD928FE67CE73F48CDFE4740DB08400FFBF34E9F58034007530EDCFBDB0CC02787F65B5432E8BFC3902065901C0F40740CDACAE67411C02069DCCFF28F0A40BE5BEC668DB3D43FD41179C3A4DD08C09CA3C510C61AE9BFD364C52C7FDBE23F1426E9611377AF3F7250975820DEFD3FA9AFD7A5C5FD17C072B3390571D6F9BF3CEF7016921FFCBF6AC0D1643996CA3F80EB57D5170E1040C68BB06CB526EABF2F6FC53F711202C0EC8BDF4E28CC17C0289317D1FF9FE5BFF8C8599BD480FE3F4C1C0D1025E8D03FEEDB01DF0FB50C40D8F0AACA9168F23F8F3537635B26B7BFB9AB18260DF418401EF8152144DD0840A4A78CE8E71C0CC0BA33C7B532C5F33F740F57D729C109C0A272345B781704C052CC898FE6B70EC0364BBB68358D16404D318301D1BF1DC070D1F0C7F553F93F23F9F871C4B3E83F9E0946BB7153D9BFB0C88003E46DD23FD8E43A0CA15AF13FE790D9D950BCDE3F0AE45ABF5ED0713F4944DA740971D63FE8514AAD3C1F0AC09B39EBA98A07174074FBE3C336221240B62F9278C7681AC03E7625328CFAF33FD4A8FE7D032507408A8ACDB868B5D73F90F17173951FFF3FF0EA353E7F24F43FD3F29A726CC1CC3F28072C7D0A6B09C02CD6BA6D81AA11405DE2AA3810F809C081B7EB25B3EFD83FFFC368D705E5B53FFA08F547560E18401EEE1038F2EE05C01EA6FC92D884F43F182A50A9EBCF0B40F96315D6031A21C0309A9F66DEB61CC0F9A6CDFCC5FEF33F50B934178BA3DE3F56E0CCE980FAF73FB0CDC56ED8C0114061B771F924ABD5BF9D13775D78AFC7BFBE3896F22238C93FB7CB010E36880B40E9D70A1C62C8FA3FF14DEC14F24907C0203F243621BAD73F2FF00357369705C019DDD5EB7ED20AC0DC323EE0EA8307C0A6F850EE86079FBF6C0449B00B10F53FE0293C6439E201C014E26F3D363D1DC0BF6778497C6DD3BF5B826E060AD2F03FBC2A277D179609C022D68F928F9805400FC22F62B22E03C083E291D388010140315FD5BEEF98F7BFDB6FB03BF74307C05303AA6CD24B06C0D082B3E765A8F7BFBA3416DBF89702402DD92462FFCD1340D4AD3D939156E1BF149646A10704F5BF8CA5988A28E3EB3F32CF65F47CB2D9BFFC26B6F878A41240CE5D91E1FEB3ECBFAA06BF73F88C0AC0008A8C54CE10FBBF7A454259413AE93FAAD2FB75E6060DC0F271FED0212006C0F4AD7071A45705C0C4F3AADDBA82ED3FFCC3CAF3DB4300405CD2B45EC779F0BFEC202D9F63F1F03FF4CD386AE77620407641E223D9680B40FE83089CCE67FDBFC8FA8EC040F219400ED52A0069D7154032C152EF697409C02850FAB2060CB23FFA028A05C029FC3F44DB95EE1029FA3F98DFCFF5CA24F43F4068FA0921F203401332841E74DC0BC002D69B9FD67107C0475B351470D0D23FFAB38A72676BCC3F2BC16F7F77060340BA898A0034AAE43F0B4515F2DF960F40654C37160887D0BF1DD89AF9B500FDBF6A210D89251AD03F6059802616F40940FD920167739DD53F0236C381D506114051B225BC272400400B36AD9334F41340ECE032606248FEBFD7CE3DF76BE614C0B6E80A556763F0BF89D150FF504FFBBF2F8FE8E2C56013C04081BB31B4540AC0F858878F7ECDFE3F5F430C8C5B491340D8EF6925E00B0B4010AE82C44E580BC000E00FAF4DB60EC014BDBF19986F1240941B8BE23B1C01407F59A31E79D3F8BFE0EF2ACE5D011B40D80C589F0D88FB3FA6DAEA81BEDCDBBFAC54B93B3CC3E83FFDF1D1CE4BD80640D877A436D41A14C0D9FD71C1D0DC0DC0048DF0318C0D04C0AFC8634E31BADA3F7C8C7A4E4495E8BFF43DD1AB02390AC0EBB734C229D9D23F3A50904086E1D9BF27869D5E1A0813405CBD2362A082FABF44684391500C0A403D0EE0D02E6EF7BF28EAFF18674EFDBFA06EDEF960F6FDBF4B9A3067DF7808C0EF573226F080F53FF2FC80C5722E10C05636608B4684014085A0837F79B6ECBF5E80E8FFC193014098BC33997392E23FF2C76F63F10BC6BFC94A461F323B0540705148DC4498F5BFE2A1D0D93F2907C03C2E00BE37DB0DC0DC6792F516FE08C03652447FCE420340D8F8043BA72BFFBF130EAD6E5266F93F731E46AEB93AE3BFC981E76AD61E0C40BF9900C8602F0840"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
