// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%0, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %0 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2205C7BFF68C15BE05EC8FBFE33C56BF9F742F4079A25F400011DD3F9CA56ABFEF6AAE3FCF9B8540E33F873F15F93040D963F5C0359084C06588EB3FC345A3C0187C0C3F22D096BFAF413F409C9C1EC056F1103FE76D37BF1D56313E4AE38440381DB13FCC9D74BEE260B840D7CC2940695F6D3F49732B40521B03C0310C44C0AA6EB0BFFB7E27C000EC7BC09D95EF3F898BF2BE36159D408FE4D7C08613D6408B7D8B3FE63F67C04ED31EBF12F1A3BFD39C9C3EAD409D3FF56448BFF019A83EF4B38EC070535FC043E292BF2A6DA140AD158D40966A8140B50B35C0A91E36C03D81013F84D42CC07DB7EABF2C80023DDD8E0B3F1CB735BF4770C63F25693DC07CB39040229ED03F55E029C073C7D4BF52958AC00AF5E83F0ABB983E212E36C08896D7C0140B4BC0A9A373402931AC40E1897CC0F3764A401C1207C1EE036AC047B6E73F93B1EF3FAED2ABBF0B5267404E5CA1409ED5DABF214702C0F190513FD74FF6BE80BCEE3F4EF1FC3F70A59940F074AE3F6C7259402EB08A3FEF508D3FCEF2BDBED73906C079C4EFBF83769F3F430405C004AD0C3E80AC94BF738471C07D9289BF0BC349C038C723BF951AC5402D0C9EBF32FE5340504767BE111A923F41C24DC0BA6F28C06A499640A1135A3FC5614BC0AAFB743F9155A4C050FE63BFF67076BFEBD958C011410DBF900DDE3F1D7741C00282AEBF34E7D73FFD4151BF72ED493F13DDB340630CD8BF6BA04F4001D8D2BFAC55ADBFAF86144070C9D93F1DD518C06AB34ABF9379A54035606BC0684692C030DFA940CC3A1C3F25DE53C0FA48DF3F46AE913F32DC47C00F3F953F688C87403D34F73E40CA6BBF1DDB753E92E59140F2C1654023992F40E20100417EE892C03CF759C0AF18A3BFE04B824013DD5D3F433EFABF52362AC01C3E4F3F8E2C963FE2C07F3FBC52CFBF9120F83ED76F5A40F36B414055B0823F5CC68F404A1F75BF0CB0064046085A40B65B80C0DEF6B43F7DF52B403EC09040D84926C01DAD543F9AB209C0BFA07540698C5A40BD6D3DC07E150640226585BE266DB4BF5F78A9BEA12401C0C7F522C0BB1D1EC0A812323F7C43C03FBC4BD9BDA4960FBEAD6075BF8EFA013E9F3A9740BCC0C640387CA940F25819C0EFC01A3FACFA57C030B5A7BFB86680BF5438D8BEEA32B93F76B642C0D31007C04E4C43C0A3F4553E3FFA4B3F206BF4BEC8D71E40A02628BFF6851B3FE8496CBEDE1B3E3CA53E9E3FBA979A3FCC3F5BC0DF7A4DBF80AD27C0E4F350409D9CC03FE273F53F1A32D3BFB9EF7ABF31F615C034E07CBD62128C400C0776406301CBBFC3282040E4155B405619E3BD3DBDBC3F460A3340E0707A3E4AD88F3FEFE0FB3E554549C02D1E03C0359E0EC0461F71401A5D924002CA8CBF7961A5C01CCB8A3F302C98BE845126C0DC6E114010FC1440810E34C0F511B9BFAF4790C050CD66BF3BC5384081C097C04F162F409844193F8E2E47C0593217406BC9933F4BD684BF180C31C0E6CB803F7BF1EF3E23C05FC0F0B9E03F1A59DCBF6704963DC63560406669BDBF65B3864048845B40EAFA643EAA9507C078ECAFBF82232A4099F4153FD04EAFBF9F97023F97B5E6C04529B84074D195405E08883CB0272F3F93B1193F6E590BC0773559405EA3C33F4CBC203F1D1468BFFA2010BE631A16402411A0409534EE3F1D5A8B403634503F2BC7843F249385400522773E2817B3BF6AB94940339A96402DBD07C05E5B0CC159CECFBEE3F430403916363F5B2890C08AAB663F468280C0E27AA5C0E28B8E3F02369AC007E830C02FD59C3FDCFA733D0B4C0940026187BF168D76C05D9993C072F9963FFF19AAC081D014C0D04FCC4077D796C005E3123FB1A08FBF538D3FC0E21C12C0E683A2BF95A48BC01A5C0DC08D718A405C6BA3C0EAD3B7C046CFB4BF6A50B23FF4433CC0FE7C8C3F66FAC6BFA3F53040BD136B4012795D405C2BC33E78D8BFC07616C3BF5D06D5BF643563C0AD163C4074F040400A11EFBFF18A7940539770C0C99B713D7C1E3640DE658C40AB5214BF7409354072D6DABEA929F34034B5EC3E65E6A4C086998D3E58A2F0BFFBCF0DC01721EB409ACE5BC01B34D73FA0DEEC3F2289C83F0C1D0B40B6B43E409D6A7A40A28226C0D3725FC08BCA97BF52B6323FA5227A4013EF6840939210403AD75FC00264A03FEEE48640B19D1EBF88BA30BFF26B613FD159E1BFE94A863FCD67CEC04B7F19BDCF81D3BE693D3D3E3E797A3F0C0743BF32D36F40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2205C7BFF68C15BE05EC8FBFE33C56BF9F742F4079A25F400011DD3F9CA56ABFEF6AAE3FCF9B8540E33F873F15F93040D963F5C0359084C06588EB3FC345A3C0187C0C3F22D096BFAF413F409C9C1EC056F1103FE76D37BF1D56313E4AE38440381DB13FCC9D74BEE260B840D7CC2940695F6D3F49732B40521B03C0310C44C0AA6EB0BFFB7E27C000EC7BC09D95EF3F898BF2BE36159D408FE4D7C08613D6408B7D8B3FE63F67C04ED31EBF12F1A3BFD39C9C3EAD409D3FF56448BFF019A83EF4B38EC070535FC043E292BF2A6DA140AD158D40966A8140B50B35C0A91E36C03D81013F84D42CC07DB7EABF2C80023DDD8E0B3F1CB735BF4770C63F25693DC07CB39040229ED03F55E029C073C7D4BF52958AC00AF5E83F0ABB983E212E36C08896D7C0140B4BC0A9A373402931AC40E1897CC0F3764A401C1207C1EE036AC047B6E73F93B1EF3FAED2ABBF0B5267404E5CA1409ED5DABF214702C0F190513FD74FF6BE80BCEE3F4EF1FC3F70A59940F074AE3F6C7259402EB08A3FEF508D3FCEF2BDBED73906C079C4EFBF83769F3F430405C004AD0C3E80AC94BF738471C07D9289BF0BC349C038C723BF951AC5402D0C9EBF32FE5340504767BE111A923F41C24DC0BA6F28C06A499640A1135A3FC5614BC0AAFB743F9155A4C050FE63BFF67076BFEBD958C011410DBF900DDE3F1D7741C00282AEBF34E7D73FFD4151BF72ED493F13DDB340630CD8BF6BA04F4001D8D2BFAC55ADBFAF86144070C9D93F1DD518C06AB34ABF9379A54035606BC0684692C030DFA940CC3A1C3F25DE53C0FA48DF3F46AE913F32DC47C00F3F953F688C87403D34F73E40CA6BBF1DDB753E92E59140F2C1654023992F40E20100417EE892C03CF759C0AF18A3BFE04B824013DD5D3F433EFABF52362AC01C3E4F3F8E2C963FE2C07F3FBC52CFBF9120F83ED76F5A40F36B414055B0823F5CC68F404A1F75BF0CB0064046085A40B65B80C0DEF6B43F7DF52B403EC09040D84926C01DAD543F9AB209C0BFA07540698C5A40BD6D3DC07E150640226585BE266DB4BF5F78A9BEA12401C0C7F522C0BB1D1EC0A812323F7C43C03FBC4BD9BDA4960FBEAD6075BF8EFA013E9F3A9740BCC0C640387CA940F25819C0EFC01A3FACFA57C030B5A7BFB86680BF5438D8BEEA32B93F76B642C0D31007C04E4C43C0A3F4553E3FFA4B3F206BF4BEC8D71E40A02628BFF6851B3FE8496CBEDE1B3E3CA53E9E3FBA979A3FCC3F5BC0DF7A4DBF80AD27C0E4F350409D9CC03FE273F53F1A32D3BFB9EF7ABF31F615C034E07CBD62128C400C0776406301CBBFC3282040E4155B405619E3BD3DBDBC3F460A3340E0707A3E4AD88F3FEFE0FB3E554549C02D1E03C0359E0EC0461F71401A5D924002CA8CBF7961A5C01CCB8A3F302C98BE845126C0DC6E114010FC1440810E34C0F511B9BFAF4790C050CD66BF3BC5384081C097C04F162F409844193F8E2E47C0593217406BC9933F4BD684BF180C31C0E6CB803F7BF1EF3E23C05FC0F0B9E03F1A59DCBF6704963DC63560406669BDBF65B3864048845B40EAFA643EAA9507C078ECAFBF82232A4099F4153FD04EAFBF9F97023F97B5E6C04529B84074D195405E08883CB0272F3F93B1193F6E590BC0773559405EA3C33F4CBC203F1D1468BFFA2010BE631A16402411A0409534EE3F1D5A8B403634503F2BC7843F249385400522773E2817B3BF6AB94940339A96402DBD07C05E5B0CC159CECFBEE3F430403916363F5B2890C08AAB663F468280C0E27AA5C0E28B8E3F02369AC007E830C02FD59C3FDCFA733D0B4C0940026187BF168D76C05D9993C072F9963FFF19AAC081D014C0D04FCC4077D796C005E3123FB1A08FBF538D3FC0E21C12C0E683A2BF95A48BC01A5C0DC08D718A405C6BA3C0EAD3B7C046CFB4BF6A50B23FF4433CC0FE7C8C3F66FAC6BFA3F53040BD136B4012795D405C2BC33E78D8BFC07616C3BF5D06D5BF643563C0AD163C4074F040400A11EFBFF18A7940539770C0C99B713D7C1E3640DE658C40AB5214BF7409354072D6DABEA929F34034B5EC3E65E6A4C086998D3E58A2F0BFFBCF0DC01721EB409ACE5BC01B34D73FA0DEEC3F2289C83F0C1D0B40B6B43E409D6A7A40A28226C0D3725FC08BCA97BF52B6323FA5227A4013EF6840939210403AD75FC00264A03FEEE48640B19D1EBF88BA30BFF26B613FD159E1BFE94A863FCD67CEC04B7F19BDCF81D3BE693D3D3E3E797A3F0C0743BF32D36F40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
