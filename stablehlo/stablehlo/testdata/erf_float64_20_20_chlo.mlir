// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.erf %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x483BD41B17F60B4058B7646945D7EF3FDE35ACD3BFEB17408B3F1C9529A5EB3F6FAE74CA664AF73FA82F8F8F4B4DEEBF9CC5EB0D92A20FC01FF4955072921440A1B7808E148810C02B645172D8A80FC09C4277D376661140C06960C3B5B613C00F4F69854B78F63F8ABF52012FC512C0D0B82C540F10E93FFC850C6BB5A3F9BF80F7CFE50F3407405C0BED919D620D40E5FF929FF9DE0140019351A389CE10C0C5102A9FB168D43F5E8CD217737501C06E57F27A45F405C03216D38C7301ECBF888C6EEE5F65024066B86C7DC22013C040181EF9F6B613409606B707A9C1FC3FA4D6AF12B22B1240A9E15844012110C0561B44F134F800409BF25AFCD920FDBFA116CC0E1F2800C096F515AC13E5DA3FF85DBCBE0C08DDBF0A04035D8B5DE9BF388285FE3B9804C09F9799BC667A14C0521958D4C92909C0A3DBBD0F800A14C0464A3A15A70E01C05CB0BE20BAF4D93FDCD6DE3D267B05C00632F71D1D42E33F75EB27C372EFCBBF585C914368D104C0E451186081B9054043412669FEC7FCBF3437F219E02F02C048BA4C70BF15EC3F005B1DBD40E30AC013694F910129D6BFDE49CA0E8D220740EEF348E2A5C5FDBFD4A5205B535C02C0049C4885D560F53F386DF96216B1E43F70ED96CCB1071BC03A9088444FA5C73FA7DE3F8D7BDEF23F881A7765BE63FE3FB44D2D1DFAFFF13F9E50BE84EFA5F03F9805B027304B01403056AA597B491BC0E3A13D791E22F73F7685B0ABC76CEDBF66EADA5F168B02C00845CD253C9BF2BF7B855ABD390E0EC04CC3DDC3242FFF3F8DBAE0591AB3C43F1FF99026752D02C0D91A72BA186505C0725733AF4130C7BF785C899C5E23E03F264557C1111212C010E4C7F991C5A23F342FF2DB71000DC0BC8D52789932F53FCBE4A894854CF93F829F1C1FAC7EFCBFC7C4F0B7FDABF83F563014E37E96F1BF2266EDEB3143FA3F7840C4B7B1DAD53F15F0C160A5C50BC0A0F4846D5FDC01C02CFA94FC9859F03F403C9FA1BA38154087555FB52E0207C06D97731A631202C0149842C538D50840921779902203EBBF96D13542BD7104C0AD4493EB324D0BC0F91FFBF61C1A12C0E8834847D9CAE6BFB8B2D812E9D612C0F47B65C6EFE205C004F5C6F5DFD20CC048386FB26997CABF6CE303DBB19CD4BFBA51641A0A3D12C09CE1D918BFE8D3BFF6619065D315FD3FD8CD7E6FBC0508C0CC4BA1A85BC3FF3FC0548D2E65AD084024D20079A8A418C05609B5822B94F6BF7A01885CB8A30A400E8247279B00DF3F4CCB062D9BEAEA3F29A2FE93B93305C0A91B580302AAFBBF50FE085FB43BE93F1EFEC063301218C0C648F0B716A30640AB2884D7F0CEF9BFFAF23780B974EEBFADE1810D3FAF11C004A6FDEC1BFA1BC007F450F392FA03C0A44FFF7E42C3F1BF7B752CE902ABEBBF5904991DBF85E9BF54D69B362C5DA5BFB83080C5CEA8F63FC0C87ECD8CD5DA3FBA7A90E71405E63F945941504191024043292C76341415406E0BF68897D211C0CCEFA4B2DFB8164093C7577B0EAFE6BFB059A8AC63B4E73F20B2A23A689518C016CBADAA87C50340D279E5489571ED3F5B02CFF774330040625E7240EFD201C053653BEFAE63E93F2A21A1880AFD08C07CFF2C279D9E0440BA3F48939A7D0BC0F7E1169F6ABBF3BFCA70C6334CFA09C0D221773B8A79EFBF02E03774C5BF1540F370EB1AA32D0640C2B57B9EC90DB7BF0BDC9E0721C20740FDE065EB83BEC33F96394737687D0BC014D9D0C74C0611C0A439B3483462FEBFFA0B187E3CC510C029E6D4E5B53C09C0FC90B13C1ED3EBBF58F223B4F41708C02E80EDA61224FE3F7A1C22CE36FFFFBF82ED0D5770330EC006AAAD30C3CBE0BF2221EF216F120440D8EAA89193C0F63F2562D996B9F6D6BF4F4F4D03B0800CC0F12A9066D00FF63F6C21CE2990F5EC3FD3B7C85E449410C09A94827C342405C07D0099DFC1A4F2BF34BF8F543CD30340F2B8CF27C451184070CF03B974C20A40C3F62824231DF53FC77804D18470F63F7E98D8D9D606E0BF7222B5DDF314C3BF58BF55598F1E1C4062FE5FE1767901C09D3985AD28401540024A2251F3A6C9BFF9A8BBFD820A20C0834626B3A62212C05D8652887560ED3FEC99EE88EC5522C00ED371B2ACE20BC0980C66FEEB2BFE3FFC1931DCBEF0EF3F75A7E24D20A4F53F0322FEDF0031114081C981B44013F2BFF512A5D45E3E1140DCEC8B53069814C05E619B924B9C1A404C7DF8469BD20AC07490CDAFD8A3C43F160685957BF8FDBFBB21367D9FB3D6BF80C449217A3C14C0BD361A71C7B80BC0942B01CD347F14C090F7F22ABD9AF73F1EA51127C922FBBF5DC40221CE381A40613181A8A9B9E73FAC36D7FD1865DF3FF877F701CFD4F43FB02D7A4E3589E03FF1DC4C1B2E43FC3F9E6DE4D5538C0AC0D2CFB53416EA0C40FE9243434CCB0A4038BE7E1CD1C0E2BFA0A6318138370A40789FE88301DA1140782A4F0F26FE03C0387DED0BC477F6BF1005F0A8DAEDF93F46E21E399917F5BF08EF9E2F1C530BC094581CE1BF3918C044C3BA0B162009403CEBED4CCBDF01402689B5617C1513C004F280F7D041D73FB6C1EB176B66F33F14B2FD87811BFE3F3DDBD7C2068512C0E129F9C68773EEBFBA84A38E78DF0FC08C46912DB02F1AC01009A80D140506408651A0D672A9174037296C83777AE13FCC96C1384BE0F4BF946287E5109DE93F424E9CD9270F03C0487450454CDB124050D3A339B144D2BF3AB607868A9A00409C7360BF7DBF1C4043D8D88B7FCB0F4084A39535C8D4E0BFD103754473671140F7BDF15D89C409C07240D1FEB26C04C0DBCEB21B3EF90240CDF71AD0BA5A06404695FE303859F1BF2A6CEADCA87B10C0AACF461E834815C04048EAF7E5D0E53F41DFB65399D00F403EF7CCE30F620BC04854FC73D9B9FDBF5883082A078CE23FDD3DF58579C20840841FC63B5A9CE6BFE2565CA599BBE23F62BDECBDDF5820C029CC38BECF19B6BFE00BD6FF67A1FABF69A4063AA7DAF33F305593A4FF5FCBBF24AB16DC34A008C0C87C8E97216309408C006D39BA6C0940F011C8F871F90840A61ED4898061E83FBA94FFD9FE790540E87DC87F0EF3EBBF467D88922AD4FB3F5D4EC627625DFCBF9C29C10737EAF63F124DE5B0A5EECCBF7C97014AD6CE1440268AFED58B510940E2A79441528C1540B0B8BBADBD8A13C0D38F76298CA2FF3FB81C166845FB11C0F2DDC6CCF56E15C0A8565CDA6755E9BFAFF96595664A12C0B693A4024BE802407EEFCE1E763B0240AE6629A74D7A02400478BEC2058EF93F1E369B2FBBE0E33F3258E31D7BDB0EC0750399F3470C0F409E43F63F6E5C0EC05AB3C43B206007C0ABC16DF1CF0406C0B2DF26667F3A16C04254CB8EC056ECBF67911E9345B50EC0C4AF091578B60D40062CD212AC5DFBBFA826AEA3157502C05042F48B8021F83F0BC36C7590F3EFBFEB764089625911C0F4201F9E5F0AEA3F3B44B9C6141611404F8CC209A5D815401CBA5DCEA9B7923F4971F0220A7103C0811696D8A7D304C036B0678C9D7EFE3F8E4D854C91BD0B40D662D5BD61851540055795CE6B6E16C01B26A963A77DF73FE236FD8FE41FCA3FE600FC9FED9AF93F9F9F332BD07713C0A6F40FF45EE4C2BFDAB59867D55119C0BD7177DC933B12C0C452B72A33FC0BC0A007CC9C0523F13FD3B4C18E4B1F0640926FEA9A46BC0440C069E51747E30040E17100FEA2C10940C12520B05475EEBFB2F193E446C8D2BFE4D54B2F9F821040E6FE1879F910FABFD5AA24D106EE04403ADED8B028160440682530828EA798BFAD9BD74A4C7FEDBF98C76268D19EF5BF8D664ECE0667DEBF63CE79CC971517403CAB04120DD70040F16F716D84C5C23F27650F4860E311C01232CBAB96B10B405665FD7ABA95FFBFE7260083D9F2D43F566C985AFA59E4BF38BDF2E36AC2FABF780564AD4FE7E13F3E198AA3577BF8BF9312E8FF81CA00C06666369D25C410C04F0E697A5F4711409F416810160115C0609EE384D74BF63FAE43ABC86BF1ED3FBAE8C8213AD1F0BF5E149EAAFC83B2BF30740C6B3BE6CF3FDAED8871CE9513C026F5C341162E08C0F606C88C666AD7BFDFBC36FA84C818C0E3FA602B1EBA14C0A2A02FDE801DD23F334D1890B50C10402480DD8A37CD0B40C67F2434EA1418C0409369E1B6A4CBBF8615404A221A17C041AC9F626E190940725B0692BF18F1BF65FA538BC53AF63F2868939FADFFD83FA055DCD22E9E14C08EBB46115E861440BE6734512387114058934418AAE9F9BFF88B49E485D1F6BF84A33F2E3FA10040AAA239BFEF650CC0E3D4A57C741DF03FA111C753755002C039F2A98639B712C0B76F1E0DEC7AF5BF8902EBA537CD01C080CBCF52DA4EE0BFECB24AE3D6E30C40D5F59D7D94B5E4BFE381D851E33208400E1899B3FC4009408838EA732136064059A53F9ED120014050DEB9850C0E16C062267C4FAD3B00C05F76552767FC0440441BAC0C648301C0EC775E89BE950A403A7E9529EFE4EE3F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8E13C962FEFFEF3F2A79B2F169E6EA3F000000000000F03FCA9CAA4803E7E83F38EAEE482ABCEE3F5918E22E3739EABF0CEDF8F3FFFFEFBFA9F3FFFFFFFFEF3F91E646FDFFFFEFBF04DE44F4FFFFEFBFC9C996FFFFFFEF3F5E90FFFFFFFFEFBFCF4D9906C67EEE3F2A94FBFFFFFFEFBF22E3CAFE5A6CE73F6E36DBA60040EFBFBB9D7208AAFFEF3F8E38DE91FFFFEF3FB2B5E5F709F3EF3F753F7DFEFFFFEFBFCD60B1D78C45D63F9BE65DEB65EFEFBFC0C4CAD325FFEFBF5BED7385E717E9BFDA64F39A9CF6EF3FA423FEFFFFFFEFBFA590FFFFFFFFEF3FC5484FD6A3A5EF3F17CBEDFFFFFFEF3FD0BFA8F9FFFFEFBF48D272D0DEE9EF3F84026D16CAADEFBF1394CDA5DEDCEFBFE61E568AE6A6DC3FD623ECD7CDA4DEBF393E8060599BE7BF4D5589B1C5FDEFBF3AF0FFFFFFFFEFBF289AACD8EDFFEFBF47CFFFFFFFFFEFBF41B90B79F8EAEFBF3AF4C70C35C2DB3F3D1CCB49CDFEEFBFEE08D05A845EE33FC7DE24583C07CFBFA6F49A2217FEEFBF2D713E68FEFEEF3FD2C4CE2534A6EFBF581622C350F5EFBFC40D1D498722E93F74C2A3CCFBFFEFBFFCE0FC486D0AD8BF451E1E6DA5FFEF3F0DC9ED865CBAEFBF51EA393A67F6EFBFA7946E47341EEE3F7E5866E7F676E43F000000000000F0BF58D896DF8461CA3F3C751AB9DBF2EC3F3B7F83DEC6C4EF3FDA1DFE68A96DEC3F479AE0B9A97BEB3F3F9FE673B1EDEF3F000000000000F0BF21CB27A015B1EE3F653AC7082CCFE9BF9DFF10B86FF7EFBFC0261AC459CCECBF825B25C6FFFFEFBFC43E22C81CD0EF3FE9B79FEBAD27C73FBD6994CF40F5EFBFA992DDE5B9FEEFBF600FFE51C9E1C9BFC5A84331F3C6E03FE509E9FFFFFFEFBF23B06E9D132CA53F1554CE61FFFFEFBF7FF75C636F0CEE3FE7996D386330EF3FF9A3D1837B9FEFBF69848BE2BF10EF3F765010918C28ECBF506DC409F159EF3F326FBB77EABBD73FE651AB15FEFFEFBF0BA94873F5F2EFBF604792CE2C40EB3FCEFDFFFFFFFFEF3F995CAA499CFFEFBFB5B1734188F4EFBF6AEC1A37E8FFEF3F84DA0511D98EE8BF12623EDF87FDEFBF12342C15FDFFEFBF0EA6EAFFFFFFEFBF31C5719763F5E5BF9241FCFFFFFFEFBFCA86ABD51AFFEFBFD44C2145FFFFEFBF8F922B264194CDBF88D3C8E57F7AD6BF3473F0FFFFFFEFBFD7A0FC61D0C2D5BF21FC7F57E1ACEF3FF976E57BD2FFEFBF5DC05E1019D7EF3F8B97C004E5FFEF3F000000000000F0BFBEB750807187EEBF73EA2AC9FAFFEF3FDFD7EFDDD836E03FB06043A03D81E83F98D475398AFEEFBFDE6B6CC16589EFBF02680367E986E73F000000000000F0BFE81F861D7CFFEF3FC5F59E255C47EFBF5247DD25484BEABFE675C8FFFFFFEFBF000000000000F0BF4ABF54609EFCEFBFE28C02EB5C46ECBF0B707DCD23EAE8BFE556D8A674B3E7BF0A676286B817A8BF7061957EC18DEE3F5FADCDF13598DC3F722A42DDB66CE53FD7861B9190F7EF3FC7FCFFFFFFFFEF3F9C6BD7FFFFFFEFBFF7FFFFFFFFFFEF3FA6EA191176E2E5BFD402B87CD690E63F000000000000F0BF0CDAFC681EFCEF3F68AED0647FD1E93FAAF203EAB9DDEF3F033B130DAAF2EFBF00A2F4DB0A9FE73FD51A460CEBFFEFBFF890D25FCFFDEF3FBB3DD988FDFFEFBF3BDA63FC4467EDBF4EDBEECDF6FFEFBF6442271EABBEEABF7BFFFFFFFFFFEF3FC6A21AC346FFEF3FD79F24E67EF1B9BFAF2CD600C8FFEF3F34A10EFE7E1AC63FA3586A88FDFFEFBF75F50EFFFFFFEFBF0B4375BBAEC4EFBF0BBF5DFEFFFFEFBFA05341EBEEFFEFBF27B779737AFFE8BFF587BAF8D4FFEFBF70FAE45DC3C0EF3F4B3E65C2A5D9EFBF4430C6CDFFFFEFBFD9F4D1C8C058E1BF8AD6FDC3D2FCEF3FCC47F04BEA94EE3F98F648026DD7D8BF47A73F04FFFFEFBFB76B83D4C45CEE3F0243B471A494E93F70058AFDFFFFEFBF087DCFEE79FEEFBFBB6490C5E4D1ECBF8C5C1D1141FCEF3F000000000000F03FB0B16B4DFBFFEF3F294463060104EE3F7DD83640537CEE3FDC15AA55F1ADE0BFB4783926845FC5BF000000000000F03FFE1C72618DEFEFBFF8FDFFFFFFFFEF3FAEB667AFFD8FCCBF000000000000F0BFA33CECFFFFFFEFBF4BFBC9E931C9E93F000000000000F0BF094A6545FEFFEFBF6F1E425145C1EF3F1F2F7D940FF1EA3FDA9C433D2037EE3F79D658FFFFFFEF3F07F98AF5DD79ECBF5E096BFFFFFFEF3F58F4FFFFFFFFEFBF000000000000F03F7FADC68DFBFFEFBF6EAA6D49E816C73FB6B54160E0BDEFBF7AE87928C294D8BF79E2FFFFFFFFEFBF43B3F6FEFDFFEFBFFBF0FFFFFFFFEFBFD63A2E3C56D1EE3FFF388E7E2379EFBF000000000000F03F8534070A4694E63F41C374308D63E03FE8899733B8E6ED3F6EC719F47E1FE13FC76C0474B499EF3F435C445BFAFFEFBFBEF84F54FFFFEF3FB5EF1271FBFFEF3FD387ED2FFDF7E2BF25A1737DF8FFEF3F4D04DAFFFFFFEF3F22DCC06BA6FCEFBF3B50347A9B7EEEBF8E77D12F784CEF3F88627D26CF01EEBF476F5224FDFFEFBF000000000000F0BF66759145EDFFEF3F38A1EF6610F3EF3FA3EDFDFFFFFFEFBF54CC0E7CCC21D93F583F940C453CED3FC240A37434C0EF3FE6F7F7FFFFFFEFBF8AE621B0BC4AEABFD18291F6FFFFEFBF000000000000F0BFFA99330230FFEF3FFFFFFFFFFFFFEF3FFD117518BBECE13F3617B6E675EBEDBFA1D1C3455AC1E73F568D0D28D3F9EFBF4D68FCFFFFFFEF3F64B1D0833211D4BF1D6D9F38B0E4EF3F000000000000F03F8A99C8F5FFFFEF3F2FEAA9B17960E1BF29B097FFFFFFEF3F89085805F5FFEFBF522009547FFDEFBFC191401E7AF9EF3F87AABC4A5DFFEF3F1F72ED728FFEEBBF1559FBFCFFFFEFBF24FEFFFFFFFFEFBF10A2ED79E147E53F9E66FDF5FFFFEF3FD9635549FDFFEFBFEB1AC7A785B9EFBF1266FCF893CDE23F97A224C2E6FFEF3F74971FE2ABD5E5BF5DE382E5CFF3E23F000000000000F0BF2AF7CDD854E0B8BF3B3BD419C867EFBF037436638776ED3F02E358A9C06CCEBFA02759DFE3FFEFBFCD9AD4E9F0FFEF3FD4D02860F1FFEF3F8C0C56CEEAFFEF3FFA2B8F36EAFFE63FCB741C4DCCFEEF3F56CA496F5710E9BF1ACBE5A1198EEF3FA95E8B4D499CEFBF10CDE5F22CA1EE3F70CFA25AAA0CD0BF5EF9FFFFFFFFEF3F4D81A607F0FFEF3F19FFFFFFFFFFEF3F6C54FFFFFFFFEFBF5C4519DEA2D5EF3FAFCDE3FFFFFFEFBFC4FEFFFFFFFFEFBFA99CD12B7296E7BF073CF2FFFFFFEFBF61BC511432F9EF3F6B800B069CF5EF3F357FCDF913F7EF3FC2180F8E373CEF3F5909019EA8D9E33F0DEAAFE5FFFFEFBF53963EEAFFFFEF3F72CE0CD5FFFFEFBF66375DA9B4FFEFBF07F6D9D92FFFEFBFDDFFFFFFFFFFEFBF62CF5BA93E44E9BF884E7CE1FFFFEFBF125374AFFFFFEF3F11C019057280EFBF06D8CDBBF6F6EFBFF290197E34F2EE3F106F65223CF2EABF921C8AFFFFFFEFBFB065AFE9A601E83F955E2DFFFFFFEF3F9AFFFFFFFFFFEF3F106BB500361E953FD14A019F2DFBEFBF52F36B1A1AFEEFBF01FC4FAA66C6EF3FDB8B8707FEFFEF3F07FFFFFFFFFFEF3FECFFFFFFFFFFEFBF28C3C2EBCFC9EE3FE9AEB768FD12CD3F3C4511417A3EEF3FC831FFFFFFFFEFBFA0394903E429C5BF000000000000F0BFD73DF0FFFFFFEFBF0862A36BFEFFEFBF6387FDE544D8EB3FEC20D1FF3EFFEF3F070D7765FAFDEF3F511B7F1FCCE8EF3F041F72EAF4FFEF3F7CA77CEC8E4BEABF7ECF129BBD99D4BF97A026FDFFFFEF3FDC8F5EEB1F52EFBF2ECC03AD3BFEEF3F0EA1F1ABDAFCEF3FE845450274D09BBF49F1AFD51FD8E9BF49C691293335EEBFC21F662F06E4DFBFFDFFFFFFFFFFEF3FA56C6A1326E8EF3F52F1C352D207C53F3111DDFFFFFFEFBF936BD6F1FDFFEF3F4929766A0DD5EFBFF1C3C2D3FCD1D63FA442F2B3D035E4BF7CD34FF6626CEFBFDAAB8B643447E23F8F0D258F6006EFBF79CA1C5677E7EFBFB4E559FEFFFFEFBF593076FFFFFFEF3F11FCFFFFFFFFEFBF85E048AF9970EE3F6C6F7A007A0EEA3F9C56ADE2639CEBBFCA7DE6E230DBB4BF7C4D3FF6ABA1D13FF665FFFFFFFFEFBF4A06BDD1D7FFEFBFFAA9FA5AE449D9BF000000000000F0BFCAF7FFFFFFFFEFBFD23A12E168E8D33F324287F8FFFFEF3F02E39222FEFFEF3F000000000000F0BFE80CE143CAB6CEBFFDFFFFFFFFFFEFBF13D11ADEECFFEF3FC169911BE3D0EBBF0543B4E90A6BEE3FC224EF9939D6DA3F0EF5FFFFFFFFEFBF0AF2FFFFFFFFEF3F03EDB0FFFFFFEF3F62DAD5C5C84BEFBFF72EADB3F299EEBF62B67FDB17E5EF3F684BCAEAFEFFEFBF5BC4F5F7AE0FEB3F6B8BBB901FF6EFBF56F6FAFFFFFFEFBF3EE8322BFF27EEBF82836D9E7BF2EFBFB7093D1AE5ECE0BF8CF95850FFFFEF3F343B4BE54C7AE4BF9545B469D8FFEF3FC4CE2027EFFFEF3F852826384BFFEF3FC5D5BAFCD2EBEF3FC7FFFFFFFFFFEFBF4D0EF7DE55DEEFBF29055A0C4DFEEF3F14B71382EDEFEFBF44848388FAFFEF3FC7A8B8CACB7DEA3F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
