// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.tanh %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x913F8640AD3F923F24C056C08FC0ABBF6D4071C0EF3F5F40AC4008C0034013C032407B3F1D4075C059C0A74035BFE3C09A3DE3BF4140283FF7BFA6C072BF30C043400D40A93F6BC0F0C0643EB5C04C40ECBEED40613FEBBFF63E50C0A2409BBE324038C08ABFC73FDE403E3DB2BFEABFEABF9B3E4B4094BF9B40A63F5B3F26BFF3BF89BF203FD5C0E6BF2FBFEDC02FC08A3FC73E2FC0FE3F0C40094094401BBE37BF43BF9BC09EC0414014400CBF643F0BC09640F33F033F4540CCBD1CBF2BC0FE407F3FE4C07FC096C08BBF023F92C0D1BF2F40BE4071C025408BC0AEC04240A7BFDABF9AC01CBF5E3F83C0F83FE2BE42C0F43F4FC0153E9B40333F9FC02940E2BE7240B53F8FC09A3FAAC06EC059407C3FC43F763EBA405CBF14C083C097C0BB3D94BF843FDC3FCF40C8C02C40413F933F4B3F0A3E2A3F38401D40074080C02940D340463E70BF2EC0C4409B3F0D406CBEA43FA0BFADBFD0C0D23F1B4094409DBF2BC0FA3F853FA2404EC05F3E96402A40783F00BE0DC07CC0784045C00C4042C00440B13F5A40EC3E65C0B5C00CC00A40BABF5ABF574094C0293F51BF8CC027BFE74010C09FBFA0400540D63FEBBEEA3F47C071BE7CC07840A440DC3E1B400C4072BF04404D4044C016401BC0C03F514038BF034080C061BF964094BF353F8FBF5BC0EFC0CF3F433F763F6C4001401ABF36BE21C067C04B3F65403EC0B53E26BFFA3F014082BF24C000BF7B4052C0C03FB040D53F3A408BC09540753FB0BF81C013400D3F554059C0684063C0183FFBC00E40D23EF93F8EBF04C0663FDE3FF3BE0240563F3E406D3E0BC1E13F2A4049BFAC3F5D3EA84096C091C0AF3F363F7BBFDA3E3EBF314098C0AE3F37BE094085BE80C048406F40E3BF80C037BB163EE3C0FC3E8BBF28C06EC05040074040402D4056BF4FBE0BC047BFE9C003C00BBFACBD31C034C0913F8EBF0840683FE14009C01FC008409E407B40C540DFBE33BFEFBF923E563F3EC089BEB13F44BF853FD3BF94BF46C0ABC0463F9C40EAC0853E42C0C84084BEDF3E113F86C082BF523E9640C83F0B40DFBFC440923D83BF24C09BC01CC0E94075C007BFA240643F95407B40BB40D0BF0CC02DBE87C0D83F02C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x503F803F603F513F7DBF7FBF80BF5FBF803F80BF743F803F803F79BF783F7BBF7E3F413F7C3F80BF7FBF803F1CBF80BF9A3D72BF7F3F133F75BF80BF3DBF7EBF7F3F7A3F5E3F80BF80BF603E80BF7F3FDDBE803F353F73BFE53E7FBF803F96BE7E3F7EBF4BBF6A3F803F3E3D62BF73BF73BF963E7F3F52BF803F5C3F323F12BF75BF4ABF0E3F80BF72BF18BF80BF7EBF4B3FBE3E7EBF773F7A3F793F803F1ABE1DBF24BF80BF80BF7F3F7B3FFFBE363F79BF803F753FF13E7F3FCBBD0BBF7EBF803F433F80BF80BF80BF4CBFF03E80BF6DBF7E3F803F80BF7D3F80BF80BF7F3F5DBF70BF80BF0BBF333F80BF763FD4BE7FBF753F7FBF143E803F1B3F80BF7D3FD4BE803F633F80BF563F80BF80BF7F3F413F693F713E803F32BF7BBF80BF80BFBA3D52BF463F703F803F80BF7E3F233F513F293F093E153F7E3F7C3F793F80BF7D3F803F443E3CBF7EBF803F563F7A3F68BE5B3F59BF60BF80BF6D3F7C3F803F57BF7EBF763F473F803F7FBF5C3E803F7D3F403FFFBD7ABF80BF803F7FBF7A3F7FBF783F623F7F3FDD3E80BF80BF7ABF793F65BF31BF7F3F80BF143F2CBF80BF13BF803F7ABF59BF803F783F6F3FDCBE733F7FBF6DBE80BF803F803FCF3E7C3F7A3F3DBF783F7F3F7FBF7B3F7CBF683F7F3F1EBF783F80BF35BF803F52BF1C3F4EBF7FBF80BF6D3F243F3F3F803F773F0ABF34BE7DBF80BF293F803F7FBFAE3E12BF763F773F45BF7DBFEDBE803F7FBF683F803F6E3F7E3F80BF803F3E3F61BF80BF7B3F003F7F3F7FBF803F80BF083F80BF7A3FC73E763F4EBF78BF373F713FE2BE773F2F3F7F3F693E80BF713F7D3F28BF5F3F5A3E803F80BF80BF613F1C3F41BFCE3E21BF7E3F80BF603F35BE793F82BE80BF7F3F803F72BF80BF37BB153E80BFE93E4CBF7DBF80BF7F3F793F7F3F7E3F2FBF4CBE79BF27BF80BF78BFFEBEACBD7EBF7EBF503F4EBF793F383F803F79BF7CBF793F803F803F803FD2BE1BBF74BF8E3E2F3F7FBF86BE623F25BF473F6EBF52BF7FBF80BF263F803F80BF823E7FBF803F81BED23E033F80BF45BF4F3E803F6A3F793F71BF803F923D45BF7DBF80BF7CBF803F80BFF7BE803F363F803F803F803F6DBF7ABF2BBE80BF6F3F77BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
