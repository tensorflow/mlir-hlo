// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = stablehlo.exponential_minus_one %0 : tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xEBFA18417DDFCBBF8C021DC11AE6EE3F4BC5A5BF4C5F944028DA1AC018408A40F5E554C08A3944C0E355BB3E0119C43F936C4DC031520EC1D91556BE46644C407D0E06C0B692313F4E7594C035A437C06FCE98BFB792AEBFFFD1573FE92174C06D33F63E9B26EE3F4A8614C0212E2A4022223F407A9D3B40D243203E6CA2D4BFE57A48C043303E405090B0BFDA273EBE7F2A39C0C995A83E5F3D843F799F1CBF20F4C13FC7CACD3EC7D1A840D1D26F40E44230C0C590DB3EE3A5C83E5E393EC017ED38C09714174088803EBEE77A4DC0569F5B40CB3F903F0883DABF59B4DCC0138B613FE90B15C0C6EA2C40586FA43F839E0F3FC3B02440FC912640A306D0BFA332814000AF873E428F4CC04AF48B3E55421AC0574C5EC095098040A380DFBE5D99953E8C56A8BF6AD80C3F99B5E33F2D7EBDBF42839F404A1D2B407E9B22BEEE0BC8C07DC2B53FAC536640333017C0259E75C0BA0A163F685D973D15832DC04710CA3FDFA26CC0E017EEBE85C9414020814ABFC95A87BFB8938E40CB5555C0BA7005C070D2ECBF0E9220408F8B163F07D287BE631E97BE8BE34FC08A15123F8B25A540D951E3BF0F43133EFAE5474081EE68C0948ADA3FEEFCA33E1B0237C0058B6FC06DEE1640640548C0635B063ED3D836C0DCFA1C4047E505C0BA893D3FBD44E63F449C56406EA1463EE3D8A33F40E3A6C0AEAC52C0DEE4723D4D67C4BF8CD02AC0358C6E3F492D0B404AA3DDBF3140FA3F0EE3B7BF7E3FC03F39D442C0FBB29DBFC63B7DC02BBF22C07FF937BF0C28C03F35D7AD3F7C97734059EAA73F020C853EB95254C01822923F4F5F77BF5F259D407819BFC027E5E9409803F540B0EEC6C092E64C4017A9D7BF51968BC09D4378BF1607013EE9CA84BF536B16BFFB1A46C09B8FFA3F81FC8BC06B6B61BFD08C164048A5B5BF0C14833F0CC9CE405060B3BF7BA9C7BF23F0DEBEF64E77409BFA9AC02F6F4340CC75F23FA47E17BE5A001BC00D11FD3FEF5BA9BF0C14C3BF2D3C3240E2CA5C4075014740771492406CCCB13F5DCE8A402FE6A33E2D842640FB7A50407DF45DC02C991940CBA74140F2D9B2BF85EC80BFFDBDB74047CCD5BFC2484DBF6E13744038650C3FA0D2013E6D82D340224E3E3CED2DA9BFF8554D4041E9C83FBC14C1BF78D4563E19628B406180B3BC8A1C324014D028403E6E8F4059586B4040AED0C0AFAC254094BFD3BFB3A1FE3FC15F9C40A9BCA4BDB0E55840C7D794C09CBF90BF0F5676C0C8BBA83FE00A2EBEDC8516C05CE7EFBF3197E2BF3FAA10C0FEEB9D4022021CC00ECD02400C9B953BFF20D7BF961EA7402D35E43EE6BCC7BFEA242440B144A23FD9EE82BFB21478BFEE9F11BFE775F33F381E813F2C109AC0BFAE9AC06B2FB1BFE1EA20C084EB86C0F15DA64085CE22BF311FEC3EC401073FE51A01407AC743C0234250C049116F3FD689833F5B6AD43FE83B7640FC538140FE65C43FF82C324001C43CC01DC40C403C5565401ADA01C0562B6840D09F61C033D79EBF0CF86AC0CC20883F5C2E54407FA1B13F5E31A03F2BEDEABE1431863FFA36913F5B5461C0A32604C0CF17A33F80F6FB3E76B907416698A4BC92F86C40A6B7C140F1DE064068B10640230D9040E2A0F53F9E7702C1B2EEFEBED978A740315A944063B0F43F2EB90B401D8282C07C8A1140CCC4F5BFA076843F9E9E2AC075E9BE4025A46C401AF9DBBE67AB04C06BD5E8BE62191E4072B5C1C044A0A540F4070DC05900D73F2F081F40CAC785405353763FA758623F79CF0CC1F70837C05F70B13F6310D63FC0EA8B400CE19FBEDBC65CBE271E253F508A2DC00045EE4097E2644055D04BC0F480AD3F606792BF53FF5ABFB191DA3EE4EF44C0EDC91140C6A65F4048ED09C0A3A08C3E3654DFBF955BE23F207BBBBF666488C0082AB340367B033F609B6E3E8343363F0A93D64026ED01C18B23EDBF1AB6D1C0410F0CC0E9C50A40A71C34C03699F53F85F59DBF447C0140951DD93F9A3E0940DE6241BD694CFE3F86608E3E9ED0863FA3A86A3F8D16B03DFC2F54BF02CB82BFC57313BF8B2FB040629DA940201B37C0B2D3553F672BB9BE466301C0913E5A40989F35C0B3324B3F990CC0BFC18C6EC07443E9BF8296BDC07F7BB9BF77B142BD9356DDBF99EE5DC0750B4C40791D3BC00B7346C0C5934040F8C751400157CD3F4C6138403FB31240C8C423C041228E401DABCC4001FF2E40BB22E0BF09FA1CC06BB1883C7650E73ED97C68BF2FDC233F89419E40D3D1B0C041E308C0189B71401091863FA209D23DA10B8CC01B0FC13F81DFF43F20333BC0BB9280BFA1BB3E3F1EDEA03FDBAFA3BE7E801C40A2ED343ED2DBAD3F69A382C09E19A13F8C5B17BFC748493FD22AA340B44DD53F4CEB563BABD53840C14D013F447E5FBEF67D993F061219C05722E8BF3AC7E940B27CA9C0B18000BF4C1EBB405EBAAB3F5D2996BCEC928BC0E1BC184075432840DB0D883F2E45DFBEDF8A16BE3B8182C02680D6BF474A1740B3B2E8BF168AA740161554BFA98C6EBF25874FC019DEBEBFFC544CBFBA92A23FDA9A223F3AA224C0DDB019C0E0A196BF1E5082BD522E324078CA19C096810140A5D2CDBF3E2C36BFA2B14540ACAF55C04499EDBE678028C04F7B643FE9985E3F122F344008962F407317D4406301F4C0F36CBD40340F3C403025C040FBFA1F3F59AEA53EE6C215C0CA2894C0C2CDA7C0C1D925C04CE0A740BE7DACBE38B157C0BEDDB6C00EA7793F47008DBF3E330BC03F273FBF177F66404BBE95C0D82C85C02B582EC0A60A45404CA36EBFE82207C1AD9AAC3F6A0D75C00C8057C0DDBB2DC0C1C13CC02B67F73F63E9C7BF86158F3F1E3C1940AB8731C013ECCEBF3301093F5D3FE2BF16D57940C3D84BC0E2DF633F230FB8BF8B8EA2BFE9DBFAC088E0623FCF3B51C0A56E774078BB28BF9F2191BFC1388EC0BB494140DC20EEBF9EE8323E8DD46D4022ECF23F1DA96840B9F2BA3F81318B3FB005B93FE37CE73EC0D98FBF20C68CBF4F081AC0FDBD313F2FAF4EC072F7893EE66F9140B09F90C0619D6D3FACDF8ABEBB73A640EF9D4B3DDC93BF3F0DCFDA3F23F1AE3FF82740C0B29315BF73C30A3F81EAA1BF3FBDD5BF2E9B91BE34AE98BF0D39633FC07A9F3EDBEBACBF24E0EFBF9CCDE43F238AB53D9225474098002C400F11CCC0AA1F6EBF8D778B3F9ECF88BFE0C96DC05CFA73C0A946DC3F43B25FC05299964066447EC02BF8AF3E862A79C0643EBA3F436984C01D42A63FF04955C037599F40B18B6D3FC410CD3F29DB6EC05C6039C0B71CB3BE7DA202C00AFE2B3ED2769C3E9F672EC080923B407F8AEFBF5A438EC09D0ADABF8D23AC40DF6698BF14A5584072EC503F410D98C0014DAC3F67692C3F4247A73F7A4E813EA9732D40A9B1B53F559B9EBFAFD398407CA87D4019274E3F36F9E1BF7D986140DFCAB43DFE813DC0E11A35C09B0776C0B7AAD6BF78A179BF0F20DEBEA9150FC02D0E9240C3B949C035F09C3FB2B387BEF8E943BF80A0F8BECF34C840677182BFE20F56402A3D4F3E18E345C0BC84DF3F816F08C04CAB8BC06B0229C0FEA6BE3D7DE73AC068530640319F91406F22A93C56455DC022AE2AC02520394098062A403807943D3526B73F1CB6D73F41D50F401F0C4EC02CFB7CBF45802B404BDA8EBFCDDF603E713E41C00CAF62BE8E560FBF4A0D6340451433BF5A18014010307BC098538DBC8457D5BF54C587BFCA903940F099484015660DC081E4A3C09C699840BA89873FC3A9133F119E4DBF6A04E0BF7A5C24409ACB8CC0C250D6BF3B5404C08CA1CFBE1E4A61C0809E843FD2AFFD3FCB9B4FC02544F63E3EA923C00646783F374A9940E374D63EAABEDFC0E7061EC0DB6224C0825208C06796A53F50E9B93F4D15EC3FC7D0D3BEC7ADC140AD247240486F3EBF6BB8ABBE5C0600C0B6E714402D000CBF02E839C01A6265C0764E903F895755BED336613F59988DC0DE97A5BFC71D71C0153A0EBE65D81CC0C0B81FC0DBDE43C0E1E9D7BF6D6F173FCD7E253FB42D1E3F7539CFBE08B32B3FAF50813F4FB329BF5D5CA2C093DF59C0AB0B9EC0A4BCB3BFF839813F4B790ABF839092BF54FD12C0D906C53EA676E3BFBC224B4021BEA3BFA6E89C4007C67840875196C084BB12405B5EBE3FCCE7D04053A518C0D8D9B5C08BEAA5406E84B040588A4A3CE01CA0BFC135C63F176B5D3F736ABABFE1FF33C077EDBBBE014387C090979640C0A8B9BFD19B6C40B4BC0CBFA534D5BF2C12D6C0344A7EBFADCAD7BFEFA8EFBF9B36DBC00F8D993F4AB97B3FF737244073CB0640749A094051FD48C058BCCE4075D1A0404FDD73C04EA5ACC0CEFAE03FA6D5993EDD93D83F828EA04093281240B85F75400236183F9526F9BFD68F98BF3FFC88BFFC4C57409D4F11408EDED83FE728BD3E0B5367C0DC44CDBFD3F72E403A1929C0CDEB543FC1928DC03E2498C07800C040EB379140E1C0D6BE1A2143C0E413A4C000748740BD465640DE3DA43F0DAB9EC09A4D2E40C735A1BF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8F749CC32EE15DC6860080BFC58B5B3836A782BF63D28BBED55984BFCD5DA8BD949584BF15BD31BB4EB071BF3F69B83F757584BFDD16A7BC06B6E7BF94D22CBDFAC367BF4734A13D053181BFC6462ABBFD0E70BF16DC97BE664734C0DB5FB93F7127BBBFB467C63F93228BBFADA63A3D7309A3C1A03F8440C6838DBF141395BF658085BF639CF13B59AA40BF345F3EBD7F9472BFF1BD923C766BA63FAC91CEBF6D074C40F8DDE33F07BC21C3F89ADEC2512D71BFBDDFD83CDA591DC062607FBE1D0E85BFC055203D9904EABF22936A3DED7B4441A56FDF41B30A5ABF30F9D5BDBD302AC00C53E0BFE0494D4036D06441F7861EC0BC73713FF9F6DDBF8DAC57C1B8CE56425C876D411CEA75BFF6F7343CB3DD8ABFE19CEF3CFB24424219E3B8C1554B29BF6CDDA5BFAADCADBFC31AD93F2C5470BF176A60BE42F8544151AC12C005ED7FBFF4CBF93A7A0ED8C14086CDC1E1677BBFD236433CE13EFDBF5A0BE6BEC0C9A3C07CBA234060E1CFBF01E8913D900047BFA835CABE140CABC2004983413A6384BF7FB5F4BDDDA013419D33DA40994788BEAE7664BECDA177BFA2E0AB3C970712C29FA72AC3E9E209C004F7AB3C297580BFBC26D53C5AAD14C0D353C4BEFA2582BF88EA883C3DDA74BFCB4CBC3B23AD85BF4F8B153DC3AC68BFBC83AA3D9F12DDC0D389A2BFCAE726BFEDE0943F07B080BFEA1D553ABD1D76BFE6BA87BF9B6A75BF66ED633D6B221AC017F80AC13FFC60BD4A08E0C0E502AFC0618DDFBE999A99BF0969593EF8D870BFD20E54BD46B558BDC75A8C40BD45284176E72D42D3B511C05B71683EF1B1473FCFEC24C04E39004302552642D1EC91430B21B744494180BF6BE9FAB8A42588BFFB63323EFEB31FBF922C433D857F34BFE52649BE4C2F82BF10AF2B3D7DF27DBF8C191FBC0993163F603B26C144B9DE3F8EA0FD3E804F7FBF20277CBE431EBEBFED12DBBE4D0181BF8477353A5364B240B3D77ABF597D84BF40F8A63D72D07CBFD23288BE9B7A83C1C3489DC05F4F89C01754B1C1D6F31DC059E56EC0349D0BC07B35353FF4E5CCC1BA530541C02F3FC1E6EAA23F062F5EBFB80B56BE17AEFFC153109BC3C0EBACBFE2F78EBEDC74373F180F603E154C394430F00941050FA2BF96C791BC185B33BF8D7499C0901FB7BF4EF193BF9242F5BF95CCAF3E151386C0D3CB59C107B11542553215C1D00B07C0F93F54C19E19893E1864E6C0A482F2BF8F6767BE7BF57EBFA18C0DBC29A37EBF27F6A83C1809CCBF6D6019BF58E483BFD4091ABE601A7ABF255AD0BD201885BF3C499F3D581A8EBFBB9E7FBF0448264358D99F42F38896BF149AEA3D23BE593F411842C027292EBF144B51BE368124403D67B5409ABF7FBF6DEB033C16F699BF1F8F16BEDE3B7EBF12AC55BC55A006BFBE3F713E95A6DDBFC0A1C33F2AF885BF968FAC3B9646A13E9C660B403806A0C058395AC0BE59893FF77E6342091687C185C645C0637812C159CC76C039E18EBF9D907BBD0D8F7DBFFE2CE4BCFFD57CBF932AB63CB55F80406092D84129940840922CC6BF9999523EA27C254095CB81BFFF50D5BC8FB009404141D83F08E79645A61CC2C2CCF719427CA013C12DF0A5C067A0E240E917FEC1D180A94272EF7FBFAAFE0FB90ADA74C1CEE63AC3A06B9CC0621EB140E16681BF1FA0533C1CD66CBF8C11013E4E166FBFF8A9B1BC8FB80E42EF7286C1B61063BF715A62BD043E2841E6632C40814AD3C2CCAD0EC391F1A7C0409651409293114205A856422EBB3DC08C17B5BF354F7DBF769B663D85A431C0ECA3A0C0B8FF91BE2A5020BE53E02EC0206A4BBF2551C2C4505A34C46DBC7DBFDFA3253DFF804ABFA74876BE28E021C03624CABDA57B22C1B3D957C0AC7163BF0BBF003DE16384BFED652F3E75DF8CBF591E553EE7456A4345B70443434F35BD4823533F230E58C3BB0145C4B24F59BFB0832BBD791288BFA8C9BD3DCD9D82BFF8D6663DE34990BF9A0D863E5C687DC02A9292407D54B1BF5C605F3F4279B1BEBEE5923F8BEDBE3F35EA5B3E1CAF45BF5FABBEBE696D19BFDDE1C9BEB19741C3FEFD5DC20A01943FE3D250BF155890BFBCE30FBD737D75BF49FD2A3D59CA97BFDA86FC3D574059BF5358683D73F643BFACC636BC7D8395BF93CE683DE35EC5C1B7BBA7C017B685BF60FAC23BF26BF1BFE206D4412B6B4CC18739564125A682BF75B998BD41D609C46E6B6D43392791BFE2F9E1BDB879AEBD4F49E33E04332DBFADA2763E4335CA42F725C142BF268CBFD7CC8EBDD754EC3F5EFC953E87CC7FBF7C8C4D3CDAB2F3C02356BABF84153BBF46457E3E628115407D5D8DBFC3AD254135C1014035A452C0B62549409120F63FFB2BFBBFFD7B30BEAB1F02C021628940D9338E3C5D736B4116090B41814335BF09C13F3F7CD082BF6ED7B5BD3AF64C444B399B44AA06E7BE14D182BE71C63440F1978FBD693081BFBD3D0F3C70B7B7407DCA41410787B8BECAF8C1BD293A80BF2CFB89BC2D7A66C001F324C1BBF8FB420A6B0AC33E27B2BFF1B2223D27C657BF641125BEE7EEEE3F5E3A0740493787BF40EA52BDD23E31BF7992A0BC92794FC1A5582EC10802A4BFBDE9F1C0F8BDBEBF8B83D33CD2E077BF311582BC6F7474BF373B653DE9A250C0C7B9433F020B5A41F10BA8401CE27FBF8AFE35B9EA428941073BA6C0C269453F6211183FD30381BFFB9AC43D7A9380BF00E934BBAE28324345007BC23E9578BFFFAA973CCADE4B3EFC5D17C086A76ABF42089EBDC72F0DC0C9881242B4D281BF26FFCEBB8D433F4151978BC1E6FC7FBF1FA55B3916B682BFD74B9F3B4D5288BFBE5A4FBC111B70BFDE14DDC076924FC0520705409C5D80BF2B657FBDCDBBAABFAC5FD6BF0E244AC256080A40936C2DBF067F1AC09DF27EBF23C68FBED2FF59C0372A9E3EE00313421EFAE9C1D9E78ABF2BE19E3EEF43DBC0E01F9DC1D6F6FFBF71AC25BF2AFDDBC0C4584AC08D49803F4D247440C15134403952ED3FF53D5ABFC44B94BED2456EBFC9276C3DB83B76BF4EA22C3C8D6498C1B6CFB8422DFDB73FD2852DBFD9573443FC5A10412905CFBFE2918D40AA4E9CC03D480BBFB6BC05BFA741933E829283BF84CD8FBEE3E838BF3B0933BFBDFBA73F87973E3F30E689BF5B1C7DBE21709E40E066073F8976A9C11D9C1D4168BD7FBF07A7B2BADB65DC3E79CD26C0FE7082BF01DD773C07CCC7C0D4CAF73FEC1B97C23C7AA3421CEF01C0AA7F763F8C0555C00A306640552793C0542B323FDF5CAC4277C8E8428BEDA3C0C6DE30408EB872BF7E079BBC29385FBF1CDDB13CB0720FC091970CBF6499D1C014388FC1D53280BF50793EBCF5F39E422F6549C311C99941520AAC41DF817FBF83F6093C610FFABEA552F23FCDD60AC03ACD093FD166B13E23377AC06F85A3C265BCADC25B62B7BF687C0CC0EE4603429B913F40684E86BF1F1982BC674A80BF7258AEBC126528BF555722BE2C0582BF7C91D8BDD64C7CBF6DDF243D94B9E4BE790D08BF8810C5BECFC486BCA23FADBF991D95BD81420EC0ADAA78BD279B81C0E3559BC0976D81BFD61CC8BB448804C0A99976BE500C14C003CE00C1B435FCBF9D50A23E259E88BF0C3F8C3C8461534187B5833F5B22BDBFFEF48440F8F226C17E843C3F81A7AABF1FDE293E98272EBF2F25923D0DCE73BFECA72FBC962CC3BF801367BE15739BBF5574E53E1FF27ABF5A97B2B9BB6468BFE2C628BEAD4F99C1CADD053E55D174BF0D3FCE3DD76861429026CC42A5F7713E05FBA3BFB4AE92BF1E0EC13D962980BFA91A48BC113F62BF65624CBDA1237CBFFC99D03C298003C17FB23D3F9F5916C0C17764BF27714BBF1F4928C0C4BA1D3E3C567DBFD21A89BF01023CBD2CAD77BF4C15EA3DCAE609C04CAA8340F56FB6BE02D51ABED1D5FA41C530EEC1041FA6BFF96B26BFECFBF7408C75AAC08C5586BF0B19C03C525501406C7D23BF697ED7BFB8EC13407B739CBFAE82243ED6DAD5BF4FF90DBF9A848ABF74E4DABB2FAA58BFBE66D33DD84C0E3F438A8D3FAB68F4BE364ED43E8F15953F5C55D8BF0DC680BF5304D53A29B27FBF9C71E7BBAC23AD3FCAE2B4BFC9099BBF53B373BEBF84A6BFFB16B8BFC2DCBB40FA26B7C1F802C8C2A9CEB6C272C580BFE142E03B22BB52403A71893F9A8C6CBF9311553DD81BFF42E5D3F7C27A7D2EBFAB0876BFFF500340A2236540AF3B9CBF55469ABD9A60A9BF2CDC1C3F59724441459EDBC2CA890542D08EA8C15A8B53BF5A1C99BD6D7185BFD45CBCBE20CD5EBFE332A9BD8DEE563FB2CA3040956EF4C0C9113341635D19C1B4261FBC5BFB43439A1118C4826C7CBF67B58C3CC93F91409EACDB3FB178213F92C0A5C03BDB08C10976C8C0161DD5BF42CAD7BF13B15ABF066488BE29EC9CC147EBB041CF6A8240DC92FB3F001D80BFBF81DCBC963268C1C2E5EBC08D95D3BFF1F50C40FBE17DBFADB21DBB51CFA842255418C21F1B7BBF99B5313D49E888C2BB0F62C131A1F8BD0DF55F4084A86A40F70368C1"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
