// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.floor %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x49BFC5C0F83F88BFA6BE84C096400DC085C0D3BF933ED4BF0440D63E9D3F84401440B5BF154011C07B408840DCBE02404F40FA3E1B407CBE974041BF0440DA40503FF63F8D408AC027C0BBBFFA3D7A3DD53F853FC3C0544052C091409CC0B8BF04C19840A0C078C086C00AC0553EAC3D4BBF9FC095C033C082BD29C0A1C02CC0CCBFF9BF41C074BF194002C07A406FBF58408EC025C0A0BF71402A404BC0A8BD02C0D3BF9F40863E0AC0A8BF623F034061408AC068C03540B640F03FAA3F36BD82408ABE0A405CBD8BC09440A23D214036BE3040893FB43F3640F43D80C0943F01C0603E7C40D3BF0140F6BFFDBFD03F27BF553EB13F753FC03C613FD2BFAF40EABF0A404D3F0F41CBBE053F564077400C3EBBBF8A3D15C0873FECC0704078408F3FD1C0F9BD9CBF2A402E40EA3EEABD8BBFC0BF603F0440BC3FD83F16400E4193BF263FC4C092C07B40803E3AC05740C53E2440AEC0303E7A40CE3FD43F92C094C029C04840B93F1E408A405B3D71BE94C0B94003C0EEBC993F84BF84409ABF6B40C8BF2CBF94C036C0A23EA83E0FBF4CC04140DDBF7A3F0E3F544062BFAEBEA2BFB7BF333F963E62BE4EC0B33FD73D1140FCBE124086400AC089BF05C12CBE89C0F6BFCC404A409DBE5140A54032404BC08A3E3F40523F613FF7BF32C0184070404340413FE33EF93F19C0923FE8BA62C0DC404D3FEA3F213E744083C028C09DBF09C02DC0BDC01C4091C083C0044097402A3F4BBD213E87C0C23FF2BB04BFEF3F834066BF46C0943F784066405CC0353DCF3F453F523F9E3E12BFA9BFFD3FACBF42BF7CC0F1C089BFD93E76C0D13EB9BF92C0BF3F8FBF65C081BF653F0EC086BFCBBF7F3F484062C06EBF68C0AF4068BF27401B3F85BFB6BC27C0CBC0013E76C0543F11C06F408BBEBB3F19C0F43E8CC0C63F953FC53E6640F9BF85BD13410B3F31BE0F3F5AC01BC025C04F40A0BF80BF50C0E03E3FC068C03940F63F07BD1A4097405C4043C06D3FC9BF2640933FD53D7C4082C0E43F9DBF0BBE26C0BB402A3D8CBEE03FD23F2B409840F2BF843E72BFD2BF5F401840B4BFF9BF20C049C0CE3FFD3F723F963C40C05540A73F15C081C0FE3EECC064406440DDBFA73E67C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x80BFE0C0803F00C080BFA0C0804040C0A0C000C0000000C000400000803F8040004000C0004040C04040804080BF004040400000004080BF804080BF0040C0400000803F8040A0C040C000C000000000803F803FE0C0404080C08040A0C000C010C18040A0C080C0A0C040C00000000080BFA0C0A0C040C080BF40C0C0C040C000C000C080C080BF004040C0404080BF4040A0C040C000C04040004080C080BF40C000C08040000040C000C0000000404040A0C080C00040A040803F803F80BF804080BF004080BFA0C080400000004080BF0040803F803F0040000080C0803F40C00000404000C0004000C000C0803F80BF0000803F00000000000000C0A04000C000400000004180BF000040404040000000C0000040C0803F00C140404040803FE0C080BF00C000400040000080BF00C000C000000040803F803F0040004100C00000E0C0A0C04040000040C0404000000040C0C000004040803F803FA0C0A0C040C04040803F00408040000080BFA0C0A04040C080BF803F00C0804000C0404000C080BFA0C040C00000000080BF80C0404000C000000000404080BF80BF00C000C00000000080BF80C0803F0000004080BF0040804040C000C010C180BFA0C000C0C040404080BF4040A040004080C0000000400000000000C040C000404040404000000000803F40C0803F80BF80C0C0400000803F00004040A0C040C000C040C040C0C0C00040A0C0A0C000408040000080BF0000A0C0803F80BF80BF803F804080BF80C0803F4040404080C00000803F00000000000080BF00C0803F00C080BF80C000C100C0000080C0000000C0A0C0803F00C080C000C0000040C000C000C00000404080C080BF80C0A04080BF0040000000C080BF40C0E0C0000080C0000040C0404080BF803F40C00000A0C0803F803F0000404000C080BF1041000080BF000080C040C040C0404000C080BF80C0000040C080C00040803F80BF00408040404080C0000000C00040803F00004040A0C0803F00C080BF40C0A040000080BF803F803F0040804000C0000080BF00C04040004000C000C040C080C0803F803F0000000040C04040803F40C0A0C0000000C14040404000C0000080C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
