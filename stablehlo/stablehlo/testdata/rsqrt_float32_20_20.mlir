// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.rsqrt %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xAA4A8040A1C471405EFA7ABF72A067C0321FFFBE30926BBF15EB06C0F2F2083F7CCF31C056D97DBEA24AF0BF2939D13F0FD563C045914F40DBFDA540344427C04081614023C7A4BFF70E93BF281A7AC08BB8F4BFFC09F43FCEA3A240986C25C0D2D30B40E14639C0833544C06788BA3FD2D095BF440B7A402A2B0640E8BD61C09088074061FB254067EBDE3F047F2BC0B1461AC1DA05DBBE1BF1CD3F242E5B40FA314A4091FA2140E58659C056609CBF82DCFD3F68CBC1C05D5F2ABF09ECD8405E08A2401228B54006DE40BEB1602BBF5DC7EA3FAD1E17C010538740F82F80C03C85A13F58118C40E07592BF273030406CCACC3DD96C04BFAB2C0A403C5718403BC2BB409E8345C0390DCCBF89AA893E3A1BD3BFB17A3CC0B188CF3F264F6A4077866840A1D7BAC0027F11C0D65E03C00D5887BF2302EABF62DADFBE72CCD6BFF195143F6EAA99BF5F1CF93FCB1358C089FC9A40ED3B594002ACCC3FC7264A404B5D92C0476C0E3D020440BF68A69CBF7CC249BED8265D40E5483AC0BEB2D0C02EB9B03F6890B5C00D24B9409853ACBDE5FE67C0F6F889C03ED4073DAFF4683FEB1006C09416873F93C9613FF6694FC060C878BFDD21D43F8745A23FB09E933FC0043240C585DC3EC5CDF6BFB5A094BFFC6297408D948140A2F6CEC042CFCCBF05E21A410501A0405DA186C05D03F6BF5D3B2F40025D353F93B24440E09B62C033C32AC0BF40E0C0BEC29FBFADF296C01531B9C0A10BBE3BDF697E40CF8DDCBF4E13CF4016318DC0168001C0EB2D223F665A5340F672A1BF336B473FD97F073E1A75A540795AA53E0D2FF1BF40440DC07EB25B3F2CD2A6BFE7A6E13EA7D122BEE7B7E73F7FFEF03F44DBE03D10C6054129456A40DEFF97C04E1E00C1F52469C0068F26C0FC8E07C0FADEAE3F40DDFEBECE10904043138D3FA470BDBF8AC85A3F461715C0A76C5EBF144734C0E1FD0ABEA3580F405B04EF3E5E5D1840E82E2EBF227C48C064B519BD72CC90BF31FDE83F4B38FEBD0D3A56BF4FA7C2BE0F01BABF668380BFFAA81A40D71D26C0A98D313E92C96E3F60A5FEBF6FFB824038737740ABE61FBE7ACE534021B2C5BE482C483F189E4A40161BB7C0B7C0564029C013C08FF09AC07A58A4C0FA792840BE7D3E406B4B1DC05138C8BF7A977140EE3537C06207D6C0228B90BFDFC3653FAFF8633F0E5517C0B06EB1C07BC9673F3C50A63F400EECBF37C67CBED62E1E40449BD4BF96D7FA3EEE10BA3CD2B74E3FECDB6ABF125452C0707E853FB915F1BC6FFA0440FE23223EE9978D4059E3134092221AC0FFC2C240FE08283F2D57053EFF56E0BF56C6453FBC4E893FC772D4BF003C31C0943A19C09F9300C1304C37C0BDC5A9BF082734BF4B96AF3FCE4B45403C31F7BFF18386BFCC4A8DBFB5614EC0F29F9E3F3A33A33ED569A440BD8C96C0EE7E20400047C4BF116BB5C0CA15993E08C56ABF5844C03F76AD31C036FA52C042A0733F648FD1BF06F510C03D5D41C0D59B2FC012F8833E1D2A28C02B56AFC067DF19C0491D5E4082765640CCE34ABFE62EBBBFE7F2AFC0FED3EAC01B6734C0331B4BBF9EFB653F18294E401855C140155703C1969E643F7F22453F06A3E7BF9699D9407ADF69C02DF7D740BA68D340EA01E140F775D63F7EA26340378FA13F3DC29BC0D866673FDC7CAA3F23E466C07F77494039090240AE763FC0559F153F51D204BFC75C38400E691BC01035953EF07A72BFDB38813ECD4C67C0DE02494020682240830F223FDE2C1E40E69E56C0C91B01BD95BC9340014623BF0A7A5B40A737514012E611BF4629A93D91F676402519BEBFBA71F6BF0A11AA40CA42904019783BC0A74842C0FBF1DB3EB14F06C0EB39773F5CE8613FC57D20C0EB3AC0401701F03E2C981BC015B5C2C0808183C0A55F434082C80440E8E8BDBF43A982400CAFBD3EED853C4030C84ABF0A4C46C07A2AD8BE6CF7F83F2FCE5ABF5ED7C3BF59BB92BF7307883FF3898EC0BED00FC0D8A45640C8F853C006802F40A43B95C097AD2BBF96888740BB927E400D689E3D68FBD9C0E275B940C2905EBF246966408A9C30404603824094EB9E40B54C9F40096697C0DB2A163EA578BCBED227D6C061C41D4012D8ECBF4A3DAEBFDF3310C0256DA2BC43FD51C02C70BEBF2996C2BF40BE1E3EB40A684093E4CF4020E382404FAEB4BF49E579BF275DF4C0E79ED23E05F5BDBF46528BC079566B40ECCD83BF559CECBEEDE448BEF31768400C5A3340D85FD63F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x76B5FF3EACB6033F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF4901AF3F0000C0FF0000C0FF0000C0FF273C483F0000C0FFB0260E3F89CDE03E0000C0FF6261083F0000C0FF0000C0FF0000C0FF0000C0FF0367393F841BE33E0000C0FFC3312D3F0000C0FF0000C0FF6E10543F0000C0FFF883013F1ECF303F0000C0FFA4EA2F3FDBF61E3F79FC413F0000C0FF0000C0FF0000C0FFEED2493F88550A3FF606103FA8EA203F0000C0FF0000C0FFBDC7353F0000C0FF0000C0FF4FA6C43E5988E33E1E30D73E0000C0FF0000C0FFFD053D3F0000C0FFC2F9F83E0000C0FFA2E4633F3EB9F43E0000C0FF984A1A3FEF634A400000C0FF2B3A2E3FC9ED253FEA5ED33E0000C0FF0000C0FF58D9F63F0000C0FF0000C0FF5D0C493F28CB053F4C4E063F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF2F03A83F0000C0FF5D81373F0000C0FFB7A5E83ECFF30A3FF8724A3FF30A103F0000C0FFE59BAB400000C0FF0000C0FF0000C0FF54B7093F0000C0FF0000C0FFCADE593F0000C0FF22DCD43E0000C0FF0000C0FF0000C0FF9AB9AF40822E863F0000C0FF7731793F894B883F0000C0FF0000C0FF79DB463F745D633FA9616E3F007F193FA309C33F0000C0FF0000C0FFA965EB3E286FFE3E0000C0FF0000C0FFBF8FA43E73F8E43E0000C0FF0000C0FF37B61A3FF812983FAE06123F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF631852410266003F0000C0FF5045C93E0000C0FF0000C0FF2CD1A03F50DF0C3F0000C0FFC006913F4CF02F405D2AE13E7D3CE13F0000C0FF0000C0FFD62B8A3F0000C0FFE3CEC03F0000C0FF7E443E3FE9913A3F1E264140E211B13E03CE053F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF69055B3F0000C0FFDB4DF13E24D9733F0000C0FFA3758A3F0000C0FF0000C0FF0000C0FF0000C0FF2F0E2B3F0B57BB3F72EA253F0000C0FF0000C0FF0000C0FF0000C0FF7DBF3D3F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF14AE243F0000C0FF71B219407888843F0000C0FFA711FD3E4B31023F0000C0FFB0B80C3F0000C0FFBDC0903F84E00F3F0000C0FFB8C00B3F0000C0FF0000C0FF0000C0FF75C81D3FC862143F0000C0FF0000C0FFFAC2033F0000C0FF0000C0FF0000C0FF321C873FFFA3873F0000C0FF0000C0FF0185863FD695603F0000C0FF0000C0FFFCD5223F0000C0FFF6DEB63F7954D44060718E3F0000C0FF0000C0FF46AD7A3F0000C0FF4099313F17D62040CF66F33E8368283F0000C0FF2F89CF3E78FD9D3F735B31400000C0FFBDA0913FCE2B773F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFF7925A3FEFCD113F0000C0FF0000C0FF0000C0FF0000C0FFBAF6653FA4B7E23F16E1E13E0000C0FF88A8213F0000C0FF0000C0FF6F16EA3F0000C0FFC2E0503F0000C0FF0000C0FFDA35833F0000C0FF0000C0FF0000C0FF0000C0FFF71EFC3F0000C0FF0000C0FF0000C0FFD86A093FE4D80B3F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFD00B873FA7A20E3F374DD03E0000C0FFBF72873F34DD913F0000C0FFD357C43E0000C0FFA915C53E7832C73E8615C13E5AC6453FABBD073F98DD633F0000C0FFAAA1863F9ED15D3F0000C0FF8F49103FBB98333F0000C0FFEB6DA73F0000C0FF04D5163F0000C0FF2C1CED3F0000C0FF5FC9FE3F0000C0FF6573103F58B4203F41E0A03F00D7223F0000C0FF0000C0FF8A49EE3E0000C0FF9A3D0A3FEA960D3F0000C0FFD5AF5E402352023F0000C0FF0000C0FFE417DE3E0924F13E0000C0FF0000C0FF1F4BC33F0000C0FF6140823F3F42883F0000C0FFE1E5D03E4EF4BA3F0000C0FF0000C0FF0000C0FF2085123FA0BA313F0000C0FF2E61FD3EA24BD23F8A28153F0000C0FF0000C0FF0000C0FFFA8E373F0000C0FF0000C0FF0000C0FF7654783F0000C0FF0000C0FFCAC90B3F0000C0FFF1971A3F0000C0FF0000C0FF93C8F83EB45B003F491F66400000C0FF28ADD43E0000C0FFB4EB063F391B1A3FB902FE3EFABFE53EE579E53E0000C0FF122027400000C0FF0000C0FFE40C233F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF5E8C22401872063FE9DFC83E2729FD3E0000C0FF0000C0FF0000C0FFD391C73F0000C0FF0000C0FF3A80053F0000C0FF0000C0FF0000C0FF416E063FAEEC183F8FD0453F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
