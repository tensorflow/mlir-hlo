// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.floor %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x434292C3E1C4B5C15DC2F94285355D43FB409EBF48C00BBDAC3A513E93B53DC28E4045BF93C1CC46A63BD4454D440D414D3EF8C09A3C05BAA8C297C730407F33FD39A4C23D44373C49BC3FC3A339DDC3D53F063E61C04ABFB1BED24136B371C65C40CAB43CBB1B42DEC511C386C467B45EC173432B3BD04299B45DBCCDBAE3C51842B03511C0A13C54398ABB2B3D433AB2B25EB138399AC44DC3F339D83D4539EA45E13D4F4569BA99BF0639F43EBBC1B13E95C010BD2FB638C09A40343E73B735B9F53E65C3B1366DBC2D457EBCD8C144B45A29123E7C3F25449A3EB9BB06C07B3C89C383B97BC70A3907393BC1D440CBC56C4106B88CC021B4C23EE438473D79BEBEC0613B9CC49EBD6AC0F63ECA43843DB7BD30C47E3F2640E4BD5A42FDC3343F2EBCA4BF0D43CDBE19B89036882DD745E6400FC4D3B934BBAAB65ABD3345A7C322C5F23959C14C441841633C31BE60BC1346BEC0EF399C43AAB9CB407CBB8340C34255C2A8C5ED3FCAC05C381C3AF336FA40FFC2123EA5C5CA4109C11344A5418939B3C025BE733F3CC342B23CC02939F6BDC03ED13AA5BAD540A1356AC55FBF78BFBD2A7D4193B3F93EF544D13E84B5C51A15BE25C7E4C126BFBF2C273DECC566C5C6C47FBE1F45A2C022BC613D4A3675C4203C8E3EEAC4BCBB5E32E3C3D14484BD83C1B8C1D640AC3825AC61BD5042E8410E419B473BC062435AC3B8BCED42FD363EBE473E8ABD8CBEE233204065C4004544C62946F9C43840D9C3A1413AC0D8436945704088C126450B346B3DD63FA03ED2BAD3C1D9BB22448939FB3DF434B1C46F3EB6C483C0363F24C21B434CC602C4883F92C5EA38BFB9C7C214442A3A09B953AE5DBBE041F2BB41C23C406AB99E4159415CBF2E435BC0924164C455AC2A3EAA268B4574BBA6C33F485B44EDC03E4336C4C240A5383C409DBE693D223C0FC0CC3D0D403CBF3AC2DD3922C54833A5C31D45AB3CDEBE203D423CA0C008BCD9C079C0F442AC42DB3F9F3F7CBDBC448C3D6942D0C027B145C0B2443AC664C3ECC35ABED040EE3B5F3B92C3B1456FBC7ABEA93DA1C7A6C0D8C0C7BEE5B1E33E97BA6C4813B635C2C9387BC494BB39C21C3197C2973A7434903939C8C32F"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x004200C400C500C200C4004200000042004000C000C200C00000003C00BC00C4004000C000C200460000004500440040003C00C2003C00BC00C400C800400000000000C40044003C00C000C4000000C4003C003C00C200C000C0004000BC00C7004000BC00BC004200C600C400C500BC00C200420000004200BC00C000BC00C60042000000C2003C000000BC003C000000BC00BC000000C500C40000003C00000045003C004500BC00C00000003C00C2003C00C200C000BC00C20040003C00BC00BC003C00C4000000C0004500C000C200BC0000003C003C0044003C00BC00C2003C00C400BC00C80000000000C2004000C6004000BC00C200BC003C0000003C00C000C2000000C500C000C2003C0042003C00C000C5003C004000C0004200C4003C00C000C0004200C000BC000000000045004000C500BC00BC00BC00C0004500C400C6000000C200440040003C00C000C0004600C20000004200BC004000BC0040004200C400C6003C00C2000000000000004000C4003C00C6004000C200440040000000C200C0003C00C400BC00C2000000C0003C000000BC0040000000C600C000C00000004000BC003C0044003C00BC000000C000C800C200C00000003C00C600C600C500C0004500C200C0003C000000C5003C003C00C500BC000000C4004400C000C200C20040000000BC00C0004200400040004700C2004200C400C00042000000C0003C00C000C00000004000C5004500C7004600C5004000C4004000C200420045004000C200450000003C003C003C00BC00C200BC00440000003C000000C5003C00C500C2003C00C4004200C700C5003C00C6000000BC00C40044000000BC00BC00BC004000BC00C4004000BC0040004000C0004200C2004000C500BC003C0000004500BC00C40048004400C2004200C500400000004000C0003C003C00C2003C004000C000C4000000C6000000C40045003C00C0003C003C00C200C000C200C200420042003C003C00C00044003C004200C200BC00C2004400C700C400C400C000400000000000C4004500C000C0003C00C800C200C200C000BC003C00BC004800BC00C4000000C500BC00C4000000C400000000000080C80000"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
