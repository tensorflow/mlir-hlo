// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.lgamma %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x76BE5734A83D553F3148933CE4426444F5BB57C186C5C0447741A22CA6C6FDBEB134A9BF3BB393395DBE763FDF43B0471539FD3A4AC0DFBAABB8D3C1D9BB8CC239C2A9BEAC41C4BF7F43394034402AB8EDC118381E415C43F5C2E5BB5B441A435FC2803D493B6041B0C41EBBC93F4B44CCBC31B732C0E4410441F94075BFDA3AA5435944B8C20031B2C2264145BEF0451B48BCC4763B91340249B1C28E42A63DD9BC3531DF44C53D0FBAC5B50A3942C20A3ED4C1A94411BC3045994253C40F3F9844D5C4663D60449A3DE8400A4093BBD33B42C0E1BD6A392B3F48C65BAA1EC21B4539C0FFB896C2C4425144F73CD0271BBB03BCA03951BC8ABF5245AEBE4B3FD63C65B8FDA6E5BC8F40913A47411F40353C53B2764554BDCD2880B37CC137BB7FC081C6683DDAC6874320420541FFBE0A44BFBE2A3A22C46F3FF5BDFF3EAA462739C141334520BA1A473DC6FDC20A41974729B77F3B1846E3C43EC138BCE63934C4DAC485BD72BC40C0DDC1333E743EF044F5C487BD8141B2C3363E90434EBF94BE58444D43D1BBED43BC3C73B4D1C4DCBEABC487B90F3B76AFC0462FC3553DC34276C511B4B42F6239FE43053ED6B588C4523D5B350BC312C14B3C1E3D02AE8D41D8B6CFC26C35583C08C35ABB45C2E0B2A4B918B72BC016C1C238B5C2BEC48F3AADC16A3986392140B2AF81BD85BDAC34672B0CBE523F04BDBA4461C7E939A13C533C43C53DBCDDC2BB433144D73B28C3E8C02945424380C0F145693DEB410139333A2D40E6C6733E75C50AC2D5A83A4779BC384400C84F3DA73BFE39133613C40E444DC5223CF6BAD5B0EBBC68C482C3FA9FE64213BA9640CF44173D40B9D3432BBEBABF1EC0603B644407C0DE2E01404141A341B841083FA7459037C9C29FC2FD1ED143193CBBC010BF70348F33A641F7BE753CB63EF0B54FC0F2C2E7BD88C1A1412A41CA3C3A45083A30C2ABC000C1374132C4DBC0A842F9BC80C8FC45CCC0AB4417C56F3C65BE4BC6EDC4194256402C46CD31CEC50FBC314394BC32C000C154380A34F83EA941B8437B45B1B7A8C4AEC5D9C0B93C07408CC4CCB8BE40E2C45ABAD8390D3D87C280C104BAE542EA43432859B4FE4179C1684303C14DBE"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xBE3ACF3CB4AFD8ABA7484AAC913C9B403B454FAE8FC49E4160372D4191C60A3C7B3C723FA93E3D34AF3A85AAD83EE7478A35922D8E3C17402D3D183AF043C8B98534073B61386840F03D862AEA29113D343E66383A359E3D1CBD56448340083D9BB489AF7B2BCC36DEC1894092A55840553E1D3D3A3E2539A5346734D33D792E4B3E7D4010BC243FD9BB6935AC3AAE447A48CBC17929983C6B4ACDBBB63BB3AF183EF83EF941C3AF643E713DA935B02FB4AF403A5C411744EE42E33BBFC02AAD2C4158C15FAF9040A8AF09344A20EB41B3220B3D163BA434B2ACB6C51142D13BAD42AB3D543D63BA4C3C684029AEF2428240D5451D3406415F3E5843113B1DACA0AD193D3C43E33D8A303D303036DA2619A7163FCA43783C87428D3E3DA1C040823866C663AF49C6033E033AAA340E3C5D3F3A3BCF3154BDCFAAF23A6BADF5455735A938F7427E3EC54680C534BDC734B6471E3D1629F344CBC08EAFC641F4324EBF2FC10E3C54402D3DDF3B8AAF18AF2B4242BE0A3CA13720BC86AF183E0B3DE23A7B407B3D9243FB3E26AD0F3E74C1903BE1C1BD3D1F2D75401E4695BD3EAF4A3C71C4503E1E40B934263FB8AF6B3DB8C137AFD93B59BDB4ADDEA8AFAEDB40F0372B3D86BCBF3B9AA951BD1C41862CD13EDA3D213DDE3E11AE8136FDBBC6C145305734A4345D3450276740163C0E3C7F3CA441D23AF6AB693D8D410AC8E63299AC53A992C39A41C4BC803E134016228DBD211ED842623D7238B04465AF3F39C335AA31122904C61AAF6FC43D409942024735402540007C31AFD4268A32CE3A72B9723FE8C3AEA43D40FE3FCA3D3DC13EBDDC44953C6A3ECD30CA4199AE803DBB3EB63A1F403140712A9B402D435C40C7120C3642388A3847AD354406396ABCE5BAFC44B63EF8A2D131383CB73C643D4C38F93B23AB6BAE633D463C12BD0A3BCF283B3881356AAD0D435F3289373D3433ABCF351EBF392A113C923D007CC344C62E624109C1D5AAB23AC3C51AC0E9391C2D1545833E85C438443B3D9B3F3A3E33ABEF371C3D86AD5638793EDA43123DE2C1ADC4222B17ADFB1DC2C13B3D5832D8C0E53E333378AE76B9981C533E933CF43EC5421F3E843942A5BA3D01ACAC3A"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
