// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi1> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xi1>
    %2 = stablehlo.is_finite %0 : (tensor<20x20xf64>) -> tensor<20x20xi1>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi1>, tensor<20x20xi1>) -> ()
    return %2 : tensor<20x20xi1>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xF38E0EEDEF331140908957B5F21318406A2F0D045EEB05C0C7FFBFC94F8FFBBFDC760AEA4307054088FAE2BCC83002405455BDE42D7CE83FB26B3A1F6DD502C0F46282E0685406C094F7FD6EC4B703C0C8F8A1BC9D1308401EEC170B7E09E33FB0D0D49A27D0FEBF54D11A5D35E2F0BF251779B347670EC032BB69911A481D403E5C3B554EB10CC00E7D3F4109C5FD3F18D985462BFA14C0E2E88C35B9A71040A4C3CC7B5FBD13C0920830BE058CF83FA6DAAA8CC915F13FECAD8286D16300408A2D81DC455B1240AE104D1B286909C071B0385EF18C11C0BE1DA2C797320240227C5A087EB5EA3F302BC96E862CFCBF0E72A9228A5204C082DDD0620365F23F0AC9F6FEEF69E13F36A16EEC57B3E73F16C6F72C6ECB0540405A4049EA6B04C09535025151A5FBBF5E50A2128DC0004049F0256DA2221040C7EADCDF0566F93F5FC50E52151C0F4073F95E8F86BC00401CBA20A087F51A4025AB9FFB8AE1CBBF5389CC96E26F1040C48018A0E65BF33F88A3FAD9793E8B3FFCF80C370E88FD3F753102A6B6FA00C08A8FF1B7A5490AC08F4C1C57E5BB03C0101D491FB1B308C0D825A75508CAF6BFB0E3C8C327E1F1BFB29DEDB8CB34DCBFB0B6F5766426D53F5E7197C01BDCD5BF228F3058FAD80EC0A9922E5D4A66E23FA5BA496B70BED03FA2A993D2639203C0A28137FD375AE03FCCE6D23D87400CC091B49E6DDBC80140F9044A98886FC43F4C57EABC37751F4049CC7858137C04404AFBA0E05D1F0240DEBBF4A57907184029EA5A93F9C444BFA5F2806E2381E93F029F344FEC22EABF9876809C686A0FC0D1056E61894007C040BEFBBEF124F63FA66EC1535A74F0BFC82C08A0FE1E09403E10E2154B7CFFBF968ED614B6BAEABFAE9F0430713300408E9701A28C25F03F9E139494C0AAE8BF92CD32C0959407C01063C0BFE0C7ECBFB23B99F201A0CE3F104F38C561A108401BB0C6D88D2A0CC0F04D20780E3CE9BF4A54681B7107DCBF72E27C41DD56004076A937AB3F420140706B343CB6F10D4012B501EA80060840E29E5C61A71EC33FF99786A659BA01404C6F1604FBCAE13FC0063A1B3E74C23FF2487FF0A0E904C075409E79C16C0040F841BF94A705C7BFB8347066CE91D7BF4A8219E5A508CD3F0C435AFFF2B3F53F14C6E5B7E78804C00C608991D7921640EA3CBABE57690A408C8BCBA85C8F01C0B2BF632CFDD001C0C03873B045F1FCBF33778359B06700404EC5B17D6BCD08409AB25078A9F9AABF8C2A64287BCDF93F0DE5254D5864F3BF3E078C35C9780040C8470929F2570E405773C7F633A314C0E2F34C04CD210340A38012BB578005407BD08AEE5EBD1B404713D4BA885402C07995B4B7AE4201402199E7B46B1B0CC035335184B13FE13FD0B486C46DDEFABF7EDBCD92B8DE0A409F82ADA07C4E14403A6D9D55687504C0946B77DF4B95F9BF36F54D2BC64DDF3F68D8AD06D4CB134032C92EDEF6440AC00E1C824B970CFBBF4B97E61837B000408FEB9B785E47A63F5CD81E85D4CB1040B6A07EA39DA3E93F109CAA2E2CE0F2BF63AA90D7A277F13F8E8B4F071E68F03F559F9B1DD228EBBF40B1A2D42BA9DDBFD63A6E1290F4E23F04BF0915611C01C00CA8A7AFAA7FF5BF5873EE66DFDB0D400C93DD6772FB254041AC6B94345B03C0FB4AC9FC13CC16C098E9E55A0E8F03400A027B8559760BC0AADC38A64E3113C0E78D9BAABCAAF9BFC313849BF725CFBFB8B47196E82AF33F1B059DBB961FF2BF786D0FC7A19708405BBCF4BD927C00C020D1A6E668830BC01B44303BE49F0D40F04B271DF7F3F6BF8603B09D19CBE83FB8047D25A94F174056B89FBA6A801440505C20FDE9D1EDBFDB8DF0C7C32AF3BFEF4DBA4C2994F0BFD08158CBA8A70040A997A26BE1E30840D89465DD76400640551ADB6F58D414C0134B68198B450340185D283F6A951240DBAE8B98A15111C025DB7BB8A7920440CF4B1B31A37F13407CF9E53D6B2A08C0D9E7B4438F3409C0AA622CB2B3E40340EC46D240311511402A2A81CC90D9F9BF9801FFE5A4370CC0C8191CC65F1111C0A2D783C03E390C401ADCDD17A88910C022E8047953C5F13F3042D3AFF8B9FB3F39FD6C8BD0BD0840165BCE40D7A7E6BFAE954D88A7E0094066D53AA48C8601C03E027DDFB707CFBF04716CE03B59FDBF243F24C82C680740B677A135361504C040378F89E663EFBFA04E98CA56EB08C05A6BFD0FDAD122C0EC209B48221F0BC09EE5BB80E4F5C73F909EC7FE8D960CC0C53512F950301440C3C052457E3F11C044ED9302E570F83FA155BD434D8ED53FEAEB1653F54E0040178B57F1C5A1E43F172582F1E2ECF13F1B7A2054F39201409C0424DD230712406FEB3460C6BDE33FB29475370D5502406BCD4D3846BF13402D6FDEC0215405409E2C189F9A4EFE3FC60C0F55B18DBE3FA6DC882BE49715C0D31788B2ABDD06C0DB7B807F157613403674A845B8AFF2BF3A0798D41E76DABF6BFDADFA5B1C03C0F657E662FC5AF3BF1220F8848A1813C084594531CABB07C05696E42417E01040F3954B96F5A81340D8FB83A59D320B40057DE7CBFB59F23F911A931B41E2F33F5969ABDA1DD61AC08D923FDDBB2DF3BF015B9A4E6F1322C07157BEA64794174087329CF0154EFC3F5572DA7A3321FC3F1B224468B449EEBF2C03D8AF65C3F3BFAB7A036DD3CA94BF41DD43C320AEED3F84446E855DBB114062460FFF4B48B3BF074BEB90407AF03F60B96D148F68B9BF98ACB90A2C1502C010F3E97CA8FE18C03025D41BA3DE024092E2DEB95A7D0840FD7B62541F3C06C07753EF5BF42C0AC02C06FA2A6241FD3FD0190EAC0DC4194022CA24AD49CB0E409E753A56B17DC0BF1654B555744AF93F7FECF8E19BF5D23F5A7B975790311840597160D19B4F1840B39782108FB0C83FD34F2E4E8D62FF3FE4F769810729FDBFBE489335303503C090CBF24F3C060B407E4D47018B4BF13F75689E72C8190AC0B85E864963FC07406E24EF9CBC4EF93FF82E517B961E194005E74D20EE9106C0B6B32830A6DCF0BF3BA7587A7B31F23FF072706C368E0B4060CFC828889A0440FF6491AE9D15FBBFB7A721AC10BCC7BF0A863A789CD712C0A3517441CD060EC0BD42834EE8391040EA2C28DB474EFBBF417330EE90A7D73FD4F5458B962CC33F88CBD45B4CA8F4BF38D5F022F83911C068F48E9B589C0EC04959C447EB61FF3FFE357C52B6A9F13FA6648044629CFDBFED7A01BCC8F709C05458A966CB4B11401E10CACDAB591140D013030A4A7ECBBF1461A741657308C0E8F5F44C0637E4BF4B3AB8D7403CC1BFC84B4681D9B3E13F80A67992B510F3BF3C16ED2D96F00F4042346ADA2100EF3FEFB539A25D2F0540D87A4794170000C01C83E6616D5E13403617B3710477D33F28B818B09B9819C0909B0575A69F074020729A743E99D53FACD889DD82BA0DC0CA7F6729724AC5BF60B116064221DEBF6DFBA880C705E03FC3FE48535062F4BF56A67D41E5F711403D17905F07711440C79D04204BC4F6BF46BCC1ED13E8D13F0AA3886C2E1F22C06BCFE3B4F16802403616260C1498EBBFAF64EDC99A4706405C028D722C99E33F2395A2328E2DE53FE6EE431F9691FA3FC2E571E9802F06C08D3FE80244A404C0944ED9D34F5C13C0FC858E7195C501C0E0863FE8BBDC09C006B7180CC9A4FC3F16B33FEF7B9FD13F3EFAB6F19F35E9BF2C1F49D72E2B0CC01D998423E272F9BFCB06A4AF16ABF0BFB8A298C775FB11407EDAFF0D8FD7FEBF411A235EE87F04407A545C040A26DDBFDC79A6A52F830D40C62F0E72C170FBBF5C5D42B154E3F43F66FB8477C14AFE3F8F4CD0165AB7E5BF85DD254ECD5D0CC0926244A8E441024058258BFAF0E30F40F3145CEC2A67214067EF4E3B722D04C0E980F814B3A10840DA3FECBBF15A0B4015A5EEAECCB4E0BFAA8945A766D0E23FB962977BF21EF13F167FEDB140BD1540FAE74A7A469614408826C9B40BC6F53FA756870A1E67F33F3AFE55DB1591F9BF82BFD5B1872603C09BDB6D008DB2F23F4ABB2E2A192AFCBF7F548BCAA2C2F33F6320B0765C29F7BFEADB928C1EBA1D40F69E14249C69EBBF6EBFEF7E86B804C013F51974C9D3F2BF7D2A56ABBE88D83F2891149E5FEFE3BF3C977E075AD9FC3FDD46F2814205DABFACA7DF8083B21440AABD8DFD52130840F262F99D773FF23F8C4E3966530109C03EB215F8B64FE6BF13084003947BF53FD3DD23C21C7EF4BFF821D4A8D80F1040A32D6F77AF67FC3F0BF5D7B18E8012C05B2AAFE4243607C0D56F07D64690E43F9BB8DBE07BE9E43F3EF39F3EB00FEEBF9C33E8DBB32C1040B93773D62AA4F63FCD4DD60193200140D41B63C0E0F41240BC1612AE0841FE3F61309D0E581FE2BFA2D85B7F4A94EE3F93A8FADAD094F6BF3C69943310F2034030493AE93B6C08C04840DE844AF010C091E82AD6C8470A40C86253A06176F7BFBB51913139A4E73FE4DFCE4A2050D7BF12F6064D1D6CDF3FD67201B589340B40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xi1> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<true> : tensor<20x20xi1>
    return %c : tensor<20x20xi1>
  }
}
