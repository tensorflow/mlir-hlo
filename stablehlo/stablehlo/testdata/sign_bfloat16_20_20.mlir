// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.sign %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2240BEC04FBF4D401F3F02BFC7BFE43FB03FACC024C097BE76C06AC0A83E5F3F81C08F3F7ABF64C0E2BEE03E544085BEA4C08E4049BF044004400840933F6BBF1040BB3FFE4044C07AC0C73E963D8FBEE23EB7BEAA3F76C0D23F8A40E3BFAD400B40ABC0353F29C036C0244050C0C1BF20BF674030C0B7C001408F4059C0D63F5E3FCBBE333FE9BF81C0C23F233F3FBF5140B8403540E23D833F18C11140D23EB2C0D63FAD4097BF35BEB4BEC23FDE3DA6C076BFDB40E8C0B03F3FC0933F55C094C094C0D9BE2A4046C02140D5BF9D3F1AC0043F0A406840A7C0D040373DD33FD3BFA23EEF3F1EBF7B4012C08B3F3B3F823FAC3DA5BF88BF14406FC0DBBDFFBE8140443FD53FAD3E3540A1C0F6C0E640EEC08ABFFBBF88BEEB3E0BBF84BF203F30BF3A405B406A3F8540513F553FA8C09DC0DFBFF43F0E3F4C402DC0773F83C00ABE13C0AE3FD6C046C0054061408D3ED1BF81BF9840074087404AC03D3F1E409E4024BFC43FB33FD53FB33F723F79BF6BBDBFBF503F4040D63F2CC0654092BF7C3E17C0963FEE3F1CC00D40BFBFF03F7A3F9940DD402BC0A23E77C08CC06AC00441A5C0EABECB3F293FCEBF0340A04011C19DBE86409EBF094062C01DC01F40FFC0BC3F32C0B13FBC402F40623F09401F40C2BF0240D1BD4EBD71403ABF0840AD40E7BEC33F6FBF6AC0B53E9DC0F0402D4082BF78C02140F03F5DBDEFBF363F28C019C070BF9EC0254047BF24C09CBD74C0D4BE89BC9FC05140D1C0264091BB6B3E67C0B4BF27BF50C08D40B440FE3F6040D0C088C099BD7640B74001C055BF48C0F23F763F04400E3E84C05B4094BF7E400140A0BFF9BE0F4051C0A0C09F4087BEBAC0B53F223EA8BE1A409B3F173F8140674027C0A23F0A40D4C059BE3CC0D040D8BF67C0B840CC4085404040CFBF823B2740F83FB3C0FDBED53FB1403BC069C07C3FA0C0A6BF36BFD6BF873F1141A0C048C0C1407940294056404CC07AC0EC3F814089C052BF1D3F0FC043408FC0DDBF703F67C0C73F834088402C403240E13EAD3F6E40173E82C00B40533F47BE68BFC8BF04C054400D4063C013C023C043C006C080BF203EA0BF3F402040BE4064BEDBC023C05BC000C0F4BF2040AABF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x803F80BF80BF803F803F80BF80BF803F803F80BF80BF80BF80BF80BF803F803F80BF803F80BF80BF80BF803F803F80BF80BF803F80BF803F803F803F803F80BF803F803F803F80BF80BF803F803F80BF803F80BF803F80BF803F803F80BF803F803F80BF803F80BF80BF803F80BF80BF80BF803F80BF80BF803F803F80BF803F803F80BF803F80BF80BF803F803F80BF803F803F803F803F803F80BF803F803F80BF803F803F80BF80BF80BF803F803F80BF80BF803F80BF803F80BF803F80BF80BF80BF80BF803F80BF803F80BF803F80BF803F803F803F80BF803F803F803F80BF803F803F80BF803F80BF803F803F803F803F80BF80BF803F80BF80BF80BF803F803F803F803F803F80BF80BF803F80BF80BF80BF80BF803F80BF80BF803F80BF803F803F803F803F803F803F80BF80BF80BF803F803F803F80BF803F80BF80BF80BF803F80BF80BF803F803F803F80BF80BF803F803F803F80BF803F803F803F80BF803F803F803F803F803F80BF80BF80BF803F803F803F80BF803F80BF803F80BF803F803F80BF803F80BF803F803F803F803F80BF803F80BF80BF80BF803F80BF80BF803F803F80BF803F803F80BF80BF803F80BF803F80BF80BF803F80BF803F80BF803F803F803F803F803F803F80BF803F80BF80BF803F80BF803F803F80BF803F80BF80BF803F80BF803F803F80BF80BF803F803F80BF80BF803F80BF80BF80BF80BF803F80BF80BF80BF80BF80BF80BF80BF803F80BF803F80BF803F80BF80BF80BF80BF803F803F803F803F80BF80BF80BF803F803F80BF80BF80BF803F803F803F803F80BF803F80BF803F803F80BF80BF803F80BF80BF803F80BF80BF803F803F80BF803F803F803F803F803F80BF803F803F80BF80BF80BF803F80BF80BF803F803F803F803F80BF803F803F803F80BF80BF803F803F80BF80BF803F80BF80BF80BF80BF803F803F80BF80BF803F803F803F803F80BF80BF803F803F80BF80BF803F80BF803F80BF80BF803F80BF803F803F803F803F803F803F803F803F803F80BF803F803F80BF80BF80BF80BF803F803F80BF80BF80BF80BF80BF80BF803F80BF803F803F803F80BF80BF80BF80BF80BF80BF803F80BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
