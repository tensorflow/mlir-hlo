// RUN: stablehlo-translate --interpret -split-input-file %s

module attributes {jax.uses_shape_polymorphism = true} {
  func.func @main() -> tensor<i1> {
    %cst = stablehlo.constant dense<[[[-0.467909843], [3.0104866], [1.79241717], [-2.66431046], [0.943148195], [0.417969763], [-3.74905968], [3.16968536], [-5.34840393], [0.546826541], [-2.03253365], [0.221049443], [-1.28537452], [-3.92773461], [-3.46224833], [-6.31273508], [-1.36294055], [-0.348805457], [-1.48003304], [-2.109411], [2.18338346], [2.66028404], [-2.67348027], [-4.70081472], [2.17808843], [-4.80057335], [-0.520323932], [-3.46543169]]]> : tensor<1x28x1xf32>
    %cst_0 = stablehlo.constant dense<[[[1.86612034, -2.69200087, 3.64211726, -0.905698835, -0.781734287, 3.59102416, 1.76857328, -0.165421158, 3.81084895, 2.13960075, 1.54851282, 1.18953419, 2.73690462, 1.39771187, 0.182823494, -2.9513216]], [[4.55942965, -3.55209756, 1.15906274, 1.3861196, -2.87826657, -5.87348413, 2.54662919, 4.35670042, 6.92599821, -3.36722088, 0.160179541, 2.87391615, 0.706002235, 0.168740258, -0.562571108, 0.90919727]], [[1.72864258, 0.410824031, 1.69746757, 3.05829334, -1.61078143, -3.05013394, -1.17601025, -0.797711431, -5.79306793, -4.6189518, -1.4868108, 1.63480639, 2.47044754, 0.880895197, -0.240365773, 1.13968313]]]> : tensor<3x1x16xf32>
    %cst_1 = stablehlo.constant dense<"0x5AC67E3F54EAD03E5AC67E3F5AC67E3F000000000000000000000000000000000000000000000000000000005AC67E3F5AC67E3FE4BF623F000000005AC67E3F3B06004054EAD03E3B0600403B06004000000000000000005AC67E3F5AC67E3F5AC67E3F000000004E0E233E3B0600401CD5D93FD907873F000000007595F43F3B060040000000003B0600405AC67E3F000000005AC67E3F3B0600405AC67E3F3B0600405AC67E3F130B953F3B0600401CD5D93F130B953FFDA0413E57D8673FCB67F83F6FB9C63ECB67F83F3C09723F000000005AC67E3F5AC67E3F000000005AC67E3F5AC67E3F5AC67E3FCB67F83FCB67F83F9064EA3FFDA0413E3C09723F4F85AE3F333F2D3E4F85AE3F4F85AE3F00000000000000003C09723F3C09723F3C09723F0000000069DD183E4F85AE3F2EDA8A3FD907073F000000004E0EA33F4F85AE3F000000004F85AE3FC602D63E000000003C09723F4F85AE3FC602D63E4F85AE3F3C09723F66EF813F4F85AE3FF83B9F3F66EF813F333F2D3EFDA0C13EFB29B63F54EAD03EFB29B63F5AC67E3F00000000C602D63EC602D63E00000000C602D63EC602D63EC602D63EFB29B63FFB29B63FA4E0A63F4E0EA33D5AC67E3F5AC67E3F000000005AC67E3F5AC67E3F00000000000000005AC67E3F5AC67E3F5AC67E3F000000004E0E233E5AC67E3FDFE3343F333F2D3E0000000057D8673F6FB9C63F90646A3E6FB9C63F4B200C3F000000005AC67E3F5AC67E3F000000005AC67E3F5AC67E3F5AC67E3F6FB9C63F6FB9C63FA7CEBD3FFDA0413E4B200C3F4B200C3F000000004B200C3F4B200C3F00000000000000004B200C3F4B200C3F4B200C3F000000001870B73D4B200C3F6FB9C63E1870B73D000000005AC6FE3E362D443F1870B73D362D443FAB33603E000000004B200C3F4B200C3F000000004B200C3F4B200C3F4B200C3F362D443F362D443FC3143F3FE2D1CB3DAB33603EAB33603E00000000AB33603EAB33603E0000000000000000AB33603EAB33603EAB33603E000000004E0E233DAB33603E4E0E233E4E0E233D00000000E2D14B3EAB33603E00000000AB33603E0000000000000000AB33603EAB33603E00000000AB33603EAB33603EAB33603EAB33603EAB33603EAB33603E4E0E233D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005AC67E3F54EAD03E5AC67E3F5AC67E3F000000000000000000000000000000000000000000000000000000005AC67E3F5AC67E3FE4BF623F000000005AC67E3F3B06004054EAD03E3B0600403B06004000000000000000005AC67E3F5AC67E3F5AC67E3F000000004E0E233E3B0600401CD5D93FD907873F000000007595F43F3B060040000000003B0600405AC67E3F000000005AC67E3F3B0600405AC67E3F3B0600405AC67E3F130B953F3B0600401CD5D93F130B953FFDA0413E57D8673F5AC67E3F000000005AC67E3F00000000000000005AC67E3F5AC67E3F000000005AC67E3F5AC67E3F5AC67E3F5AC67E3F5AC67E3F5AC67E3FFDA0413E000000005AC67E3F54EAD03E5AC67E3F5AC67E3F000000000000000000000000000000000000000000000000000000005AC67E3F5AC67E3FE4BF623F000000005AC67E3F5AC67E3F000000005AC67E3F5AC67E3F00000000000000005AC67E3F5AC67E3F5AC67E3F000000004E0E233E5AC67E3FDFE3343F333F2D3E0000000057D8673F5AC67E3F000000005AC67E3F00000000000000005AC67E3F5AC67E3F000000005AC67E3F5AC67E3F5AC67E3F5AC67E3F5AC67E3F5AC67E3FFDA0413E000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"> : tensor<1x28x16xf32>
    %0 = stablehlo.uniform_quantize %cst_0 : (tensor<3x1x16xf32>) -> tensor<3x1x16x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %1 = stablehlo.uniform_quantize %cst : (tensor<1x28x1xf32>) -> tensor<1x28x1x!quant.uniform<i8:f32, 0.0039188104517319626:-128>>
    %2 = stablehlo.convolution(%1, %0) dim_numbers = [b, 0, f]x[0, i, o]->[b, 0, f], window = {pad = [[1, 1]]} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<1x28x1x!quant.uniform<i8:f32, 0.0039188104517319626:-128>>, tensor<3x1x16x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>) -> tensor<1x28x16x!quant.uniform<i32:f32, 1.5367804432676217E-5>>
    %3 = stablehlo.uniform_quantize %2 : (tensor<1x28x16x!quant.uniform<i32:f32, 1.5367804432676217E-5>>) -> tensor<1x28x16x!quant.uniform<i8:f32, 0.0099521412568933827:-128>>
    %4 = stablehlo.uniform_dequantize %3 : (tensor<1x28x16x!quant.uniform<i8:f32, 0.0099521412568933827:-128>>) -> tensor<1x28x16xf32>
    %5 = stablehlo.custom_call @check.eq(%cst_1, %4) : (tensor<1x28x16xf32>, tensor<1x28x16xf32>) -> tensor<i1>
    return %5 : tensor<i1>
  }
}
