// RUN: stablehlo-translate --interpret -split-input-file %s

module attributes {jax.uses_shape_polymorphism = true} {
  func.func @main() -> tensor<i1> {
    %cst = stablehlo.constant dense<"0xA8A14B3FF894CF3EEA9CE2BF9A0A5FC0703EE7BF06916C3E3818E8BF29EF78C0475C5C3EC9346C3F887852BFBF9F68C0CB2A43BF590BF8BF6B5AA7BE66BD95C0BA28E540EB2E03BEC0DF253FE50563C09543783FCCCF82400507D5BFDE728D4013D0BDBF62B1ED3FB2129F4014D732402C4C764073B2B8BFD6FAF03F5D6E6D3FD62EAB3EE451D33FD543663D9F5AD0BFDB9D48C0A8101140657EB9BF83BA6B40C8B8FDBFC8867DBFD43A253F44DA09C058880440ECFEF7C099400A3F381D9DBF34D0C33D3004834095EC494039F646C03524FC3FCEF361C0B6B9674067D292C07EC25D4022430D405C6C4F408FD7ADBD9FC467BE307DD3BFE91D084063DA3BBF2D7A94C037174FBFECD991BFAF39504017D73C40477B69BCAF0447405EA574C0F2C70AC040CBB53F0FE383C0DD2543BF440576C040024B3FB915A0BDF0227B3FE6ABFE3EA9725E40ECC48D40C9395A3FBEFACCBF8B42184061AA02C05A43B3BFB6A6A53F96CC424055D2D9BFE0B49F3FB67EF3BFDEEB06C0165BC8BF3601A54068F793408B1DE4BF04D89D40094D74C0F98AD5BF8A060ABF686737C065E8B8BDB6F52040D1A650409AAF1D4021DB00BE66094B405FEF4140C9761D403A840640E78556C07DA70940F620843F1F29A9407D679DBF27CB38C00B9F5640EA06B7BE0ED86F3F85DAFB3F1D3996C0FA830C3FC0E638C0F6645AC048451F3F3515BFC0991D0840D132BA3F048DD03FB6B351BE5EAE253E313811C08FABF540232376C0987F773F39E11B4174A343C016CCF5C095CD36BEF457A63EA544EA3F946D0BBFC11188BEEB966240694FD8BF5EEA8FBF27F4FF3FEC9A04BF7DF3AD4040085E3F10ECFC3EAF531BC0DB6BF53F38D97A40F7B2E6BFAE7DA53F66D27C4020074040AA7A18BF097F16C0075A8EBEC87362BFE656943FC17B9DC094819BC0368F0140E29CB740E0AED53E0E7336C02BF8473F8A6FFEBEC380F53F942B1CBF8D094E3F29DF5DC08C676EBF149B64BF3D3A0E401FA6B43FC5B213C058549DBEACC0553E93BA35C0C016D33FB5962640472753C0C122ADBEEED94940A2E886C006DB6D40BD3A9C3FBBA0FC3FADEB924047742E3FB732323D4ED2B0C0C6FAEFBF129C3440F0EB9EBFD2FFF5BE900F2CC0BD9605C0EB5482C057EA1340266F87C07A797140B5CDBEC0EF00F63E23618440F3A9B73F07F21CBF2FF887BEBE608840EA314C40182781BE3D1442BF02EF0C4056CEE7C0AA4A69BEBD46934029C81DC0BF6316C00BEE51C0C941A3BF67457CC0FC651CC0E60E0BC00F7681BF6B0144C01DE870C0DFD4CB3FA464C53E2C43673FC4D441401C8090409DF092BE1D05683F727945BE39EAC1C0875A863F88D0A03F109A7FBF59A7DB3F3C993240533108C0118C6140CD81983F9E6A6BC0CA9FE2BFDCEE55C02E3C0EC079F656409C74EAC0A0D8E5BF712B88C0CF334640F8A455C015485D3F2C9A5B40B7760540C8AE27BCA2D1BFBF8E24C63FDC13EABF45DB783FD3277C3ED65CE1BF8500DF3F1F496AC0F88A26BF5005CF3E27918F4043390DC0DC35744062E7BFC0CCFA373F8C0ABC3FDAED2DC03B425C3F0025A1C0B0A72EC05EA642BDEAA369BF2830A53FA8EBA440B6F2E6BFD4FA23C0C8808340EF849AC063310B407DE5C4BFD2C01B40BEDC0440A8AAC63F3B7F93C0B145F3401FCB593F53064B3FB8F0C3BF6B22BCBF064400400C5438BFBE636740D03AC4BF8C7701BF57C77140A9BF30C09B5088C070F63F3E4269B240C7985D3F51A734BE71442740306C17C097723FBF9D6E25C044F61ABEA8D0AABEA7F4B8BE6ABEA640254C16C05AD30CC095E5EB40E5B0BD3FADAAD13F7EB1DC3ED7A04440F8385E40FC8003401757D3400D388C3E0122FE3E075EF43FED8FB2C0658BEC3FEED20640C4CD5040EBFB1140032B5FBF93204B40744B3BBE8EED65C0A8C09E3F2F904840A90B0F4055F91CBFFDB882C031A376C019392B404A69903F6FB4BA3F303899BF2F86D5402740704025D5BD40F3B930BD703C4740CD20CC3FA7949BC0505937409CF4794021FB66C0EDB6BDBFA8CA11C0FB25E5BEA45050C0365E393FC9EE86C01C40B8C032C622400DBB913FF97B1EC021F42940898A45C0EBFE2C3C8AD204406A6F38407562CC3F7EFA49BF1E6937C0A8866A409C95B9C06F898AC0950F4FC04403AFBF2E788DBFD8AC74407210ADBF4D5E81C03225393E6ACB12C0E5152B4055AC553E036A0F3FFC60AABF633E24BE1707253FDB8AC5BFF0753B3F165C90C01AC8C0BF08655B4095740CC09F0006C044A96DC02A796ABF17E0B73F9654E63F5CD23340C8E33BC05309A0C05E89A4406A2017411D2D8DBD6CDD90BF52EE07BF9BE6C140CAE166401F661EC0CADB4640AE2F1EBCBC18FEBF754552409511F6BF661B8DC04C172E40D20CAE3E893F874039009E409EA7A8C0FDF93340281CD340D6AD1840E891E03F5C7A10BEE3FD33C0FB194740422742C020750AC03127A1BF95EBFEBF93DC83C018A8ECBFC094ADBF727E81BEA8EA41BE55F82EC0DD41C13FBBEFA43F4FD1E63F4C7E64BF578E95407033E23FE51BC240EBE0C6BE639B64C045CB7240F783233ED6F1F23F25CB9D4045623E400E0764BF04A9763FFA00A0BF2DF09F40D849BEC06CBCC33F15C27040A98ADFC0BA0DE5BEF21F8E40855F3DBD04885CBF2E349940ABB0E5BFF385063E44153AC04581163D1F13AB40309BDDBFBF5B5F3F3F40A73F227EF13F7CE40D4015A399BE6C0F753FC1781B3F4B91434083D1C740F01550BE3FB45EBFC095DE3F8409D9C0F94883BF96CC77BF4C3448C06FE141BED2503D40E6B3963F55DA2F40F979EC3FC8F136C030F42BC0629C863CF6F514400E9D16C0B6E9E7BF3E1E1D4002818EC0BA7233C0DFF43EC0675461401D4D92BFEED8B03FA33C873F07DEB93FEA6CC4BFA2C819C08C760340E8FB373F6CCD8D406E90443D365B2B3F5390994020C0344021B5CCBFB6554EC0833C7F401A2B1C3FD4953D3E93832C40392E4E3FD10A4DBF4D70733F570F1740D818ABBF4BBD14C03634D240"> : tensor<2x3x9x10xf32>
    %cst_0 = stablehlo.constant dense<"0x20C22DBF44AF31405C87823F1050C640E6B086406B6F46C0EFDDD5405B9BA33FF9BD04C04A67ADBFC4ACC4BF65E816C058F44B3E071A0A3F0DDF0DC013BB13C024BB9EC0DF004E3EB6260541BF6D12BF5914E93ED3A86C40B40FEEBF74FD4EC004505F402F09A34077CC634067E82AC0F40F163FD1978B40001691BF3A93B03E4A618E406BB54640429AE640EF9629403C9D284085D4D63E38CE0C402A30D0BE5F73853E1BDB9F3FD1FFA7C0088BF6BF267105C0656007409D40DBBF721F3C405D81DE40AEF7C8BF92944540020DA1BFED3C8CC05F280AC0ED8512C0072F233FDB890AC03ED888407D53AEBFDA3C393F54B8BBBF085844BF4412BE40610C93BFEB2696BF0154E1BF2881F63F9B38603FA24813400CA61F40DBA46D3F3857AB4023A451401827ABBE8FB419C02053A7BF7BE3FBBF5C82D4BFA4A52DC01BA6B63F1CF90CBF609F2E3FCC1A05C0C41301C066ED943F49ED73BF67E921C0C6BB71C0D865B0BFE335BB404D2F55BF80D894BF8BFE513FFF92CBC0041724C0E0D79BBFF68D4340A565604030123140BB2489BFB344233FCFC6E6C01D94603E4B180C3F0BE48EBFA0E01BBF996AA1BF7CC0EEC06F7E123F81F28DC041F2DAC077F5D03F42802DBFBC8307C199D0A13F06F78EC0FF07F83F568572C0378DE6BF2AFF5B3E389538404F7641BFCB1E893E484C7840C8A8863E4EB06BBF806AE34043D71F401CAD06C1A6C850401DEFE73F1F64B43E59A42EBFAC4B383F6B440D40358C6C4032EC9340D55AB5BFAB8A7FBF2D5359BF1CEC93BEFF3D45408D4006BE254EAAC06AD37F3F43DA36C02BEE914097A75BC00C24DA3E5DBF2840DFB18C3EB83D74BF3940C53F62F98BBF8A19CC3E7CB424406A0FC640CF8922404AEC76BE78DF7A3FC5B451C0C0E107BE661A0B404D1F7240D959413F4489B03E7BAFC3BF2E9CA340AF6FB4C0A0EE0BC0200CBD3FC3FAFE3FD3D51240C7CEC4BF617B1D40927B73BE6A54154010BBF93EE92A14404B0EEF3F"> : tensor<3x3x4x5xf32>
    %cst_1 = stablehlo.constant dense<"0x8B6547410CAF4441D5C522413D4CFC40C89A5341033D65411521244194D72641DCA4074194D72641FD9B854181606D41C92D4E4185195D4181606D414E303B41BC027F418486624109894F41956A2141956A214112FB2E4146BE5B4147515641D6581D414D9D4041CF7938410FD539410A1C4A41FE2E8041C92D4E41033D65414A774B4151563041FD9B85415DEE84413FDFF640C4E1E340CBC0C8401C00094119DA1341560F204191B13141956A21419BB60B415DEE0441475156415AC80F411D9303414751D640DCA4074146BEDB4053E92A415B5B0A4194D7264117471941D8EB174157A21A411521244115212441C4E1E3401D930341DE370241956A21414105EC409A231141C1BBEE40BE95F940BE95F940C607D940DB110D4115212441CBC0484102AA6A4185195D41C607594183F36741C6075941FEF07A414E303B4191B13141C5745E41BF2874418DF8414185195D4108F65441C5745E41883F5241C607594184866241BCAD894181606D41BE957941BD4084419C49864187AC5741CEE63D415AC80F418AD24C414072714181606D41106834418486624181606D410A1C4A417DE5824146BE5B4181606D418AD24C4108F654410FD5394112FB2E41BE9579410D423F411521244194D7264191B13141106834411D9303411521244106635A4187AC574187AC57418F1E3741CEE63D41CC5343414C0A464146BE5B4157A21A414C0A4641D5C5224158351541BF28744197FD1B41C5745E41C4E163414E303B418F1E3741C24E694185195D4147515641FEF07A41C89A534100177041C1BBEE40D29F2D414072F14050C335411A6D0E415DEE0441174719419890164198901641D8EB174158351541C24EE9403D4CFC408F1E374157A21A4150C3B540547CA540C4E1E340560F20414398E64016B41E414C0AC640D97E1241D29F2D4191B13141D5C522414751564157A21A41152124418F1E3741138E29415DEE0441D5C5224115212441CEE63D418B654741442B6141BA1A8F418AD24C4184866241BD40844109894F4183F3674185195D410CAF44411D9383418B6547418E8B3C4187AC574105D05F4153E92A418E8B3C4192442C418F1E3741BCAD8941FEF07A413D4C7C411068344181606D4105D05F413FDF76417E3A7841BF287441BE957941B98794411C0089411D938341FEF07A41BF287441BF2874417DA77D41B7F49941"> : tensor<2x3x6x6xf32>
    %0 = stablehlo.uniform_quantize %cst_0 : (tensor<3x3x4x5xf32>) -> tensor<3x3x4x5x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>
    %1 = stablehlo.uniform_quantize %cst : (tensor<2x3x9x10xf32>) -> tensor<2x3x9x10x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %2 = stablehlo.transpose %1, dims = [0, 2, 3, 1] : (tensor<2x3x9x10x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>) -> tensor<2x9x10x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %3 = stablehlo.transpose %0, dims = [2, 3, 1, 0] : (tensor<3x3x4x5x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>) -> tensor<4x5x3x3x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>
    %4 = stablehlo.convolution(%2, %3) dim_numbers = [b, 0, 1, f]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x9x10x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>, tensor<4x5x3x3x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>) -> tensor<2x6x6x3x!quant.uniform<i32:f32, 1.537725862903607E-5>>
    %5 = stablehlo.uniform_quantize %4 : (tensor<2x6x6x3x!quant.uniform<i32:f32, 1.537725862903607E-5>>) -> tensor<2x6x6x3x!quant.uniform<i8:f32, 0.084777487960516234:-128>>
    %6 = stablehlo.transpose %5, dims = [0, 3, 1, 2] : (tensor<2x6x6x3x!quant.uniform<i8:f32, 0.084777487960516234:-128>>) -> tensor<2x3x6x6x!quant.uniform<i8:f32, 0.084777487960516234:-128>>
    %7 = stablehlo.uniform_dequantize %6 : (tensor<2x3x6x6x!quant.uniform<i8:f32, 0.084777487960516234:-128>>) -> tensor<2x3x6x6xf32>
    %8 = stablehlo.custom_call @check.eq(%cst_1, %7) : (tensor<2x3x6x6xf32>, tensor<2x3x6x6xf32>) -> tensor<i1>
    return %8 : tensor<i1>
  }
}
