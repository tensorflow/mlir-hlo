// RUN: stablehlo-translate --interpret -split-input-file %s

module attributes {jax.uses_shape_polymorphism = true} {
  func.func @main() -> tensor<i1> {
    %cst = stablehlo.constant dense<"0x34EE53401057D0BF6DB1A7BFD00AF73FBE67B9C07BD7E83F9F70AC40963EA3BFC00EB83F276D63401F088740A77D9E40CA547C3ED2D321BF2CD2323FB2BE024109FF10BF42F9D63FEDE133BF5C242F401D51B3BEAAE29FBF15398940FEA1E0BE0D299BC07B0A4BC0324ABD3F829D9DC04B2E9140DBB0C33F94C97A3D1C66C3C032A5B3C01CA861404B915EBFAD01C13F1B5A56BF21DF4140168E9FBFF8A6C83F3BD06EC070F94740E6A0E33F30BEFD3F4F1DDCBF99D423C0116FC0BFEFB077BD67DECB40D567FD3FCF6D9440F9BF603F8E4804C01F03EA3FCBDA1A3FF326003FFE5810C0612A8740D45C25403AA07040FDA0733FB9C4F0BD26211FC091EBB8C0BF5429C0D7A30C40F018B3C02C461640B287CDC0110B8640A5AB88C0E7F7F6BD916A0740E976AA3FF15E3A40ABF269C067398C4016455BC0ABFA2DC01D6A304078261A40AA1001C1069AE6BFE26D36404116A5C025696A40F6A297C042240BC057054340ED05BBBF7E298BC0DA2B034017F1E1BF846AA13F4FC60E40A9FCF0BF257DE7BFE1FB7C40675453BF94C3BD3E9625C040B1159E3E1495FAC042B13DBF591FF3C07284393FFC6784C0E0FAAFC0F525913F8EFF30405495A7C01692B440D59918C1ADD2BABF341A23BFD2348B40187890C07E1E0D40EE951F4006E74D40CBCF78C08291EBBF094F62C0245FEF3F748119C06751E4BF4E052B40B1076240871B13BF776A8C40385A1EC0582B81C068D893C04C16B93F4808C5C088ED6B406F161CBF7736D240F3182B4065B45E40BCCEECBEF9B88F3D0DBF05C0AAEBF83F881F72C0DD53B2400B2EB63FFAC3DB3E3FD446C0B1FE4B3FDC3954C06100813F978454C0D00DA640CA88B7BF10ED934061D0C0BF0E27AABFB4AE0EC028A4AFC0B12F45402F08854045E53FBF35A3C03FB7B7D73F74B359C0270A9740012C26C0B1B58A4074C18540EDF61DBF24FDF0BF95C9C8BEBAFFB4BFBDA82FC0ABF1D53F212179400F030440674EA83F048A63C08E42223F75F34D40FE39153F53418FC0D4536840E12EBE3E76E1EF3E7A7204C1A82211C06D1C903E86A984409ACA6DC0D5F3873F803B71404FABAE3EE33E5BBFB3B6A43F8A58E8C0E4AA48C0B29936C005554D40DAD8924045A549C032B84C3BD1C364BF8585D240BEF28A3F0A5B81C008D4E73F98AC8C404982C33EAE271D40BE002740FE747B40E43D79C07BCBBFBFC8908A40B279023F575002BFD5CFB7C064607FBF70ECA1C0E57062C003BDB2BED8787540D287D3BE3F1222C08AF72440AEDC2F408260F63F8D9807C0A82804BFF1D47540967EEF3E68E0C0BF087CA43D0DA43BC00BCD32400A67DABE4FF7D3C046C182BF73EFB93EB25DB6BF902EBC3E1CA73C40499C313FEE9838C0FFA1F73FE3CF03C02B3124BD6C1BADC0EA059FC0919C063F909CE43F5FCB044054E0303F0038BFBFF9EBC63F31095E40591FC93C28AEAEBDCF4CA43FD4124AC020B35EC08DDF7EC0F92C74BF496484405D84483F7436A73FCEE69440C3922040A86D843FD491F93F7ED15EC0849F16C0ABAAF33F6C49C33D6F4011C0E2A4ADC002D65040E63CBDBDCC36C53E774C86C002C23140D3EBEBC0F5140F3FD375FD40943D9D3FA2026DC082CD02C0A588813FB9088BC0DCB99FC0F14E98BF34EB3DBF25C782BFA40CB0404F99F23FF5CDD5BD43902C40F26EA43FD96ACA3F7BE24F4091751EC0A1DB81403EDA05C0A4E9E2BF104B9A405DFA55C07F04D9BF983F3340B9FD9AC05E406940B9869740C7021DBFE927BE3F65E0CAC05FD89ABF7D065A401D36D23F5DF01540907CEA3F6DFAFD3F57097D3FE8439D3D05F69E3FC5D8EBBE1575FDBF938988C03C9FBABF79254240F6B4A1C0024604C0D53D3840315F8340846A9A4082168040211C00C06BED3EC083F430405615534019761340EDAFEA3FFF420AC05C1B8040BFCACA408E40BA40D1702E3F97C45A4094291F3F4AE736407BE68D3C7B954BC0969C03BF2B8759C0E64924401561EEBF3EFD7DC0C2B2FCBFB17FD9BE834C544052323E3F7ED43FC0A697A7BE766B513EC1B24B400E152B3FF26B464049FBD4BFB68BF13E4662DEBE0A12D1C0D7DC41C077C592400EA737BF8B57CDBFB3EA4D408FF55DC0CC23ED40E31D51BFB6FD1840D6A89040CAFB86C055C906404DDD454096E7CBBEF0462C40B4158AC022D45AC0D85026C02C5D0B4032F09FBF15C0DF402CB34A402FBA98BF03ED18C06FD4DE3E50BCA1C050BCF2BFF997493F747F184072F482406018CDB9B14CD6BEAE04CD3F3D024A40ECAA82C035B29C3F3C2AEFBEDFB3A7402B3F9ABF84DC0BC0205B3D3F2BDCE4BF50A0FE3F289756BF47C334BF0D922840710508C1EB8B57BF3CDD8B40BC4B863E8EF52EC0F0BA8C3F075EC73F8F153BC0C49FEC3F2EAD693F45BCB9406B0D5ABF88A11DC038C18540A5D9DCBF83612BC0CC172D407AC3E33F613469409CAD9C4078EE00C06A0E1940BE724DC0F65843C095140CC0566BA53F89D19240D92003C0ED76FA3E56A4D33FD9BDF8BFD246D23F75A9D83F36FBD2C0C2368CC0BAA0B540CD2CB23C9CCFCB404EF8C3BF16E85B4049288240BFDCD0BF93FE8AC0A840ADBF41BA08C042E14CC0B67E8B400CA85D3F76259D3F0B1F11C06F97B9C0D4B626C00A853D3F17C64B404CDE043E0FA4E73ED3395EC070CB074088154F3F0874853F0118D03FEE171240C002C63FE09B9C4078B6A3BFC8C4B63E35A587C06255F33E"> : tensor<2x3x9x9xf32>
    %cst_0 = stablehlo.constant dense<"0xA0371F3DF6C320C0ADFA563F7E2E94BF21E7A9401E38D640AC90AC40F98941BFB8460940EE341F3C75D2353E56DA81BF24339DBFD67D4240A42B00C0EA051940585148BF4759A93FE00FC8BF1828D23F73D0F0C0217F43C0D2836C3FD8F5A8C018C529BE545573C0996D92C023D4344053B6ADC03B792A3ECB7E09BFCCBF7E3F72D8203F33E20B3FCDCB94C01E8E603F0B35E34004FCA3C07FCD12BFFC013FBF6356033F2F155E4062D046BF649B36C00DE9CEC07111FDBF3DC793407E32923E1628E63FC367F33FFC0C3D3FC8462E40963F913F599383C0E90B633FE22F3A403A8D1EBFAE8EDBBF8D93564073243FBF209581402FBDF5BFC4596A4080C584BF7070AB40DA0FF2BFF7FF4FBF93C39FC07C9E2DC0DD52A83F6E6489BFEC4B56402D111840D8DFECBF9D2D9ABE31AAB8BF140614C09612EA3DDE1AB23FBA6702415BBD323EDB23AAC09C27EC3FD4A7C9C0D8459F3F9C4358BD72BA97C0EAC19D3FC7569EC0B849BC40F2F22F3F428AF4BE671327BFF6BC6140474AC8BFAF8A293F560BB73E1D8CF0BF4738E1BF471289BE45F4DD3F447C0440080365C0E97F15C06BCB0BBF9CE06540335EAFBF2AE06D40"> : tensor<12x1x3x3xf32>
    %cst_1 = stablehlo.constant dense<"0x0902843F763A36406223813F7B3B78408B51EB3FB6920240CAA93740CAA93740A1CA1340FF9D8C3FDF71264032306E4062230140D90E7140039FCE3FE4232240763A3640BF4540401D687F40BF454040CF5B33408B51EB3FFF9D8C3F622381401D68FF3F48A99640EED65F3FCAA9374091B42040CAA937401D687F40CAA937402D7E724023CB34400902843F6223813F1D68FF3FCAA9373EBF454040F439953FAB2E0B406223813F9B18983FAB2E0B40A67C8F3F1D68FF3F1D68FF3FAB2E0B40D90EF13F95B5E23FBF45C03F1D68FF3FAB2E0B4018673D401D68FF3FCFAAF93FF439953FCAA9373E13B541406223813FBF454040B0E0863F6223813FDABF2A406223813F5CC04B406223813FAB2E0B40045008409B18983F8B516B3F000000006223813F8B516B3F6223813F6223813F0000000027CCF63F27CCF63F91B4A03E000000007CEC313F27CCF63F0000000027CCF63F000000008B516B3F6223813F8B516B3F8B516B3F8B516B3F6223813F6223813F76897C3F8B516B3F8B516B3FE472E83F000000007188BA3F0000000027CCF63F8B516B3F27CCF63FD90EF13F6223813F1D68FF3F5CC0CB3F91B4203F3C946540B0E0863F42F71A40F43915407CEC314018673D40CFAAF93F3C94E53FB0E00640A67C0F40B5E148408650A93F7CEC3140B6920240B6920240B86B8040AB2E0B40F93AD73FB0E0863FAA7DD13F0CDB8140F93AD73FB5E14840EED65F3FF439154027CCF63FF4391540672443407CEC3140A1CA13406CD63E40D90EF13F525C543F91B4203E6223813F0000000047F8DC3F6724C33E000000000902043F1D68FF3F0902043F6223813F6223813F6223813F0902043FD90EF13F6724C33F91B4A03E000000006223813F0902043FCAA9373F6724C33F1D68FF3F0902043F6223813F000000006223813F0902043F1D68FF3F91B4204091B420400902043F58BF893DCAA9373D1D68FF3F7B3B784058BF89405CC0CB3F6223813F58BF093F62230140D50D2F40E7FC9F4013B54140FEEC5240BF454040000000000902843FBF454040993F9A40525C5440BF4540401D68FF3FCFAAF93F3C94E53F58BF893F1D687F40B86B8040F3885B40CAA9B73F039F4E3FE472E83FBF454040B86B8040869F6F40869F6F401D68FF3F2D2FAC3F58BF893FE472E83FBF454040A1CA1340D90EF13F6223813FD90EF13FCAA9373F1D68FF3FBF4540401E1939401D68FF3F1E1939403C94653F6223813F1D68FF3F01778A40B02F4D40F9EB10406223813F58BF893F47F8DC3FA019DA3F7B3B7840A1CA1340BF454040B0E00640000000003C94E53F1D68FF3F7B3B78401E1939401E1939406223813F0000000009020440D90EF13F1D68FF3F1D68FF3F6223813F6223813F6223813F000000001D68FF3F1D68FF3F1D68FF3F6223813F1D68FF3F000000006223813F6223813FBF454040DF71A63F1D68FF3F6223813F58BF893FCAA9373F58BF893F1D68FF3FCAA9B73F1D68FF3FEAD59D3F000000003C94E53F6223813FBF4540406223813F6223813F00000000000000001D68FF3F6223813F76897C3EAB2E0B4061724740B0E0863FB0E0863FCAA9373EAB2E0B40F439953FAB2E0B40F93AD73F5CC0CB3F5CC04B40617247401D68FF3FF9EB1040039FCE3FF439153F000000006223813F7689FC3E6724433FF439153F520D0E404D5B124061724740B0E006400902043F58BF893F58BF893D76897C3E1D68FF3F1D68FF3F0000000058BF893DD90EF13E86502940BF4540405CC0CB3F1D68FF3F6223813F9B181840EAD51D403893A33F9B1818401D68FF3F4CAA58401D687F40F43915401D68FF3F1D68FF3FFF9D8C3F6223813F1D68FF3F6724C33ED90EF13E6223813F1D68FF3F1D68FF3F1D687F409B181840F43915401D68FF3FEAD51D406223813F8B0225406223813F6223813F00000000CAA9B73E6223813F0902843FF93AD73F4D5B124042F71A3F1D68FF3F6724C33E4D5B923FF439953E622301406223813FD50DAF3FB6920240B6920240B0E0863F7188BA3F6724C33F7CECB13F6223813F7CEC313F8B516B3F76897C3FA0195A3F27CCF63F622301405D710540819E2D40EAD59D3F6223813F6223813F58BF093F7CEC313FB0E0863F00000000000000002D2F2C3FBF4540401D68FF3F1D68FF3F1D68FF3F6223813FBF4540401D68FF3F6223813F7CECB13FBF4540404CAA58401D687F40BF4540401D68FF3F8B022540FF9D8C3F6223813FD50DAF3F525C543FD90EF13E6223813F1D68FF3F1D68FF3F1D687F40F43915402D2FAC3F1D68FF3F7188BA3F6223813FBA9344406223813F6223813F00000000D50DAF3F1D68FF3F7689FC3FCAA9373DA67C0F406223813F4CAA58407CEC3140E924644027CC7640039FCE3F0902843F3230EE3F27CCF63F91B4203E0902843F42F71A407CECB13FBF454040D45C7540520D0E40520D8E40CAA93740D90EF13FB69202400902843F525C543F5D7105400902843F1D68FF3F48A91640BF45404027CC76401D687F4042466140D45C754027CC7640B5E1C83F58BF093E7CECB13FCAA9373E8B0225403C94E53F38932340AB2E0B409B18983FA67C8F3F00000000F439953F58BF893E6223813F622301407CECB13F1D68FF3FBF454040F439953F819E2D409B18983FCAA9373EAB2E0B406223813F00000000AB2E0B400902843F6223813F6223813F090204401D68FF3F5CC04B40BF454040B0E0064009514A406223813F7CEC313F000000006223813F8B516B3FCAA9373F8B516B3F27CCF63F27CCF63F7CEC313F0000000027CCF63F58BF893FCAA9B73C00000000CAA9B73E000000008B516B3F6223813FDF71A63F27CCF63F6223813F27CCF63F00000000000000006223813FCAA9B73D0000000000000000DF71A63F8B516B3F27CCF63F8B516B3FA67C0F3F27CCF63FD50DAF3F6223813FCFAAF93F91B4203F424661404D5B1240CF5B33405CC04B40B0E006400E03C63F1867BD3F42F79A3FFF9D8C3FD90EF13FDABF2A4091B4A03FB69202408B0225400902843FD90E71408B0225403C94E53FE4232240D90EF13F91B4203ECAA9B73FD90EF13F91B4A03FA67C0F4091B42040672443406724434042466140520D0E40B5E1484058BF893F91B420406724C33F9B18983F2D2FAC3F4D5B923FA1CA13406223813F6223813F1D68FF3F6724C33F00000000000000006223813F7CECB13F0000000042F79A3FB0E00640AB2E0B40622301406724C33FCAA9B73C000000006223813F0902043F6223813F6223813F0902043F1D68FF3FF9EB10400902043F6223813F47F8DC3F6724C33F525CD43FA67C8F403D451F40D50D2F40819E2D40CFAA7940EF8799406223814095B5E23F3893A33F47F8DC3F1D68FF3F4D5B12403893A33F4D5B124013B5414013B54140F3885B40B5E1484037E2694025A4B2403C946540D90EF13E0000000062230140BF4540401D68FF3FD50D2F401D68FF3F71883A4047F8DC3F763A3640B86B8040EAD59D4076897C40D50D2F400902044033E1274042F79A3F1D68FF3F0E03C63F1D687F40AB2E0B4048A91640D90EF13F1E193940D90EF13F6223813F1D68FF3FD90EF13FE47268401D68FF3F1E193940B6928240E9246440AA7D514050349040CAA9B73C6223813F000000001D687F40D90EF13F6223813F1D68FF3F0902044096661C401D68FF3F1D68FF3F5CC04B4095B56240DF7126401D68FF3F18673D3F039F4E3E6223813FEED65F3FBF4540402D2F2C3F1867BD3F6223813F1D68FF3F000000006223813F1D68FF3F6223813F1D68FF3F1D68FF3F1D68FF3FBF454040F93AD73F1D68FF3F33E12740000000006223813F00000000BF4540406223813F6223813F6223813FF439953FB5E1483F6223813F1D68FF3F1D68FF3F525CD43F1D68FF3FF439953FDF71A63F0E03464042F79A3F525CD43F1867BD3FDF71A63FB0E00640F439953EA67C8F3FA1CA13400902843FDF71A63FAB2E0B40A67C8F3FA67C8F3F00000000EAD59D3FAB2E0B40672443407689FC3F58BF093E0902843F287D3040F4391540B5E1C83FEED6DF3F91B4A03FAB2E0B40AB2E0B405CC04B4061724740F439953F27CC763FCAA9B73F1D68FF3FBF4540406223813FEED65F4080EDF33F1867BD3FD50D2F406223813F6223813F62230140BF4540400902843F1D687F4091B4A03F6223813F000000001D68FF3F71883A403230EE3F3D451F403230EE3FEED6DF3F1D68FF3F3230EE3F47F85C404D5B923F96661C40E472E83F1D68FF3FBF454040BF4540406223813F8B51EB3F1D68FF3FA019DA3FF93AD73F525CD43F525CD43F622301405CC0CB3FF439953F6223813FA019DA3F2D2F2C3F525CD43F819E2D406223813F622301407CEC313F2D2FAC3F2D2FAC3F6223813F62230140DF71A63F6724C33F7689FC3F6223813F2D2F2C3F27CC763F819E2D406724433F91B420402D2F2C3FCAA9B73ECAA9B73EB0E0863FA019DA3FD90E713F1D68FF3FF93AD73F1D68FF3F1D68FF3F1D68FF3F3D451F406223813FEAD59D3FD50D2F406223813F1D68FF3F0902843F1D68FF3F0902843FAA7D514091B4A03F6223813F6223813F80EDF33F71883A403230EE3F1D68FF3F3230EE3FEED6DF3FBF454040CAA9374047F85C40A67C8F3F96661C40E472E83FBF4540401D687F40BF4540401867BD3F763A36406223813F8B51EB3F"> : tensor<2x12x5x7xf32>
    %0 = stablehlo.uniform_quantize %cst_0 : (tensor<12x1x3x3xf32>) -> tensor<12x1x3x3x!quant.uniform<i8:f32, 0.0039213213266110891:-128>>
    %1 = stablehlo.uniform_quantize %cst : (tensor<2x3x9x9xf32>) -> tensor<2x3x9x9x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %2 = stablehlo.transpose %1, dims = [0, 2, 3, 1] : (tensor<2x3x9x9x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>) -> tensor<2x9x9x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %3 = stablehlo.transpose %0, dims = [2, 3, 1, 0] : (tensor<12x1x3x3x!quant.uniform<i8:f32, 0.0039213213266110891:-128>>) -> tensor<3x3x1x12x!quant.uniform<i8:f32, 0.0039213213266110891:-128>>
    %4 = stablehlo.convolution(%2, %3) dim_numbers = [b, 0, 1, f]x[0, 1, i, o]->[b, 0, 1, f], window = {rhs_dilate = [2, 1]} {batch_group_count = 1 : i64, feature_group_count = 3 : i64} : (tensor<2x9x9x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>, tensor<3x3x1x12x!quant.uniform<i8:f32, 0.0039213213266110891:-128>>) -> tensor<2x5x7x12x!quant.uniform<i32:f32, 1.5377650949769248E-5>>
    %5 = stablehlo.uniform_quantize %4 : (tensor<2x5x7x12x!quant.uniform<i32:f32, 1.5377650949769248E-5>>) -> tensor<2x5x7x12x!quant.uniform<i8:f32, 0.02241982852711397:-128>>
    %6 = stablehlo.transpose %5, dims = [0, 3, 1, 2] : (tensor<2x5x7x12x!quant.uniform<i8:f32, 0.02241982852711397:-128>>) -> tensor<2x12x5x7x!quant.uniform<i8:f32, 0.02241982852711397:-128>>
    %7 = stablehlo.uniform_dequantize %6 : (tensor<2x12x5x7x!quant.uniform<i8:f32, 0.02241982852711397:-128>>) -> tensor<2x12x5x7xf32>
    %8 = stablehlo.custom_call @check.eq(%cst_1, %7) : (tensor<2x12x5x7xf32>, tensor<2x12x5x7xf32>) -> tensor<i1>
    return %8 : tensor<i1>
  }
}
