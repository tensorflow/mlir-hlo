// RUN: stablehlo-translate --interpret -split-input-file %s

module attributes {jax.uses_shape_polymorphism = true} {
  func.func @main() -> tensor<i1> {
    %cst = stablehlo.constant dense<"0xAE384540D8CC3CC06C47F93FAE97BA3FC2C1A6BF21E21740B85C4BBFAA844F3FF9630640A6FE36C02E2B1EBF12BC533F544179BFFC6E81C0B9E58040D641D7BC20EECF3F6EA33B40A9EB2F3D1826164054C44FC00ACB33C060AAD5BF416A3140C256093EFC64583FB86C40C0AA12F1BFEECDEA3EEE75624038C8843F751AB9C0FE51ECBFF9148EBFC7988D40167770404109A53F6A1E34C06AFB2140D29C164096488DC0CA9BBBBE0A913DBF25061240916904406BC7BF3FF81D923EDD3E623E20C92040C475D540D47F15BEAA1F8F40B6BA3340C2EBFDBE5A6C02407063F23F3AEC9FBFC69E3D40D5EB02C001949BC0E2FAC5BF2B02F6BE915236C0B355A4BEA9060040FB43A4C000934A3FCE5D13403674E53F4EB003409174E3C0E8E3AA3FFFE7F3BF9B3852402F177FBEF34C14C0F4926640CFAF91C0AAB1FEBFDEECA6BEA04B04C0519A1C3FF5FA12BF4C6F6E3FE2DF5A408112913F6D7C6840D2019BBF7385713F59BA5340AD717B3D68D2F43F256D843F0D8182BED704543F37EE93BF69CCA03E7ED16940E8569740BB253940F27CA7C005CDF6BFD5DE59BF9C6A09C0284F6AC0309626C0E6CC36BF7BC16F40EBE7244085739BC00DDDEEBF404E3E3F06DD8240898C2B4069E3DF402305EE3F880ED0C0FE27A23E46715CBE999A0B40F6D07C40500BB6C08F00CE3F1637563E21CAAABE5DCD0BC01FE08D40BA25C2BFD95D34400593FEBFC4EB9640F5C26840521517C0FE3CCDBE4D4BC8BF8C5D66405A3F0040859E82C0B938CEBF0C4ECE3FE76D363EAAE09EC01070AB3DBEAECD3EF0E98FBF4848833E5E4B15C09F28F040B04BABC0BACE1DC0208F21BE06CC584042628EBF02F862C0281EFB3F3F625940C91D2D40D80553405407A0C04E2659C05A1CE240555B85BFA6DA4840602957C0322BCEBFCF698F407090BCC0D6FF2D40B75523406BF978C015763440EC1046405F445BC065635B40AA6DF3BF5B2C3A40F7D4703F5B113F3FBF0EEBBE79F5B340D9336D3FD7825ABF107A50407C4F70BEC11D2840AC29C3BF17050941E811A4C0E1AF85C0A29423BFBC67DDC0CE8706BE948D8CC0FAF93CC0E44C63C05E9AC8BFB1AF853D93F29FC0EC0294409F3D99C07D2D2D40DD3B28404F9F3AC0EFD5233F6FD73ABF648EA3BFE2BD33BFE3B129401AF505409BAA58C05C7AA4BE314747BE5A7AA33F3B02BCBD821896C05D9E75C0120BD1BF6EE4E240DC2CF83F88EE5A406158903FC08F1ABF30B978BFEF2A4ABF28D66540F177C44041881D408988D0BF97F37BC0789A5EBF814307C06846403FBFE8ABBF9ED5934051E69BBE65A6F3BD0B0DDE3F239D2840FC9322C0D39A51C0043A92BF64458F4048D9EDBF1549BD3E2CEED2BF29A88FC0E0C569BF31D77540E0A06F3F815130C03881B5BE92BC803FC193EF40B5CA1BC0DACB6DBE889B0C400D9CA7BF7BB8A43F1BC289C0B77FAA3F3D5C67401938643FF22B11C0416480401BEEA63FC70F57403380813F1E9C3A408C3F8940C296343F9AE596C0A41FED40CD349DC0AB6509419E516FBF5AF21D3FF0EE99C0B20810BE25663840AF21F53EE0E733BF63ACF0C0D1CB5940B3678F3F50FE9FC0176404C136214CC0148DB7409D1F1D4052CA87BEFBD93140D00B963FA7AE78C021ABCABF686055C025FC3840F0289540CF446640FCEC864092B91DBF535841C0B57A75C01C1F98C05AE3C040B12D8240D6613B40EE3059BFF458803F6BBDE73F40AED93D04CD5CC05A6571BD84CA7E3FD729DCBF3E9D513FC50E86405E1455C095AEEEBF16CC423FEE7428C0113A1E40AB815140C34A5FBEE8615540CB4C3A407C10753F36C86BBF9A71623FAD4C45C06F2555C0DE9D62C0A2647F3F1480FABFD3449B3F06C41BC0A4910FC0B52287BF88C19D3F7176E73F1140093FB8A8A53EA43A75405EB27540301419C08F5BF03E04877B40DE753340347B9E3D38ED973EFC247E408209D83FAD8ECDBF876B603E1232ECBFD2E738C0FCAA5440479133409A4EBB3E54B4C0BF5DF4CEC04D4B16C07BBA004009F2D33E8DE5E33F96D315C05A86FD4084F277BE9113D8BF0E47C33FDC3BF7BF8F118FC0E7FA90C052ABF8BFC925A43F04BB8DC0EBD077C0A6A537C0655F49405F88853F0C78853F11209CC0B7E68D406DB80EBF61384EBF1D1653C038576F40B0BB8A3D2454FA3ECA3756C0DE412DBDC9E6EE3F619D2AC029669EC0E8F7C5BF0B0567407DDF1DBF49A32AC04F5A0F3F9734AC3F56EAC9402779A33FC0631FC0681B8C3F477EEB3F8DBF2DC0D8AF3EC0BB4F7C3F57AE53BECBAE2340DBA898BFC6DD51C0497D16C04D7F15C0915604C1677B7EBF7DC654405ED0EA3F2AB733407AFA393F70BE2240AF7B89BF3613E33F37E4013F5CCE76C0DFF1F7BF41A720BF36A1DEBF65128C40EA2995404852B73EE39749C0AB0100BF091A51C02C65DE3E8A6CD140298D1CC08399173FF6FA863F589F3AC03F59FC3FC2EB74BF1E285FC07BD653C0F46692BFEECC4EC0CCE359406ECF973F46758140E86C864092376C40CBE5C5C020F593BF8301D43F821720BEE51427C04296CA400A87C3BF4F664BC0A5FC82BE08D48340884D903E13139C40B562744038ED323EB6B6713F925BAF40A2FEA93EEB5BA8BE441CD4C080B380C00C167F3DC7010340E4BA3A40065D9FC0421EDD3F604CAB3F8D0BDAC019308DBF16AE0A40F44A2EC0A5621D40818DFEBF19AE13C0575543C07FC0A83FC48AB0BF3754FCBFEE6EA8BF13F57D40DBDD4BBEC74366C0B17B51402BCC2E405481D23F800716403FAAC73FA74A4A40F6B1D4BD830DA03F900EE44092B68D3EE5180DBF6563123F3257133E27C60D4063E3C740796126BF0739CABF3476B8BFE0E31A3EF1DED13E90A4E5BFDF04A43FCA6E9C3F623CA7403A72A24068DEBB3F050AD2C07770AE40D2425FC0DFD6A140BFA5CD3F89E848BE660DCBBFA8A273BFD371EBC0B2651B40F497DCC0183251C07484BF40F236DB3E96DC3F40687BBA3F5DD697BCB53F58401DAFCB3D54035C404DCEBDC066F45F408C49BBC0"> : tensor<2x3x9x10xf32>
    %cst_0 = stablehlo.constant dense<"0xB8369040581F33BFC74CF7BFE159893F010F3340328927C0212C823D4E48183F283483BF5C86C8C00016D13F0C0002C0BD2F6940D725B7BFD32DA63F1927A440358066BF713E24C0598AB5C025C10A40F75F1CC068B2B23FAB92863F09F2BD3E69CEC63EA1A288C0CA298140E0D195BF16598E3F51982440EE8D02406759D8BF212141C0AE243EC0CBB30F4029ACB1C0C2E3C4BE5F76B340D21FB4BF8EDC613EDBF9DB3F43050740F89F00C1BF803BBFE20351C0912E9C40992662BFD9FDA5C00D610CBF3E2D32C0C248D63FA5E26AC08306E43F1A8A6AC0CD3B22BFBEB1C63F184ACABFAA05164019030B40312CC540B25563C04C0A85C064A612C0A7E07BBFB3A30FC006CC7DC0B7890FBF36DBB5BEF9F37240834732C023EA16C043F74240817AE73EA8A71940F94442401460C5BF700B61C04A5E93BFE63DB0C03C6C9240EF6E3840D76607BE2A59E3BEEFEE0B3F1237F03FC923D5BEAB228F4028790E404CAFCCBFA5792DBF5E0C96C048E4B13FF3FA7840DBC2D73E4CF8264085D27EBECB448BBFAE1B1EBF7EE60FC02CC47F3F2F96B2BF5E59863F833FD33FE257603D38300C3FC9341D3FF85814C0C62A9040929F9040914FEF3F07DC8BC07FEC69BFD1E1B440E21C45C0FDF518407A170F3F5FF0CFBFC5DCA93F700415C07BFC3F40E32C0B40E35CAC3FEAB7D03DFCC52BC086DD34BE79A4154138CEB2BF342BDF3F1A534CBE2D7A0640E82F1340197D0B3F3564B9409E72DE3F784B57C039EFC73F1A6A594044F9C2C0D13D31BF732358403C5283C05E99E33E6065F4BF63F149C0269B073F5FCAF83F1C0C5C40FB1112C031E009C0AC3D8540D16D62C099607BBF18D25440F09668C0BD07AEC04424B5407D7A13BF7498C53F87C1A23F85881DBEFA7EBEC032C20CC0D8441DC012EBDABEF49F9D3D0FE2F1C0357884BFCAA2E240D515C53E9A37CEBF0C7B0B4090BDA03B2A0AD2BFC0D676C014893AC027E4A440C882A3BEE974C8BF97D3A5BE5AF884C0"> : tensor<3x3x4x5xf32>
    %cst_1 = stablehlo.constant dense<"0x8F1E374197FD1B413D4CFC40560F204108F654415DEE84418E8B3C4153E92A410FD5394115212441883F524157A21A4112FB2E4105D05F410D423F41883F524153E92A4108F65441DB110D4150C33541547C254151563041CBC0484141056C419A231141956A21419A231141883F5241CBC0484100177041560F2041FA75904108F6544180CD724105D05F41033D65419BB60B41560F2041D6581D41DE370241CEE63D4150C3354157A21A4117471941D6581D41D8EB1741883F52418B654741174719410CAF4441D10C33418E8B3C4191B1314187AC574194D7264153E92A4192442C418B6547415156304119DA1341C89AD34012FB2E4192442C41FEF07A410D423F4185195D41D97E1241D10C3341D97E1241033D6541C92D4E417DA77D41152124414751D64097FD1B4197FD1B4119DA134197FD1B41BC02FF4019DA13414072F1408B654741C89A5341883F5241D8EB174119DA134117471941138E294109894F4150C33541C89AD340CF793841D5C522410D423F41C24E694183F36741CC53C3409EDC0041D10C3341138E294116B41E4105D05F418F1E37414D9D40415B5B0A41C6075941C5745E4141056C4116B41E4149E45041956A2141DB110D41C607594105D05F410A1C4A4109894F418B654741D10C334158359541C92D4E41C92D4E4108F654410A1C4A4102AA6A41BE9579418F1E37418E8B3C41CBC0484149E450417C528841C607594181606D41C574DE4081606D41BF2874418F1E3741407271411D9383410D423F4150C3354191B131410D423F413B648C4105D05F414C0A46411068344198901641560F2041C89A5341DB110D4109894F41D29F2D4109894F41CBC048419EDC8041D5C52241CBC048417E3A78414C0A4641D97E12418F1E3741DCA4074108F65441C607594105D05F4187AC5741FE2E804110683441C24E69411521244187AC574197FD1B4146BE5B414E303B41CC5343418E8B3C413E8A8141CEE63D4108F6544149E45041DE370241C1BBEE409BB60B41CC53434149E4504194D726415AC80F41CF7938418F1E374150C335410FD5394153E92A4192442C41583515419C4906414C0A4641C5745E4149E4504117471941DCA40741C92D4E41C92D4E41C607594150C33541DCA4074187AC5741956A214158351541CF793841033D65419BB60B410CAF4441D5C522410FD539418B6547410CAF4441"> : tensor<2x3x6x6xf32>
    %0 = stablehlo.uniform_quantize %cst_0 : (tensor<3x3x4x5xf32>) -> tensor<3x3x4x5x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>
    %1 = stablehlo.uniform_quantize %cst : (tensor<2x3x9x10xf32>) -> tensor<2x3x9x10x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %2 = stablehlo.transpose %1, dims = [0, 2, 3, 1] : (tensor<2x3x9x10x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>) -> tensor<2x9x10x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>
    %3 = stablehlo.transpose %0, dims = [2, 3, 1, 0] : (tensor<3x3x4x5x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>) -> tensor<4x5x3x3x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>
    %4 = stablehlo.convolution(%2, %3) dim_numbers = [b, 0, 1, f]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64, precision_config = [#stablehlo<precision HIGHEST>, #stablehlo<precision HIGHEST>]} : (tensor<2x9x10x3x!quant.uniform<i8:f32, 0.0039215482917486456:-128>>, tensor<4x5x3x3x!quant.uniform<i8:f32, 0.0039212212843053483:-128>>) -> tensor<2x6x6x3x!quant.uniform<i32:f32, 1.537725862903607E-5>>
    %5 = stablehlo.uniform_quantize %4 : (tensor<2x6x6x3x!quant.uniform<i32:f32, 1.537725862903607E-5>>) -> tensor<2x6x6x3x!quant.uniform<i8:f32, 0.084777487960516234:-128>>
    %6 = stablehlo.transpose %5, dims = [0, 3, 1, 2] : (tensor<2x6x6x3x!quant.uniform<i8:f32, 0.084777487960516234:-128>>) -> tensor<2x3x6x6x!quant.uniform<i8:f32, 0.084777487960516234:-128>>
    %7 = stablehlo.uniform_dequantize %6 : (tensor<2x3x6x6x!quant.uniform<i8:f32, 0.084777487960516234:-128>>) -> tensor<2x3x6x6xf32>
    %8 = stablehlo.custom_call @check.eq(%cst_1, %7) : (tensor<2x3x6x6xf32>, tensor<2x3x6x6xf32>) -> tensor<i1>
    return %8 : tensor<i1>
  }
}
