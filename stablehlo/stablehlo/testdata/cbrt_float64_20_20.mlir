// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.cbrt %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x325D608E49740A40FBAE2B95804E0740EFB9702C145FE6BFE02F7AF7FE70FE3FAFB2112B8BBBDA3F9DA97C1CC65A0AC0EDE362CE9B2DC0BFB0823D20B54AE7BF585098B36378F43F643D5C35F65BDC3F836D88C0D5C1F63F3AD8451D3E25E4BF2A37985324731040C0124583C961D93F489A321CE3F80840126C76F5406404C0C05EB04DDBA9DE3F44F296E1458BB7BF19206337A7E2FDBF5DDBB58F84171340F5400346DA93F63F74E163CE60300FC0AF5722EF6607F5BF294E80505899B5BFE7DFEE530BB402C037C9BA8B9620D43F0CCCC3B00B3DE43F22A68050BA82DE3F5D49A03D6B7FC83FE6E9849FBDDC08C05812E0A01562E0BFD203CB6AEA7603C0B0B61AB139BB0E40909E4A5246F007C00819116433B4C63F528005C87D3B05C0A7AEC4EDD4F3DCBF56F0B7AA8B3E0840BB939147133F19C07B8684197506DB3FD0B0164DF4EEF83FB455C97A4CEEF2BF32FB5841AEEFFE3F567D4A18C49915C04EA6AF879387E9BF309BBBDDF87302C0FC77250B7C03C7BF8C50B1A95A5F1A401B123E7F291B04405E9963DC85BABCBFDA8AF03374B9F03F53B4CA8BFC5C14C02EEB261A033AB93F3BD973B733F6E33F8BBCCB00B95A14C0480A432D452BDBBF383142B863C2E13F00069B1C4150E43FFE6D2D38E77709C0EFE2EF6EF48E0840EBE0A2C61D1410C0FF6438F243D0D13F9A5294E98243EDBF66849F975CE9F1BFE0D62EB1187AF2BFB34B3ED795910EC0E824EAD960521540723F6AE3F858F1BF5144F4B77FE7F1BF40626533CDA90540CF7BBADDD70FF7BF0C52D5F76B3ED93F203CA6FBDE830640841A92DC74130640942ACA442B7C09C0BE7FACA9C33B1440C19C40B18F4D14405BA93B7E0002E6BF0AEDC64B10AA1640DBF31ED5A6B2F93FB8639E873BA50CC0F41CD1CA740D08405E2561F852F9BD3F0C5542142F870F40B2A26754F9FAF73FE808A35CC7F1FDBF46CA43E12F7E03C00EFC0311954DEABF22C9D2476D0903C0A3B833D43DC1F8BF5347051F2890E6BF5E522EE271E1FEBF3BE5C81A52A4D03F0D5C3B0ED8190540DA7678EF1F6B0EC0A707CD8CC77D04C0EBC39BE916BA823F9E4657B07EF20240C511C57C8B94F63F10C83B7F89EBFDBFF0A0EA81A34B03C0C1F4B131107300C0DA91A9E9D79302C03832DED88A06FBBF4F3A92AC2674FE3F5F97D56E6746F1BF09B655AFA01601C000C508BDFEAB0AC0223249381C789EBF72F8E3A8913D10C0A8C83C258D4204C03641B839B7D7F6BF8612E87DD98DF73F252BA495D39CF13FF1B3D99FBD74CBBFC49FBBDA0C53C6BF8B507B15F66902402B525B56DF1610400882D56E73B303C00CB108EF8A021FC0732771D1FFC11140B277AF5AD6401AC08440F120EFAAF43FC4609713AE6FE03FB46E5CA0A340E9BF962471981E830BC0D91916190A7C1B40EC43AFA80B76F43FC0409F957F3BE1BF8E13BF23A14005C042F34E24D337F33FF3AB2E69270E08C051C4A50E6297D23F6479DABF0FF3F3BF945A8DEE617312406FA7A926DB230A407A68DF0E5E9310408596B575E6CF02C06A57B9C0062818C0AB1BD643B550F5BFCC76C296EC3714C01EAEDDF77880B6BFB08BA28843D70140F72A1B20803601409CA0A3B239FE0740B4F78F15C43A10C09CD3E3756E5C12C0EC416BA8E3F42240EEB71706AED7C33F88E1DB17347F14406CF9E7B903E00C40983EADA9D44FE43FE16A3DAC7A0110402EECB3CC42DDE83FB39EAD4FDE7E114056F4908922710AC0711D02727400E93FAC3EB4075BAF1140140D3E0745BCF8BFDF1C5F1C787B13401C9C64F748340040204F696DA34ADABF2076DB577927E0BF389ECDDF803EFFBFF542026A482716C0CE34221A5101FA3F93A8660ADC21F7BF071D19A3BD1103C0639CA117DAAACF3F921CC49A8DE2FBBFA3DD76DD335EDA3FDCAC4A401CCF13405BFDA31EC07306400004F20C5FDC13401A3C83BCC0F8F1BF94C9F1F1263209C0F2B7812DB1C5D43F6ECF062CD55AFA3F9713C56B679510C0A8BC6F549A44E13FF6DA30008C530EC03AD24BC98F1F01400A8E5FF659C3EB3F7A91F70E2D230640186930CF106D0740206A11F0F63AD4BF6E90BB8BA828F7BF54781083FEA60B4030201CEC42CCE23FAC190859FD16E9BF66AF7C98C02903C00CD19ED5F2D7ECBF768C9E49B6A904C078910DD2AEEEE43F55FC9449AB6DFDBF572D994F89EFF0BFA1D72FCC3A2700C0964FCC5A5841CFBFEB54AD10E72BE93F05D65525D55F03408349CFDAE6B6EEBF0ACC6F5CE3F80540BF0314B1AC1ED93F1C3565E0301AC7BF70D405F2B088F3BF800DB83A3D05D7BFC2C525EA1E3AE1BF6CB48910279F03C0229CF37A76240B40A25569932293F33F6EDEB292FD0A12407C935E2C75AA0C4074776DA99C15E93F51B5117E204306409CA324A73EFC18C0B6368B46C4EF09C0D80C107D9FC400C023DD84B2B25601C0B2A913C2FD8F0C40AEF02B4051B5E4BFC1262778805709C03612C0E611B3E0BF90784E91695EE43F14554B6B1617E7BF756F75689F7C12400946FF17DBC606402F8A9F948DEAF2BF16F10165B486E0BFA0AEAF4F92F07B3FA84270091320BEBF2BC00627A77EDEBF310ECD3A9BF502C08C1FDEA26AAE19C01CD3330F3EB4C8BFD69A6676D44FC13FDF15E4564E7804C0FC5FC2F760DA0940CC12E57CFF861D405C26C99197C7F8BF3B637B25B91B19C0CF91A0CDA11ED63FCE8927B2D83F09400400571300500040C786BAEE089904404DF205F2EB6EF73F606EDFA86364E4BF1C4F7460AAC4EFBF3EC3D2550CB0D8BF4573FB3CED83F63F2604846C0CB9FBBF57A26382F396FABF8E9EB64B0D89CC3F0E456C905156E6BFA6839E5735C7C4BF7E64A54227A0FBBFEAB924D0EE7012C04F13FF60517217401EFECBAEEDD5E83F11A4A226E682DE3F76DD0AD15E73F2BF54FE4724B628F7BFEFB4BF15D99ADB3F74D24559C3100AC0E898B907FE0E0340D15C5A522C84AA3F8CB9BF0BBB67F8BF1AF5371519560940F2E42278795A0DC020155A8754CB1340EA95236DD8DA0340609EA915AC5907C0138F37517D8A00C034C25E4D200CE1BFFD76B10F1A9E10C0A4CBB5622D9814C0FEB53BEF5FADEF3F8D3F316D7281CF3F2988148ADEA201C0E413C3F2EEF01F40CE1278F1BED9AEBF0675C8857344F83FEAEA755A6DF6F9BF3225D7C6DB10E1BFB29FF58915E60CC03BD7A60C59CC0D40AB8225926F97E1BFA6F1C848A67B1340CCD88DE97346AD3FC8EAB52F9410F33FC6CCB5605BC1D4BFA05D5450E84011C007DEAB36FA6503401228FBF24D89DFBFF8F954B7E35BF7BF22BD6CD518F6FBBFC33BCC184F220DC00A57EDF68B36F3BF1D8BF9EAC7B701C02C26AB4A507C06C0BCDD31FAA9450C408F7A65DD45CB1540D1632E02F122E5BFCF38C7D3967408C0F4AC9F5BE93A1340725B0A3A602AEA3FD01134B0746E0AC089C9CEB28725D8BF3C2A33D4CA89FD3FFDF071724A0AEEBF48B31ADBD69B10C0DDB66016CC3FE53FE66082C325311AC029797064B692FE3F42FC643037E8FB3FA9B7093598B80B40D050FBEB49B41A407DCF4516CA75014054DC01FB8C3402409DF19450EFBCF23F4A92FCEBEA2C03C0109DB012A622EABF30EB83BD4CCC0740D88F8DD86EBE08C019A370CBFEF4F9BF967363A64414F8BF43617EE55E17E43F76DDA144FA8AEE3FD276D107208BC93F1ED6560851F1E9BFFAC18028859AF53F2A13223F6585E03F2828CCFC2E30E43FD236CBF6DF63DB3FFD0784A6CE3613C0AEF8F764B70E0640921B59B48EF315C09160537A88C10140FA247667C356E93F1EA4CA39C43E19407CF09D0771160DC0B4D373DB9A380EC0FA3CD5AD62E3F83F2203529C6FDED1BF1417A4F682ADD6BF0558E993F00300404277790915910C4024858198E8FE1F40FAF1960F26E0E93F22312545D20ADBBF4DD32F380912E23FD1D06D8BDD9616407C5198E85E9E10407AACE04F64A60A40CAEA18F1AC31F1BFEE732DDBF322FBBFAF1485822773DB3F15A19E82A86E0140BF1BA3284F4A22C08E206C28011AE93FFE20739187040C40AC417E6330DB17C0E86F67D19200E4BF169058418B63FBBFECF5C717BBE0E33F08C55E9AB42C04C0AC3328E7C8280240AC59DBDE25871040DBDB845DE07AEABF94E122CB82631BC0C2A4E977E845E1BFED7165D25823FDBF321D796621A303C0F89E704A22AF0F40B45A20747F4803405E64BE783D1717C0C0AC38F83827F23FD6A254C89F0C11C0B130436673B4FC3F0E76F6F3E906D63F3EC3DD2BEEBCED3FB74F9E4BCCFA0D40EE2E998E971414C0C4BC05F106A304402DB1D2AF94C7FB3F3D76EEF22EEDFE3FB44568195462AABFA6E6CD3D8A2F0040F77F276B2A0016C0AFB11A14A21D0040B41396476E82F3BF140F3BABD873EF3F9AB20A73D7D81BC0A47C47FB45E5FC3FD215E4227F4CEC3FA337E4BDC4C5B23F2B892D6DCA51EF3F0BE7242F345DF4BF03738B4BA7D510C0246B7ACBBB1300C022E6D8D4C28CE4BF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0F46EA5152D6F73FB6AC1E6B02DAF63FBA4F09DF9C66ECBFC33B55E273D3F33FEAB55238A6EBE73FE4B63915A6CEF7BFABEF2194250FE0BF8986BAB4FCC8ECBFB5922FF6985EF13F649F6EA16A65E83F45F1E62E60FEF13F524D07BC006DEBBFDA44E6A75BA2F93F3D1C32D0BB82E73F505249462B62F73F22FF65542DDBF5BFA7C7A3442F0AE93FBC5A25467DE3DCBFBE5D99595CB4F3BF37A08DA267F0FA3F6DEDA47D39F2F13F9091261A982EF9BF83218B56AF86F1BF836CEC9CF411DCBF66AFAC734A3CF5BF9FD8C48DE5C2E53FF905BDBAC977EB3F6B13AF1A84FFE83FDA21A2E2F070E23F9EE230F15E59F7BFE7A3B9547C99E9BFE3A1225C1085F5BF25CF91AEE80EF93FCB7819F4680EF7BFAB244D8BC7FAE13FD99459DF0A27F6BF1D046851AA90E8BF0B5515B56E27F73F5DC148109A91FDBF75E4A4A7E901E83F177C8476C38CF23FD145361A37ECF0BF26C962BBCEEEF33F432D6A4D2312FCBF3475C21ACDADEDBF7D09E1D4EE23F5BF79C4761E9D0FE2BF770A60778300FE3F60C0A8C5F0C0F53F08394F79BFDEDEBF46175064E83CF03F8096B9663586FBBF89D989E69F8FDD3F30692B3F9757EB3F021F623F3085FBBF312D224DCB0CE8BFEFD14BCB124CEA3F06C273A67780EB3F50E87EEE8D89F7BF3375BCA0EB40F73F03F4DA1D9F70F9BF8EC6B040AEE4E43FC1F73E58830FEFBFCFBD7E23069DF0BF0465B5394FC9F0BFE4F439389203F9BF9543018914F3FB3F0C92C2D2E76FF0BFAAA585AE729CF0BF769D3E3D264DF63FA2AE5831D812F2BF8F9DFB5ECB77E73F341D1E310597F63FA344935B2D71F63F93644146DE8AF7BFD7A2E1503577FB3F195BED77407FFB3F9B1C728C023FECBF4A38FFED3486FC3F119F9EA4CEBCF23F0F4C04545B7AF8BFFDA53689C317F73F72A22F3B534FDF3FEA94AC51DF45F93FBB78E77C784FF23F75AA6FCEAEB7F3BF062D1908BE87F5BF4E1A57B4C4F9EDBF2B0A222F6A5CF5BFC56376636681F2BF13068276527BECBF4FF87F8CBFEBF3BF123D8083BE6CE43FDF281900511BF63FB3C4A13710F9F8BFFF37FE2B48E4F5BF9C688EB92DC4CA3FEE7304F5D253F53F95015F7168F2F13F2066F8FE4FB6F3BFB9E6FA911175F5BFE3D1AABC8358F4BF19EFEF9A1330F5BFA7670DBC080EF3BF55A79A3523D4F33F8B796F65086AF0BFB78EE274189BF4BF183EC91402E7F7BF3A21EC25FFD4D3BF7A32773A6986F9BF4701942E1CCFF5BF0EEA20AA2204F2BFB88ED9B68733F23FB5A07F783A85F03FDC8E5B00CC27E3BFC9B0777DFDE0E1BF8E899A781B20F53F36410C271372F93F257E4281489BF5BFFF6905ACA0AAFFBF56519E7BE14BFA3FD3784E7FECF4FDBF9A2D4C10D96CF13FA0501E2C8FA0E93F968DEF583692EDBF34A85A6C9B26F8BF44832E5FFC6AFE3FA2E52D38EF5DF13F2B5290E2D208EABFC2538D2ED428F6BF343A47A40302F13F6BEF98B2FC17F7BF538511026C31E53F2E5C59FB8F38F1BFE9F9471553A2FA3F3A6D033111BEF73FBBDD960B0EB3F93F1CC07D1AD046F5BF2EAB89C60D23FDBF64B04252F59AF1BF765AA9627875FBBF60057478B774DCBFA464AB566AE7F43F06431E2EE0A7F43FFC29E8AAE212F73FEB9C5735F184F9BFEFDE365C4397FABFA773349C2DEE004037140C5EAB30E13FEAA92B749795FB3F58E1A13A0E8BF83F2B44FBB44680EB3FB0AE69FDC666F93FAD085776386BED3F2C661968942AFA3F9ED762E35FD5F7BFBF6897431379ED3F8C295659AA42FA3FA6342A252980F2BF22C7B765191FFB3F847FDC8E803EF43FB57F4848C9C9E7BF13C329A3D07AE9BF2F77EB42AEFFF3BFFDE8FCA6EC4EFCBFB0BD0EDAD9CFF23FA29CD9D28B17F2BF49E6BDCC855FF5BF390A00C0B116E43F79DFF9F23341F3BFF9C1A157AECFE73F992FF55FB245FB3F492D3AB69F91F63F2DEA81F5C64BFB3F8BCBE5F7C6A1F0BF358D2D67FD73F7BFA1F16E5CC6FDE53FB5D7700957E5F23FCDF0BA721BB4F9BF1D6272D4670DEA3F645B95C19AF2F8BF41DD911FAF9EF43F79D228823485EE3FE98D44BD7F76F63F2306FE37FBE3F63F259984F062CCE5BF356FD9675119F2BF2E02D7271631F83F7C1F6A4CD3CCEA3FDB06FD77EB81EDBFA1C1AB937A68F5BFC18EDF0C46E9EEBF67F80429E2F3F5BFB1467A2540C7EB3FCA580896849AF3BFC2224371564EF0BF9140A54A0F39F4BFFF8F4D754900E4BF044494FC1B8AED3F53236D3E8B7CF53F2763FF43CC90EFBFD350E6F82868F63F0670F6B9F06DE73F27468FCC8B15E2BF3A161A79BD19F1BFD707666FF7C1E6BFD44289432108EABF6F506A49DA93F5BFB36937ECC80AF83FA692B61EC91CF13FE8DA9011B86FFA3F9F35F73FD87BF83FB0E972326181ED3F4BC6FB1E4981F63F85DF83A86B77FDBFE0265D6941AEF7BF2B22CC09ED79F4BFAC93FF41B9B4F4BF4277D0F14C74F83FB426C5A7C8ADEBBF11D20F698E7FF7BF7ED1AEFF65C3E9BF57C836D9D986EB3FA3610924A9B3ECBF5289E48CC4A6FA3F7524192556ADF63FAD4D364D19EBF0BF87DE960C81ACE9BFB52EB1177846C83F990B6480CB5CDFBFCD24A82867FEE8BF4450DEC2FD54F5BF94157C8CD2BCFDBF713ED998287EE2BF8752BB1D046DE03F1CF3050255E2F5BF0CA77942BDA7F73F5E9D2C8D5127FF3FED543D5CFB82F2BFC85C5568C683FDBF58286E2EF674E63F635CC8623C78F73F3588A4AB044AF43F61ED599FF8EDF53F47C027CE8C2BF23FCB3198D98A89EBBF76E1C2842CECEFBF0D7C3FE0584BE7BFD342D44200EEF13F3366A69DA137F3BFF6E9BD59AAF3F2BFEBFBD8433B67E33FDB69CD60E762ECBF765C7AA8C774E1BFB1781747DF31F3BFF901E34625A1FABFE3A1CDC044D9FC3F5BF7B8DB5368ED3FF4F0831390FFE83F38EFE28845C7F0BFB1248BF25419F2BF47A221DF8A2DE83FB9EB24F447B8F7BF815C2FE17E5EF53F8CFC7FD916DBD73FC879DA50FD6AF2BF735857521F7FF73FD683FFD48FADF8BF5EDF5728F643FB3FBFBB83C5A5A9F53FD2A29F64A8DDF6BF683983B52762F4BFA08EF4A7E1F0E9BF26A1180C99B8F9BFA86F80E8C6A0FBBFFA3220795DE4EF3F40252793EC0DE43F037A538EDFD2F4BF2920EF86F9FAFF3F451E16933117D9BF7E823C141962F23F7478E64539CDF2BF7B42F8EE47F3E9BF50FB3358C68CF8BF55DDE15650CDF83F3AB3E516CE36EABF3979C0D22E1FFB3FD7CD822BF2A7D83F07E30BE567F6F03FAA565A9C3EFCE5BF9F8659F18B0BFABF893F2786D07EF53F257E885C7046E9BFC2F3832AA026F2BF847CDC7BB245F3BF844A525CC89DF8BF9798E21DA301F1BF44F8E74917DBF4BF1B5085DE7D94F6BF6116901B045FF83FAB8236038527FC3F4B87E6DC4ADEEBBFF8EC12509638F7BF8237580E0301FB3F6ABB96F65EECED3F471114CC91D4F7BFA068A24D751FE7BFC6ED6A3FC1A0F33F061028793A55EFBF86428B286EB7F9BFED77E7B6F3EAEB3FCC6E0693F3EEFDBF9E963A06C3DAF33F05F456828142F33F463792023736F83FE349075C9620FE3F3FDF4C4612C1F43F624DA9C29A0BF53F162428B274DDF03F3DFDCF43A869F5BF144719976CE9EDBF28B58D6ED602F73FD0E1DA38DE4FF7BFCED117C8E0CCF2BFA63F9853E655F2BF85AE9BC2B366EB3FF1465101B981EF3F9CC9B0552EB3E23FA35C5BBC8ED6EDBFD504CC6130AFF13FA0F54C7AD3ABE93FDCC55CDCF671EB3FD7E0AF7E731DE83F4B59851917FFFABF5B08BA0B926FF63FF7B84835D338FCBF5A319E28EADEF43F58EF5BA0D69AED3F30B347337B91FD3FBD5C1F40709AF8BF39257E4635EBF8BF3750768FE489F23FC6FF4B1137EAE4BFC25DD8C5E9A4E6BF0FEC4A6A4A2AF43F7134D9A49C74F83FE96B71DCA2FFFF3FC12FFD4FF8CFED3FF6978D643403E8BFF1D3C6842873EA3FF4F264D3247EFC3FF2D35091BCB8F93FFB02477855E5F73FD33537137563F0BF461918B8B314F3BF7A575E9BEE21E83FED49D98E3EBEF43FC37350F1C9BA00C0883186FD1983ED3F5FBF256F3E4CF83F51E5CC1E0804FDBF51F80EAF525CEBBF6D5E7B5ACB23F3BF79A58418C64DEB3FA704C3A442C7F5BF608670201107F53F568048CFBBACF93F35386FA2EF0AEEBF479AF32DED61FEBF549D49DA0F0EEABF6158E0D1F589F3BF353D09784F95F5BF5154D5898750F93F0559F375E773F53FBEDE6052B9B3FCBF36D6FA7A10B0F03FDA9BD75022F1F9BFB618427B0C71F33F70B2E57FEC6CE63F32B5E7BF3D3AEF3FA18E79D12CDAF83FFFB8AC517065FBBFEAFA98D983F1F53F0D68AAA6FC3AF33F7329606945EEF33F28B18B37ECD0D7BF57151C82863CF43FDF456E6B393EFCBF0D349B460D35F43FE54BFF9AE917F1BF3F5DB85C03D1EF3FB8B8B06E128DFEBFF64D7AFC0B7CF33F5D5298F523B7EE3F44A36B05BDC9DA3F860E518083C5EF3F8B89B11BE556F1BF30B876A822D5F9BF36F69732E930F4BFE5782911AB9BEBBF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
