// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.and %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0000FAFFFCFF0000030003000500FDFFFFFFFFFF0400000000000300020003000500030000000200FDFF0100FEFFFEFF03000000010007000000FAFFFEFFFDFFFBFF000000000100FFFF050002000400060002000100000002000000FFFFFDFF000003000000FCFF0000FBFF00000000010001000200000003000000FCFF0200FAFF010002000000FDFF00000300010002000300FEFFFDFF0000FDFFFEFF0400FBFFFEFF02000600020000000000000002000000000005000000020000000400FFFF0000030000000200FFFF00000000FEFF00000100FCFFFDFF000000000200FBFF010000000200FEFFFAFF02000600FCFF01000100FFFF0300FEFF0600FEFF0200FFFFFBFF0100FCFF01000000FEFF04000400FFFF000004000600FFFFFEFFFEFF0100FFFF000002000200FFFF0000010000000000FCFFFEFFFEFF0300FFFF04000200FFFF02000000FFFF0100000004000200FEFF0200FEFF00000200FFFFF9FFFDFFFCFF0000000001000300030002000100FFFF00000000FDFFF7FF03000100FDFF0200FEFFFDFFFDFF0300FFFF0100FBFFFEFF0100FFFFFDFF0100FEFF000000000000050000000200FCFF00000000FFFFFEFF00000200000000000000FDFFFCFF000004000200FEFF02000100FFFF0100FEFF070000000100FEFF00000500FDFF0100000003000400FBFFFFFF01000200FFFF030003000000FFFF0000000003000100FEFF000001000200FFFF0300FEFFFFFF0200FFFFFBFF0000FFFF0000000004000000050002000200050002000300F9FFFFFF0100FEFF0500000005000000FEFF01000300FBFFFDFFFAFF00000700FFFF0600FFFFFFFF05000200060003000100FDFFFBFFFEFFFFFFFCFF02000000FFFFFFFF0400FFFFFEFF00000000FEFFFCFF0300FEFF050000000000FEFFFEFFFFFFFFFF0A000000FFFF000001000100000000000000FDFF00000200FFFFFDFF01000700010000000200FBFF0300FEFFFEFF02000000FDFFFFFF0500FFFF0100FCFF01000100FEFFFFFF0000FCFFFFFF00000500FFFFFDFFFDFFFEFFFBFF0100FDFF0100FCFFFDFF00000400FFFF00000100FFFF010000000200FEFFFCFF0300010000000000FFFF06000200"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x0200FFFFFDFF02000200FEFF04000000030002000500FBFF03000200F8FF000006000100FFFF0400FEFFFCFFF9FF0100FAFFFDFF00000100FCFFFFFFFFFF0000FFFFFFFF0400FAFF040000000000010005000100FDFF000002000100FCFFFDFFFFFF0200FFFF010001000000FEFF00000200FDFF0500010000000000FFFF0500FEFFFDFFFDFF020002000300FFFF00000200FDFF0100FEFFFCFF0200010002000300FFFF0000FFFF00000200000003000200020004000500FFFFFEFF000000000200FCFF0100020000000200FFFF0100FFFF01000200FDFFFFFF04000300FCFF0200050003000100FDFF0200020000000100FBFF0200FFFF0000FEFF050002000200020002000000040000000000FDFF000004000000FFFF020000000100FFFF0100000001000100FFFFFDFF0300FCFF0500FFFFFFFF00000900FCFF0000FEFFFEFF0400FFFF020000000200000003000000FEFFFEFF04000600FCFFFDFF0200FDFF0400FDFF0100FEFF000000000100FDFFFBFFFFFF060003000100000000000000020005000300F9FF0300FEFF02000000FFFFFEFF000008000400FCFF03000100FFFF00000600000000000000FCFFFDFFFFFFFFFF0300FFFF01000100FFFFFEFFFFFFFDFF0600FAFFFFFF000003000400000000000400FDFFFFFFFFFF03000200FEFFFFFFFEFF0300FFFF0000FDFFFFFF0000FEFFF9FF01000600FEFF010000000200020003000300FFFFFEFF01000200FDFF04000800FFFFFFFFFEFF030000000300FAFFFFFF0100000004000000FEFF00000000FCFFFEFFFEFF00000300FDFF010002000500000000000300FBFF0300FDFF0900FEFFFFFF01000400000003000300FFFF01000400000000000200000001000100FFFFFCFFFFFF000000000000FFFFFCFFFEFF0400FEFFFDFF000003000000FCFFFFFF0200FEFF0200FBFF0500FDFFFEFF00000000FCFFFFFF0000020000000100FEFF0000010004000000FEFF04000000000000000100FAFF02000300FCFFF9FF0200FFFFFFFF04000300FBFF03000000010000000100FDFF0000FCFF01000000000001000000010002000000FEFF0100FFFF0300030001000000000003000100000003000200FEFF0000"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0000FAFFFCFF00000200020004000000030002000400000000000200000000000400010000000000FCFF0000F8FF000002000000000001000000FAFFFEFF0000FBFF0000000000000400000000000000040000000100000002000000FCFFFDFF00000200000000000000000000000000000001000000000000000000FCFF0000FAFF0100000000000000000003000000020001000000FCFF00000000000000000300FEFF0000060000000000000000000200000000000500000002000000000002000000010000000000020000000000FEFF00000000FCFFFDFF0000000000000200010000000000FCFF020002000000000001000000FFFF0000FEFF040002000200020002000000040000000000FCFF0000040000000000000000000100FEFF0000000001000000020000000300000001000000000000000800FCFF0000FEFF04000000FFFF0200000002000000000000000200FEFF00000600000000000200F9FF0400FCFF0000000000000000010000000100FFFF000000000100000000000000000000000200F9FF0100020002000000FBFFFEFF00000800040000000200000000000000040000000000000000000000FFFFFEFF00000200000000000000FCFFFCFF000004000200FEFF00000100040000000000040000000100FEFF00000000FCFF01000000030004000000FDFF01000000FEFF010001000000FEFF0000000002000000020000000100020001000200FCFF04000000FFFFFBFF0000030000000000000000000100000000000000020000000000FCFF0000FEFF000000000500000002000100000000000100FAFF0000050009000600FFFF01000400000002000300010001000000000000000000000000000100FFFF0400FFFF000000000000FEFFFCFF0200040004000000000002000000FCFFFFFF020000000200000001000100000000000000FCFF0000000002000000010006000000000000000000020004000000000000000100FAFF000003000000F8FF00000100FEFF04000000F8FF03000000010000000100FDFF0000F8FF0100000000000000000000000000000000000100FFFF010000000000000000000300010000000000020006000000"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
