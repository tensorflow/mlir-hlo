// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.cosh %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x81611EC84CC3014067D91ECB11A610C00863A8DAE09511C04787066A86A50C4037D9FA6693C90540D8BD2B03B725DCBFDCF8C11A362116405C784FECAB2A0E4071A0A8471E6812406E04E735AD27F13F478AF7A2264E04C0DE06C053D468E33F0DDD2DC77E73D3BF6A696456A0F5FA3F6EAAD8BD10A7E0BF3AA547C925C008C06352A21680A90FC03905F03E62C01240707DA5694973FFBFFDC4ECB7E41D034053A51FF5B3D3E4BF0D79692E1ACC07C09ED87B25FA61E5BFE27B3D29F3A0F3BF9CC6AE7A60DEEF3FF1A6F990034B0740E892516CF4FBF43FE25DB61B0F9209C08366FC78847B05C03E060BB0DCF704408C015EAFE20DF1BF68250BBC05A90FC0F21EC01F414AF2BFE5A9F97E9A0F02C0FA47D4E1C2C50C40343F2805AC27F5BF1FCF7F5F8B4405C08F95993D140F02405479CCA9AADF0140332620E38B87C03FA698D4DDCE1F08401A149E33AC9B16402082F27CA73AE03F8405FB0604710E40F66E8CC5124806C0C3C2EFAF8D2E00C09C9E6B5F2EBED43F72CFEB0C72EA06C04C4E6D48955F0540BFA871FB2DFB0FC0E4758ECB760303C038065031F75906403FDB2849F14501C0625328522BC2064087D4D3362F9514C05A1AF2F45D97F93F828FBEF64D600C40D6097E7A3D828F3FBFACA97892DB0840B8F7889C61722040C350818AA18DE53F3C495F0993F5FDBFDC554E65D0080E4074CCC065220DD43FC8CFA60ACE9304C002AE80F7A34BFA3FD8D5420ACDADED3F7ABA68EB49B31540F7604CAF5CA4EABF187D945F87340B402AE74324315C08400498BF809E670A40A2043A71EF7903C0D7643171234FF53FB4406FB9707CFDBF04435FB4D8BD1C40868979379C60E23F4399985ABEB294BF1084A6FCB8DF01403010F7F2080818C06CA2E9A5EA8806409365E1B77F41E5BF2825844BE099FF3FE5E474B27C65ED3FC2E73A3B3BB29D3F3334A317EDB3B4BF948046EE39B1E1BF3034D5BCB69304C04818949E45FEFF3FC6A4DE2028290C407D25F2D5FD31F0BF0655C6A7226DFE3F04A8D4DD4C1F13C08F12B1C4C5B2F3BFA0837B1505E7EE3F8EF8B0EFAE202040C82A2A136D6724C0D83BC0DCF28CFFBFEB6CD25ED826FA3F330DFCD252D20C40CB7F550474420A4000F408E99BAAF43FB4D437244C8BFBBFCCB6164D96ACF63F6253490B7C06D9BF2AFE6C877C740940EC7F6CCB54FB0EC0AAD4812F1DB3F6BFC03A1376B06509406781DF90780616C079D342A349A6F1BFF8675412EC38FD3F8A211F298B5615400C6D8C81AEFFE0BFD6CF2B48980BE3BF282E2B7C687108401D8D38E47FD1F7BF6443866D1250FFBF920B501D4A70104058717B167B4EF73F0FDA6BA57E681BC06F91C0EC40B4C53F575E47D3F2BDC83F16A18C8C923A1240BECB80A60C4CA4BF7B8D95DE61A9024047CCAA0D8D5A0CC068CE585576382340805652D2346A05C0341EEB628CEE07C060896D503DFDF8BF23C94071FB9EFEBF3C8D3F481B620BC0EAECA19BA1C70B400D5782DA13550EC04FCB6E77C19B0AC01CCEC89C57F4F8BFEC3DF33084F709C01E75CE328A09F43FBF216B1254DFFFBF4E2814482047024028924205B336FEBF6FF012976D4FF6BFA740FCECBCB400406213DDF96F43E3BF5311D0352AEEE23FBCA46BE0712C14C07EA730454069FA3F1290A02DAF03F13FB350735133F003409C9D3363E41EEA3F34D9FE8A17330C401B8F4122522FFF3FF358B40000BB134018D26B08BA5CFDBF6FC9AF7793C3DEBFDBA21857FDC1EF3FDFA7EF2422BE0340FCA928D9B468DBBF68CCBD3DD001F7BFD0F4DA1A4A1DFFBF5EE44CC6D9570CC058F68E3429870040CFA3FB4FFB2FECBF680CA155F1D6EA3FB4BBA6FE3E6B0FC01475C9052A9C0E409C7FD9BF2D01DDBFCEB78C4507FDDB3F5A510019680A13405794F8249332F43FCEA468759EC510C0EE1D576EDCFDD9BF1657BBC734E6F1BF482404319F90EA3FCF6FD86F1F3B10C0D7D4D5024B920540F8111C98FCC0D0BF6B009169E027F43F265C97F4A5960840207FC18CED03FE3F5E6852B59F450CC080BF045F6B21D9BF8272778AE6BFFD3F1E9C4D893139F4BF545B391A0094E1BFA860150FCB74E7BF98238C082C89034000C3E703AEF4F4BF5870FF54824802C07B774D0EB72001C0E2ABE4A92FDAB13FC2CE1DA9741FE93F9CC525D8A88502C08D969EAC1FBD11C0A53BE781ADC7F6BF483CCCE04EC2124070A1054E5E420A408E7FC5A15F94CE3F3DFA6DCD1E8F03C08229D84A43A300C099E230B49BDCADBF6022F5F06C57F4BF675A553ABE9712C06043EDD6A68914C0E275759D7CF300C02CD5B5CFCB8AFABF40F196E9133212402DBF5463D38AF0BF7FB49DCCC53BEBBFFB148B98FB5F17C07731BD587BFDF23F5E6AD84893571140D6FB834D4AA3FE3F91E3146C9B78DDBFB87B44C6A987F7BF6B9697D7D16B0EC0B8684AD75F470AC0026C9605866E0F4090DB4320B045EC3F9422AB756A7F03407D647098236F0440AA62B0AA87D31640707DBC97849CD53F57BDAA43942B10C011F7857809630740486F2950F1F30840332A8234056B034078BBF6C8F85906C0D0D62B5DFBDA16C044FFB4B0D285F73FC80FD18D7636F53FD527BDB30C70F13F52071A46582214C0F09197BF4688CD3FC80BBCC19043EE3F8E7F64983C13FF3FFCC3A53A24DF094075A8CADBECF901406B3521B2326C1140CE1F8E90E073F0BF2E8A507108C0D6BF0F9D68ECCA3804409C358590BA30F1BFCB078C773F5CF8BFD87DE9A6D7AE0040EEF8E14736C5F53F87111A68B750F9BF9A296D24550E06C0EC9355C5304712C076930789269B0EC059837D13489CEABFD282AE5C0FC306C0062B9074F2DEDBBF384134BB84CF11C0FBD2B3E01AC916401A01A75AEB450CC08E63C3FC91A2D4BFFBAE2044AD68E2BF1A83360411E50DC04632860C330DF1BF04B2FAE5797D134055A90F92B3421640EBC3D0018FAFC23F3987C18658A408C0911BE76F8FF00740E2EB12DEFF9803401AEAC265B15217C08C8D687629E40DC06D96D63E013600C03C3B1DD127CFD7BF2809852B6B2712C012C107AE84F70E4028DBC14B018608C03B8F98EAFB2C16C07BB9ACD4FBFB17C0C8F36D50AB2C024096825DB8357B0DC0C061687BFC70F3BFDEAAC9A87D3DF13F4C6774568AB40A40F22BCE15325EE9BFCA93C5795D41FEBFBEBE1CC735BAD8BF882CDE937246FCBFEFB5023A4B751440167ED9CDC42EE5BF87C591F35237F43F06E5CB5E72AC0840CA8868EE9F52FEBF84451F2DBE2FF93F1B6FEDA55AB103408813C39BC090FCBF65B578C57708F6BF60CDB8B92FD918407B6F98386B8A0E402E2C177D9A03F23FAC5DE0901C660A4052FC8B57665BD93F7F75DB048BD4F33F794B2C352F8405405E6EF81E978904C0C5D9B1E516390C40C4D415B93DB9F6BF85A74BABB2440EC0248A613A5121E23F5A3EA417C86B0B406CCD9A7B9FF8933FFB10AEC47A8BF1BF36C3BE9BA644ABBF96444628D249C9BFD8D74C051B2E1140B1ABF39512791340C7AC1C4122CD0DC0F66B48ACE61E05404A42009C36B709C0E2D9A84148CD004086483B72770110C046BC27147817F0BF02224219B2FDE73F0493E7AD7A69054098FE89B313B5E6BF289933AC9D5311C0FD934BB9896FD0BFAC6FA90D637C054068F6F85F9F17DD3FFA60EA8D2E3A1AC08C34731D5779FBBFF23D0D845A600A407C52F86DA947FDBF9D560D04FB02E4BF686D6AB9841020407158665CCFC7F83FC17399757E1C17C08415FCB212CF1C40CA8115C9C83C1DC060D41B3493EC04C0E696C53A3F530B404FDBA590543214404E2FA79943361540C08E77473D0E05C073061DB47C24D73F65EA70BB37780240E032446EF476F2BF52DFBCB6987DF8BF7309B07DF23BD03FF70D22EDC789B8BFD73099F31EF0D4BFEEB9D015499D03C04301286D00F30D402CA92EC8521DBC3F9BFF39B43E00ED3F6CCB42FB897203C0CF1B78F5CDD1094029839E97FCEB10C0EBB959279220C73F4E45E9908EF91940A8BC71B5DA60F3BFAD73AFE23ED5EA3F14068E3F107BF93FFE6B51FECFA5E1BF466D18A3E56F0840AAB67A0A48B10DC05FE87453D1DAE1BF446A5A420FDEB13FBA3D040B2CD3E8BFDC059B5C0255F9BF4F45FFACFFC900C00CD65B8DBC77064014ACAC5F54C4034012869C00EF1AEB3F85BCE88FEB1BFABFF0A95C113918E83FA48176697184C43FD59458A7C7790EC0DEF3F01A806ED03FFC2A39A515290DC0E838D55FD86106C0184A96E351F4F8BFD84E8F67D991A93F9F33953116BCF7BF637A03113CC9B5BFDE359A5DCAA70A404CD4F5325C610EC0D4C1C2FF663DF63F4E0169559A4022C06AC904B975EF00C060F0B8E4386D0DC06AC452EE7B0CD2BFA0E8A2B6709BE33F4C14EB79F209FA3FD319D7DF75B72140DAEBA57C4A9F08C0B6D673876C55F53F64585C031AF41E403082E0B75DDACEBF10134147142906C04CAC1DD630E1DC3FA43CE6AEDCC30C4046BFCD74E1F502C0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE0E782D671A3124028A7160A830E4040416B9098BB4A44403B7D4F7228F73140DB1E90D19B981E40898A0DFE8F92F13F279E82DE62985F405324E92B3DB83540CF2906CF54EA4840440EF0E7B61CFA3F201B814382781940C80CDA64D708F33FB32FD363A2BEF03FAA360141974F0640C50BAA7B3F37F23FD74EBDD8471B2640A2F1093AFC2D3A40953D2E2167284B40C6EF22D04C1E0D401E096133630016408E76D17D9582F33F2D9800D34EA223407A14F435FAB4F33FBEB12266CAA0FD3FDD546126C19CF83FCA843E78EB702240EBF7D2FF7CD9FF3F53A6D30CB87B28405EE053FF40761D402BC72E3B26A51B403EE1EE2895FBF93F5941132B6C2C3A40DE5DB755A1A4FB3FFB9E09696D54134093B04DC202403240851AB08899120040D276AAC45EB01C40CDFE0D15305313403485361C74E41240121859503322F03F42D87E20EE72244049891D92EFCD614003D2971D281AF23FEFBA0FF4557A3640557B0CE2BF4320403030A72ED3C30E4072990D1106D9F03FE43E05EACB982140A93FC3AC07111D408C8C27C57B3E3B404E258E4B61B91540D0BA685F0268204051411045F48E1140998A5AE1A4412140D966C78740765540D07FA3E7FE9B04407E4967A48C5E31407A32451A7C00F03FA4384F2A43672640E9D98069501E9D401B40F572BEC4F33F867800B9C7A10A40BA3FDD942B5D3540A949D75CADCAF03F1A6F4A8956571A40147286C82C770540B0865A59A263F73FDFF5D23622615C403A9BEC0584DFF53FFAC49A8753042E40A8788C1DD60E254012819CB2672A2B4097349F1013FF1640A2B7DA522D350040283561206BE409407B12D23C0EA084409A930AED39B6F23FA4AF2337D600F03F837A772B95E41240DBA0468CBF696940F0B47290B0C820409C958E1257A9F33F90EDC67728620D40CB0D6B5D503DF73FCE33AAF6B801F03F7E2389BA660DF03F047014162582F23F7F5734B20A571A400980F500D8150E40BDC614559CE83040D8EC253DAEEBF83FE9E75AA087620B40C66C0D4089CB4D4051E7E6BCA3BCFD3F894DC73D0A0FF83FB9CC5E32E7D298409CA9D0F34953CA404A7B2FFD594B0D40C2478B8B9649054037AD15ABB65C3240DE024A61AEAD2A40E2115A6F134FFF3F09692E8B461607408CE662CE84780140E35E17CC243DF13F27B22EE32A222840FBBDA21F010C384018C39F38DC7E014079DE74FAD7F52740432FEAD1E8C75E40DC071A253BC3FA3F27C9E5E5657D0940AF92298A10EC5940342B6A44A24FF23FC049EF661DEBF23FED1F4E6BB8462540EF148AC089A002400CC0DE23F4E00C40190ED86E9C783E4071AE830335190240C91747A0848E7D4040033659063BF03F16F4ED60C24CF03F03EBD452E8D447409619C30C3803F03FDCAA223C3FCE144047511480185231402C5F3B2AA822BD40164C09475C371D40FE61655E1FF72340834A52ECB9E8034052B2B217A5B40B4089F33153E0B02E40AC6D4DB8AC1F30409B2A7197722C3640A8E8D8DD3CDD2B40BE11F3B099DE034068D7566400B9294036EBB2884946FE3FC444173EF9DD0D40ABA6CE6983D91340419E944C0A0A0B401154FC8A3C1F0140591C1D77AE631040005C5408D8FCF23F56D2B1A9DCE1F23F129973F718605340C1CDF3A72E9C0540413378038DEEF93FE68C6A08DB571840EE372CD30CA2F53FF3E01AB19FFD30401F677EBF63A80C40CD1AACC3FA57514080CBEE7FCEB309403C0F099E64E2F13FF6C7A2A0338CF83F2CED90B86CC3174045F4563F677DF13F54F80D4D39CC01409E7E8CC872890C406AE6214E434C31405AF89D092A0A104088E95E10819EF63FAB13155732F7F53F36900897796539405ED08EC9BCF436401C18B1E5E1ABF13F7333750CF58DF13F149F1ED980314D406381E4B49788FE3F8C0A630D118F40404B4D6D767356F13FA5A748A9C519FB3F7605F7E854D6F53FD120AAC326EE3C40135D2460D2C91D404074C32C268DF03FD52EC71A3B77FE3F58ABA7A13AAA2540F1317F329CB80A404B9C00CC17253140CDFFD8AFD93FF13FEECC0C35264D0A4093F5AF505C93FE3FE60C8E83AD79F23FD27887B38C7EF43F7CAF73645E2A1740F4629CBDFACCFF3FEE3B4929E0DC13401F43C24C22401140DE1DDCAAF609F03FEB28CC7E8030F53F99897CA3E17314406031BEB8A0154540A4A4550AEA920140EC3B98697A354B40DBC5F12D66AD2A406A9427257275F03F2E4BC0085C3B174058314B991D411040448B35F4F706F03F7B520A34CEC4FE3FA5A89CDCEC194A40298FEE90B93855400496B9B755E2104021203ED274C60540A53D457684A2474085B669AF4457F93FD35B913A0B27F63FCE80F5AA16916540589139C4FEA7FC3F2E1E5D9730184340B1FFD877CABB0B40270C727800BAF13F56253A30AE53024084E8A0ECC46B36403D9698E010BE2A4022275430E16F394065731DA65EA9F63F42AE22079C0E174032E491C015E11940EBBC386F76CD62402361A1F4C0EBF03F926A97A5A57E3C40423182B04BA82240C0A27627A5AB2640889F918A02D51640633B2E9D056820400D91295B9EF0624044B4D5D6C85102401A24A57B831F004024A10B241B7BFA3FC3A9E04F6B2F5340F9E9CE18816DF03FA2BDD3E47BB4F73F8BA3057742780C4021713A80546B29403DCDAF35752113406221CC5A997B4340662669562F3BF93F985EA34A8505F13FA128E265B43519407D9CB4E56728FA3F3A1F40052D350340AC31FB67FC5710405DE315BFEF9E0040B43A4C8EE848044019CBA2D9C6A11F40E7C8788B882048408ECB4C14D5F1364087BA8A9BC0DBF53F15C0B0918D4321406EA83AF7918AF13FB26A850970774540C0617E51B59C624056FF68A6B92531408A5E1ED3C0D6F03FF42415A1ACB8F23F38A17AB9A3FE344040E41275B4FAF93F005B7BC319555040023A3845A4526040C8BF63EBB82BF03F8C19421F4ACF2540CA6ACFED1EFC2340B580C375B05717401FFCBEE7E5496540BDBC88DF44FC34401D3BB5EC8BDF0E40846F161DB91EF13FC2B55D5AE0634740A6D0485390003840965CA448887D2540C387E508E9F55F40EFE42615A21D6940E6EE941DA399134005C2338635F0334036FB34778E56FD3F992D0FC2F138FA3F5204157BDD332C40501E980EE64BF53F5C29910F481B0B4091455E398B35F13FACEE9E6FD91908402F675EDACACD54400D566E38AAA2F33F2804C32C5190FE3F8C4CF53D53E52540968A71FE47370B4013B50829A9220440578169E91F9E174021A95054738408400C3869C6C0DC004026136D23F62B6F40C367BDE615C236401329B1CD2342FB3FD05641354D252B40C3FD6294B745F13F3B4AEBBFCDF1FD3F2144E8ADF1951D401876EAD02D361A4028BD36AA5B0A3140A5C698D8D2840140204A1D8246FF354098F041D82DA3F23F6D9B678E00D62E407F242F6EC700F03F435BC8C16E9FFA3FE40A1A75CF05F03F66A7F0B03250F03FA8BA476540564240518EB53F294350406F7620E044C034409F0A03A8ED2B1C40C9AB997F15EE28409D19BF1FBF9410409E4157A8EB583B40F176AE9E24CCF83F5FEEAB5413B6F43FCF008A00BB341D40C2A42C584033F43FA4ABF4FD54054340B954925ACF87F03FDE0DEB496D791D40E6A0017984AEF13F93B320613C0076401667C7CD06FE06402E4A450FD8112B404B30A260BC93094086DD936F603BF33F24056467660D98403C14624247AC0340599CBFADF23064402956EAD4A1F984406FD89C14E258874097E934C1A97E1B4085EDC86C32782E40DF03BA89AF7C53406F7A2F07261E594076210A6716F21B409DE3730DB80EF13FEDF701D94A521440022E45B307E4FB3F76E98569BC59034052033C717B84F03FD75D90ADD412F03FEA19FE5229DDF03F75AE07F0056417409B37711A4B23354072E369C7B918F03FD0218C3A7108F73F674FDC012DEA16400BBE67DA38412940CF23E7ADD63041402FAD296A0A43F03F0139FDEBC4A7744005B0511ED23DFD3F110BFE0C66F6F53FF011D9D5857A04403BFE39BBD47EF23FF1181E85B84225406084C2A1987834409D5E99624C8EF23FC0129EFEFA09F03F6FE3ED989E0FF53FA8ABB09CE94D0440B3AD19C3258E1040448AACBA0DA52040C78D736598D51740AC48C2DB5D17F63FD4686A35233C0540EA391D6101C1F43FB81CBCA5BB34F03F0248B536FD923640FB925B1DBE87F03FFE20BA16D62733408F3FA84B147820400E6E672F93DE03401E1FB1E41B05F03F30F95032178A02404CEB1D5BD70EF03FA2A5CEA12B072C4013FD2D1A8F4E36406EB3625F390E014073A53B5368F4B1405AF57F1416DA1040490EC6B482CD334015C8FE19F6A3F03FED8DD4F43D19F33F68632F09182605409243E39AAA78AB408866958195C12540EF20DC27B83A00409F658FBF81ED914018F3D9CB9077F03F8054164CB005204090B4083824A8F13FB414A8CBAF3B3240326D09373F951540"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
