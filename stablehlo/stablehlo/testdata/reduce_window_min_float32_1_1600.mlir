// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<1x8xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<1x1600xf32>
    %1 = call @expected() : () -> tensor<1x8xf32>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %2 = "stablehlo.reduce_window"(%0, %cst) <{window_dimensions = array<i64: 1, 401>, window_strides = array<i64: 1, 160>}> ({
    ^bb0(%arg0: tensor<f32>, %arg1: tensor<f32>):
      %3 = stablehlo.minimum %arg0, %arg1 : tensor<f32>
      stablehlo.return %3 : tensor<f32>
    }) : (tensor<1x1600xf32>, tensor<f32>) -> tensor<1x8xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<1x8xf32>, tensor<1x8xf32>) -> ()
    return %2 : tensor<1x8xf32>
  }
  func.func private @inputs() -> (tensor<1x1600xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x835F5E3F639CD2BEE29AFE3F75C46D409A361CC0F55D8F3E662E8ABF4878DABE41142FC08FE0A2C0C8C86EBE2BB690BFDFE08B3FB0DC3B40639BB0C0BE635640E1F904C0AE6561C0B9938EBF253EC6BE69C60F40CAB2DBBF6CCE1640538842403F34A13F758CE13FF1FD2B409A42C03D52F377C0E73B403FB8B20CBFDF1A67BF14CF72C0C72BF2BFF4649A401053A5BDAD2B6E3DFCA62DC015CECAC09E4B923F3E849ABF331F33C09FC1534030A2D03FD785053E365419C0CC22A83F42345EBDEF34CC3F4E5057405375333F38AA553F55229DBF6DF688C0387B73402B36DABF1ED906C0484DAA3FEE88F3BF58DB53BF52D76540A98B8FBFA88490407B504640F62231C0CD460B40431B26BE2F5E8B402106E8C0DA222740F763563FD590493FF8AAFE3DDB998E4036EFF73F939B4BC0D91080C0302A8EBD5FEE9A4086A232BF3624A1C0830F9DBE338C61401F5AC43F3AD9354085A5AE400E13804086AB9CBBE2601CC0EAA302C0A95F7DC0A07D9E3FBA5184C001E8C33D97FD1FBF506E813FABFF1ABFD2DE593F3CA528C0C2C3FD3E15B9813E0BF82AC090BF6640742887BDC0600D3F30410C41047715C0C41FAD3E3B2A98BE09B9D4403351D73F55911E40493DA6BE9E172A3E9DACA340E4B7AAC0A968AC3D8CF52E40E2833DC04A05A53DDF10A5C0B4644F3F879DCAC0FF1D77BE839D2C3F93D3603FB8E9B13F78AFB13D265F6D40A9691FC0AF613A3F99C98A40DCB2EB3FFB353840C9560BC0AA766E40054715C031002DC01BAD81BDFC428F402FBB9E40D1CD1B40CCCA203FD339B240B4CEE8BDBE3C37C0461A94BFE71009C0D50F48C00DB546C06E51693F73ACB9C05A6F3E40DBAB48C04D3B3B3FB7FC6540B719E9BF1AF84340463733C08C250E4015057BBF1BB0ADBF11E555C0C5DEE33E0601EAC0E7E9D9BFA5734DC07A7080C0853336C0EAA6713FEB7E92BF90E0CFBF79137DC0E4CE14400D4FF4BF433FBABF8FFF03C085D5413E7BE592BFB31400C18339053F33D8A14089736840BBF66BC0541C53BFD4D38BC07A813F3F43BEF13FACF705402BE3B8C071C9EB3EEBB513BF24CD19BE2EDAB94021C8B940CD6FBDC0358840BDB5ED90BEEE95D63F664D56407C0F49C0D97249C06B8CF4BF627AA340CE360EC0613F943FFC127B3D44D01A3F8D7F93BF2DB91240F5678F3FEB0FD93FAB641E40DE0317BF3DEC2EC02A4DA040F6AE1F3FD31B0F3F3399453E7CE50F3F4FBACCBEA612343F635485BF04AA844064CA00C191C29740950350C09CA40541CA108CBF9718EDC00D81CE3EFE41853FAEB49440BF38A9BF6A8519C0C973A440BC5E4FC056E3893DCFCA97C0339E5940534D3740AAE7053F1F1C45C06A177A3F9673A53E23E831C03A0156BDF3A95DC0201B16409B8FD43F04D98C4039D680C0B6A4A0BFD7429C3E6B2F30C013A37440A51E8B3F5BDFD1C0B8C9B8C035FA2A40FA1EE7BEFE954740CA7818406F0B2240E7B60A3EF15BF3BF5EDB0CBE15F4D03F671E44C002F889BF410ABD3F4F56FE3FB604A5404226F43EB285BA409D01A23EFCD242C074B1F03F2BB094C0D11B2D40987A0240E602A3BFA5C1153F79CEB43E6060A840210E46BF3FE0DC4036E979C0770BB73FCDE5FEBF6DC42340778D15C099C0DEBEC91B06C09D538DBF78186D3FD589F2BF9E62A7C02FA900C0EC6D14C03F4A493F045AA93FB9C5DDBCB84E66400D7BFFBF465CAB3F2FC2A2C0FC1CD7BF1124D33DCC5DEFBF4AC04D405FDE1840F4C86FC0985A9F3FAFA616C02F09DE3F45DBE0BE4FF72340C7D9E73F375151C008882CBE2A64F3BFD0D904C0835C5E40EAA00F414FEF4940E5930A40CB14FC3F1BD7FB3FB82BEEBF63E105C039A68CC032AC294061300E40464451C038AC28BD9DB9D9BF5828274030D33F4005DFB23C57F3C8C08F16A23F62D41840CB2753BDEF13B0C0F42C4DBFC7A63FBD80D413C012F77CC0510AE2BF65F13040E2DE29C00E55283F04FA563E73D4F73EDEED31C087C4A8404F1D2FC07CD3F53FE6401D3FB38C84C0B307363F738139C0CC9F6F406FA5C1BE0A2D45C07254B3C0BC8E42C0BFA220C0DFC4E93F606C79BF9460B93F2B0B9FC0B7405E40FB5C19C0922740C0541BCF3E7FCD934051F9D73F7DD52C40BDF680C0E0B5973F308F64409BC907C0D67AF03E6B51B1405DE21CC0EC68CE3E295FD5BE8C08A93FF1396EC08B50F1BF96CCF83FED7F5540B71A90BE34C924C018255440197B6EC03E0AFCBF58D6A43FCBA8DF40AA62A8BFA43BA73E76CAE4BD4FB5F94037931840C47EAEC00A2AA3BFBA918ABE21C703C04AF00240178A57C0F1656A4004911740F673533F8072DEBFFA076940664CFABF0D152D3F013EED3F0B22F64021BF3B40836173C07ED0F33FE12F873F75281EBF140229C00FB4F5BEF053B9BF38362340A0334ABF13643B40616274BE47AD0540754D9C3E7CE5CD3FB056DB40DD0518C09BEB85BFF0A58ABE8DE020BFB2B132C03AAE0B40FCB63B40A51B21C0D43D78C0F4CF9DC0FC4D19C004F279BD13F578BFBC24504029E7B73FC516353F5328A5403948B8BF03AA9CBF45908DBF31171EBFF4037ABF2C4E86402866653F6E3A11BE95AB3F3FCE8BD23E0F4F713F330D0B40236CA2C0C04F4A3F7F2510C0B898173E0C9500403669B6BF9F44083F070149BF4B08834007875640921905C107247F400715B1C0611484C088857B405B3AC2BDAABA163FD3186BC06081AA3F780DB5406EEAA23F74411F40E3C6DB3FB499BABF090FF93F6EEAF1BE34FE86C0D65C6240DBC984BE594C30404E43AAC08B60B24096F26C400C656D408A5D39C036243140CCE3E3BF493157BF813B303FF0F955BF6966E63FABB56D3FF66996BFE3DB32C07AE0F53FCA151540B0346C3F45D0443FECA9A840F51EA8BE1D6EC0BF386DBBC0D17FB43F944F77C035B22D40DAE1A140FB25E1C01423A33F50F228400B7B113F1E01D03EF5C11D4094BA5ABFF18C55C07F50F5BF0A4A093EF7B4D73F12C6D33FAAAD0A3FB8077240AB8A7D40956844BF80CCA74094DA5440495C89400C86C2C088F02BBF14EE81C04DEC11BF3CBF34BF185DEA3F05AFCE3FCFC3393FB89EF43F303EB1BFC935B840DF1CB3C0C3F60640C894863F5CE69D3F2339463E85F861C09AEAAE3E297B7DC025A442406DA249C0AE1E46402CF655BFA3AF51C073D61A40884A7C403F0F16BF552C773F0E288FC0ACF413C097C44D40F8C10640993FF1BE90712F3FFB0F11C0A7D50940E3A9A8BEDAC676C017864740B1A667C0E8986B3F29693240A3FA8C3E88B5B1C00ACA473F07DC73BE0FEC99BEB28753C0D44AC93FD9D0B3C043DE0B406735AB3F14E044BF43E0A5402412F73FED477EBF0257074181DE12C0419DD9BC63ED2C3F025FCCBF36432940804EEEBFF7165A40C42229C046F6BFBFE970BDBE3E1F9140C7DC30404E5E8ABF08E565C0BB7D114009A70540DDC8B7BFA82D1040191996C039D44340C6A3BE3F111C63BF7FD5564082F2A03D879146BF3D77CABFB32E263EC8512E4023C944C04046CCBE10F29F3EDB691BC0E683853F203C8E403367BB3F65CD01C0758CBA3F782BC04063149E3FA7E2A3BF934A8FBFCB14594048E73641370F4BC05164E9BFA23DD1BF59D595C072E6C6C0CBA00F40A1B7DC4014367240219F1FC0B38916C0F94B09C0CD7334C0888906C0B78BBF3E024DC3BF84288BC051A99E40F9EB0CC197113C4092BCDF3FDB0344403ADF7240BA0F42400E34E3BFDD061DBF6FC18E403DFB5EC0ED01E4C0CA35FF40D7CCD7BEB71936C07F8F17C04BF9764030A98DC02C142D3FB1974D3FB9EC80404942C4BED2CFB1C077F74ABFC6F85A4016B30B3E2DBEB34090876940EAA7B13EED490C3F266BA2C02E06EF3F1B9CF73FA8BFF6406301F8408B714E3DA758B3C0596E5CBF146DF63FB3D2FDC0F9821140A0627CC01D3ADAC0585145C082A951C07AF2113EA22829BEB3D823C1F7305EC0A0715A40E61EA340E575143F1A49FBBF2C68193FDD9D08410612663F9D7389BF4FC45B4041CF0DC0E056613FF81470402CE7814041210ABFB5BE95C0BC279940259F8140E1A0D6C078F14A4017F44940DCCF01C0EE3280C0988803C0329C274019F2AB3E170D5740A07FA6C030756BC0388BCCBD74A7F33FE4228140FBCA31BF78BD223EF10A623FF6E144C0F884CCBFCDD286BF751FB63FB567B4BF679A123D98DC72BD59B996C0BF5AAD40FA1C404058E9B5C0B80CBFBF54B54FC0003F91BF95EF8E3F37131CC05A44A43FBBFF27BE616A8640054E6EBF4CE41EC07537BF408CFF07BFB53ED33E25ACE9405A33C3BFAB5F7EC0135246BF3F438BC0975F23C073DC09C052322B3E35332940C4DC27C09D2E2040554CC0BE5BCFE0BBC9670CC0BD3D18C00B8FA2BE1F5D7F40F59095C0479B393F26264B40C1B5CEBF4A54A0C0D7C80BBF23700FC0CD982940AC19A7408F011E409558BABF995253406706A2C0B1C411BF1BEFDD3E16C9BF3E96A186BF77D19F40B080743FB1B3A93F4E17B63F7DB8CFBF880CA0C0D22DB3BFA84BB13EEC06E6BFA9405C40E5A116C090AC45404366D33F06898BBF187294C0841E8DBF71A74BBD0A522B4059C950C0BD136FBF5210B5C05C87C5BF28429E40FF7192401FB9973FCC2D4CC0F9712FBE2BFC4C4079FB7CBE2F4DA03CCB6D553F8BAE2D40E5E32EC0F2E26D408747064043EA8F401A1CB93FCDF196403ED59540AC470140306DE4BFF221993F6FBB8CC09370EBBFC940333F1839E93FC74C49C0037E50409B28D2402E09154088CAEDC0E2AEF5BFA0BCC6C077F249407404C13E56742440429B1E40C24619BF6F691AC0E2A10D3F6C6C82C08AF360C04FEA5140FC24D1BF9608083F473D2CC0C9FBAB3F90800640C2F0BBBF3A934C40B6E3AAC05A14D3C092FA853F1FF613C0D9043740DF4417C08E1124403C837040180DFABE1ADAEEC04F45473F60C5EBBF5241BBBFDF6BA63F94542C407E7EEABFA32A0FBFFF243A40BE7D49BF0FFE2C4002D8AA3F18D9B33FDF3605C054746AC0BDC1933FAE0C2CC02A7C86BE4B8B2A409218334020C6D040E0793F4083E4EB3EE60221C029662C40146A1EBF7EA33EC0203B0B4067534840EE22983E564A7B40BEF66D3E1AA49DC084D7C2BE6ECF6A3FFDFD5BBE940685401CA9F6BDA51A6FC012EB0B4074FD86403B11A340522D43C0491C3CC0D7B96C40E58B654082C2C8407D54CEBFB0CECABFC999913EA4AEA83E0F304F4076C3C73DA2FE3040E72F6E3E78C1EE3FF22422BF73449D3F99E096C00E56DEBFCE83B2BFAA19E9BF2FCBA6BFA5A7FA3FA93639C0E80188BE635F96C0D04A9EC0ADD248BFB70BE83C1281E8BF7A2FBF40676DAFC0BE4BA13EC3EE5EC059820940D0CFB83F46E32740C8955CC060CD99BF8DE2B0BFF8061A40EB5C2EC057BE4DC0FDAD8FC006995440BB26B9409B088FBF1211134072FC5E40C896D33E7B2AD1BF313A62BF8EF6CBC0EC2A49C076127D40CDB98A3F4CBC1AC0C4C867C0893270C0E66441C0864327C072422340C786EB3FB1CC263F65D24A40B35A4EC01112F2BFFE94D13FF86B6A403888B8BFE0EE0EC03C306340BD977A4064EF8BC0D27179C05F3E91C08D5AFB3DE017B5C0CBD017C03C058BBE04F0B2401B50C8BF5F9603C16EC592BFA41E8B3F4C94593EFEE9C2BF5059973FBD0062C08560F13FB8AEDB3FD90DBB4002EA29C03418074030011340BBD52F41F6BD2940E4ED42C0814255C04F1075BEEEA09BBFBA8DF33E48BE3A40CDB9A43E0AEBE0406217DD3E369C9B40C4B11E406A3922C09713493ECEBA493F31A8FDBFDD5B34401D114340BACF2CBF8AE9053C27ED7BC01DAC8E3F08A20F40B0F359C000AF79C002C317BFF4528E3FD3F317406F9099C0B49A1CC0E046B9C0E99092C0B36BDDBF8A23B840901E46C018B193C01D0A04C0F8C6ADBFDB93AD40859CCA3FC5FF054057A4A4BF3C960840BDE8714010D6F2C070CD8DBE8AF3DB3FF695C73FC986E53FB0705E40DB7E9140BC71FC3F2408A14076E1BCBFC9F7DF3F2FF516C0A1C49BC0382888C0D0C7083F119219BF354818BFA394DD40917CFB3E6216C2BE0E5D04BFC4F0AF3DBBB9A9404F923840BDF7BF401287AF3F261008C09C929E3FEA29C0C097B084C0A2F95E3FE14E3FBF9A275840674A2E4092FB833F9C0F5C40F616E7BF038B91C0B2012CC01DB954C0C59DA6402D64334041736BBF83C078C0781EA0C09580D83FC66D803F21038B40AD88C73F2352663F23548F3FD1ED403F422963402CE98A40D54D23BE1D22C1C06CEF45BEC53B8A3F0ACE12404B27EF3E471501BF71A8C0BE4E0B023D411C873FA46336BEC77E853FD8450240254B8F40DF02893E372328BDC1FE2DC040C7AD3F1E63013FEF01F9BFF2938F3E39CF42402D6D6B3FEDF863BF7C7A14C0BB632CC0F20792BF963808C0774549407326C13FB96080BF24DD17405561BA3F7F4A28C05CDBE5BFDD171D40F04981C01F63B03FECE3F73FA78985404C2D10C03DE1233D776715C06684D040BCA4D0BF468E573F0BA90CC0198253C010B4EF3F39E91A40409B95BFF783BF3F392900C03F8892C029E2B83E0B4127C059DA693F835D57C03417FB3FB7B46340F6D6DBBF87ED583DDB2C20BF2ABAB63F2B74514099931CBFA1E30140500E60BF750FF43F1A6744BF225E7D3F06AA60C0B1ACA1BDDC49E4C05D9680BF58BA6ABF8D2894BE8493943F750B5F3FFC933DC09F052840C742DF3F515635402B5A88C013449A3E2E4C21C002090A3FC32774C0587B93C00609F5BF6EB0923F52E3D0BFF8EC00409EC886BF49ED8DBEA3F1CB40E8AE423FCC997ABF25BE41C0A48D89BF23C4FEBF8611E93F3C1889BF6F827140AA8C9240D541953FB507A6BF10D4ED3E8395A7C0F12E83C0E02A4040007F06BFC0779DBFA0CD7B40DC554440D015554045C802C09BEB32BFA510D5BFB36179C032F01BC0041A3E407E12A940CC3C5B3F78642640106A8D40746C1A40FA44883F987C0DC032DA9F3FC346EEBF8986B73F651C773FE778533E251C79BF504F56C062DD4F400F4DD13F5B175DBE88A110C0AF622DC01A5B58C00ACC683E2D2C18BF151F103FCE3AC74042D775C0D2AA914099A107BF1BC067C085EF3DBF856F043F4596ABBE1D088C40A32FDDBFAF2C0EC03814CDC0DB41FC3FF17FE43F742441405B8014C038F5813F4CD98640301F8A400DCCDB3E57FF8040BDBA043E1D517DBE1C42A33FEF4D73BF4F8AA63F2096B0C04FBA36C0CA3CA0C0ADCDA0BFA4D471C03D529E406919C5BF9F2ABFBE0D9DD5BF05D323C0F99928C06F97CC3FB31D684075AC9E3FAA7CAC3F3A709E407BBF26403E2B68BF41146FC0BF547340DC0363BFE14A4F4060968A3F3AAED73FA0EDECBFF42904C02A5E6BBF8E5D2DC07B9EAF3F989AD5C0226106C0F62A0140957E70C04661F4BF9F523D409B2A7740966131BFE0334040A2BECC4023070940C459F8BF589F0AC06318AB400A9DF4BEE88FA03FE54F36C01D4467C078F393BF6C18D23E0BEDE6BF55F320C0400A2F3F57DA28C0534018C01422A24011B0893F7B20553D771FE740088BCD3F3D1D5ABFE72729C0E25695BF687863BF516BA9407BF06DBFCF1C7640E16A823E506F80C04BE149BF5965E3C0CF03844090110641694DA53F886AEF4055598D4070F3B83F4E0886BF9DFA54C0242BC73F94F5553FF3AD51C048DFABC0349191C028550DC0305C95C06CFE3ABFD394B83FCBA995BD616E913F6CA386C0348B1340B979D83F00AE4EBEE4D67FC01163F6BE5BF8B2BF744BF13E950C4940302F0440CCD4513F4A41B140290B99C00FD08DBEFC9D5E3F883616BECB5EC43E7BAD9C3FE0061E3FBAF735C0397937C04B5ACF3F65765A3F880042C07E9FF83E4498A13F18625E40DEDA5B407C4844BDD7ED8B3E7ABA1FC0824503BF6743884004E58FBD9E8617BF68233CBF4AF6ADBF56597D3E5A71B93FC82C8AC0483136C0A716543F86A8B440C95E1CC0510FC6BFFE4690C01484A3409D4549C09B4AD6BF6A9583401C3CA4BFDC5E14C067C24EC03E77EC3F7C722B4012F2343F075C0BC0B4653DC05C1D593F21B1333FA40B9C3D9E5B4640C62C1040194F6CC0A026D13F6ADF20C028C0AC3D23582C3E8E9B313FB46D06C048E328C0C8BC6DBE4E0FC6C0502395C03D9F47BE9AE224C044E2C83F4014A8BF376B0840C4F3DBBD1FFDD73F673C9C40C5F0B8C0FF5E08BF584E51C09635283EB64035C00DEF033F587C80BC85AD85BF7317323E11BC80BFA913103E0FA3B5BEA94CC8BD1EB996BFC34BBD3E3A902F3F7A4567400EBF8140650FCAC0DFFAF3BF432583BFF2579EC04B3283BED05B37401FFD933F44E497C0DFD95340CE6EA6408209D9C016AAD7BF08D75BC094A89C3E520ACB40194774409A4BD33F6BA26BBE1008BA3F64720D40E80DAB3D0C257A3FC8004D3FB21C5A40C159B43F484740C03F16DA3FF33B633FC29C013F9E54DD3C34DF233F9CA08040309F3D403072573FDA201C4030E7B8BED23649BE64991ABF2899523E35C3D3BFA990D33FC52D82BFAD3280C016C47D40289F7B4020F393C0A2030840B6FD48BE2687B9C0031589BFF1F28DBFA73503C008C1B3C0D84051BF0CAD973EACF6614079C11E40E500EABFD4154FC08CF9CE3EDEA2963E75CD473FCAB43EC04CCF04C0C8D64A4088C39EBF0AA757BFFAA72940E76725C096CF0F40550C4940229CA03F14597AC08D71C3BF5DC6A3BDDEE4B03E0D4D85C0803100C0D1C18440E5AAEB3F9DB81EC045A8BC3F2984E9C0677EADBF134FB0BECEFD063FC0BDA6C096F190403FE7B43C9EA7B9BE866C10403BF4BD3F168115409F1C0F3F898F9F3E44E1B13FC4097640828E8F403C6C553F0A02174020D5B33F6239B5408000A6C0C6779740C26C75C061916840BD3C18C0BFD526BF6BCA0240031720402CF10440237F4ABF336052C0CFAD1340B1A787C09FBAAD4022E24CBF873F24402C5E93BF5DE6AFC0048B833F2503BBC0EC7509C031792C40164C9BBE8776823F86F180C0EB53DFBF"> : tensor<1x1600xf32>
    return %cst : tensor<1x1600xf32>
  }
  func.func private @expected() -> (tensor<1x8xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<[[-8.04941177, -8.31874275, -10.2404051, -10.2404051, -10.2404051, -8.22421169, -8.22421169, -7.13401604]]> : tensor<1x8xf32>
    return %cst : tensor<1x8xf32>
  }
}
