// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.log %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB4413BD0E66302C07E9064DA69ABDA3F7F66A0056720F73F52F6E46CC62E0440F21156082A3800C0A841F17C935ACE3FCE009A95A8F305C099C4DCDC2D8DF83FB1E536F6EFB3FCBFCE57990B3E23F63FEA34446875AD12C0521FF649735202C045657DF9ECE3F2BF908EE8C445E1FDBF68DCE647DD2308402D79DD8BF6F403400F399F83FAEB01C0A376ABF1CB2CB03FE6272EBE345500C09ABCE4BE1A2B0DC091699A9F8E35B23F581059AA9C740140A47A669D1EF40AC01EE5852E7D96F53FF7590A3973950340F40E3F79A4EA11C0C8E7E127CD71F93F2E3D62E766250540828E77ACBABA07401366FA05DA2EF2BF9AFB45BEAF810A40B9B2C3267847F3BFD488DBEAED671A4020B5BB3C6939E93FB4EC41224E79FF3FF29AB6156AA40F40F5AA795E9FA6F03F8BBF2C2AEFD0F93F34192A4CE37CE23F6A93664BF596ECBF2A5EC0CA5D30CABFDD9A7FCBD68FA73F420E42495BD11040021D31D18D87FABFD4EF13FCE82E02403448D9A4E7EC10C05B523E113931F63F72FE5130BF86E63F772563F2CA47E6BF6B1DEA708D8EF1BF08B229197BDBD5BF3CD87953AE0DBA3FF800B206F7831040C950A7AB666C02C0B048510289670A40125046C1E4F7F9BFACABD49F048604C068CAE0380B81E3BF340BEFE0F65CE5BF2C52F3E1A7A702C00B7EF3F5A91C07404675229F3C5BEFBF1764DFE6DDFB10C0D091F5E86DEA09409CEB9C3E06BDF93F573E1F07FE5E0A4077DD9BEE8DB4D63FD30F9A1C13DE10C08CACAD12E57EDABF4AA97DEA2D790A4097AC2E658A8C06401975DC971F20FE3FB62B2B5C711BF9BF08433E51DDA5FDBF014CDFAAF215F5BF9AFC28BDA79C06409EF81F6CA0D800C086FC98E80A4211409AFE720EE1B0D03F54A6B4E7AD3200400415F435A3390AC0E53FB63AAF0B1240ABC79F9DDCF712C048795F6A6DCAB73FF4EAD6FEF238054052F3D00CFAA7FC3FB60FDFC0B1A206C0C03C91A359590FC003BFA83C6D76F7BFAABB97AF3FAE02C05A00C8FC414604C06C83BE8069D6EEBF48381F132171E7BF0A6EDF101EB2F33F34D10378B6F006C0F215F2CADD1BC8BF72349315EA79D5BF12D7ADBA275C1740221828A6276010403C73191E78A41540CCA8551A781B0740D3DD1114566B0CC0A4AF7FD5D014F8BF5CE41B9721CEAD3F4B9D11618AE8104003C9AFCC4723E9BF881D6EFD5B22E4BF6063FE316C550DC0E611E71E600EF73F654FB0B7A7880C40A05E4BAEDB67034062D5DDBF503CFF3F0CC018D5F8C00A407FE28D0677FC843FAE48AEFF6B68E23F7CFE97C5EE70F03F08506F39E6FDE33FFA8BAB530D8915408AFB0DD9692603C0BE5E78E04470F83F004C29A6A83B10C0C12CAD121F76054005648AB6B48508C0F24CABD29C6F00C08A34CEA526CCCBBF1EA96CBDF9F3F63FF6329F08EA45D93FEAF37E8AA1FDEEBF05424DCE2357E93F64F17B663C8701403A71EB78C5E706C098E779764CA3CA3F22F6401FA468F13F046037F8458CD63F74C88106634B0840FD9D94DA072AB53F739BA7E2B6DA06C008F6DA0402DFD8BFBE2CB04E641415C04D1A86C12612CBBFE21336E033F1F23FFBACE24EF40B15C0FC31B20B1CB5E03F6C780FB6B73EE6BF24AB6E9E5574114098FF39D4DC3AFFBF4EBC8C03EBC1DF3F9A9E4EA4CDB50640FD8366CEFE8EF1BFF453FF1C110C10409BF5F6B80635F03F80E09F405C21C2BFFCD39765D149F9BF2E940807036301C057AA96B3702F0A40F713F2DB0EA61040E7A4B4CFE7EEE2BF5BC92B70F26D15C02547832C0DE2B1BFF424E4005492194070B42AA5E47BF23F59F01F96D29FE8BFBAF5A07FD6AAF6BF343E352B3F99F3BF503010A4D3B1E7BF3CD8E38043960B40BA43B148239E06C06EBF8A3B976C1440099A8ABCF4ECF1BFC41F726F218EF93F36DF0708D420F1BF3BA0BC73578DE13F6223F966CC2F1640B6DAD2A7927D1140C28006DCC9831540C8D6C75CE59CF4BFBCBDF3B98FB8EB3F44AF67ADEE1FFE3FF955CE1F69F3F13FE11C5857497110409A8F5D887CC1F83FA61BA022AA59D63F908EDE704220DCBFE2B5629E3BC805C0A52208726B94B43FEBA82AC6EAB900C010B4A26B6B82ECBF2AEDFC7BCABCD9BF5063B990E6EFE1BF3A08D5DA3FEC13400EB4D51F4CEBF23F5CD71059FB3710C013E8E0982A6A1A40BA12D9B1C928084000457D1AEE1313406AF51AB49077FD3F5E511A4EEC12EA3F64EDEBE9FC0CE7BF3BBE024681B9C53FAFF1A1CE3925DDBF77F7B733C0FFF8BF3AFC5CFD40740140EF9E6D8D9318DC3FEC96B4454949FFBF853CFB835261F23F0026AB706B92F9BF2E838966F5680DC0CF4D74FCAFFE04C0BB2017A5AF3BF73FACD0FB3DD1910940DBCCCAEDDBDEF23F0EC9EE834D0B0640D301705D5E02084016DC1A5C4A57FA3FF10B0B42B27DDF3F96DF19D079F51440E27C78178869BEBFE87E0FCDB84408402A644CB044DE0240BB2FD6F2A8CF0740F54CFAF4ED9A11C0B6B94D367742DE3FA0D1250E54E0E83F174397282B17F6BFD8492DC7E01E194048B4E0779E72E1BFB5591668C216DBBF888426495B3908409C86846BB077F0BF6C2AC14D2C98F1BFF0F7FA06DCE111C0B178E1B44718F23FFE31E3102ACB084015958AC54DD703C0E20DBEB3B2350A40D449F49A1AFA1440386FF9FA57A80540A41C4C0B843CF5BF670319FDEB310340A87C17D574A2E63FE8CEE4FF1DF60440360C3522D0FFD8BF266DB15501B2F73F6AB9BAE39F8FFD3F4DF7C2C4950BF73F34545A1F48C803C09F864BD6AE9DFA3F3620B0E00D1917C086A93AD801A901C0C01F2E030427FC3F34BA8A441968C03FA6A907699F0FFBBFE8E8714C4DEF084071422AB83DD6004056DD531235CA0EC060CB50F9328911C0204093D34CB203C052A6DBF04F2CF13F445D87A9A002E7BF089D159634F317C0F854115E0FA716C0F8B790561AD90FC07A341FCEDFDAED3F8A5E99F5AD5601C0D3884104C0510F406974C85DB0D10CC04C96C5540225E13F04631B62AFE1FBBF417A311EA3EB02C06C2A7A74152AFF3FB4CC0E0F8ED00EC0676C69D72E3211408317FB8647610C4090A74E72610805409495F880359D01C011C1240894E2FABF258F3C803AE7E63F05F131E4657115C038481C102E2A03C0C5638280DE2F15400B90C78D6261CEBFC4D1FEEE954C01C070B4A93A7F0114401F892606CC73E2BF703EEB4B7F65F5BFF6D072FF934C08C0D425CE4E49E303C0AC9F8D520B2C0DC0C9A9D2CE1CB40740E2528A705AB1FDBF5AF13D58A605E0BFCCD69EADF4DB01C01BA11624B1D710408983732006121DC00644E838A8CA14C0CC9FD422B31108C0AEAF96C9A6C108407A3EFEE8FDFDED3FEC654E888899B93F2A738D69456D08C07A42BE3842F30B405223558E2EF5F43F8DFD1754887DF5BFACAEA9A6F7A711405C6D77005F4508C0C0C4CF657D7C1B40525EA80C1A61FCBF2CA1C313826CF0BF6A260F8D90B102C0063DE417DCD6E9BF4E0C4F9ADBF809C0BC75D894461D0E404DCF1F6C4B4D0CC0027F5F1B05330240C835FCA0D162F13F0362CCF377EAF33F3F4FA13EF2B4D4BF2E982E862A630B4074E9F443DB24F13FC06D271188460DC02A586E720972FB3F0A47E3278158D73F1FD565772B2311407E11C34F9E5CEABF4A490B2F56CBDA3F33C7B3BEB51FE73F88935E0750C7EFBF77EC71F20ED3D1BF088650DFD688BC3F4793904B24B701404588A7B184930B40242BB55F6C93D6BFD0BA03AD4C000C40DD07246FA253D93F6BD5E3C10D970740F6BE35D2545C0F40E6FD792BE15818402A5C5BE11BED0940CE0B52CBA91805409AEECF0A25DCF2BF619C31F05E090140C7E6A8F903FC184086751661605102C0D3904D939900F03F546DD029E845C13FF1F1FB439CCCF33F88E7590A8137DA3FA0220B928A6302C0D68C669CAB32E53F1CA57F9D44320EC0D53F728EE21206C09543DC49D9D10340EB1DDD144484F53F1AB13886D5FAE33FFE941106409409C0B6D7160E7419CD3F9D413836243AFBBFF09F9A39A0DF00C003B4A7AAA7EF15405C7771E12AF9D6BF9CF9704BF8E7E0BFC26C6F5EDAAAE3BFCF1B5DD3056801C05AC651F7F0D017C08102EF261DC009C030350C4963D70740A9902932F0DF0B40326CA3670763E6BFDEAA0D290927FBBF16D6529B2C050840BCA00C5C7C8CDC3F8AD4C3B35E541A40EED72C0992631BC0C4655D0B952BE23F2700559D8BAE13402C8377EF2285DD3F8047667C0748F8BF70D6F478AC87FBBFB059AF3968D972BF7C707B70C33D0C408F2C16E25AB6F9BF890EDC9860B8F43FE44F58B061B102404CEB4360638C0540EEE34705EBF70440035F2F1103B1FB3F9692A23DA3FF0C4031B4C025DCD40F40AE43865736FD0E4090258493584BFABFC8D0F59F69B30540208D9937A4C914C00E2BB9CBAF890AC031BE969059DAF0BFFB56A5A03339FFBFFFF340C2F4FF02C076041A1115F7EDBFAE5A802E37D00D40FDFC96E23523D73FAA7982E85FAF0B40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x000000000000F87FC60F319AF102ECBFD0572D7CC293D73F7D3DD608C19CED3F000000000000F87FFE29883C9606F7BF000000000000F87F302EB9975B67DB3F000000000000F87FD3B290EEBFC7D43F000000000000F87F000000000000F87F000000000000F87F000000000000F87FF189A689C1ABF13F10DAE4559340ED3F000000000000F87F1EF80D27FC1706C0000000000000F87F000000000000F87FE6DB144B602505C0AFDE1AA183F7E83F000000000000F87FE4A37B78B12BD33FD57AF394F9A5EC3F000000000000F87F7AC23756BDB0DD3F3C032224BD1AEF3FFEE1841C7965F13F000000000000F87F2907DD76CF2AF33F000000000000F87FA4BA63335D32FE3FCED526147A74CEBF5BBF108172A6E53FFA20E5033600F63F10D6F969536AA43F080433584B9EDE3FE8A861C9508EE1BF000000000000F87F000000000000F87FAB2D2EC32AA108C02F65D48A71FAF63F000000000000F87FDFFA174B1D46EA3F000000000000F87FD9CC02251EF0D43FEE58283A9A77D6BF000000000000F87F000000000000F87F000000000000F87F36AD9E8ABC4702C00825923925B0F63F000000000000F87F2ED1E68EFE1AF33F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F1AB6B0C57BF9F03F000000000000F87F000000000000F87FD279259D79CEF23FF643E3A8DC6CDE3F283EDF7FD015F33FB7DA66B39F94F0BF000000000000F87F000000000000F87F20F6420DAC25F33F0229A7667994F03FCE7D2972C13FE43F000000000000F87F000000000000F87F000000000000F87F923B0587E49FF03F000000000000F87F79A4EA5F4564F73F3ADE585E1881F5BF5A16F497FF92E63F000000000000F87F6CCA2FF7121BF83F000000000000F87F11F7B514CE0103C078FEAF194438EF3FA1AEC39121A6E23F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F5FAB0089B099CA3F000000000000F87F000000000000F87F000000000000F87FF7AA5B84553CFC3F2E7FA0284E8DF63FF5ECF8918803FB3FADEFCC02A8F8F03F000000000000F87F000000000000F87F6CFEBB3EC7BF06C070A187E17010F73F000000000000F87F000000000000F87F000000000000F87FEF81B6D1CB61D73F600765B5AB58F43F448ECFFB225BEC3F645247B93368E53F918D6E80D550F33F3C892A43B15212C0A9FAFCFAD0B1E1BFC6E60C2DD9D99B3F6DB15C56431BDEBF3DBCC4C836EFFA3F000000000000F87F9E7EE16FD21BDB3F000000000000F87F05EDA4FEFC93EF3F000000000000F87F000000000000F87F000000000000F87F851EC39C5918D73F13C109D988BBEDBF000000000000F87FBF651708F7DDCDBFACC4DDD39519E93F000000000000F87F39899656791DF9BF7417FD9E389AB53F9B838CA51BB1F0BF2ADCF633DEC5F13FCE4F505C64F103C0000000000000F87F000000000000F87F000000000000F87F000000000000F87FFA8A488C599BC53F000000000000F87F2137BD73D2CBE4BF000000000000F87FE3AD3130A292F73F000000000000F87FA1117382946CE6BFBF5A0610A6B1F03F000000000000F87F0B0B63914F3AF63F1F065B7BCD578A3F000000000000F87F000000000000F87F000000000000F87F2C07EA7EDCF8F23F760B7EBB0AD1F63F000000000000F87F000000000000F87F000000000000F87F664FB360D9AEFD3F22362193E578C23F000000000000F87F000000000000F87F000000000000F87F000000000000F87FEB21994072CEF33F000000000000F87F952448CC3816FA3F000000000000F87FE1578242D7F7DD3F000000000000F87F3126A88FCC37E3BF3FFD04964369FB3F453525EA179BF73FF5B8A42F4DEBFA3F000000000000F87FF0BB9071C55FC2BFF917597C8D3FE43FF5622A3FBC73BD3F58015F86029EF63F3CAB0D8125EFDB3F85A563A22DD5F0BF000000000000F87F000000000000F87FDDA6F572BD2A04C0000000000000F87F000000000000F87F000000000000F87F000000000000F87F90FE013B6DB0F93F074362D06B73C53F000000000000F87F66FAB924B833FE3F4A98C19A04AFF13FE05AE0C7E8FEF83FD6A6943AB98AE33F128CE42FE636CABF000000000000F87FD2299A479960FCBF000000000000F87F000000000000F87FD4D64C8FDBF6E83F88636A931C58EABF000000000000F87FF0AD9A9860C0C13F000000000000F87F000000000000F87F000000000000F87FC17C5D2F17DFD73FB533560F6697F23F1BCDD0FC281FC53F91441DB4BA37F03F7B5906A57E95F13F097C753A08E8DF3F978506E29CB1E6BFE53C15701380FA3F000000000000F87F98A0BEE779C1F13FD6E768C20C75EB3F85F794D18F73F13F000000000000F87FBA6B8C9C5EF8E7BFE5DC4D14D61DD0BF000000000000F87F44E172D5F765FD3F000000000000F87F000000000000F87F4DB569EDF9B9F13F000000000000F87F000000000000F87F000000000000F87F9C28D381707FBF3F316127EA2A19F23F000000000000F87F1144A9E8AEFCF23F9E877D849B83FA3F042EEF2C88DEEF3F000000000000F87F10E81F97B501EC3FC5C6D59F1029D6BF92866D8BDED2EE3F000000000000F87FB3A944A4D221D93FC7C5E134CFA4E33F2C3CDF6D0C5AD73F000000000000F87FAFCFD2951649E03F000000000000F87F000000000000F87FE5BD6749D714E23F47C46B1E4C6F00C0000000000000F87FE78D110F6C30F23F8D712DFFE9CFE73F000000000000F87F000000000000F87F000000000000F87FE4FABCF4021DB23F000000000000F87F000000000000F87F000000000000F87F000000000000F87FE78189D52BC3B1BF000000000000F87F1E98EC5F32D6F53F000000000000F87F2654095141F8E3BF000000000000F87F000000000000F87F02E9B2C08055E53F000000000000F87F8AFFEB7B8A55F73F90AAFA118842F43F8A249D09B4EEEE3F000000000000F87F000000000000F87FC9B98B29C167D5BF000000000000F87F000000000000F87FE060959A69ACFA3F000000000000F87F000000000000F87F6D65C98174C1F93F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F1C95415E0261F13F000000000000F87F000000000000F87F000000000000F87F274CA3657700F73F000000000000F87F000000000000F87F000000000000F87FC721F92E0613F23FE1D8ED2EBC96B0BF659C1E11B76B02C0000000000000F87FC2E48DA60704F43F3AB4EBF45B46D13F000000000000F87F9A0F7653B1C1F73F000000000000F87F4E7C59F499D6FE3F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F23ED72F67E35F53F000000000000F87F6DAB0711584DEA3F083318398C44B53F239C234AE005CC3F000000000000F87F547307EAB3B0F33F6F9F511AC6ADB13F000000000000F87F566EBA368044E13F702B2CCAB022F0BF2C754E508C47F73F000000000000F87F789243BBBADCEBBF2F33E520AECAD4BF000000000000F87F000000000000F87F663C8EAB708D01C077431E679470E93F36FB078EDACCF33F000000000000F87FAFAA0DFF7C0BF43F9D5A46442EAAEDBFA72EFFEA584DF13FE61EC44C99DBF53FC6FC6516E0E5FC3F30DF520921D0F23F85D26E597007EF3F000000000000F87F1E5334D68430E83F38FFF9EBB34FFD3F000000000000F87F8E6000930D32233FDC5776AFE60500C0835B28B06945CB3FD5F4BDC4368FECBF000000000000F87F5ED4E4EE755BDABF000000000000F87F000000000000F87FCD9190B01308ED3FEBBE6E5194F5D23F881428291425DEBF000000000000F87F6E844FFA73B3F7BF000000000000F87F000000000000F87F42370D5CBE3AFB3F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F1B93B853C078F13FEBE1EC7CF4F8F33F000000000000F87F000000000000F87F77B3C02D5D97F13F32688E1726D5E9BF819D48D07E26FE3F000000000000F87F92F24588441CE2BF2F6847F0917EF93F0A5DDC4713C3E8BF000000000000F87F000000000000F87F000000000000F87F92A34C96752EF43F000000000000F87F2775F4C69D8BD03F83DAA83A9128EB3F346F9A3E1FB5EF3F2A18883A9ED5EE3F00329C75998DE13FB57461EBD99AF43FE75D9B7AA218F63F6FAE25ABC7AAF53F000000000000F87FB53A82D4DEEEEF3F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87F000000000000F87FBF0C9CE6580CF53F41FD9F266147F0BFB459F602FCDCF33F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
