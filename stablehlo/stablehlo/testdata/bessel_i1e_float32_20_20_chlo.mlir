// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.bessel_i1e %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xEC9A26C057FBA7C08EDFF8BEAE2F414063D608403581ABBFF93A123F6D22F5BF93DA9840CD4C00C0BE46E8C015FBC8BE4E6F3A400BE1C0BFFC2345C03377DB3F2E3E38C020DD6F40ACCD913F79FAC8BF2E7504C0F9CF49BFD776D83F3B3AF63E6B6B1D408F0DEDBE22E09CC0226BB43F4D1DA2BF5D60EF3E062CA3401EC7F63F6FF9C33FD88CA94080B3A0400A9A8B3E11C776406438EBBEBE162FBD252F723C1E8B4740ACAF9440A176C6C0D49C0DC003F090402B94A3BEF33526400AB310BF1804893F3F943BC01F66A440478BA03FF8FA7E40BC7EACC0B462954082DD46402113CFC070D16AC0303240BF89B4E3BF68BF3240926939BF95D5533ED2B6FFBF30FC94BFCC7E063DD5EDF83F03BB6C4040C5CB40187405C0A177B3BF1A06D63D016B94C022E4EF3E432C7B3F6D0AA8BEFB1F7640203A3140379506C0569E6FBFEE41A440362B33C025A7FEBFE1B646BF562F4C3FD786A6BFC44C5A3F3354B23F6931B53F0B44DBBE01323640E91D3340D6F2CE3F2C99A73FBEF0F73FCC98443FB857ABBFA8BD0740FFB58BBED068BBC041B10CC00EC7AC3FF24708C06DDC274039470340565355BD49CF9BBF977EB6BF53F9ADBFCE6794C0F4DBDDBFFFDBCE40A2342140C92BC4BE2FF2B0C07DB67FBF91FE92BFEF9F8EBEF82CC9BF436138BF6634A8C098730B3F389D35403AD08CBE0949BB3E96B84FC02542C8BE1BBA17C063ED1A3F9C5C76BF87627740463D8BBE7B2346404B01D9BF4D1C47C0C04F04C068CF9540767053402D8A6B406FCC043F8DB79640CDE7574061D10BC06D7B47C0FD01B940653F8B3F6B6AE2BF7B9A2A3F2A18D8C0319F03C1B481144039F0A33FA6752940593848402B82ACBF8F130DC06C9BA7C0ACAFA73F80895E3E0986A3BF46CD72C0A84C2F405992A23F697C93404BBBEBBF12E7D5C07237A8BFEC099FBE6AC9F23EDF72123EAB24F34046CB7BC02B4749BF951D843FE645963FDD2D8FC084AEA240032FE940CE24463FBC1D9DC0F8A3B4C043A50C40B7CCB640A4E6C23F901D2CC00D0A1040EA001C4029FAA2BF2FFB5DBFBBCFCE3D6AF3CF3FDFBAC0BCD697E8BF4F1DA0C064579B3FA96D43C0EC6568BF448A883E8B54D7BF46B949402D8F3BC0E9BE33C0D2C1C63E84593CBFB44E8FBF22B3353FF116984083F0A7BED75FA2C05FF713BE56DB2FC07B6A2CBE3F76F740EBB38C401ADA41BEB53A0DBFDC911940942B16C0BCB707BF3293A0BFF9838840102CC23FF7775940249993BF22CD4A3E7CE13BC0ED45FDBFAFADB23F2DE2793F334560BFA0FD03C0D2DA1A3F31FD0540E2E4D2BFC1EC10C03CC690C09A9F4CC0FD9DE5BFC12DA4C00E1425405233C940418468BF549B3EBEA740D8409D632740994C1240E98B9C403F3F7440BB81A53FCABC28C0C6BBBABFD631D1401EB80940F8BFCEC0A7A8BF3F67F5A2BEBF16F73F71F4A9BE26803540D75619BFEE839DBF4639B73E5D7E04C0927646409C8EC13F613876C099FCD43FAAEFA9C04E70B83FD9D222C0F275C8BF8E299E4069DBCDBFA3F3823FDF880C40D293D6C09EAC4DC092FE3A40F1D7D63F550C39C0433E9CBF228E184190B67AC0C79929C034193D3E7CC9C4BFE958C4BFE5D681BEA2A18BBF9D031B3F3CE6F840C14C46C0D6DD85C0DC1F32C0AA6989BFC35025C0CA487BC027FE7EC09F02B13FF8F7CE3F366792C06E5498400FC72DBF1B3883400E61554014BB0CC0D9FA86C0D1F22F3F0769DD3F781475C07B7D27C026A62BC09284CA4019108F409391833F02790EC0B07A4A40F3DA8C3ED60E9440E55441C010F68DBDADF36D40CEAF5EBF05363D40809C52401AFEB0BE55DEB33F77FF4C40B04ED33F0A92EB3E07F4703F818FC23FBFB333C04DBB9A3F136D7CBFD86D1BC0563308BF86709B3FF7290B40D89E354078C8204024005BC06029D53F43D00B3F9B9672C0D529483FBE3E9DC070BD02404B6A3BC09DD10CC0F6CF7940D58C89C01A38803ED8306540E19A1A40771A9EC080B5DC3F9642A8BF17CB5640510E7D3F672B8740ABFBBA406A0EBB3EE7163640973E35C0D687BCBF6EF7A03FB8AF9A40D8205840F0D51F400A40733ECCC14B4031C8F3BFACD5BE40EF21BBBFBC2036BF41327C4049D2F5BEA9990F405CE9ECBF5176ECBE28B8DA3EAAB58F402E4C6B4065153B3E811E653D1A60E7C07181BC3FBC91154033A3004095D82F3FB57428C043818440E143B93F244068BE724B2ABE36A3B33F06ED24C013A4AA3E300305C0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x058051BE5D9E24BE66A11DBE972E493EB43E5A3E7A195FBEF9052C3ED29D5DBEB3012B3ECF5D5CBE09680FBE7E5C0ABE66494B3EC84F60BE33F547BE1CB25F3E16F94BBEBC653B3E94A75A3EA05560BE015E5BBEFE1D46BE47DB5F3E6FAA1C3EC254543EE93B19BE7C3E29BED2D45F3E9CEA5DBEAE1D1A3E5294263E8F725D3E5558603E24FE233E8F9C273EB98DD63DCC80393E3E8818BEEBCCA7BC1AA3EE3BBF37473E87E22C3E2E8619BE26F458BEE89E2E3E64BBF0BD719F513E90192BBE7523583ECDED4ABEBD12263E3BAC5D3E3B4F373EBED522BEE2902C3E246D473E21C116BE45CE3CBE9D8542BE1D285FBE79B24D3ED5C63FBEC92BAD3DF9775CBEFF6C5BBE172B823C8F385D3EF8443C3ED9CC173E2F1E5BBE11C55FBEC30C413DF2012DBE664F1A3E8EE8533E3153F5BD1FAE393EB52C4E3EB2D45ABEE94C51BE9E21263E9F904DBE04975CBEE3FE44BE00F4463E65875EBE19894B3EE9B05F3EF2E05F3E3A2F12BE6F9D4C3ECD944D3E9E39603E87A95E3E68535D3E8F35443E34155FBE30885A3EC3ADD6BDFE4C1DBE183559BEDA395F3E1B645ABED51B513E61A85B3E7B91CABC30DA5CBEE4F35FBE86565FBE69032DBEAE8D5FBE69D2163E192C533E903308BE832021BEC3D754BE9AF35ABE67FFD9BD1B5560BED0573FBE7C8724BE6ED6273E1DCC4C3E6DF0D7BD4B18043E61B944BE260A0ABE180B56BE5109313E12DD52BEB656393E4D23D6BD6CA6473E3FD45FBED15947BE4C675BBE815F2C3EC79A433E5E9A3C3EB87A233E84F62B3ED745423E4A7259BE933C47BE0D281E3E80D5583EFA3F5FBE4722393E670014BEE9A807BEC4FD563EA92E5E3E0E9C503E8B02473E28335FBE101A59BEE2C424BE42AC5E3EE220B43D971F5EBE5F963ABE9FC74E3E1AFC5D3E916F2D3E2A825EBE3FA814BE88BC5EBE96F8EBBD04651B3EF9837E3D158B0C3E972738BE17ED45BE8377563EDDB75B3E50732FBE6CC8263E2D290F3E09C9443EE22329BE1DBF1FBE6338593E6FF41E3E4A56603E44C74FBE5346583EC1C2543E610B5EBE41A04CBE772F3B3D7232603EFA423CBC7AC65EBEF2DB27BE89C35C3EAA7C48BE317E4FBEA305D33D79E95FBE8A8C463E64EF4ABE3F624DBE3E5E093EC1FC40BED1FF59BE7D323E3ED7582B3EC238F5BD25E926BE946480BDD69A4EBEFA3692BD66730B3ECDA2303E6323A1BDB2F528BE637E553EF58056BE496C25BE81AD5DBED1AF323E5954603E68CF413E28195BBE592EA73DACD54ABEDDBE5CBE3FB75F3E4EA2533E86484DBE9F7B5BBE08FF303E79FB5A3E841960BE090658BE82B22EBEF1A945BE3D035FBEEC2926BE8AF9513ECDA0183E17864FBE86EB9EBD62F4133E7F41513E68A1573EEF62293E12313A3E81655E3ECDD550BEC52560BE1E18163EEB025A3E37DB16BE274A603E3D16F0BD436A5D3EFB44F7BD3DD54C3E602630BEC3295DBEA02A023EBA5B5BBED38C473E5A52603E81A739BE6204603EF3D623BEFA0C603E58AC52BED05660BEB1B0283EA64060BE0F0A563E2C40593E587414BE265845BE971C4B3E58EF5F3E82B84BBED5EE5CBE23D0FD3D807138BEC49050BE53E29D3D425960BED45860BE1823CBBD13F358BEA215313EB7170B3EB49947BEBF0334BE90E44DBEDC4358BEB0E651BE674A38BE624E37BECE975F3E7D39603ECEEF2DBE673D2B3EDFA23ABE975D353E3D06433E663259BE237433BE75A33B3EC0945F3EE4F639BE6E3951BEACEC4FBEBF33183E71812F3E7444563EF3B658BE5F51463EA8FCD73D352C2D3E072349BEA48804BDB3ED3B3E8BD44CBE596B4A3E62DA433EB349FEBDD5CB5F3EC98C453E8F15603EAFAA183E869E513E7155603EC0654DBE8BA55C3ED72B54BE35EF54BE5CBD25BE51C85C3EB49F593E9DCB4C3E5D4D533ECC5B41BE7B02603E4911283E60A53ABE4486453EA31529BEDCC95B3EEAFA4ABE362C59BE4EAF383EB32C32BEAC32C93DE5663E3ECF2E553E2CB728BE949F5F3EDABD5EBE629A423E4E4D543EC95B333EA3731D3EAFFC033EF1A54C3ED0E94CBEA43560BE5DBD5D3E8E322A3EEC34423ED497533E512CC13D84ED453EB6C05DBE411A1C3E902960BED9613EBE270C383E47841CBE0A66583E69675EBE250219BE98F5113EF7322F3EC5AB3C3ECE7E9C3D4DBDD83CC5A60FBE7235603E30AE563EB9495C3E78973B3E50EC50BEDCB4343E8016603E5C50BABDEDB390BDF2C75F3EA60552BE71F6F73D8F3A5BBE"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
