// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.atan %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x94C28741F3C626C2284293AD0A46003BA8C063C03AC140C0F3B28B347E40F8C0B24404C4D24175BB58C1A0BA18C1A64230341946AF441844F6B6A7C0BB3C253F0BBB55B7ADC054BD39BBBBAE08BE7EB70B2B37446EC31044BC424FC28F34F89F80421F43963B02C0B0C4FF3827431F4204B2CEBEF13FA24007B8D3C011430B4415398B21D7C3CF3F04C7AB40B63C1DB41146DC40603C6E46F344FD435B3B493BD33D7D42F0BC3C3FC8AF7443D341A739AAB9D23BDFB256BD033799366E3BE9309D45EB438FBE2FC7ED43D5BA6744E2C11941143F7235E8C63BB85445573C4E4307BECA348A4547477DC2D93F753E3F44A540FD41ABC253C46FC4E247BE45C5B8B4B6E3467D3627BC45BC81BD8EC0AB42BDC0AFC0BAB0CEB99444C5B73C4127BAA3C54C39803CAA31AABDEDBA2B39DCC4703F2DBE464106C5283D24C555C2A6C6FFC02F3B2A3E23BE24BF9D409F3D78C0B94285BA62BDC1B356C3E1B4A8BB10454CBDBD41563C94417ABDE6320144C041A63D9CC3E69CDD445CBD5C394DC3C4438BA6444110442046F4BD74AC55B8E7C2033E774476C16F398541A6B9BBBB9F42E9B279408C3B04C855B9CA3C93B2183FC83E56C317414D4063C45837644198BDE0BDB944B9B88641B9BDF244693C0C3DB54232C3B6BCFC3F63C6B4C379C150C08B3F673B3E44433C47C4B5B5D13EBEAEE01A4C3E233C26BB54C474C0182935448FC38ABA5243F4B9413CB9C281C85C444A44D6B2E8BC403225C17D4657C22BC0BDC0B3B731C327AC6FB9F138A7C33043EBC5D1C4DA4264C83ABC1E34F4BB5742F73BFF446D403DBC45BD2EC0704004C5DCC4F0C1FC395241D9BC3E429B48E4C4783B30C2A14374BB6FC352C5CD3D72AF3EC6FDBED7BDB6BE493D98C4CAC1EA392821C540763F093CC4C4FD40FCBCE5C510A83BBC6E4154B68F33A34648C1A1BDCCADDABD87BE39B8A2C105C209C27CC2C4BD853CC32E84C9C4B7B5C38B450D36D539393E923FC9BE6144144249C3A7C6B3BE9BC0BB45AFBDF8BE8CBB55B74EC1FE45BD445C460EC1053CAD3961C06BC0BFC7BFBDFDBF0C42A34015B838B5FF475CC0EDC5923DA9BC2B38343CE03CD0BE753DF03A91C243C02BBB3445D1B9AA38"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1ABDE53CB6BD06BD073D8FADA03DC039A9BC92BCD2BC86BCD8B26D349C3CC1BC723D4FBDF63C01BADABC89B9C9BC1D3D1834A23D713D533D91B6A9BCF33A3E3CC6B9E0B6ABBC6ABBE0B9B5AEE2BB02B7092B5A3D3BBD513D213D0EBD7134F89F173D303D123A6FBC71BD7738313D053DF2B128BC6B3CA73C76B7B6BC2E3D503D87388B2149BD643CB8BDAA3CEF3A07B4A13DB93CA43AAA3D7C3D4D3DF339E939C03B163D1FBB433CBEAF3C3DF63CEC38EEB8313AC5B26CBB9C364236FD39DF30943D4B3D18BCBBBD4B3DA8B9643DF9BCCA3C3A3C4035B5BDC8B78B3D9C3A373DE1BBA734923DBD3D16BD663C113C5C3DA83CFE3C1EBD60BD65BDC73D983D4DB859B6B53D2A366FBA8BBA8ABBA1BC1E3DB0BCABBCB1B006B96C3D3CB7D33C3FB995BDAE38C13A9B31A6BBB5B9973879BD4F3CF8BBD53C7FBD4A3B84BD0FBDB0BDC3BCDA39F63BF2BB3EBCA63C9E3B9ABC203D78B974BB9BB338BDBCB41CBA813D64BBF13C9B3AE83C85BBCB324E3DF23CA33B41BDE69C793D70BBB93837BD463D8BA6D53C513DA33DD5BB72ACF1B728BDDF3B673DE1BCC638E53CEBB825BA1C3DCEB29A3C0D3ACABDB4B8003B7CB23B3C273C38BDC93C8B3C63BDE336DD3C9ABBC9BB733D44B8E53CB0BB7C3DAC3A343B203D33BDEFBA6D3CA9BD44BDE2BC8CBC553CF9395B3D893A5DBD7BB5293CB8AEE01A053C6B3AD5B960BD98BC17295A3D40BD7BB9373D1EB9873A20BDD7BD623D5E3DBCB218BB2C32CDBCAC3D10BD7EBCB0BC2DB733BD26ACC6B86D3843BD333D9DBD77BD263DD4BD81BA083442BA103D443A7E3D963C84BA5FBB7FBC973C7FBD79BDFCBC2339D83C0CBB0B3DDA3D7ABD023A08BD423D00BA3BBD8ABDBD3B69AFA6BD34BCC3BB22BC623B6DBDF4BC18392821B23C513C513A75BDC23C28BB9CBD10A882BADF3C07B66C33AF3DD6BCA0BBC8ADC5BB16BCC5B7EBBC00BD01BD16BDB7BBC53ABD2EECBD3BB744BD923DC9350A39FF3B573C27BC633D033D36BDB0BD21BCA5BC983DA9BB33BC0DBAE0B6D7BC9F3D743DA93DC7BC4D3AF03892BC95BCC5BDB4BB6DBC013DA73C8DB70BB5C93D90BC9DBD963BE4BAAF377B3A123B29BC823BB7391ABD87BCD8B9863D07B93938"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
