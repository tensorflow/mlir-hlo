// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}, tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x863F98C0324093C01ABDA8402B4066C02C4052C0383F9C3ED4BF0BBF1A4046C041C091BD6A40C33F52C02DC0B6C0AB404540C2406840094044409C3F684071C0D53F3240B04054C00A3F0BC0A540C4C01940AA3F924032C066C08E4024C003BFC23FD5BD09402E4014BF36407BC0A03F9040AA3F0240E73F15BFF3BEDDC088402840943F3FBF7BC01D4057C081BDDBBFA3BF4E4084C080C08AC02C4037BFF5BFAA3F98C06EBE82C01DBDF03FB1C0E9BF78409540804088BFC040A6BF663F16C0A33F524043C03240FE3EA340F3408DC04D407FC07FC08C3F583F8FC00040053E63BF4DC027C008C0883FA03F0140DB3F61C0B13F5840523EEFBF17C0A1BE2DC00D41BE3F05C09C3F70BF86BE23BF524010C068400040A83EA440983FB6BEE4BFCA40F63F6E3FE23F99BF08C0AD40AD407F402E408640D040794005C0D0BF543E25C09D3F0F402E3F6CBF733F34C05F3F093ECAC0854002C0E53F5240D2C00DC081C013BF7A3F30BF7D408EC0B13F8040223B09405EBF3EC0953EAF3FD9408D40CDBF1D409DC03040D0BF92C09A4048401AC0B940A54009BF99409740A43F8ABE8EC08A3F41BF33C032C0913F05BE9CC09B3FC8BE1BC04840513F5D40A9BE87C01A403C404D40A4C003C103C17BC071408040BB3F1FC0B93F25C00441A740A7BFA93F18C089BF70BF0A40D0BFFF3E23BE673D8FC012C024BF863E8CC0BDC0B53E11C03E407B40BCBE1A3DD0BFF33FA03F87C076C00CBF0ABF4F4019BFDC3FB63F323FF53F513F0B3F213EC0BE02401C40AF4089C0CFBFBDC0A6405C407D4087402EC008BF5640E0BF12BF454027BE0FC0233E6F3EEFBE8EC012C073C01F4011BF45407A409240FF3FA9BF68BFCC3F91C0903F2B40FBBF073F68C031BFB3BFA840473EFFBF40C08D3F26BF814003C067BF96C005405940E3C0443FD33D3F40DA407CC0A43D6EBF75C084C0F13F56C094C0F73E82C0DD3EE04056C0FC3F0D4018BF7CBF11BFC8BE8B40533F31C067C05340893FC3C03EC015C0763FC8401D3F00C0B53FD83F6D4065C07D3E793F86C0C0BEBBC0A43FEBBFE2BE61C0E5C03B3F77C01B3F483F1B40A04031C0EF3F50C034BD21BF13C054408D4021404840E43FF13F"> : tensor<20x20xbf16>
    %cst_0 = stablehlo.constant dense<"0xE6BF973FBCBE14BEBC3F1A403C3FDEBE87C0BD3FC5BF9CBF8EBF25C058BFDABF1BBFE0BF1BBE80C0A7C01F4086C01D40B63F89BF8ABFAC40F83FD3C0E53F94401B3F5B4081C03DC00DBF1940EE3E50BFC23D73C0A03F2CC0A0BF93C002BFBB3F393F37C09CC01AC00640C040883E37405AC047401840B6BF8DC073400BC009BFB9C093C08B3F21C0EFBF87C0734027C04CC05EC0EDC0A83F0140CEBF96BF7DC012C0893F4F3F9440E23E143F873F193E26BEBC3F64BECB3E5E3FBA3FB73E824093C01FC026BD1BC053C0A43D5DC0DA3F54C0D93F4AC081BF07BFF73F82C097C099C0DDBFB93F9A3F3340B43F64BF0EC00540ACBD03C04DC038C05B40EDBE62C05940B13F8F4065409740734058C0D63F0C4093BFABBF85C063405ABF81C0D93F8E3FB0C0A03F97C0FDBF0C4077C089401841F4BFEB3E2240C93E4D3F69C08D409A3F483F3F3F36BF8ABF8DBFAA3FBEBF23C0F23F8FBFC53C97C0E93F78BECA3F9740AF3F7AC0264015C08DBFF2BF5A3F21400A40B3BFB1BEB5C02CBE8ABFC73F3B40F7BFE43FB03E8D4082C008C10840DBC090C02C3F16BF1FC0A8BE94401D4071BF343F68BFAFBF1DC0543F0C3EF63F4640944031BF09BFDCC02EC085BF15406AC094C0C6BDE83FB9BF28BDA23FC43EBCC01C40323FCFC0A9BFD03F363E2DC0083FA63F7AC0384085409C3E843F78BF8D40C8C0AB3F6EC01940C13F874067C052BFE03E99C0E33F3B3F32404D40983F87BF883E5CBF9D40AA404E400340FBBF8540833F1EBED24040C072BDC7BF0FBF1BBFCEBFAEBED33F8ABFC8C0993D2AC081C053400940DD3F5BC0A540C3BF9C3F18400C3F4D404C400140F74004C0AABE904053C082C08DC0753F1F3F5EBE804097406AC019C0B23FD0C0B4BF054002C040BF3940963E55BFFB3CE5408DC09B3D0DC06E3F1BC0AABF9FC03B4082C09AC0ABBFC83F0A3FA33F89BFF9C0183D0BC0E1BF4C3F613F5B404F4082C0C1BE6BBFCEC09DC04BC0543EDFC01540F13F89C0B73E65BF6FC08EBF0CC064BF2640B340A5C00540564030C08BC0B440B73FA8C0843FA4BF1D40254075BF0740353FCFBE12C03D40853F5A3F37406EC078C082C077BE003F1DBF66BF24BFF53E88404E40"> : tensor<20x20xbf16>
    return %cst, %cst_0 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x3640BEC04A408EC0C1BF3640F83F4AC0DD4098C01040C33F0CBF02405040B2BF1AC0D73F7440B140F83FA6C0C0BF3940D43FE44096404FC0903FFA40EB3F06C1883F24BF1841B8BE8C3F92C09640AAC01340A4405440C0BD16C0104104C0FCBF4B3F3040E040A4402BC04AC086C0CEBFFD40E4BFB0BE4E40754089C098C099400641B840EABFB4BF8A405C3F77C0663FF53FD6405240AAC0CAC08A40EA3E02406740BAC085BF0BC1F6BEA63FD3C0FCBF81404C408740BBBFA44030C00A3FCDC0BC40B84040C0A6407340A0403141C4C0D040B6C054BF0640B03FCDC0C2409B407940BDBF82C055C0DEBF20BE3A407C40B3C0BC3FAE405A40813FB9C0183E543FAE40D03DD2C017C0B5C082C02F40CE3F8EC0994056409040CA3F02406B405EC0A640EE40A4BED040483F8AC01441903FB0C094406F407E40604038C0014086C072C0E43EBE3FB23F203E034084C017402C4003C1A94004C0D040BB3FCAC072C00CC1F8BF9C4052C0C94056C052404A4021C080BC083F28C0BE40C43FFC40364091C08C40D6C01A40C1C000BF5541803F8E4024419040503DE840A24056C02EC060C0C03E1C3EB7BFA8BE9C3E88BEDAC0F1BFA0C0DEBF6A40F640C640363FD2C0C240F2405340DEC0D8C002C1A6C058401E417ABF4CC0FD40A1BFD440A140B33F4A3F6BC0364074C000C0F7BF08BF4F3F8BC0E43F68C0454008C0BCC022C17E40B9BF22400B4109C031BF8DC0A7BF803D4AC084C0A03EAEC005C074C0A8BE58405EC0643F783FC1C04A40A2BE66404040C2402BC0A4BFF2C0C8401B417840DC40A83F75C09A3F5EC0364005C0AE3F5DC00EC0A0BE6BC0F4C08AC038C1924070BEB6BFE6400A41CD4012C0C4BFE83F08C166C0CA40DC3E5DBF3840373F5EC0E940723F9CC053C0F83F2EBF48C017407ABF1FC0933FBA40B8C0B84034C0E2403A4126C0BEBFBCBFA3C044C01B4158C01DC00F409CC0E5BE6540D2C0C1402540A63EAE408B4032408440F940A3C0B0C0F240363FA6C0443F9CBF4A40E440FEBFF3C0D240C8BEB83E54BF934095C0B4C09C40DCC0244089C041C024C014C1C03C5DC039400BC0B13F8540B4C0B340203F8140C6BE33C07B40AA404A4029401EC0ABBF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
