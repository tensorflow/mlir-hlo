// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.shift_left %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFDFFFEFFFDFF0200FFFFFBFF050002000300FFFF0100FFFFFEFF0200FDFF0300000001000500FEFFFCFF070001000000000000000100FFFFFFFF0000FDFF0000F8FF0600FFFF0000FEFF03000200FFFF0500FEFF030000000000FFFFFAFFFFFF00000000FFFF0500030001000700FCFF0100FEFF020000000000FFFFFFFFFFFFFCFFFFFF000003000000FDFFFEFF02000000000001000000FEFF0200010007000000FFFFFFFF02000400FFFF0100FEFF020006000100FDFF0100FAFF0000F8FFFEFF00000000000000000000040002000000FFFF0500FCFFFFFFFAFF0100FEFFFDFF0000000003000200040000000000FEFF020000000300FDFF0000FAFFFDFF000001000400FFFF0000FFFFFBFF0000000000000000FFFF00000000FDFFFBFF000002000100000001000100FEFF0000FEFF0200FFFF0300F9FF0100030006000200040001000100FCFFFEFF01000100FCFF02000000FFFFFEFF00000100010000000000FFFF00000100FFFF0000FBFFFCFF0000FEFFFCFF0500FDFF0000FCFFFCFFFDFFFEFFFFFF0200FEFF0100FEFF0300000000000300FFFF0000FDFFFCFF0000FFFF00000000FEFF01000400FAFF0200FFFFFDFFFDFFFFFF00000300FCFF01000300FAFF0000FEFFFCFF02000000030004000000FDFF0300FFFFFFFF030001000000FCFFFFFFFFFFFCFF0300020000000100FFFFFEFFFCFF0000FEFF05000400FDFF000001000300FFFF00000000FDFFFFFF00000100FFFF0100FEFFFEFF010000000300FBFFFEFFFFFF00000100FAFF0000FFFF0300FFFF04000100FDFFFEFFF8FFFEFF010001000300FFFF0200FCFF0100FFFFFDFFFCFF000001000000000000000000FEFF020001000000FCFFFEFF0000FDFF020001000000FDFF02000000050000000200FFFF0200FFFF010001000000000002000000FDFF04000100FFFF0000FEFF0400FEFF0200FCFF0300FFFF0000FEFF02000000FEFF0100040000000000FFFF0300FEFF00000100FFFF01000000010004000000FCFFFFFFFDFFFFFF030000000300000001000100FEFF01000100FCFF0000010001000000030000000000FCFF0000FCFFFFFFFFFF0600FEFFFEFFFDFF0000FFFFFCFF0200FDFF"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x01000200030001000200FFFFFDFF01000000FEFF02000000FFFFFFFFFCFFF9FF01000100000002000100FEFF0000FDFF0500040003000000040001000100FFFFFDFFFCFFFFFF0400FEFF000004000000FDFFFCFF0000FFFFFAFFFFFF0100FFFF0000000001000200FFFF05000000FFFFFEFFFFFFFEFF0000020004000100FEFF040001000200FDFFFEFF010005000300FDFFFFFF0500010000000200FBFF0000FFFF0600FFFFFCFF0500FCFFFCFF0100FEFF00000200FFFF03000200FDFF00000100040000000100FFFFFFFF0100FFFF03000000FAFF0300FCFFFFFF00000100FEFFFFFFFDFF020000000200000003000000FFFFFFFF04000000FBFF0000FBFF0000FEFF06000000FFFFFDFFFCFFFFFF00000000FDFFFBFF000001000300F7FF0000FFFF00000000FDFF03000000040000000000FFFFFFFF0000FEFF00000100FEFF0300040000000200FCFF010000000000FDFF0000FEFF02000600FDFF01000500FEFFFFFF010000000000FEFFFEFFFEFF0000FDFF000000000300FBFF0000FEFF03000000FFFF07000100FCFFFEFFFFFF0200FCFF0200FEFFFFFFFEFF0000FEFF02000000020003000300FEFFF9FFFFFF0000FAFF0100FEFF0400FCFF00000400010000000000FCFFFCFF02000000FCFF000002000200FFFF050004000000FFFF0200FEFFFEFFFDFFFDFFFFFF030000000100000000000200FDFF0000FDFFFCFF03000000FDFFFAFF0000FFFFFEFF0000040000000200FCFF0300FEFF0500000004000400FEFF01000300FFFF000005000000FDFFFCFF0000FEFFFAFF00000300FFFFFFFFFEFFFEFF03000100020000000000000000000100FCFF03000000FFFFFFFF0200FEFF0100000001000300000003000500FDFF02000000FFFF0700FEFF01000200010000000300FFFF010008000100FFFF0200FCFF000004000200FFFF0000FFFFFFFF0300030000000000000001000400FEFF000000000000FCFF0700FDFFFDFF0000FFFFFFFF00000000FEFFFFFFFFFF010000000000000001000000FEFF0100FFFFFEFF000001000000FDFF0200FFFF00000000FDFFFCFF01000000FEFF0000010000000600FEFF00000400FDFFFFFF02000100000002000300"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFAFFF8FFE8FF0400FCFF000000000400030000000400FFFF0000000000000000000002000500F8FFF8FF000001000000000000000800FFFFF0FF0000FAFF00000000000000000000000003002000FFFF000000000300000000000000F4FF000000000000FEFF1400000020000700000000000000000000000000F0FFFEFF0000C0FFFEFF000000000000FAFFC0FF10000000000020000000FEFF0800000007000000C0FF00000000800000000000FCFF00000600040000000800E8FF0000F8FFFCFF00000000000000000000080000000000FFFF0000E0FF000000000100FCFF0000000000000C000200100000000000FEFF000000003000FDFF0000FAFF0000000000000001FFFF0000000000000000000000000000000000000000E8FF0000000000000100000000000800FEFF0000FEFF020000000000F9FF000003000C000000200010000100F0FF000002000100FCFF000000000000F8FF00000000020000000000000000000100FFFF00000000000000000000FCFF0500E8FF0000FCFF0000E8FFFEFF00000001FCFF000000000000000000000C00000000000000FCFF0000FCFF00000000F0FF0800000000000000FFFF0000FAFF000000000000FCFF10000600FAFF00000000000008000000000004000000F4FF0000E0FFF0FF03000000000000000000000000000000100000000200FFFFFEFFF0FF0000FEFF00000000E8FF000000000000FFFF00000000FDFFF0FF00000400000008000000C0FF0100000030000000FCFFF8FF0000010040FF000000000000FFFF00000000FDFFF0FF00000000000000001800FEFF0800FCFF0100FFFFFDFFF8FF0000080000000000000000000000040001000000E0FFFEFF0000A0FF0000040000000000000100000A0000000400FFFF10000000020000010000000008000000FDFF400004000000000000000000F0FF1000FCFF0300FFFF0000E0FF00000000FEFF010000000000000000000300000000000100FFFF00000000000008000000FCFFFFFFFAFFFFFF000000000000000001000200FEFF0000040000000000010000000000060000000000FCFF0000FCFFC0FF00000600E0FF000000000000FEFFFCFF0800E8FF"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
