// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.abs %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFA3D67FFC676EDBF0A48C4C52125E3BF0C4C9CBAA02CF23FE1CB6D589B65D93FC2500143B0DC1AC0A3D7F1E7E2EB124090DCBB455EFAE6BFD2055FA962C2EC3F67F21F80E6230D4024F1A0ACF2BBEEBF056765E9522103C0BF2EE547275F0340184F62232C0FF83FB89257995E98E4BF64EE4AFBDBE30DC0D1C8D3BDE5E1FB3FD0D2EB2E22930540CC2299E8481E11C0749EA62508330EC0543197D0112B1140923D2A62D5350D40E46BFA685160E63F74192D4A0C31F63F4DFB8B93FB4A1B40DA2F90A04AECE43F9A351010A652EF3F0AE63AD5C4ED0640C6DA6B7EBCD0F93FB6796864E9350D400A90F3ABF40004407CF074EA83A5014068D4A9CC4A9B1AC0E293887233F30840BD7C7A81C7E0D33F2CC3B0711C8003C0F5E35F83641FE53F97B53B5F06CF10C07A4BAFA1C0BCF9BF6F23E977517808C0B44F44B9E986D3BFA85798BA38F311C053A31CA12C8BE8BFFC2CAEF1B4120FC0F31F6E552719F43F60535F576396E73FF5624907C1E209C077301F21FABBF0BF724B31AEF46EDD3F00E722D7940701C030D3C0A3D9D21B404104390E80B806C0A455F7A21F2DD13FA090D472E550F23FBA01F450E9DE0940C52D30EFF83A1540CE05425B85390140EB9135B27C2CEFBFBFB4A365BEFCEEBFACB1EA433E2900C08E2DC0F17E6AD53FFC8CFAE0BA6113406686F8B680DEF5BFFE3455F66188F3BFCB849853DDD6E0BF64990872762300C06BC5D7DB483E02C0FA7CAF263A0DF93F02703771494E0DC007D33A7196C70540A42F4793D279D9BF28D0EC70FF74E13F0DACE46FD141E3BFE426F504F4380540D3C64434EADE04C052DBFEC820ACE5BFB95C657E00CC10C0029CE3CC6A8807406DD29B6AEE3A18C02E92A1686B740A402B12A55F93C8EC3F6A8E7AE44E79FEBFE80C36AA503611C0049E064028CFA4BF4C709E56124CBD3F06E09D52B8D2E73F7849ED6359EAFF3F4E1C54B744D5EFBFB42E567B0F690E405D1692586FE7F1BFF8E84238A71213C0F810754458BCEA3FC4AC6AA5E9D154BFB40494DFBD010740465D7A5A5A8A0D402D9876C12793FD3F1C28E5226FF1004018491C9BC23AEBBF37A1CB8633DFE73F7BE7034A6EA5C23FAABF5AE9C3E908C020F29914AF7C08408ED5309CF316F33F9640BEE32BCAE13F783A1C3D67E8DD3FBEC5C2B59D2AB9BF6194329636340C40A7BFE22A450E1440429C59E59C4E0D4036E8471094600D40C9400543C9B216C0B08470E8B2D7E63F8858A960B6130440D2221D75ABF10B4029A0AE337658F33F24F8BF45281D0A40182F24E82FEF0C40C0FB1CD97D2315C02F00B664C68FE33F08EB76E11516ECBFD6A185FE0D8302C0972C1AC5511A1B4010AAB3371AF5F73F8F11AE5CFE9AF53F0BEFA9034129084027B1CEE95F14F43FDA9F74A03CAAF73FDA46D070976B16403C3BCB5D70E20640B4648CDC328D144077927A62A6481640A0744FC51A0B0940400FED6418FE1340DA97BD010DC5F73F1ADD3FB27409F5BF4833905E1B711340CE7CD6B8EE6209C05316C601CB2101C0E3218825B15310C0D931D492AD4FE8BF623F822344C6FD3F45E63C2C388AF83F06B1CCF7F15316C08073F2E149B50740480891A16A7E0E406A6856BA0C1715C0DB2F6414D49804C02010C0B90348D53F65067A7F3D2E02408EA2C4D6F003ECBF8CABF6C87A27FA3FB2BECAA971F31840B6CCD53FC1E8E63F54E4FE799776FD3FE3D96BD9D11100C0A5F5D6C58AE610C07437B2DD936E03C0E29660B9CF6DF73FCF966F737E0DF7BFAF08660E6E3ADF3F92EC71D1587A07C049217604021AF63F518F5EFB5903E53FE4178A5B55DF02401B803CAE1156E83F08538BF657C71140FE55F250A2DBFE3FF7C7D3D46AE0C53F1216CFF8AC57CFBF5AD6FE5C0C8E1440D0CE80BB9FF8FCBFC5B38508398214C0C40879EAA19903C0E2F55187BFCE10C05796F691D32818C05F352225F303A53FD699FDDECA260440CCE0044449ADFFBF1D30F5E91416F3BFDB5FD818D00CEBBF45EB654F48330D405E04A68A5D9411C0748063F7736904C0BE6B02EA4676F23F9313C0C0FCDA14C0D4B438744FCB0640009CF68C0485E63F968259A5BAC7154080C2DE89B11411C032C7866C09200740E4C810D8E61BE43FE851C95B6CA608403EFB324E05B2C8BF080BE41DCD8B154094BFDE109F4B06C00999A7BA981F1C40166B1AECE6E907C0C665F18403440BC010B942CC6B051340F4B754090F61FE3F57479BBC146415C09371A374D0650FC0D2A34256A1F5114040B88E056F330FC0536420D64D81FF3FC8B600A8BEE41A402E35F02AFF3D14C06B3BA903D3B8124006F4CC001A981040B49796DAEAC1F63FDD8F757A1BFD02405843773D857AE2BF26CACB2E1A2810C039BD28A2073AEE3F7D3210CC342019405C19794852EC03407CAD36166788E3BF5608590BF77E2240DA9245E992DCE4BF61957722789416C072D461BCE27CF6BF8D3546B3E7DEE33F29550AF373840240D82CD59A4797CBBF7FBCDA0D5392DDBFA5560F57534AE83F1C03D4FDB4F002C07228F08BC5970D406C490E980A9203C0A5B788D3EA3805C04990D73C3B1809C0CCFB58B75A0A02C0D09B352D64DDED3FD46DB1AF8EC2F3BF28CCA6786317C5BF1FF1065D1BEAE2BF78A2B8886AE6F53F2EAD5FCA402E13408C00C86FD9F60EC0BA6827A2090B0F4060B180DB821AE9BF7A36AC56764111C03E66D66A8B5CFD3FDBE381697764FFBF2EB7E0E2DDA600408283E76B8915FB3FA73497D941B1F03F6D538B78E56BD3BF72AB4E49944DFB3FE4B1A7C969B91240504BF19B6D5C02C09C7DD7839B70D43FCC9ACD5DE141AFBF76D3C1706E7F13C0791A3B0E74EC14C08AEB7E32D92402C0FC01F5EB5D4704C08A9C90CC7C6E1440807139940D67C23FAEEF753E9772F8BF1A34AE6B0E88F93FEACB9EC0FB550A4024E4708E4E1105C03AE2C101D9CF15401AC0FC3B3BE6F83F02C091D486FC01C0088B7B963D64EE3F8546BDF1B33707C0542BC6710CA514C0E9B01F11C614D23F764E11EDC9BC074010C4B357377C1A40D6A2438CB97BDEBF5F7AB9A6791406C02C8DCDEB7C9BFD3FC1F59C64C4E214C018F6D5ECAA0F16401065AE0F54E80AC0468C296D05C818C0C3554B64436A0AC0619A505FABB31340A678A94F19A4F43F2245B69AF0DDF4BF50961468F77EF63FA5DC257E213717C0B8E4ECC3593314C05841A89DB42F004077C1ACE6EBDEE6BF53F2851C868FF4BF284AA05A16B5E4BFB5C6E18FB65ED6BFE8E591E8794C00408B010E7B8051D73FCD6EFD0365A707C0F0AEF8B7960302406BB383BC808819C0B0708B96417E03C0BE6619634FA70BC0027B0F554A220FC0A485F5919105E63F648608577463FCBFC3164BE8AE0EF73FB80B208F918F0C403C4D7B4F3363F33F04B24BA4DD9115403E9A4605FFF91C40B14EF666402CE8BFFDC21B489843E8BF3D70750C481E03C0E4EB2532C1850EC00800214C5D25FB3F44E897CD47D4E9BF4605820EF224F5BFF8294157EBF608401FB5E8CE61200740FC967B8179E1EFBF9ADDA0C6A332FC3F0C01A4EDE768EA3F9C61072DDB6CD13F6E1D1F960883D33FCBAA66545A2E1940FE52AAE8AACC13C00FF40FE32F6EE7BF5F03E3AAE61BF3BFF09FBB91072CA7BFB01D506739BB0540BADAE898D8FB0DC0F8F242FB4A3B0DC0CD4F7F71A6CF0440176B2920107205408235C6D5183BBD3F2EE710ACEDD9DD3F75B4A72611E913C05123ABD510190A40781FE32C224703C0297B73ECDF950F403B0660DB4D5600C019E2A31A46F40AC002AAE923A2A3E33F03561ACFC83FE3BF5C5FD0455187F1BF380ABF41529907C0808944FCBD1A12C0087BC3A4914FD8BF5A6A9459CDE61440FB629F9ECEF704C063FF66A65FA501402CA380C403BB064056EF7BE7C40ADFBFE3E1472E025702C0987CFD6F3672F0BF3B2A9B5258CAF43F7A05B8FE726110C0DBA8CC48D53BD7BF401FAC04CB3303C00AFCC504B4DAF83F60962D3EE0190C40A26546202E49FEBFA0D7BD9640E607C096394953F4E40C401CAEA02B8ADEC0BF105C9934C6E40240CDBB785FAB820940865404B4752109402101ECF3DB90E13FAAE30D98215809C0AC72DCA58BAFFF3FA0A2746FF98D14C01D1BE9C3A18AF83F749CD0B5EF7012C07BBFDAD68F000A40ADDB88302F3D1BC058BED2068019D4BF4F96C6D073AB11406CADED70E1DFF33F8DF6B344A7DC0740C3FEF8A3E809FBBF8CAF79737BEB04401030C05C0F51FABFBC6972839646EDBF7C4984D88161FFBF0027F2FA5526E3BF5203430D766FF6BFBACB9A1577CF054097E54418D3B610C0CC273910C060FCBFBEAB0613355213402A35A67672C8CC3F7FB441267D2CE8BFC68E9004A2DCBA3F5E539D4509B8E9BF1604519470280DC05CB76550B00017407E681E6036BFF23F327E561D33BF00C0B8CF29245AF6D1BF537DD307E9F5124006B65D419C29FCBFA4F3A21F2223CB3FD2000AFD720B1040B0A276F31D6D1340"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFA3D67FFC676ED3F0A48C4C52125E33F0C4C9CBAA02CF23FE1CB6D589B65D93FC2500143B0DC1A40A3D7F1E7E2EB124090DCBB455EFAE63FD2055FA962C2EC3F67F21F80E6230D4024F1A0ACF2BBEE3F056765E952210340BF2EE547275F0340184F62232C0FF83FB89257995E98E43F64EE4AFBDBE30D40D1C8D3BDE5E1FB3FD0D2EB2E22930540CC2299E8481E1140749EA62508330E40543197D0112B1140923D2A62D5350D40E46BFA685160E63F74192D4A0C31F63F4DFB8B93FB4A1B40DA2F90A04AECE43F9A351010A652EF3F0AE63AD5C4ED0640C6DA6B7EBCD0F93FB6796864E9350D400A90F3ABF40004407CF074EA83A5014068D4A9CC4A9B1A40E293887233F30840BD7C7A81C7E0D33F2CC3B0711C800340F5E35F83641FE53F97B53B5F06CF10407A4BAFA1C0BCF93F6F23E97751780840B44F44B9E986D33FA85798BA38F3114053A31CA12C8BE83FFC2CAEF1B4120F40F31F6E552719F43F60535F576396E73FF5624907C1E2094077301F21FABBF03F724B31AEF46EDD3F00E722D79407014030D3C0A3D9D21B404104390E80B80640A455F7A21F2DD13FA090D472E550F23FBA01F450E9DE0940C52D30EFF83A1540CE05425B85390140EB9135B27C2CEF3FBFB4A365BEFCEE3FACB1EA433E2900408E2DC0F17E6AD53FFC8CFAE0BA6113406686F8B680DEF53FFE3455F66188F33FCB849853DDD6E03F64990872762300406BC5D7DB483E0240FA7CAF263A0DF93F02703771494E0D4007D33A7196C70540A42F4793D279D93F28D0EC70FF74E13F0DACE46FD141E33FE426F504F4380540D3C64434EADE044052DBFEC820ACE53FB95C657E00CC1040029CE3CC6A8807406DD29B6AEE3A18402E92A1686B740A402B12A55F93C8EC3F6A8E7AE44E79FE3FE80C36AA50361140049E064028CFA43F4C709E56124CBD3F06E09D52B8D2E73F7849ED6359EAFF3F4E1C54B744D5EF3FB42E567B0F690E405D1692586FE7F13FF8E84238A7121340F810754458BCEA3FC4AC6AA5E9D1543FB40494DFBD010740465D7A5A5A8A0D402D9876C12793FD3F1C28E5226FF1004018491C9BC23AEB3F37A1CB8633DFE73F7BE7034A6EA5C23FAABF5AE9C3E9084020F29914AF7C08408ED5309CF316F33F9640BEE32BCAE13F783A1C3D67E8DD3FBEC5C2B59D2AB93F6194329636340C40A7BFE22A450E1440429C59E59C4E0D4036E8471094600D40C9400543C9B21640B08470E8B2D7E63F8858A960B6130440D2221D75ABF10B4029A0AE337658F33F24F8BF45281D0A40182F24E82FEF0C40C0FB1CD97D2315402F00B664C68FE33F08EB76E11516EC3FD6A185FE0D830240972C1AC5511A1B4010AAB3371AF5F73F8F11AE5CFE9AF53F0BEFA9034129084027B1CEE95F14F43FDA9F74A03CAAF73FDA46D070976B16403C3BCB5D70E20640B4648CDC328D144077927A62A6481640A0744FC51A0B0940400FED6418FE1340DA97BD010DC5F73F1ADD3FB27409F53F4833905E1B711340CE7CD6B8EE6209405316C601CB210140E3218825B1531040D931D492AD4FE83F623F822344C6FD3F45E63C2C388AF83F06B1CCF7F15316408073F2E149B50740480891A16A7E0E406A6856BA0C171540DB2F6414D49804402010C0B90348D53F65067A7F3D2E02408EA2C4D6F003EC3F8CABF6C87A27FA3FB2BECAA971F31840B6CCD53FC1E8E63F54E4FE799776FD3FE3D96BD9D1110040A5F5D6C58AE610407437B2DD936E0340E29660B9CF6DF73FCF966F737E0DF73FAF08660E6E3ADF3F92EC71D1587A074049217604021AF63F518F5EFB5903E53FE4178A5B55DF02401B803CAE1156E83F08538BF657C71140FE55F250A2DBFE3FF7C7D3D46AE0C53F1216CFF8AC57CF3F5AD6FE5C0C8E1440D0CE80BB9FF8FC3FC5B3850839821440C40879EAA1990340E2F55187BFCE10405796F691D32818405F352225F303A53FD699FDDECA260440CCE0044449ADFF3F1D30F5E91416F33FDB5FD818D00CEB3F45EB654F48330D405E04A68A5D941140748063F773690440BE6B02EA4676F23F9313C0C0FCDA1440D4B438744FCB0640009CF68C0485E63F968259A5BAC7154080C2DE89B114114032C7866C09200740E4C810D8E61BE43FE851C95B6CA608403EFB324E05B2C83F080BE41DCD8B154094BFDE109F4B06400999A7BA981F1C40166B1AECE6E90740C665F18403440B4010B942CC6B051340F4B754090F61FE3F57479BBC146415409371A374D0650F40D2A34256A1F5114040B88E056F330F40536420D64D81FF3FC8B600A8BEE41A402E35F02AFF3D14406B3BA903D3B8124006F4CC001A981040B49796DAEAC1F63FDD8F757A1BFD02405843773D857AE23F26CACB2E1A28104039BD28A2073AEE3F7D3210CC342019405C19794852EC03407CAD36166788E33F5608590BF77E2240DA9245E992DCE43F619577227894164072D461BCE27CF63F8D3546B3E7DEE33F29550AF373840240D82CD59A4797CB3F7FBCDA0D5392DD3FA5560F57534AE83F1C03D4FDB4F002407228F08BC5970D406C490E980A920340A5B788D3EA3805404990D73C3B180940CCFB58B75A0A0240D09B352D64DDED3FD46DB1AF8EC2F33F28CCA6786317C53F1FF1065D1BEAE23F78A2B8886AE6F53F2EAD5FCA402E13408C00C86FD9F60E40BA6827A2090B0F4060B180DB821AE93F7A36AC56764111403E66D66A8B5CFD3FDBE381697764FF3F2EB7E0E2DDA600408283E76B8915FB3FA73497D941B1F03F6D538B78E56BD33F72AB4E49944DFB3FE4B1A7C969B91240504BF19B6D5C02409C7DD7839B70D43FCC9ACD5DE141AF3F76D3C1706E7F1340791A3B0E74EC14408AEB7E32D9240240FC01F5EB5D4704408A9C90CC7C6E1440807139940D67C23FAEEF753E9772F83F1A34AE6B0E88F93FEACB9EC0FB550A4024E4708E4E1105403AE2C101D9CF15401AC0FC3B3BE6F83F02C091D486FC0140088B7B963D64EE3F8546BDF1B3370740542BC6710CA51440E9B01F11C614D23F764E11EDC9BC074010C4B357377C1A40D6A2438CB97BDE3F5F7AB9A6791406402C8DCDEB7C9BFD3FC1F59C64C4E2144018F6D5ECAA0F16401065AE0F54E80A40468C296D05C81840C3554B64436A0A40619A505FABB31340A678A94F19A4F43F2245B69AF0DDF43F50961468F77EF63FA5DC257E21371740B8E4ECC3593314405841A89DB42F004077C1ACE6EBDEE63F53F2851C868FF43F284AA05A16B5E43FB5C6E18FB65ED63FE8E591E8794C00408B010E7B8051D73FCD6EFD0365A70740F0AEF8B7960302406BB383BC80881940B0708B96417E0340BE6619634FA70B40027B0F554A220F40A485F5919105E63F648608577463FC3FC3164BE8AE0EF73FB80B208F918F0C403C4D7B4F3363F33F04B24BA4DD9115403E9A4605FFF91C40B14EF666402CE83FFDC21B489843E83F3D70750C481E0340E4EB2532C1850E400800214C5D25FB3F44E897CD47D4E93F4605820EF224F53FF8294157EBF608401FB5E8CE61200740FC967B8179E1EF3F9ADDA0C6A332FC3F0C01A4EDE768EA3F9C61072DDB6CD13F6E1D1F960883D33FCBAA66545A2E1940FE52AAE8AACC13400FF40FE32F6EE73F5F03E3AAE61BF33FF09FBB91072CA73FB01D506739BB0540BADAE898D8FB0D40F8F242FB4A3B0D40CD4F7F71A6CF0440176B2920107205408235C6D5183BBD3F2EE710ACEDD9DD3F75B4A72611E913405123ABD510190A40781FE32C22470340297B73ECDF950F403B0660DB4D56004019E2A31A46F40A4002AAE923A2A3E33F03561ACFC83FE33F5C5FD0455187F13F380ABF4152990740808944FCBD1A1240087BC3A4914FD83F5A6A9459CDE61440FB629F9ECEF7044063FF66A65FA501402CA380C403BB064056EF7BE7C40ADF3FE3E1472E02570240987CFD6F3672F03F3B2A9B5258CAF43F7A05B8FE72611040DBA8CC48D53BD73F401FAC04CB3303400AFCC504B4DAF83F60962D3EE0190C40A26546202E49FE3FA0D7BD9640E6074096394953F4E40C401CAEA02B8ADEC03F105C9934C6E40240CDBB785FAB820940865404B4752109402101ECF3DB90E13FAAE30D9821580940AC72DCA58BAFFF3FA0A2746FF98D14401D1BE9C3A18AF83F749CD0B5EF7012407BBFDAD68F000A40ADDB88302F3D1B4058BED2068019D43F4F96C6D073AB11406CADED70E1DFF33F8DF6B344A7DC0740C3FEF8A3E809FB3F8CAF79737BEB04401030C05C0F51FA3FBC6972839646ED3F7C4984D88161FF3F0027F2FA5526E33F5203430D766FF63FBACB9A1577CF054097E54418D3B61040CC273910C060FC3FBEAB0613355213402A35A67672C8CC3F7FB441267D2CE83FC68E9004A2DCBA3F5E539D4509B8E93F1604519470280D405CB76550B00017407E681E6036BFF23F327E561D33BF0040B8CF29245AF6D13F537DD307E9F5124006B65D419C29FC3FA4F3A21F2223CB3FD2000AFD720B1040B0A276F31D6D1340"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
