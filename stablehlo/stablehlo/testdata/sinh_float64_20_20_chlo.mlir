// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.sinh %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x80C17935E061EBBF2EEA95FFDE670AC0D513327B15E911407D0E24F8297C0BC0D28DB905E453E2BFDC2EF0D77699E5BFA0DFD673B32C0740BABE971B5BD0DFBF021993EA6D31AC3F540526E4FA320F400A4C9B9FF9701CC0C2B156761FD0DEBFF25C3DEBD9EB0940D82B167E88C6064000395BE614F9E93FACA3F7244EF7F43F03FB20C4C5E10640CAABAB505D6BF53FEACF809C27A809C054F42B32B349E9BF7942E848E2FB1040BC5101DA13ED02C0373260039A120AC000E6333FB970F7BF38A56D832D7DF3BFD89305FDED18CD3FAECE3A8E67751540C4DDDC57F8DCE3BFD4D19EE4408613C080A30EE8827EF6BFEE575FAFAFB306405EC306DDF3120B407AB62320DA1AFC3F305829349D67EABFBC01633F0124FD3FBC909E1E4CBD0540801EFBD762FCFABFBBD3D3497D7E1240C8DC83F69D430B40BF313E58885EFF3FA8A926434BF2E1BFACA5F10D72FE144094EA60B35585034005F790B7ED0F12407F0AFEEC58231640BE8858AF7772E63FE180766F85351340BD67EC42D24EE83F401D3E1ACC36B53F8989B0BF067E0340C2F9551AB0BEFC3F803D2A6723B6CA3F7668979DA2F3144074BBF9E21C910AC058601D55A6D00CC05668A65F9A5CFEBF3C1848A51D6D0BC02D2BCD8FD018F23FD01077E4ED80EEBF7DE627CEABB7E73FBA8B485B1CF5C1BFA8C982EC8405FF3FFC81F7821F2FE4BFEDDD85B702FDEBBFD8D44AD8A03CDEBFEA47849DCC1BF33FE786FA5CF5B7F03F3F84859A1A89F6BF70A57765951DE93FC228969BDFD1FE3FCD6C1C65F795F4BF42881386B8DED03F50526488C52EF8BFA0B55A3B1AC203405F1BA5AF072EEFBF8FF074FC20CC13C067A696304860F43FFCB40C3B947BFDBF88F22A5C9171DEBFCE2FF0D4B4A1FF3F931A7CEEB1DA05C0D3DA1804C4E6C33F0E13B4AB6A6F04C02773317CF2D7E63F69F88058CFE30D40D4C26878ECF10BC007518EC4A864F03FB065A65EB4C712409D9E4579DB8C0840E287FD6BAD791B4018D7B4BE46D5D33F92612A406183FB3F2B2717784E8BF23FA13B238B3A480340A1C9CF82B68A1040A0BE1E75026401408A1DE30DB28414C0643B4742F0DE0D40A2287D0851070C402744B8613ED1E93F4E20C0951C0AEB3F7A4D06823526014023E3FD31400FE13F2097502D74390840A0E574075506DB3F2B4D26653D76FB3F44B4E8FD374409409C8DAE2C85B61BC06DEAA0BB4F0EEE3F8489589AB2031740243AD252D371EF3F9A897965082BFE3F0FF76A2FFDCDC83FB223A94B108AF9BFCE3653D622C7124076A9CE5B7E66EDBF65D7C70F685A01C0E0D3181F766CB3BF626CB5FFF900F73FF03F71E6B365C13FB4CE5DF62CCDF2BFF7621A56A75A07C0800E1F0BD8550C40AEA3EBDB4C040D4005409F25D5E812C02B4D8C51696207C03863A32085C3E5BFEFD881F2C0D913C0A0D547173FCFEA3FE83E24781009C83F78100F49B3D30EC03967CCD5BAFC0540F84976EFD561C73F26A04C370E3419C0BA29161E6B33CABFC4226F1C28EC1540591AAA4D5E2CFF3F88D72B8E04080140C628BDAC0E42F6BF70211A471032CEBF0CB5A96F2A2DD2BFA0D889257AE00C402CEF46C4A9CDFCBFC903EA283636ED3F3279205B89C3024098DD8C067E420FC0CCBAEDB94C0017C08816DA33EE4907405C0408443648F8BF73C63D37C2C8D03F9645A2B2BC8704C0EC3B362BC1DDEA3F0BAE066A3B4018C0E4614635AC3D0D4029F92ADD29AF1140E4A73202040E0CC0DF1B4F8C9B650C4095A9890ACADD13C048CB1B07EFFEF83FF8AA6692B568FFBF2A0947A197520CC07B062B90D372CCBFCA893B9565FDFA3F621DE410C6B4EFBF3E8220E72EE5B0BF70D9345DB65EE9BF02C01FAA492902C0C41A528E605A0DC0C76F0D0F8B591040F2BE55400291D5BF4D6598E39878154098A05A100AAFFFBF9DAB253D46B4F33F9B4DB58EB57B07400B6AE77EBCACE2BF9A1AF0D8491D03C004ACC5491043F1BFFE4D1E10685815C02ADCA6D55AF4C63FFAC91AE7043EFEBFA282059BD86AE43F89EEDCFC5A48FA3F32DCAB085BE81EC0135ED3BF22F80640BA5A56B44E4711C0B375F5CEC3420B40E8391EF50F5DEE3FE09389EC0E5F06C008C7374082B008C0861C0E13849B12C04438D022F16AF23F1655B2257007F2BFD432CB57B82F0AC0531D84004B48F23F5E9DB384E3ECECBF0699283A3C3402C0388562AF464A0A403383F41B2988D2BFEC5A42F1776101C0A859B329DC60F0BF3FB7D68158480740503C0538012FFDBF6CEB3E0024A01140E91FED598E9D07C03A8776EEE05A0740A4CE5F041C7CF7BF62F10A9DD6FEE73F481EB5AB80B2EA3FBEC82F22BA3D0D403372F7D264E513C024C4867304C7F7BF160CFF83FA7418C0D491F3B65EB80340147484461549FD3FA876F38BEC49FB3FFD94258D8259C13FC142F38DFB8F0440ABF77FD7ECF611C0659FE866F97AFC3FCA6AF56EC2A9F4BF282F9E66ECC60740C82DF03C59FEE3BF03A0A33BD7C6DEBF2911190F8F40FF3FBC079AD4E188F0BF77E8C1853DA4FFBFDC6E0E338D63C8BF8C919E17AAB1F8BFF6E9AB95F275154072BA2B990A51DEBF80AD89FE86A914C0B2FDF15C22AA0CC0C0AE9BD5D74918C086CE1701765E14C0767D0551994609C0A020AA15BFA9FC3FF0B479512C1A0A40AFD0C90F13E411C002ACDD179C2106C0B20C08791FC20BC0CADF1D5D7076F0BF096239C24CC200C0214BB8ACDB320A400F51EA62E29FFEBFD4A7553FF4AC0940342DAAA62CDBE3BF8C7003272B02FDBF9D17E86FC65A06C062394CA7A4E1EFBFAC33AFA94987104063A79D13BD85E93FCAB8266537C60BC09915AAF1757016C09A367B0A0E0E0140F939D94C572C0A40F7752D9D32E2E9BF980859E9D20FBC3F2248A78ABD9F1AC02902E59CD976FDBF376F9C773E76FEBF668A98839E8D104052069E3F79E0ED3FC4C8C279C4C0AFBF6359B00E1C2EF33F8023C34E8E86B63FFDEEC76294A3B03F8CE9B298454F0DC03FE203BE7DC51240C496506EF00A0E40435F8CE33390BDBF10A363B6E077F7BFB5EF9DC1307EFFBF6433640BAA3203409AE938AB79E8DA3FD0A05F457A6AD83F707B4A05194C00C06369B01FFDA1B83F0AA8DB7E5DCFE4BFCE10BD13977406C06386600E7C38014063C5B8D22CB0F4BF49822913E63C06C0CD3BC0EC3AE4F1BFC9EBE7A8408406406E5CB0FCAABF0E40913AB1A1287502C0A03EC48294E6E5BF2AFB921D77ECD3BF86F22580E99612401299EFDAFBEE12402FE27D169F72DEBF1A12AAB95D2BD03F80FEC3BF84E4D1BF46F57DA29337D3BF44E7FAA9D2770BC070DF1F3BE43DF7BFD49550CE42C810C0AEA418019DC015C0121EE786D409FC3FB07330A845B7B0BF00D8534E2EA81140BE47B52FBAF20A40AC654B0D533900C0AC7C328AD8020AC044C15893F367044058EEA597966600C0298DE647C5461640B2C512C244D40140A5C5115FF5D10D40F85B681B5A20F53F3E714307AB9B15C0DB73560708DE0BC0E3C3065EC6770740A7F1A55E5DF815403F703367B4BA10C001858A082758E93F46716D59A950FD3F7D74A2810D3010C0CEB99E1AF501AC3F082A28149E8C02C09653FBF9B7A503C0761676446AD0F5BF047A7855E9C715C02FDF07DCB23702407A4692156796E0BFC2A94A5FC87610C00D532F50EA150D407416A43371A4EA3F745232DEB958CE3F5284285D26340440120D1DA4BBDA10C0DCBB2E2BB6350A4021A9CC7FC1F80740DCCEA2CF3EEC02C093871A9D7C47C0BF4CF11EF4EE62FA3F1F455C69229E084004215055D1D31DC01622288F3C7E0B405C7A5FF7E106EABFB21624B5BDCB01C0C1AC281AD00BC63F78F18A51E639E5BFDEB6257CB41111C0ED9C2CCB06E91040A75D26A8F528E13F3584A628C84DD73FCB4FCAD6B2DAE9BF565E1307505200C0481A95960A2906C001E11AEED6D41440C4092AFA42C7F93FD3D58AE7A1610240AEFA9CE837BA15C0D6926FA3782EE53FB4BFB6073F2A0040C10AD04FA4AFD13F1251AB2B2D2405C0D65E627A12C4FABFE248A3E1241807C02F1276638E0601C0F6CA724EC677054008908151ABAA00C0ED0514783D2912C075B26A5BB6FD0B4038D68C25032FFDBF88DF1805FC68F03F18DC9D3780AAF93F2E00913C826407C01386C7D710FD00C0E940C2FC73881AC0AA40161ED4DFF8BF23E90ED41CA8D4BFBA29964C45901440B46759B910E7E7BF7770729EF34CF13F5E3D7EFB731615400362F4EE074DF03F0E72037A536F16C002CEB1DCA936EC3FDAAD386DCA470240AAF9FE06804301C0AC6CD34C41A4F73F0A7108C1EF16F53F8EE769677A570A404EB0DE8BD3BBDCBF34122CF2674715C008AD77FBE2AFF6BFF2CC1A6F590CF1BF06B6D6CF1D45FDBF6B77D2E9EFC2FA3FAECE36EBD426FBBF06C25E2D256DD4BFF59AA424D7F2D4BF36BA24BCCA600D409A2FDFAB1C0DEA3FBF5E8292D19901408377DC369C2A02C06A96699049A1F63FD4778196896410C0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xAF1A1BF534D9EEBF5D68C43E63182BC0B30EF9ACDF004640E1B8166AC7042FC068C32D55A558E3BFB48BD0A80147E7BFDE8086ABB50F22407CB824E8F791E0BF5E640AC71335AC3FE5E0CC3D3EB0384096700C85302283C0ECE5CA123502E0BF1177316FAA7F29403C0B6D004C2D2140FEDFCACF8FEBEC3FFC84C788B980FB3F9495419B91682140BA3BAE03626AFC3F7C2FF32EC2AA28C0A0E72DF5D800ECBF6A36FBBFD473414047B67F20D41D15C022F83942BBFC29C08F5ED12EE06200C0CA3452BCB7ADF8BF92C4D0274059CD3F0F071692CBB65A403B39B36ADB29E5BF6D751C829A7850C02BA87AF503ACFEBFE0F94F1BBE0421401B1AFC174B762D400450FB60B07A0640A6B037713981EDBF7774783771120840271BCA5290261E40FA4AEBB838DD04C03337B809ED75494076E7E955122C2E4088633C81C4D90B40048540B6F2E6E2BF711DC2C5B3C85740D8A74DF430C6164088DFD55CB6DA4640CB4CB4CB05A95F402D0532A17855E83F0CD06B21CA714E40D3E7EEDDC7B6EA3FB0EB80D4033DB53F1CD90DBE1AB116400E023CA3AE730740CCB25AE9E0E7CA3F36E6E33AC2885740BF67F49ADDA52BC0288A6AB3E55132C005E4039D79140AC0FE2A506586CA2EC0ADFD02BDBE35F63F37A03BC439ABF1BF33684E7A09F3E93F4442C1A83404C2BFA980B4033B3A0B407498F928A08CE5BFACC176451EB2EFBF6D372FA2D25FDFBF20C10AD67BFCF73F2F82E41070EEF33F73A961C5F1C2FEBFA0A0C8E253C6EB3F3CEFC33B2EDF0A40DBED294C1FC1FABFC87F3826E810D13FED0ADE14104001C085A1606C6C7817407790CBF22F2DF2BFABBF497E69A251C0CDADB8811C59FA3F19ED33D0B39E08C072B506C7D29ADFBFB1D4502163540C4036433AE720971EC058223F3C51FBC33F747476345E9219C0D5E727AD70D5E83F8BBD22263EF53440FA6B7B16DA6D30C0DCF8E22E6B6AF33FA60B93531B594B40F390AC02187825401F706EDD890E7E40F04D0899EE26D43FAD22DFC3AF9C05401AF618B3DDFBF63FC20C397824181640296906B750403F405BF097F2395B11405E668AE91D1E55C00BC514437BE834408F86D7BA189A30407ED944D1F3B5EC3F7C8648D4C05FEE3FD6F2BC88A2D310404578B41014E1E13FE0E195B9CB9B2440019B8AA4C4D5DB3FD4793A00CA890540E670C1F5007D274027E38C5A94E57FC0933E1C834956F13FAAB421722FB563401672D571A660F23FA450BA5172C009407AD78EAECEF5C83F19F9AF092DED02C04A04866D38554B40FD002DB17CDBF0BF305A2406E54511C01AC2DAD43B71B3BF2FF4F4A021CAFF3FA736D0826D73C13F04A27BF3EB6FF7BF7D972733437922C0DF7EC81E854031402B824246DBC9324006BD815E583F4CC0FABDA2BE508B22C0EE3C7A38177BE7BFEB649DD6E2DE51C094C0A9EFCA0EEE3FFADF0EA7492DC83FD3E041C8B29037C027E31F40771B1F40D3AB7C972E83C73FF6AF47B3330871C01A7AEE405B62CABF6AD0FF1FBCFF5D40ECADB92C737F0B4092BFC225D4921040FD2CFCD1272AFEBFE572C5B9F579CEBFF63DB6F1F86BD2BFDC33C31156763240C8450E08EA8A07C0971EC89F7EB8F03FCC7E7C4055AF14402766D2F655E038C03F883AA278A463C08964CEA593522240D7ECD0EB615E01C063111B632EFAD03FD859EF2584E119C01664719FB522EE3FFF180007AFD86AC046B25BF7B1523340C62F99F005CB4440CC164EFF0BA830C07C1A47E3B3623140FFF03BE9F3F051C0BB6FDBE0423D0240AEEFE55938EC0BC08096B66D803931C0EEC1CBD2EEAECCBF06354C1DA2DE04409676183EC993F2BF42B014DE52E8B0BF6A136D09CB1CECBFB9D51C4FC22713C042DC54BA9B9833C0500FD1C30AC93D402CD4AF5217FAD5BF697F07E626CC5A40FAFF54CCF46C0CC0ADBC3B5A9213F93F14DFE5FCA8C6224064201072C2C0E3BF8A983678DBA015C0880DEF7EA2CFF4BFD8FEF1ECD6F759C0522F861CE713C73F20BDE92E84E009C06F021480C6D4E53F0A755785DFE6034025FCB03329B991C04E4F7AB8D199214093C8B26278C942C05E325BEDD9282E40481AA53F8D90F13F3D20E84F245320C05896117905D925C01FAC840E5D314AC0BC9D56DB66C3F63FF88899681118F6BFF4BEA780465C2AC066BE70F65A87F63F3ECE8746A383F0BF530173849B4213C0D511D0AB99B42A40E3C4542ABCCAD2BF273CAF81925511C0743B87607264F3BF73DEC650ED4E2240B591E261E72308C0658796477A7D4440B241914D351723C0A54ECDFBC87922406759FA3ADE6F00C046B2C92CEA4EEA3F061DDC8667E7ED3F774C9BA5D35233401D21B42D311352C025F3D43229C600C0AF095837FA436CC0C9B4E0C0865B17409E8200D37A4D08403141081C794A05403477BE5D1F67C13FFCC295DB8FFC1940BF549E8A8C4D46C0354A7294A10B0740E9C4E030C4E7FABFC704EBF1777B23402CB5DB8EEB51E5BFB4E1EC7D09FADFBF6982A583ACA30B40DC62785F92A3F3BF0F8FF3F90C590CC03DBCD90C6689C8BF30E9D904E7DD01C0C3FC5E5D6CBA5A4079BDE8219076DFBF718EAAB91EE455C0FBAB7DDB63FA31C0E56258507E196BC058CF9BFDF75754C05B953079058427C07561743354530740EA9EE5ED71152A40C0040CAE60E545C04B1D668F59AD1FC0E0529135A40C30C0CCBA7A426C86F3BF6A1C6767AD0010C07F17A529A7662A40E389DBCF17880AC02C583E689FB92840E27E8351B427E5BF56FE96E801DD07C0C428056F584A20C04C168D4E3CB6F2BFD5A8CC0196253F40F8941F7CD250EC3F59939DB3E01430C06B6168F07B1161C02D2A0F93B69F1040F9CABF4B1E512A40671617F2BECCECBF8A664813381EBC3FECC4B394724B78C073B4962D0E9708C0ED0911B552400AC03B7E1AB310573F40EAE9E1129034F13F4CE952B1FAC5AFBFBA1F24A18A1DF83F94ACEDF8FF8DB63F3E237D5094A6B03FEBA79AA3717D33C0B8890AD2FC494B40B4407689DA5C3540B9FDDF1609A1BDBF84E28819096B00C02FD199B250130CC05B453628EEDB1540A8BA92B238B5DB3F963953B53303D93FAC33297C4C270EC0B38F905CB9ABB83FD97D6AEAE14EE6BF48EAB1D4A37F20C0A341F05C51FB1040304CA69E53F4FABFBE1BEF2B7E0D20C0620E7EB63FDCF5BFA23440204DA02040F4A109A3EC553740BD1C177FC0E413C048E1A5D0A1A6E7BFA81851A03F3FD4BFC7BAA96D47134A405D21CDF2EB6A4C403AFEFA9AFF9BDFBF6C51600A8B57D03F1AEBB6F66B20D2BF322FCCF6D581D3BF582A0C21EEF32EC0F9E0E7DF432900C0B98C75B7159840C002065C5701C05CC02E95C5B65A6106401051794950BAB0BF9567EBA9D6A64440B866FE5C45002D40ECF795F369DE0DC0C9F7C96E98C929C0BB1B3549427A1940390B51DF3F8F0EC0C3B3AA4528636040AED0C996F65B1240278E4E60A0C634405AD474FFB4D2FB3F8544003A2FBB5BC095D1CB521F4530C024FBC30162BD2240A73ED8D7D75B5E4062CB4B06316040C0D305744B1014EC3F486040EA9B590840AB0F527F179A3CC0FF9C3BA88805AC3F4472E4F6962014C04CEB6556862417C008A6B00D933AFDBF8041E971A6F45CC08257AE75214B13404C013AC42357E1BFDE7A40B207A63EC08C187FAD76F33240653F81E32BD4ED3F3A65A163B5A1CE3F3FFCA89855D518408C03E34C72E540C0ABAA80781A702A40345D3B7CF3F62340EC6936E8971B15C0EFDD3817BB52C0BF64DEFF6B9C0A044002ED7F2EDBA6254079731638C20E8BC09AEF6F00D60C2F40098BCDA42CFEECBFB7CA9295F94712C0B6C01422C227C63F1712185E3CD1E6BF0D81098A19D441C0787548F545224140484C42EC8CFEE13F5B155DD17CD2D73F08059AF3A8C2ECBF8A2B63DD913F0EC0D8A19D4410CB1FC0DF430C1042D65640FE50BAF34F3C0340B326837774B3134002789FED2E925CC0DC81AC8E34C3E63FC673CB1C57A40D4028AB5F397DE9D13F8DA99F2876F51BC0602CA9B0138F04C00BC030533FE121C0DB512202B78F10C0370A134DA5221D40DFA35D8473A00FC0DC2ECD342B6D47C07D5911142D86304099775472EA2308C005592DF83871F33FC3F18B3DFC16034028C86830359022C0313654718C7B10C013AF0D829ABF77C0D161B61AAD1602C032A1440E6804D5BF2A464EF3935B5540477F85D52A30EABFBB8CC98DDFDFF43F53C26337255958407D37B3EE5845F33F71067725A50C61C0961645BEBB01F03FD70724F8EA721340A46BEA4C671311C0DF82B93CF09D0040758974B6D6BFFB3F22D2A9D4EFE02A407960913E72B5DDBF873C89C8608A59C0CD135E5A5817FFBFD537E1DC5676F4BF536F6FBF234708C018339A1D838D0440D4FB6AC5C91805C05C02812660C6D4BFB568AFE41D53D5BF1B60CBCF5DA833404C4C58179506ED3F1AF1FF3893D41140299D2EAFFE2A13C09B3E2F7B7DF7FE3F3DCDF865651B3EC0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
