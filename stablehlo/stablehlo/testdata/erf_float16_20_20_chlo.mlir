// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.erf %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x432CF63C9B378939623453C2BBBC3C42DB338035BCB8F5BC083B2BC027C4814625C33FBE8FBF28B76B43C94105478B3F27BFB5C1463349B467BB4243A937A6BCC1B3C0C0DD3D9844373E9244B13CDB4329BDCB3AC5BF25B3F34641C26A4176424F44E74013AE29400C42F440E94434C1C437A4AF4841E83BA13C33BCA34292AC9A3E5F3E85381647723905C2EEC4E0C5B0BCB7C1F9BF16C39542D4BD4946E8B9A94305B0B2C4E43EA842F6429E39D7C132C129BFEA42003A9B472DC24B3E7440523F6943EDB8D83D2C401CBEB7C16F3D44C2A9BC5B406EBA89B63FC770A50944FDBD04BC72BB52BB3BBB324021C43C3C3944F7BE9744B64049B433C6F746DA42B7BCB6C3BEC6ECAE443CAAC4C4C098330FBFB6BBB8BCD53CDD4156439934272F86C44F451FC0EF3E453EDE43903B1B35D2AFC7C529C0002E92B439C44939AC3C61B100C129C6F043A24167C1A93D24C815451C3C2E3DB44260C1C4B8C8BA76C0EA36303E6444A3C1F0354EB74C409CBF7EC48B40F232DB4046C31643AC41F6C47043AF44A9BC23385DC3F5410841F944823BA6BBB8C6D84312C197449C3013BB02C26EC4F2402D3DD73405B0764249C06B3847BCEEBDEFC0444580C45643AE392243B73EDEBE36B0F23F1AC7493C4AB14AB953AF64C4B9BD66C249B564C0273AF84599C4713CDDBBB1C19639023B3B4376BDED4557C51E3348BE294261C0EA2A374271405B38E2BC2CC0F63F7643694105BDB43FB73BC1C1E3B9D6C218C5D7414245EAB535C59FB9E5B17D44B34040BE51C16140CAC37EC3A73E4E3740C4433B124162341EBE8FAE1A48743D0D325DBCCE3BE9C0034636B2D63F513C1C40C0B60B43AA412642FF4102C59DBB97C7AB3D5B440B42D03D2CB90D4045BF723F73BF38C4CEBD9ABE7C454DC017C564393D384A3F823D59436EC4C144E93FF94335BC5E4302BF25C0ECB8F7BCF2B9BD3DBD447CA49B4294C2303F9C46DAB1E341B1C20DBFA2BD434065C54DC2CBBC4FBEB5B95A40B4C1EDC0A53E5B4418C4D030CFBD3EC4A5BD9BC5C6C0BAC258B81C440BC217C2DCAB86BE4F44BBC24DACBF3D19C4DCBC52B877B833427C2CF1C25A4B353A7F4086BFEC3D6730463B76C395BC82C4"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCD2C5D3BFA376139D33400BC3FBB003C5834F835C7B85DBB4A3AF9BB00BC003C00BCC8BBF1BB91B7003C003C003CF03BE9BB00BC0934B9B479BA003C033833BB4AB4FEBBB23B003CC73B003C393B003C75BB293AF4BBEEB3003C00BC003C003C003CFF3BD5AEF93B003CFF3B003C00BC0F384AB0003CB43A303BE6BA003C26ADD83BCE3B9B38003C503900BC00BC00BC38BB00BCF6BB00BC003CAFBB003CA1B9003C83B000BCE23B003C003C6F3900BC00BCE9BB003CB039003C00BCCB3BFD3BEC3B003CEEB8B03BF93BC1BB00BC903B00BC34BBFC3BF4B9FCB600BC22A6003CBABBC1BA7FBA6FBA64BAFA3B00BCED3A003CE4BB003CFE3BB9B400BC003C003C3CBB00BC00BCC8AFF33A00BCFEBB3534E6BB9EBA3DBB4D3B003C003C0C35053000BC003CF9BBE33BC93B003C8D3A923564B000BCF9BBC02E05B500BC3339363B03B2FFBB00BC003C003C00BCA33B00BC003CD43A773B003C00BCCEB828BAFDBB5837C53B003C00BC6836B4B7FB3BF1BB00BCFD3BB733FF3B00BC003C003C00BC003C003C34BB483800BC003CFF3B003C863A97BA00BC003CFFBB003C2A3150BA00BC00BCFF3B763B4D3583B0003CFBBB8638F5BAB6BBFFBB003C00BC003C7A39003CDC3BE1BBB9B0F63B00BCF63AEAB134B91DB000BCA8BB00BCC1B5FCBBC939003C00BC123BAFBA00BC6A39473A003C92BB003C00BCE733CABB003CFCBBCB2B003CFD3B783853BBF9BBF63B003C003C64BBF33B9E3A00BC9EB900BC00BC003C003C62B600BC70B994B2003CFE3BC8BB00BCFC3B00BC00BCDA3BB43700BC683AFF3BD334C1BB60AF003C923BBF3204BBA93AFFBB003CECB2F53BFC3AF83B30B7003C003C003C003C00BC93BA00BCA43B003C003CAE3B1EB9F73BEBBBEF3BEFBB00BCAEBBD8BB003CFBBB00BC46395F38EC3B973B003C00BC003CF53B003CE8BA003CE5BBF9BBEDB85EBBA7B9A93B003C0FA5003C00BCE93B003C88B2003C00BCE6BBA1BBFB3B00BC00BC47BBCBBB7FB9FC3B00BCFFBBD93B003C00BC6431AEBB00BCA2BB00BCFEBB00BC76B8003C00BC00BC6EACD5BB003C00BCD8ACAA3B00BC50BB71B88FB8003C0D2D00BC003CD239FD3BF0BBB63BF030693A00BC28BB00BC"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
