// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.exponential %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x72B91ACA1A300340D81D3857C4C01AC0BF89486CEAEF0BC039DF07ACC2660540303A1B81283D0F40806998208FABF0BF0C63096925F31040CE99E70D72231240E0E3926B738E10C0EB3BED1AABEF0D40D249D34774820C4052174D93614AF03FAB0DBC34092E09402004884F014BD53FDC1D782B02D61140AA9C640309C807C0F87BE7D9827AF83F82818BC7EFC516400889F96C00641740069C374F0EF600400E5720C8E52FEB3F3DBD1BB78A9BEBBF403E4AFBD63F18C0D29574CE3B10BEBFF8F5DCE3AAD7EE3F069D5C4AB18003C0A46DA7F0BA59C23F1B34D0C47E53F3BF2CBCA86C2AAB1940B776D16A6175FF3F94D4746103B8DC3F6703B335E88DF83F8811B2C1BD57FD3F2CB7A766994FF6BFEABD234D1CEE0DC0A1A4871DC87300C00588378863B114401CBFD10A87530E40BE56AFBCD641DC3F9EDA7E34124310404F60AEE9A0D811404DDBC789AF410FC07C28C347A7F4FD3F740A7B6B0E9EEFBF719724D8BC9F01407B2AADE9D7D419404A11E1E6A6C006C0B473273EA1CB0DC073CAAA1AB837D13F798D426223FAE8BF8E0752C71714C43F9D24D99E576CEA3FBBF6634562B8EDBF6AA41CA34264F03F20A78215CD90F6BF26FAAB7B9FF80740A28BE1138962F7BF077001BD7E2F09C078DF97EB3C07BF3F4FD5920824C30740E09552C3219BF53F5A129A9E9F131D4076A165A19E9CF13FC68097A11D3EF73F98EEA6FE50FEEFBFD345C2F8FCD4F5BF6C7C7FA3AAFE0C4041181617209CFDBF1E4B5BE3AC460D4048B138B4DB360E4076DC657B968BFEBFE05FABF8C2260CC0C55E907F6831EA3FEDBA7BCDBA2CAB3F00D8CA4312C4104079BC539BCB62E2BF8F39E80DDF920140ACC6B747FAEDFE3F8BE23A8C8916F13F96283D086966BC3FCE4485330520DC3F774A1AC3C450D7BFAA0BBE74AB3905C0AC8EA03C6449FF3F05D4A396F405E5BF9E324DA994D2BB3F3C5707D38858F9BF242A6D3076DDE1BF165177FB314F0140BEFC451EEF1804C05779AA80388415C02C401457538003C03F294A94F759EFBF8F3291E4AE8617C052A5C9A40DACFF3F1B24DB62456911C054C831DA20B6F9BF077E58D86EB6F83FAE9A9890FDF016C05AC60A0C7736E93F728EF4F81CF318C0C01F2CED1E9617C0C4242F5CA8CBFA3FBA40CF2C6C280CC0AB9A92AE54F0F03F16B7015A3D93E3BFF6D663E5DD8D00C08AAF3C281FF105C03AA4CA317920F43F6095F52F6311C73F98FFC4D13F5804C0215D2ECCACD005C004F7734AF7B8F33F1BEA7EC8E7D5F93F642EE07F135E21C0166F3B927C1ED3BF9278C6B2C799F23F1F44BB4101A707C0C2CCD99B9673AEBFAE14A9A6990AF83FF23E6A1B9BE31040B4A9C6648EBBE03FA023AD5AE358C53F6D54378B30EB00C096D741C07EA8EABFBA97B6733993C5BF76049D3122BB05C08135BB6E3B470BC0B4C50767BC7E0DC0A522B405765E02C0AE4B23AF6B06ED3FCC9040B31908EE3F3C5DDC719704F13FA4D741CBCB94C4BFB25CB4E8A4FBFDBF30E8CA42A1EA05C062D4E267DB8AFC3F3D991274EA7801C0B687F3B64F10F43F66AD518A4A3812403CC95F0962F90E404CB15BE203E6FE3F1CFC59D2C6AF16C024641C344BDE0E405644793BD676F43F783082EBD16001C0B071FD792BECA03FD9914FEE9AFACBBFA297369232A402C0841C97ED7FC6FF3F762820E3065CF23FBAB3A5BCA2D107C0A0828C1D53870D409305956A6EE9E3BFBB5A65C51289104053753E34F106F6BFCA1F94CDB9E2EDBF92ABD8018A2A14C0C07936FDB8D20BC0FCA994705A9405C05431FC7D9B4F0E40C6FC2F757755D73FFF538DE42432F03FCCC39ADCDCA1E23F70B0FD85B4940CC0FAEA47B563B9FABF64D2C812ADD7E6BFEF60629006880CC0224260C1DFE900401CF280992D0FE3BFC5812CA9D3C0E83F0418DB94DE9C0C409B02853B612103409CBBAE20CED007C06C9F57566655F7BF9B843C63E8791A402AAC1A14E72514C080B6174D817E05C0A323C5148600F7BF4DC4ECA570CE114093298B47478103405B83D7EC1C4A05C0F4E113584F7CE43FEAA0E808C732FEBFB338F614C6BA024022A2B70B582A0F4088EC77991CB5D5BF1E304054B7CED83FF5956F50C31504C0411178FAABBCE2BF525427694C51DD3F25E89D94F2F0E43F5E4EFCF60F750F40AE6E9B74EC180F40F7209EE52158EABF403C385CB68B0140F42885E2DB40E03F5D268EC161FBF43F38A1A43225DC12C0895420AE5E6FC63FB3CDAE0C4F21F7BFF38ED08935680F407BFC7C6DC96501C0ECFFE73A6E3B19400931D36CF150FCBFF1ED62D19B68F1BF99C95EAC8EE5F2BFA76E1F4B04BDE2BF4AE4E32EC77004C04A10803DAB0810C04A33934B558AE9BFA44F6A883091F33F29696BF5E21A08C0481B36449BF101C02A20BCAEE729FF3F408CB1D596E7F6BF578F5C5C395AF33FAC53ECD259C0E8BF602DF33701E1FE3F393629D24E79F63FDAD1EF97BE02E8BF5EC75202CD7F1240A3F51EA9E261F83F8877A3729B6003C0DA011225DA480F4071E213D7C8EF11406B54E00F2B0E1A404AAFDDA1CE061FC012C2FB04F6F50540F0CDD2F49534AEBFD72EFC87B30AC1BF2817671EC5F9CE3FE85080DE2F4FF8BFC22DCEBED2F81CC0D4915C1727B0F0BF1E96B1E2C656E13F42B5DC37DEE1C33FCE4D434DC2E30AC0B848799203DF09404AE2BAE1F27B1B4024C096DD9EB702C09289B5DD1D56E4BF5C7A7A9E510710409EF2B0C9D4830C40996949A44A79114031E5DB18EE021640B2CB440A0FC317C0CF2C76D1D29513401598700C8281CD3FADC82BE23F320040ABB80120DBD5F1BF52C79A7148F5054098645AC2B8300FC052C307ED9FC9FFBFCD180A67E1A00A400A6C6A9D5313EABF803E506EAD6900C05E88340965C20D40FDA3A644A4C2F83F408D25815127AA3FCADC1E2B06D602C028E3C236621DE23FA76B5AA5EFFB0C4094ADB8E05724F1BFB8FC7F0822C0D7BF6025F59625290040539D8AEF146B12C0C194897A5C3BFA3F784B61509A80FABF57A6DFBD252009C09AF958E3322D04C0ABEC1237DD7CFB3F0058A90AB766EFBF775EFCC1D2A7E63F8C66ECBCE112BF3F3242F0671C10B5BFE9089F2C38761840E6AC251A2C9D0AC0297C3304F2BE00C0CBFE789D22DC11C09430FA4E9A5CF83F0EB064849AF90040D5783BCEE3D7E1BF927BA34A0C8FCD3FD3473D55329705401BE3493DEEE81BC0055AA1A612CB0DC0586C5A5711EC184040FFE480725EFD3FC697358A83451B40E1C6BFDB38281940A8664F8AE20CED3FCED2AD26024409C0BC50B898F3F004C0271090A832F00E4066F9CA8285120BC00EDC1FF5DAD8F7BF3299D6C6748604407CA63AFD114CF53FECC821EF0D2814C08D093B09E799FCBF259AB994F97BC63F5ACFD8487730FFBF097E09DD23A8F1BFD39E009238A4D0BF7EA72AA807E1C33FE28FC384A17DF53F04FB9F9953CB0FC0C4C96C8E5B7A03C04A379958DE1E0640D8CA27B89C9AE3BFAD97F2950B50EF3F841D048316950640FD58FC5E818009C0185298D0707509C0AB1264ABCE04F43F98E85FC1558C16C0DB4EE53D0EB4014041C5668471DA114003F2E1483237F9BF25B4A216883B0FC006990F9EE8F9004072DC0148FA080940B3F17B356072E53F7C8C69CAA8EC0A40C85D94AA309CFB3F608FB041BB2D0BC0B99E27EFB1D8F13FD901455D49EAE1BF05A5BDB88C41CDBFED75CC9D03C3F73FBF0525536FF3DA3F6ED412EF2DB209C0769DB78A57C6044020E2ECEE35A5F13F72049623743A1C40C74F4D23159BD9BFA66F6E0D55F21940CC1F76BA9B3B06407ADC46D83B0F9DBFBBC5AD088C971A405CBE3B910B5EE13FCE52064DFEFEE03FFA647A67297B1140598BF3CA56BA03C0714F41401D2907C06242445895250340567C73BC19F2194022F0DC2B1721E1BF5021CA1925B3084076B9D4C367A4F2BFCEFB098366B311C02C1760AA5B14FABFFE48851BC4B01140F6F0815CB8BFF2BF94A563F2A4B1DB3F41BB6218BF1C044069241CBF444DEA3F9645D6A9631300401A339E1CCA32FABF3704EFDB76D313C0C5CB9891C9AB12C099DD59FE60651140037AE96504E90540B1F90ABA7F05FA3FD23D2BC9E55FFC3F7A7A3C54A6D4F23F82E1E3F8EF0FED3F7B1BFB58339C05C0AB10371AC62FF83F1484E26564420940C34EC26446DE0A40686B91C50A1F18C0EF21EAA867D7ECBF879DBF51DC730F4011521166B780F53FB8A43C10F5C6FA3F04EA32FA2EE6E2BF5BCF008A6B030740F8DC7F9FCA280FC021585435F33EF1BF0E828D5D166C10C0A90CB8AC682002C0EBC1910D4A61FD3F686F814074D2F8BF651404F5BCC6FE3FC28A147E817211404A5CFB693ED4FC3F3C20ACACEB5FCB3F1C4A4A07713F1140A2E8CE8C1E911040AB0D798525B70540D2AA74CF2633D5BF7822BA91F0F0EEBFE62010513581D23F9F3A547CB02CE13FC48B6FB980E306C0026860C1302906403CD0EC2126D99ABFF7BCD434A2130D40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x97A126B457032640FACE414FD867543FC3440D497A2A9F3FBAACBC84A1072D40F6A2D1FC55D248404CAE1F301994D63F926D542EC74E514017DC4BCC014C5740AB845A9AC951903F66301BFD77174540E62DFCDF90A54140A56236240F250640C52E3DEBFC4637401FE92B7AD350F63FC9F6F6A4A0995540B1841E617932AA3F040EDC53967812401A80AF5EEF8D7240ED04A6C7C0A67540B7CD49A228AA2040B1F1915FAAB502405F7FEE282302DB3FA896A14B2214633FB83265A04F74EC3F6ADCE7DA42F90440BA863427895CB63FE9D0E6076577F23F47CF3EAD0220D33FDD4C49B6102283401CA799789C921C40272EF46DA90FF93FA5657721088F12400B90DC7E940819406F10BE7698BDCF3FFB5051BB1F4B983F4D2B957FE95EC03FF32D88697E0F664071D1B37344254640074208B18DE1F83FFCD842B8A1254D4041D3FD4FCBA7554068DEA968E594943F64EF4CDFD8021A404C57710BD5D3D73F53231F03AD1A22407EC2B68A88ED8340C1E43E80E0CAAD3F6C53249EB7B4983F4D7A8FD063F0F43F88004CDB8252DD3F9E9B317CA5B7F23F332A16D4AE440240D34A8F2D6748D93F5A8E0C92FD480640DE47C4DC453DCF3F95F1E7CA68033440C2DCA62215AECD3F1F305D52E2FAA53FA4E620ACCA0FF23F343048BC587F3340EAD6866DF6DE0E40CE4CEFCA656D96406E32C8C7110D08405E61C91B14191140F6BB335C938CD73F2D3912E6405AD03F2576C4CB09C04240D064CDFB2B1DC43F18B0C3F5CF6B434071E3AD4275D64540E57689D3C4F8C23F65A0EBDDA5579E3F9B10A0BC2823024039F7C43F45DFF03F07BC8C1EB387504040BCFA03B503E23F54778C72A6FD2140C52A7A38C3A41B403E50DF01C8460740F740387090E0F13F7C8AB8666BD4F83FDCEA4274D03AE63FAECBE90A9807B23F923D23ED79441C40F8E75F77DD96E03F3DAC28A340D6F13F62261E20AD41CA3FA463CEBC614FE23F2D9C3F9FF1672140AD00AABD6CC2B43F72CF9F84E5E3723FBE12FAC88F5DB63F0C05CF48BE06D83FE13F7E3026DC663FCC056666E6F41C4045F4D2DCF05B8A3F861E63B8D3A9C93F14F4AE9A45BE12404D9E762B55756A3F350B8B3E15970140CC379D06BA03603F44BCB1C19584663F6CAECDD96659154037BE3CCF59519E3FF1A16E26750F07401EB0480A775BE13FAADBA51EDF29C03F6A32F09F1F7CB03F6C8B718A1E250C40BECAD03FDF28F33F0CB934BFA320B43F0E64171384BFB03F78D6631753710B404126369B211B1440FCFDD52D4F31263F199618CC75BCE73F5E81DDC99F950940D52FF17A839FAA3F2162CD4FFB26EE3F95F6B54524F911407EAF9B4B0B0C51408C75C4508FFDFA3FDE8CFF9060E7F23F0BD8BA4419E3BE3FFB51AE4458D2DB3FE4844B114B09EB3F68CA02E7D9ECB03F8F71EA2CB9EBA03F60CB6FCCB2A6993FB118D75F15C4B93F65AE46B3D2D0034035512CCFEC720440D5C10C37BB2C0740200B5A383E3FEB3F84ABA2777BA6C33F883ECD928589B03F9A413896E7CF17402F1416EB69D2BC3F6AFAC3CBBE080C40327B5536A9C65740AAD424A87D034840B6F078DA04971B401F350221BA326C3F6F1E0067B6B24740964FB89EA6BE0C40D78F49CCBC29BD3FF95F4077A489F03F6869E36C8AB7E93FCBE98DCF42E7B83F7AACA0D5EA241D40A23981A39E3309401FBA370A1C13AA3F42624FE0420B44405F63595BF52CE13F9C324E498F354F40CDD396428227D03F98EDF1150927D93F672A2DD8C1797A3FCBCD0B58059D9F3F9112F2ACAD3FB13F6B1EA6156D1A464066772E76EF09F73FCAFE26EC9C030640483CA1C727A4FC3FD73EE645A6C19C3F44D67C93DE16C83FB6F8C44D5358DF3FEB8C4F3F5EEF9C3F3A09A9B3DB902040EDE9307CADA3E13FFF6D0F54E1560140D1DF430F36E04140B359F777F8DA25405E63EF24D115AA3F8198AD087DC6CD3F10160801DE6987400B8EBDD283987A3F54C2828E096FB13F36F574481666CE3F7BEE9E8BE870554016A2DC4630E726409016941CAFE2B13FE3CD457B5759FE3F3796B2693963C33F5E1DA7B090C92440E0684C613A984840A6FE49499CCBE63F1042E3505093F73F9C5156F3A8CAB43F5ACA4C3063D1E13FF03FDC92F74BF93F8E9074B8C0C8FE3F7D8245CD2D8249403CC2AA45E6624840AE8C6AE18E18DC3F0976002F94ED2140A61AE278D796FA3FC4528B30ABB00D40CD6F27209E59823FA3D4442BAE10F33F29F779EE0B28CE3FF045C8EB52594940A3841F49A717BD3F6407DDAFBB27814039033882CDCEC53F8C639FF8618FD53F33CAB14533A5D33F0838D70332D1E13F7B96507E4BE3B33F21E6230FDC98923FEF6E7EC689CFDC3F04D3ED7C6E2D0B4052B0E4769428A93F4501D61B292CBB3F7328EBCB0F0D1C4009C4CCF39A95CE3F925637F7B0D00A406AF59C72A687DD3F2EF8666A628E1B40879D0FE7BC4B10406C69FB44A938DE3FA543CB63E87E5940FFDAA4593E5C12408038EB23EDB6B63FF564FEEEB8F6484030896EE795265640D59BBACA441385408FF543A8C70A3C3FD270E652DD212F40B1BB0260B12AEE3F4560E10AD002EC3F10CF8B837261F43F1D7866DE8803CC3F45E4EB1D466F473FE0F50CA69E8DD63F71B870AFBA81FB3F5F4A79C54EB0F23F949905F04FC3A13F26E700B2D6603940B5B6960DA21F8E40AE61BD9E15ABB83F8017B61402F3E03F141E9D00B17E4B40CD8748B69AA841401E84A588F3BA534056B7913B94AC6E4001CC8C14148D653FCB279C3174B96040780C134DE125F43FED9D7A8B564A1E40A37BEE011EFED43F8ABBABF5391F2F4052B4B37DB8C0943F4333FC22EE8DC13F9B57472EE3E53B4006D2C44F3955DC3FA26BBDD2A373C03F3F160C846AA1444036E2485A98CC1240DC294429AAD6F03F67CF86C8064EB83F52EF27FE882EFC3FB960399CA4B9424093D8BC3A24ECD53F431218A14314E63F4070FDEFF2271E40186ECF52047E843F8C18CC15379C1440ADAD9E42F66CC83FA5CE1FCC3525A63FF91F2534198EB43FA2EF94DE0A4B164084B222E82DFDD73F1940AAE63B3D00407D7381FF9C10F23FEB64E210F878ED3FEF5BD057C94C7C40E1BC71DDC562A23F48B2DA82C78FBF3F19432480EB8F873F4CD3B17F2F561240106ACD258EB12040837F832D9252E23FCDAF72050328F43FFB3877C97CB92D401479B926B58F4E3F8A89250970B6983F97946C3A6FC07F40C2A26BB5141319408F80DA2165908C4012411DA01ED6804012E311DCD3D403409491A012CEC2A53FB4C24E7D6CAEB23F41B47751FBE747402B6E8B9EA85CA13F556E7F2BBDD5CC3F0DDAAD65AE042A40ECA8E196E1470E4029AF1510398A7A3F7C9FD8843D6CC53F1477AEE58E12F33F89EFD0512639C23FDC8A302B6F3AD53FA00477C64EACE83F90E2D4712FB0F23F0AA3DE373FA60E40B2245A9C6C3E933F34B83437456EB63FBD3E547DA8C22F40BCC688C37757E13FAA0D8B17BE480540BBB6E615E7D230405A1F8B1BA720A53F4D3B29F9F33DA53F303B2BEB9DF40B40E31430D0F2306D3FA2071A7DE24822405569B4D8A0B155403001AABF9B78CA3FF3175CABC0A4943F1F66A22131B220400FDED06A21DC364048AE92994046FF3F44EBA2DA18F33C40CEC11D60DB761640A4A6BB3CFF21A13FC6F19A2C0A68084003AF539B0C48E23FDCD70D012E76E93FE95B6C046DA9114088BB74B9DD60F83F9F3D96640B9FA43F5725E313BBD72A40EA91BA38FF190840DFD0E17E37249240E0BB33D3C372E53F601ED0DE94828440F86998C7C71A30404CD02DA7CA1AEF3F6313B76FE4198840C2CAADCFFA87FB3F8918BFB1AC36FB3FD2CD83382FC453406ED0EE5CA6BDB53F97604F9E9B4FAC3FD145F05677E62540DAD350C26481844081550F296ABCE23FA4F569EBEEEB354081F4D6E8D5F5D33FAA3830E2B484883FDF1905526914C93F0EE6D26E21D45440C3A7E289DFD3D33FC63715CEBDA9F83FB67E47EB9AB5284080AF801EFA320240492DFB325ED61D401D40412DE3E4C83F16CB098A4FD37C3FD45C143BC83C833F850492EEAD5953406864C0E9A6EF2E40F62C718949571440020AC0D24D9017401133B32D70F4094047E4053AB8D60340A8783B92CA2EB13FDED497001723124029D5325583823740A7F2440D3ABF3C409E5B8C9D19B3633F3FC67F9E9EFCD93F3F377324597E49403DDF70DF28AC0E40B6EA512E225315402180BDEF54BAE13F533AB8ED4AC131409359941455D5943FC4CE33EBCDC7D53F203DAF745DE0903F3576ECFBFE8EBA3FE372274A8917194054BB2DFF5821CB3FB87FCA874A611B40E33D9A4097995340D6C5827A1B3E18400B4DB65BB6D0F33FCD8A853483A55240F628EA9C95744F40DDA2DC6C21312E4067A6FC5A15FAE63F483D2FA31B56D83FBF983AE5475DF53FBD325BE9A45DFB3FBCDB1531304AAD3F5A542A76BDEB2F402D1FA660012CEF3F6B6A43C06EF14240"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
