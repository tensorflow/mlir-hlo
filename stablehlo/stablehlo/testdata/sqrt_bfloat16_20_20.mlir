// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.sqrt %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x9BBE05C0D240DA3FDD3F2F4017C097404EC0D93F49C078C0833F043F73C093BEBCC0433F403F33C06CC030406BC0DC3F053F0F3F0DBFFEBFB43EFC3F264099BFAD3F4BBFB1C087C05DC026C060C0733F6640F2BFCB3F2B40A33E2C40DEC0A1C0E7BC324032C031407E3FA8C014BE6CC01F3F833ED53F81C001C03D40923F4C4045BFE8BE07C0203F25404C407B40C33DF13FAB3F9DBE52BF5B3F61406ABE063FBFBF1241013EFC3F953F08C013C068C0ABBF4B403EC0183F56C007C011BF89BF8A4024403140533EEABFF4BF8EC089BD2940BEBF9D403D408DBFDDBFE8BF88BC18C059C0F7BE35C035C0DFBF514093C04C402ABD2FC0393F88BF50BF073F3B4089408A3F4740F2BE9FC0BBC03AC0F5C0F93F21C05EC0EF3F523E02C09CBFC13FD53F03C01F404BC07CC0F53F15BD8E3F53C0FFBF03C0F93EE2BF00402840353F5540124007BFDABFA4BF933E03C014BE97C0643E31403BBD8EBF203E8D4090C0B8BF123E88BFD440C94012BF4140B53F964005BF05C0833FA5C020403B405D3F8E402B40354078C0FF3F70408C40363F3A40C640A03F4EC0A0C0BF3E60BFFC3F4A3DAABF0BC0BE3D7640B9BF8CC07EBFB13EC43E083EBD3E6EBFCD3FB3C084BF41C047C0DABFCBBE9AC0A2404ABF383D89BE503F6A403E40D0C0B3C096BEB3BFE640C43E59400E40514086407640E1BEF2BFBA3F3DBF32BE313F6440C4BE844089C028C0F8BFBABE9B3F7DBF6BBFAABF9FC09BC05C3F8E3F7E4081403A40E2C0BBBF55C066BE23405DC001C08FBE45C0B63E2EBED3409CC07B3F9BBE0E3F8CC07ABF2B3EEB3F154026402C3F5CBDC3C06D3D0A40EBBF533F06C085C088BF4F3F4AC032BE36C011C01E3FE3BF66BE6340C73F0940B64041C09A3FA5BF5FBE743FDA3E7840B040863FAABF96C0C53FBF3FB6C0A74057BE05BFC14046BFE0BFEBBF02C0D0BF89BF1CC0FEBF0E4004408E3FB63E41C002C0EE3F0B3F1C40C43F9E40504022BF23BF1C4086BF854048C0E53C3C3F51400F4079BF1DC090BF43C04040034083BDEC4070BE6DC0853FF74045BF3840D73FA23FD63FC7BF993E1DC0F5BF1940E13F3DC05E4022C00340AA407AC0AF3E5B406E3FB63FFD3F14BD8FBDD83D"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC0FFC0FF2440A73FA83FD43FC0FF0B40C0FFA73FC0FFC0FF813F383FC0FFC0FFC0FF5F3F5E3FC0FFC0FFD43FC0FFA83F393F3F3FC0FFC0FF183FB43FCE3FC0FF953FC0FFC0FFC0FFC0FFC0FFC0FF793FF33FC0FFA13FD13F103FD23FC0FFC0FFC0FFD53FC0FFD53F7F3FC0FFC0FFC0FF4A3F013FA53FC0FFC0FFDC3F893FE53FC0FFC0FFC0FF4A3FCE3FE53FFD3F9E3EB03F943FC0FFC0FF6D3FF03FC0FF393FC0FF4140B63EB43F8A3FC0FFC0FFC0FFC0FFE43FC0FF453FC0FFC0FFC0FFC0FF0540CD3FD53FE83EC0FFC0FFC0FFC0FFD03FC0FF0E40DC3FC0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFE73FC0FFE53FC0FFC0FF5A3FC0FFC0FF3A3FDB3F0440853FE23FC0FFC0FFC0FFC0FFC0FFB33FC0FFC0FFAF3FE83EC0FFC0FF9D3FA53FC0FFCA3FC0FFC0FFB13FC0FF873FC0FFC0FFC0FF333FC0FFB53FCF3F573FEA3FC13FC0FFC0FFC0FF093FC0FFC0FFC0FFF23ED53FC0FFC0FFCA3E0640C0FFC0FFC13EC0FF25402040C0FFDE3F983F0B40C0FFC0FF813FC0FFCA3FDB3F6E3F0740D13FD73FC0FFB53FF83F0640583FDA3F1F408F3FC0FFC0FF1C3FC0FFB43F633EC0FFC0FF9C3EFB3FC0FFC0FFC0FF173F1E3FBB3E1C3FC0FFA23FC0FFC0FFC0FFC0FFC0FFC0FFC0FF1040C0FF593EC0FF673FF53FDD3FC0FFC0FFC0FFC0FF2C401E3FEC3FBF3FE73F0340FB3FC0FFC0FF9A3FC0FFC0FF553FF23FC0FF0240C0FFC0FFC0FFC0FF8D3FC0FFC0FFC0FFC0FFC0FF6D3F873FFF3F0040DA3FC0FFC0FFC0FFC0FFCC3FC0FFC0FFC0FFC0FF193FC0FF2440C0FF7D3FC0FF3F3FC0FFC0FFD13EAD3FC33FCE3F523FC0FFC0FF763EBC3FC0FF683FC0FFC0FFC0FF663FC0FFC0FFC0FFC0FF493FC0FFC0FFF13FA03FBB3F1940C0FF8C3FC0FFC0FF7A3F273FFC3F1640833FC0FFC0FF9F3F9C3FC0FF1240C0FFC0FF1D40C0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFBF3FB83F873F193FC0FFC0FFAF3F3D3FC83F9E3F0E40E73FC0FFC0FFC83FC0FF0240C0FF2B3E5B3FE73FBF3FC0FFC0FFC0FFC0FFDE3FB73FC0FF2E40C0FFC0FF823F3240C0FFD93FA63F903FA63FC0FF0C3FC0FFC0FFC63FAA3FC0FFEE3FC0FFB73F1440C0FF163FED3F773F993FB43FC0FFC0FFA63E"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
