// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xui8> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xui8>, tensor<20x20xui8>)
    %1 = call @expected() : () -> tensor<20x20xui8>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xui8>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xui8>, tensor<20x20xui8>) -> ()
    return %2 : tensor<20x20xui8>
  }
  func.func private @inputs() -> (tensor<20x20xui8> {mhlo.layout_mode = "default"}, tensor<20x20xui8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x010000060101040306000103020002030000030400010203050106040101010006010200030201000706040201010500010304020107000304010105000003030102020001030100060000060002010201010201020403010500030000000400070300030102010201000304000001000102020205070200030302060305000100020005040003000201020A0101000402040200000500030400020302030201020003000002040303020002010004000000010201020200020105050101010003040105050002010204010100000000010301000101010A02000100030100000104010003020501010502040103000100000001050401020002020502020100040102020002010004060203040301040601010101000102020505020103020005030106030002030102040500010102000200040104010400010304020300010201040103040102040102000303000404000202020503020703000500010400010102030600010403020001030401010100050201030403020502040100030104020902020201030002030103020303"> : tensor<20x20xui8>
    %c_0 = stablehlo.constant dense<"0x03030700050204020005000103010103020001000100000001010302000001010101000003000200030003000200020300060300010103060303030105040002010302020300030103030100020605000603000200020201000608030201040201020203040502060504000201030102090002040201000200010303000200030401030104020201030002020601010001020102020203010002020303010201020001040106000202000101000100020404010401010304030104040002040000010300030100000002030000010002020500020000010002000000040305020405020201010002010304030101040504000002000501000605010301020501030201010205020304010306040000010306070203050400060200060001020103000001040300020100060003040403020303030202010204000101000106020202010300050300050000050102000202030004010403000103000100050200050504020002060201020503010504030104050201000100050104000001000101010202070104040204000B01000505"> : tensor<20x20xui8>
    return %c, %c_0 : tensor<20x20xui8>, tensor<20x20xui8>
  }
  func.func private @expected() -> (tensor<20x20xui8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFEFDF906FCFF000106FB0102FFFF0100FE000204FF01020304000302010100FF050002000002FF0004060102FF0103FD01FD01020006FDFD01FEFE04FBFC030100FF00FEFE03FEFF03FDFF06FEFCFC02FBFE02FF0202010005FAFBFDFEFF00FE0601FE00FDFDFFFCFCFC0302FFFD00FEF80200FE030602FE0302FF03030300FEFC01FD0400FE01FFFF010008FB00FF04010201FEFE03FD0204FE0000FF020000000002FCFFFC04010102FF0101FF04FEFCFC00FE0001FFFCFF00010101FFFD000303FE0502FF02010202FE0100FF00FEFFFE01FE0101000A00000100FFFEFBFEFDFFFFFE020105FF0002FE010002FCFCFC0000FF05FF0002FAFD01020100FCFF01FF0101FEFDFFFD0005FFFD0003010303FBFAFFFEFBFD02FC0305FC010200FF02030105FFFD02010002FE05FDFDFDFFFEFFFD01FF020002FC0102030202FAFF00FF03FE03FFFE02FF0102FB0201000202FD02FE010100020600000400FC0200FCFCFE0106FEFB020200FBFE02FFFDFE00FC000000030303FD04FE0401FF030003010700FB01FDFFFEFE03F60202FEFE"> : tensor<20x20xui8>
    return %c : tensor<20x20xui8>
  }
}
