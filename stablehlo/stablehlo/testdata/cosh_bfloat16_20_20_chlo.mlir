// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.cosh %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD340193DB7C06FC0E9BF18BF39BF914069C0AC400EC024404F3FCDBF2E4001C0C93F29C0E2BFF4BF25BE96BF4440314070BFC53F043F4440FEBF5CBF9CBF6F3FC9BF6EBF2A40E53FBE4092401E3F29C066BE01404F3E7E3E87BF1EBFD6BFF23E92C09D3F443FF43F8140F93FE1BF77BF803FA63ED8BDB0C0853F273E2C409D407840C93E2BC0B63D5440DCBFB3BEB6BF2FC039C048C0CCC0BD4080C0463F3D40EE3E934012C01CC0A6402FC09BC040C026403EC0E2BE55C073C07AC09740BF3D5CC045C06A40D5402EC05CBDDF3FA8BF0CC08EBF32C0AB4062C0EABF20BF4DC077400340363E61C047C084C055C08A3F9FC0993FB240B2BF6A3FCB3F5840A7C0D23F02C078400BBF3D40A440CA3F043FA3C0CD40EFBFC3BF31401E3F9BBF34BDA5C091C01E40D83E6EC0224087403D406440E7C0E0C0243FBC4027BFFCBFEEBF4640A2C099C0333FA1BFA5BF97BF42C0BBBD7B3F7E4036404B3F36C0B140B140C9408A3E683FAF40CBBE4A3FDE3FD2C086BF35BE89400FC077C023BF49C006BE8C401FC099C01C407EC078400B404DC072C027C09040FBBF08C0D0C077C090BF2E40494027BFA53F0740AFBF0541AC3F563FAC407540DC40A03FABBE86BE09C154C0A5C055BF03409E3E87C02A405140A13F78408240783CCE3F18C01BC0D3BF2DC087C014C09EBF0EC06CC0E13F29C075BF13C1D63F293F68BF1540A7BED8C08C40AD400DC08FC096400F3F23C058C067C0D53E97C009BEBCBF48404DBF203F7240F3BFE03FE0BFA13F0DC083BFD9BEBBBFF63F2740903FEEBF7C40A4C077C0833F3DC044400141E93EB73F4B3FC6BD63BE6E3F2FC057C01F4058408FBF79402AC107C0064085BF08BF02405F404ABF8BC0F53F873F884052C024400F4017C016C09FC0403FD3406F401340C9C0F5C0B73FC1C04B3FCB3F103E86C020409B405E3F3B404DC0D73FBD3F1DC04B40A63FCE3E74BF1C4099BE66C08340B6BF2B3FB3BDC53EE33F5DBF2F409E40E040E4BF6540D2408CBE31C01E4010C1C2408440F73E0DC05640CABF4A40AD40AFC05B3F02402EC005BF673F39400F4083BF0D41A3C0FEBF96C07B4026400F402E40833FF03F3EC0B13FEA3E973F0340C64084BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB743803F1843A8414B40973FA33F3A429941D8429540D140AC3F2540F44074402140E14041405C40823FE23F2B41FF40BC3F1C40913F2B416D40B23FEB3FBC3F2140BB3FE54045403D434042993FE140833F7440833F843FCE3F993F30408F3F4042ED3FA73F5C40E14164403F40C03FC63F873F813FF542CC3F823FEC408742C1418A3FE940813F5C413840883F0C40F7401041364193433843DA41A83F1A418E3F46429E40B940B342F7407E422141D7401C418D3F5F41B241C7416042813F79412E419B41C243F440803F3C40FF3F9040D73F0241D14289414C409A3F4541BE417C40823F87413441F8415F41D23F9042E73F02430940B93F23406A41B9422B407840C141933F1A41A8422240913FA342974354401A40FF40993FEA3F803FAE423A42BE408C3FA541CA4008421A418D412B4409449B3F32439C3F6A40524031419E426F42A13FF33FFA3FE43F2641813FC33FD4410A41AA3F0A41FC42FC428643853FB83FED428A3FAA3F3B40B143CD3F823F11429740BE419B3F3941813F1F42C1406F42B940D441C1418E404541B041DB40344268408840A643BE41DA3FF44039419C3FFA3F86400640FF440340AF3FD842B841F243F23F873F843F23455C41AE42AF3F7C40863F0842E5405241F33FC141E941803F2640AE40B6402D40F0400842A340EF3F9540A0413F40E140BF3F994530409D3FB83FA640873FD6431F42DF4293402F425942943FCE406A4194418B3F6042813F12403641AB3F9A3FB0415A403E403E40F33F9340C93F8C3F11405F40DB40DA3F5240CD41A842BE41C93F1A412B41C6448D3F0D40AA3F813F833FBB3FF7406641C1406A41D93FC441A14686408440CC3F923F78408341AA3F1A425E40CE3F0C425541D1409740AB40A8409042A63FB743A841A140864384440D405043AA3F2340813F0442C4407E42B33F1541454132401340BB403F41FC3F8B3FBF3FB940863F9241F0410C409E3F803F8A3F4240B33FF7408B42094443408F41B143853FFF40BE407D455743F8418F3F9340634122403C41DF42ED42B23F7840F440923FB83F10419740C93F5245A3426D405942CA41D7409740F440C93F56401C4108408E3FE43F7C407343CA3F"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
