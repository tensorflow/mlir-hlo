// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.acosh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x67F6A5C00F216640D87C404027FA463EF4BE1FC02B401E403621853E2E1E38404DEC204081ABACC0EA5F74C045F08CBF90C0313F22F4ECBFA1152640B3C693403130784058EE494028991D3F0C67A6BF09FA8FBF8109A2C04DDF773F7B7F34BEE96A1DC03883BBBEDEBFF93FD51721C04A5EAFBF21007EBF81E84D4099F7993FBF40434032616AC077C893C07899A4C025A74D40C91A0DC0898AB83EADBDB33EBAB186C0C2422940A5DC25406FD50840C3858540F96F854074E4163F4B09C23F9B163FC0504E794095E528403F653B4063360EC1D39598BFA8D3163BADFDFBBEFEBCA94037E122BE8203A540CBCD9F4065FBC1BFE612A0BF0C236AC07F852B40E36303C0223A38C058860E3FB465533F99DADE408561164073725340BA1227401508894066A9803F33974EBFB94BACBF86371FC0900FDB3F31350A40F3820E3EBE6A3FC00B6C123FB32DCA40F3571C40537C313FB0350140CC2433BE31426E3E375F7840114E7FC07C91A23F2F588EC07C24CABF31570640CEDFFBBFFEDF6A40D4E56AC0B9BEDDBFF5452E40BA51ED3F3C256BC046BE1FC0AAECAFBD3475F83F6D1043C04758E4400EEA11BFF04651BF8B40A540934BC5BED2113040D7124440F5607540740858C0C65B14408A805A404CE5413F451082407F41E9BFF5B87A3F4EA892C09B07433FCDA973407F835740B81E8FBF5518C0C017589840B1703940036B6240C4BFE6BE5F0F8C3FFE52AA3F19D2DBBF9464E2BF30CCD0BE04DF59C0225B1D40A656143DFA207C40700663403F369BC0E1AC86C054023DBFEFEABF3FB9CD8840CC6E1BC0C963363F5C34B1BFFCC1FDBFA62B463F43E522BFCBF7C3BF7A0940BE0AE128C080274340EE81753F260AB4BE373A86BE94FC20C0A078C83F4AF145405FE69DBFCC5626C0C1AC45C052602D4012592A3FE020DEBF444DC43E285DA2C06F60E73F8876E53F705856C055DB74402F7E633F0DA8F23F3AADBABF53AD963F5E70B7BF49A197BF621C24400EACF63F762FC3400A6B014092A806C03407BA3DEB9AF8BF0D35AABE214CFE3F2A0B6F3FE4ACC5BFFF04B6C0FB7B46C02244A7C0AA8974BF499B17C0B9450AC04CE0A2BEFDDAA0C04C398FC017175D3ECCD44040F5EF4F40B1686F404208103F33DD834026B039C01F82C73DDC6E523F217D23C07A3A9040774934C0553262400E7D90C01436A2C0A353A2C0D0B40FBE6D94604055F58240984BB3C0B6FF62BF6A9E03408555E8BFABC7EFBF45633D404FCDF8BF630F17C0F71AFF3F227C703FEE2AF23F4204A23EB79FDDC02B7942C0FADC723FFC54B9C097FD51C0DA2D9C3F6B036740C63ECBBFF839CF3F86542741079354406FFF4C3FBB96873F3FD30BC07A5716C059BD5D40A38B5D3F505781BE1A9B5C40003397BF24810240DBE2DDBE7C7C4F4051EC9DBFB17C8E3F91DB55C06C5E9FC0C3B3E03E385942BF7A95123F44DBBEC0E34DB2BE8DC345C09893883F8FB5A3BF7A4A023FB5AE3DBED80B81BED201B0BFA515193E46A6AEBF0AA0CEBDF8F171C03253013F6FE30EC0638E4F40AC1F8ABFA09EF5BE451223406EB402C0AEED1A4063451DC084A72D40D675BE3FA1D58AC069C6F43FB41E2340A1128340459905C07A898B401B0AA1C09BC7893F120E093DEC4689BF6C039E404A0E3340A849F43EFEE89FBFF9566E4070AF1AC00E1E39C0CEB3A4C0CD4F0B3FA8C4AE3D89282F4010431A3FB237BDBF7008F4BFD07134408D382F40D68548C04F6BE33F2998583F01CEDC3ECC1AD34034AE9F405AEED7BFB0225BC086B9EABF516BFD3E09E4AB40233B0640D56B51C0EF00363F504A253FF1B493C0C74948C041CB39C022099EC0D72DE13F7035B6C0C0AA37C0CC128540EE77C43F2A1593403174AABFCC67633F5CE46A3D5B2BD7BF16B0F0BED4E1F9BF178210C094E29540A9681440A98DD53FDB7F1CC07A72B2BFF92185BFC01412C0ED702A40989EA3BFB9790EC072EBEDC00C0AD5BFFA4162C00F1FB9C040BCC8BF4425DEBEEEFB6ABD1E8E1E3E5A9774C019D5C1BFE676863D71B4A5C006747F3FD35699BFBEB2004089440341475D443FE3474ABFE54E024018DD6ABEC763FABE16DD963F4BC01140B28126BF1B63FE3FB71C44C03AEB3740E4B5DF3FFA894BBE04C7B6C0F71A583FB409FD3F77803440C9F281C0075C2EC05429DFBF658B43C063608E3F4573703F820E5DC04AC61FC0AD78C9C0ADD9B9C07354A5BF0352F2BE9830B6C0AA7B6BC09FCEAE3F0C508C40F276CDC001C052C0297364C0D4C757404218FBBFF7234FC0F325503FD16417C00BBDC5C0B5924EBF6ACB6F3F4C2D4F3F66018F3F7629363E300619401B12C140A1C82B4070B9D0BD8B2C21BF7242B0BD1C5E64C01DDC96C0DD5C0BC060165A3F7B078C3F6211ED3D5740A03F784F2C3F53BE64C03542923F62CE8BBF88BEAAC057C13C4087CC0B4078E486406F143BC0D97D2D406B78863FDDCF3440E9DEB1BEEEA91540F0284B3F7E259FBF211ABFBFA5242FBF8918CFBEF1376CBFF0FC92407A7A8A3FA4962440FDDC9C4080073BBEA50AC1BFFB593341945C023FAF2952C095BF02C0A4AAE53F234A0CC08A380940346D35C00B58FBBEBBE40E3F3AC5E1BF832686C0C089653F6993E2BE9CB9D2BF99F3E2BFD52025C009BCA3C0E76DBA3FF215CA3F26C430C0D02D5B4083606A4024D3F93F7AFC77BFE3B7083FB884554002CF214091A960C03517D7BFF55CA6407BB4AE3F5ED230C0C268C0C02D8B5940AC01A33FD960B1BF362384BF382410C0E4B843C0F1C11840051297408CCD8C3D27D7643FE386324004549FC07E37D63F41764D40A2D5D9BF0C85C5BFE97E20C046620340F3E137BD748E6E404D31AA406259AB3FB36435C036DE9E3E7B5323C097FBAEC0215477BF8594E03FD1A586BF8EB936400F0836C0F2951940CBB16640B65507BFBAE796404D9006C0300241BFD97AB23F48B429C048DB0C40A46E2BBD51710840F968C6BFDAC945407EA1E6BEB06392C0867026BF6DA4A6C08AF8E6404E4C5BC0C670AFBF6DE18AC0CAEF3040A6C0A13FDE9B883F4E87E2BE41AB5AC03C00763FF91BB6C0FB2252C0537B54BF1ACE1C40F9340341557C0140F3393F40A6D750C003469E3E1FE7F53E571E8CC0AA0081BFD7FE903FA9C366BE503A293FB7BACCBEB41055C0AA1F6A4071412340B7C714C0B80610400BB7AD3F55B3B9BF0B6A51C0E562244039777540BE2F6CBFCA31953F29EEE43EBE13A140C2D89140D5832ABF6E8B45C041B68CBFC1DA0EC0882A3EC032A4D6BF502D3CC0DC07C0BE6E46343EBAF55F401CFA3040BD9655C04B105F3CE03497404FCA594035BAC0C03E4F28C0BF262EC028D3C4BEBD05A6BFB9605140712992C061FD1340E4A09BC06D51A23F731B1A3FEC3B87C0D51C06BFF31F9B40D3F303403A698AC0248474407ECFFEBF166EE4BFF26695C00088CF4087B885BF5EC93E3D68151F4045B8D03E7830DE3E847BBF3F2162F03FA0EB12BF7C6C35C068824EBF9743D7BF06B686BE21D97E3DE4549AC0F9E2B7BF723548BF2F49FEBC841C71C03E0C54C047D794BF813F4FBFD544433FE3F0AB3EF163DA3F4BC695BF4E9231C0B34E48408D617A40C6758F400149E0403B61EF3D952B2EC0B33D60C0CC52EBBF63830F40FA89974071A37B3F03A746BB235E8EC0EC5727BF50BA08C0965288C09FDE6BC0F2880440317592BEE52128C02EA32ABFCB342A402FA223C01DEE2940014769406B038D3FD1C3AB40B57788409D3400C0BCEC93C049161040B577D6BF7F5E224046BFA4402E8F8CBF2A0164C08E60A04015A792BFA9746F3F1E346D3FCED4323E29D9054097C5393EFEC907C0BAD04F3F604E35BEABFAC1402901A33E5205AE3F407BE23E905D1BC0533A343F8119A6BF12AE9F40151103406278863F3C0313C095AE53C02597AC405B6C31C0500E1B3DBDB2323E7F09E5BF002A63BF082AC440F9163DC02880DA3E75CE22C0BAF16B4044C291BF64C096BFE7949BBEB5BEF1BF753AB63FCBD2E73FC81B003F48CDFC3FEBF52BBF840E6AC0CEBA0940BC1F35C0518A81405232653F84EC3E417D5E3940B0A012402E4709BF186B4EC01BB5A7C04AD88BBF83AAC1BF41E321C0D47E814066A44B3FAB9282BFC116484084F7CFBFF3001D40DF8757C03EFB5440029D23408D571E404C14CABFB6ED6E40B2DE774061837EBF029C3FC062A27A405B643D3DD7DDC7BFB15620C0DE4FB83FEEC65E408AED3BBE31420E4045DCA840D2CF833F0F61524031B13CC01E3103C02C54D73FBEC9AA3F285D0D3F408990BFBC4424C0CBEE7DC0F22107C0E75C87C0F154343F4D18144012911DBE8B7394C08DA06DC05C76FD3E813FB5402424DC3D8C0636C028E9BF40ED4502BFACBC8F4079466640DAF1B04046970CBF80D40C3F31ED943F6E33743EFDBB8B3E36F31CC048B5F3BFE852873FE215E33FCD8FA63E118DE2BFA54E37C0D045A8C088B4D4C07BA3CDBF24D07DC05D3451C0CF42A0BFC9594340"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1A21224080E22140204BE23FB6098C3D0C9FF93F64CD1540081FE43F0A28BE3F74D21E406DED91BF4ECC03402F8836C00FFDB53FB9D29FBF595C1740937D883F643C1340115E313FB521913F9A0E9ABFFA3F1640C08CE4BF6A71C83ED7AAE8BE5B19C83F8EBF3EC028E1ED3F744D6FBF9BE5993F1A501BC0249DF43F58A8BE3E25711040A21063BFA6222840AD0513C02A0E03407EF21DBFDEC9BA3EE8F79C3F42B812407B912440EC63F33F2837363FDCF31D40B6D14A3F829A9F3F0C52A03FDC5B1240AEBF0D40EF4604401F6A5A3FE78F3840F87940C01CCAF23E31CCC8BFCC991640370FFABCC6802A40B532463F5F65AE3FFFBD18C04EE50C4020D91F40B843FB3FC0FE0AC0194D503F72A3923F00C92B40FA0EA83ECE2D08404DBB2E3FED690A404630723E0640993F132B02C0DB09E53FE6CF20401328B43FED8B943D28F1E33FC1473C40448A264054CCBE3EB129BF3FE688A23FC8986F3E59F6DE3F173E1A402EA64EBFEC040F40B63AA6BFE4D2D53FFEA70B402E2D0840B0470340FE660540E4102CC06552F03F09A71E3F6A800B407A1B22C0C975B53F8018CE3FEAAC2F40DD59FC3F09804F3F0A7F00C01603154094739BBD470F0740D58A5A3FBAAA14404B3E3BBFE870074051DC7C3FF60E0840B820B23FA0FFB13F4A14264002F40D408D453E4068591440B5DA3B3FE28D20407D54E0BF08141A4095D00D3F6EFAF83F5A1A07BE8385A13F52BB753FF4B0CC3F123F13C02802F93F9CB7D7BFD33CC63F7411843CAB0E1740BBEE3D3F7B54234014F01AC0039EA13FB8E5FB3F2BF51140DA9006BF2C60993F743795BFD236B43FF6852E40237EA13FF199F4BF2C8DD93FF58ED1BFA4DCEA3F7EA3A33E84E08C3E9B4BF5BF7E42E23F9EB923407C99F03FAEA9CABE80DB0540685710C0A846D83FDEA7833E7253983F706C3840FCB2174075CD3240C66702409AF28BBF8DF80240A359713EBE40C73F3DFD32BF176CAA3FEC5673BF5A41E03FC994FD3F5F7323407A55A23FC11EE23F749A55BFB189B53FE4BDC3BFB94AB93F2F18DC3F7D53A93FA23A8BBFB5BD234098CA28C02AB91640CE493DC09AADED3F562E18C09073144044FFD0BFED8A0B40B6E54540F9B50B4030F2553F0F6B0040AA681E3EA6AA13404A711FBF2D66403F666EBF3FA4F21540EA06054087160D4071D70E4089FA264012C212C032AF1340A54147C00646184084D65E3F68F71A4017DC3EC00590D93F12A241BFB052FA3F8D800740968FE83FA1F80EC033CCB93FBEF2F73E0B1AA33F00D5453E5AA92D40A0642EC02E0E1E40F691B4BFF51CF73FD4613140D17A03403C74DABEC37C43402D7DB53FB57FF33F48DA7C3E3EAFCD3F6D3793BF175808401AD40940EED3D03E568B25BF334FFC3F4939AFBE2B94AF3FFAE672BEC9EFF53FF198C1BE1EECFB3F4460A1BF77B8124040524340B4722C3F65E00E408E4F1E40A54645C02EF6ED3F3DCE3240A8736C3F4A082940FBC7813ECD27E0BFC8C95B3F4D233F40A296563FC52D42C044F300408641404077750440B62B0A4030B0443FCA7B22C082A4EF3FBFE832BFC156F73F185950BF9395E73FDF48063FA07C0F407AF42D40C1621140D307833F4FA411404495004084A7144089523B40B8906E3F2A24C6BFE3381B407DB0053F82778A3FC061A3BF27700B40946216BF273E1E4022E904C07883CF3D19AA7F3FF1CBD83F52E96C3EEF19CB3FED2C0CC000F303405272493FF684FB3F2BF526406316163F40BE443F4785334061AF263F48C302402EFC00C0A0BDA23F5E793540C2231C408E3EC13E00C1F03F29BD3A4018910F40F6A9B7BF55320940FA5118C0EFF11540FBC83240C4B1224037DD2AC0AD090B40E664B93E41F60F40717593BE276CF83D8173FB3ED881963F2D2C34C05E5BE53FD86710C015D91540C627EF3E3613E53FB56D7FBF14CF9D3F1DB61AC010D2F93FDF9B10406CF5D33F8DE903C081122E403DD93AC091032740995407C0DAF58B3FDAB433C0442E1E3E8452D03F7F240640543F30C077331640F077C7BF6B8B953FA92C78BFC61F35401780AA3F0494583F77367BBF466AAC3F085B03BED72B853F5408F13FE314C23F2B059CBEB98CFF3FB88D81BFB1BDF23F440E113FCB671C40AA72CDBFA172BF3F8FE3993F17E21240512679BFE2C5ED3FEA3223C07551ED3F58B031403C11FE3FC547A8BFDE0A2740E7E8F8BF3C151E4075DC3AC046601C400285D3BFD6130340C89C3140E8B72F4074B879BFFF9011405F8B13C06DF8024022A50ABF2564F03F959638400E9125408F60F7BFC16C753F39FF08400B08893F118E863F97D7CD3F6B49C03F55EC2440F384D83E8094183F7D1AD4BF1906FE3FC208CCBFE4671540B9E82CC0A4C8883F748B823F8282863F51D2BF3FC61800405612B2BFCE9D943FEA655CBF4ED41F407F6028400E7710400A018D3F51D10440573318401797E83F5FA89D3FD209CC3F7A76DA3F9DBE913F1DBB8BBFA416913FD32F28C052265B3FE2DFEEBFA0030F400427723E602D1A40D7108C3F930C9A3F2CF5D5BF18F9464004B03A3DBA780240977624C026F4DE3F022D6ABF64CCFB3FA82471BF2FCB143FE025004029D80D40E2F5FABFB9B61F3F53583ABF308FCA3F8EBD11C015621C40140902C078ACBB3F0BE5603F485E0B40862A0F4057ED0640A083003F48B83D3F170B1B405FC307406E91293F70AC0240C1A32BC018821740ABAD853EE089254055A5FFBF95E6FB3FA333BE3E54F39C3F7BAF1AC0A81E0240521D0CC0B0501740040D8E3F1A224E3F7E80C23F34171C40E18588BFFDD2FE3F227D8D3F9A05C33F30E316C02ABBEE3F95A51B408EB10140048DCA3FB2CF1840A84E803ECAD0DA3F619D4140CBAE1F40E22400C07320B63F26B301402AC2E93FCF22F43F8D4C0040500F1B40F4D6FB3F47F91ABE9A0515407E5FDABECD159B3F2878FF3FF7ABF63FE9621B406629C03F3856CB3F5121F93F6340014005B70E40F356D5BF180517408FAED8BFE4343140967FE4BEB2F90D40F95AEFBFCCCAE43FC38FE63E3E9E3B3F57F615BFDEA9F83F61D13640FBA824403F3F27C09819D63F2A34F03F98B834403161793E43A00B402C9257BFE745F63E4433A53FB3CD0B4096393AC0C184203F06EEAFBE28A5F43ED1E36FBFC0BE1240C8221340C81DF73F689142BFF865D23FF486133F4CA0FD3F62B3FCBFEC8B0E40ACCC7D3FB089903FBA0B094094A71440B8EFBD3F54610D40122C18BEF44DEE3F4C2B32C098B9004064AB0CC07341F63F668A04C028C8403EAF5EF93F43E10B40FF5A2E3FC402F03FCCC9484004F91C40F494213FDF9B244033702EC050DCD53F346E3FC076A7FB3F6AAEF73FCC84144099912A40C32313408F6B3840E6120A402E6CB7BF94671240ED8FD63FEC141140E52F91BF7C580940A9B8FBBEBAD11340A2F5F6BF3C7A2440C77025BE622ED23F3DD6C63FCE29E73EDCA2983FC460CA3F7562703F8512E43F7641E1BF9A5EAE3FC706FCBF49F7833D8B11EB3FAA3E1340D22D36C0F1894B3DFDE61DC0DC8213404A431AC0B8A1823FCC041AC0743BE63EC8984E3FA0A4B33F469E28BFAB110840300C1240BC901E40E53A5C3F7CA928405E038A3C58ED0B40E6030EC082E3E13F37A70E40619A1040FC0F563EACAF0C40A325C9BF2CBEC43F86E1EBBF8FED1A4090EA1AC0BF77AF3F04A21FBE5065D43FB40438C039C9FF3FE4B948BF94020D4095EA733F48B61940AA8FAF3F3E1B0F409E5FE5BE98C814403A922B402C81E83F9A580840C42016400C0E5BBEFBBE204000AF0B40A9648A3F48E41540CD51B33E3DAE023FECD4AF3F5F56C93D821EBD3F7C5C2F40CB252040F0BFCC3FD773903F880DB13F3006D13F96A7B3BF481C933F84A093BFBED31740098BCA3E99A1D23F84AC95BFB99C22406B620740D0DED63F00204840EC98AC3F832EBEBFA6772140FE3ADB3F5C22E13FFE533F404E9E0C4086730A4057DC993F0DF90FC02067B33F2B2EDBBF9B4FC53F7CD9723F973ABA3F7277AC3F34780140B887DFBFB7D2FB3F9C7C70BF4C8506404D6C653EEDC54C40389E743EDED3C03F2E6681BEB6D82040E07607C00523AC3FDA8508C04AB2104088A90740350B813FB63684BF017AF83F191FFEBEE6FD0740806A74BF70EF0740BF3D2B3F0116E13F1D6118BFA512184099F84F3FD251EE3F9049F0BFECA902409011483CCAFCE43FBE9D06C0370A02402064983F2F54C53FA8AFD23F2D7E1740A4C3483E90560B4045703EBFF4E5D43F8BCF1A4047607B3FA285003F5A75DF3F054CFBBFAC1B0C40B21729C09EB3084036353E40080DBE3F8DA696BD35511E40AA6B1DC04A121C401E12BE3FA660E23FF57FC4BF4ACB1E404ECBAFBD72441C40FFC92E3FAA9B19409C14CEBDC645853F9AEC9B3FACC08D3EE867AB3FF407E93FA82C1DC0CF67B93FAE528A3F1365AC3F99B0B4BF36261F40781404C063192740DEB939C06904154082581CC0D399F33F85EBF83F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
