// RUN-DISABLED: stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt -inline | stablehlo-translate --interpret
// RUN: diff <(stablehlo-translate --deserialize %s.0_9_0.bc | stablehlo-opt) <(stablehlo-opt %s)
// RUN: diff <(stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt) <(stablehlo-opt %s)

module @jit_testcase {
  func.func public @main() -> tensor<i1> {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = call @erf_inv(%0) : (tensor<20x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.custom_call @check.eq(%2, %1) : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<i1>
    return %3 : tensor<i1>
  }
  func.func private @inputs() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0x157406C01B5094BFEE0B363FF473D73FDF3867C08D0BC93F1D29C4BF1E878DBF6EEED03F05CB31BF0B5006402EDB0F40118F8840DB702DBF7A54624097541BC16163A03EB3FCDFBE65325A3FA6C18940FEDA7A3F6E3D92C0DF5F5940782BC8BED71F01C0A6E4F3BEFE1FA83FFF20B93FD42BD3C043199C40DF1B9BC0848DEDBFD3729BC063AE38C087D32640287C6D3EF9341840FE536540CB670140BA791A40047EB140F7017C3E402B5040090E60BFE17758BD9AE22EBF691C38C088C401BF874C1D40E95FC0405A730AC0D6F5B53E45508C40179EF8BD173181C00CA332BF73A6873F4A75C43F57DC4F3FB2BDBCBF5E1293C07B556040892F1BC04611583FCE543340CED43D4079CEABBF654413C0E302E440121E9FBEECA3AF403FF6173F765984C024DDB4C06F9DA53FAAB384BFA1F07B40AAE6DAC07066524081134BBFFA6DAB3F93273540B5C7A9BEDE45123FB82782C0DA79183F92E601C01D1BC23C7B17813E630D15400D73D0C0C380A2BF0C8B7FBF76846B40DD57A2C02DB0D83F341CC6BF2EA89A3F1B11F6BFEE90F6402FB989C0E4B287404F25623F62C21A40017D8CC0E798B7409C789C40A3F02CC07B0FD3BF8C49B03F952872C079765A404321DE3E067929C0086316BFEBB3BC40570926C0AC67C23D2F66BAC0949F6040329D86C0C3DECCBF432E72BF66C804BF9C1E28C0A1BCAF3F50984240BA5B2EC031232BC0D36307C0D8B3054006AEE23F71CB00401402B33FDA4B954006A417C0859DCB3F6353C33C143B883F69C2543EA46A26C0A7FECF3EB919C840681A71BE9F87B5C0887F913F34508EBE0DF092C0B216223FAE594BBF9746A53FD65C76BF2DF74D408A710640FEB79ABFEEC4CBBEAB9716BFAAFB863F4F5AB73FCC2495C04EEC813C82884CBFBFDADB3F5E26E73F9CAB9B4050F30E405CDD2E40830946C0D34112C00BE9AA40AA9BAF3FF699863FF1E6F6BF879001C0B71160405AF4CF406952A940E96886C0E2FD4E3F3DCFCBBFACC8A440053182C0A222B93F9B83B33FF2FAB13E1CF409C0851858C0BF11EABF60149C4095576FC052ABE53F6FCF2740EFCB7C3F78E92C3E0821263FF89E813EFCF22D3FBE6DDEC0041198BE76A2BA3F820F763FD89ACFBF2D68213F8FB649C03CC34D40906F06C0DEBC0240394D1FC01828703FAF7287C0777F15C01E6E143E2038B83F08892FBF30AB6D3F88A131405B189BC0C5EAA4C0642289C0D24DC73EAE348740AA2026BF89EF6A401C69DB40E99A2940E936304041D249C0BB974140BE9430C09370AB3DA64C9C3D24EB80BF149986BF1FDF993DDBE6C140E177D73F3F85B8C01A61D5C0B3C45E4090DC6F3F4D05A33F38F87A40FCA213C0602D9CBEE22F6B40D0D5F1BFED09893D381EC03E82B591BF9E5E4EBF199C6840852B25C07704814038B5BB3E43FEB43FEDB707C0AB6F1F4064279A400768133C60EC32BF3B252ABF8E8DC4BFB70A2B3F1201F73B3E72F83FAA3FB0BE31DF204095F281C061BB0BC0DCDDD9BFBF177FC0DF5886BF56D1B43D8A2CA1C0576B07C0DC81993FF956E0BF1C52B7BF59F512C07AED73C0D09F39403C7FDABF30B163C07300FF3FA58A5EC0C6875C3FE42C0CC08A20FFBF032003BE04773FC06661DBBEF4EE92BFC986A8BEF587A440BFD712C0477B864006AF81C0872C93C04999DC3F8E0E77C0C4AB463F687C653E0ED6823FA3F7CAC01BF637401BDD3D3E909206C06D2D0EBD5869353F544FE13F9E896ABE3187C8C04D482340D9D592BFC24A9CBFB55549BFF9B2143F0E9828C0BBAC29BFFB39FD3F54E1C64000229C3FF7840E407C35B23FB80BB5C03B91A8C03051CC3E914F6E40336EA83F67ACBD40891DBFBFDEE9EDBF636DABC0535A64BF9E6852C0DD389640346225BFE4FE91BE48983FBF8BED8E3FAAB18A40080FF9BF21558C4003A5CE3E618A27BF6CE1073F49EE11401882B3407B647E40F6469E3F388311408D5D7E3E94C1DD3F9EE556BFC48F163E22F58D40F5B86E408FBCE0BFF740DB3FC344DC3F8A290D403D6E31408C57563F7C50E33F2EBC83406CCB1BC065D7003F8DE89F406A1768400D76EC3C7EDB08404C6E1ABFF8C6E63FECFC293F5DD36B3F0AA3723F23FA0241EC49FA3F28B1EA3F2E9428C01A202840DE24BA403DFB54405855A6C05DC451C0A7F58EBF2391A33FFE5C29C0AE89BCC042D103C0327534BF8957E33FDADB62BF71A91340E39960C0424602C0A9076940A77265C0583866C0BBB7A240"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
  func.func private @expected() -> tensor<20x20xf32> {
    %0 = stablehlo.constant dense<"0xFFFFFF7FFFFFFF7F52FC3F3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F6F7E39BFFFFFFF7FFFFFFF7FFFFFFF7FF71633BFFFFFFF7FFFFFFF7FD100923E9DA7D1BE960A833FFFFFFF7FF664D23FFFFFFF7FFFFFFF7F3029B9BEFFFFFF7F80E2E6BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F2B85553EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F0F00633EFFFFFF7F7EEE8ABF01FB3FBD9A3035BFFFFFFF7FAD23F8BEFFFFFF7FFFFFFF7FFFFFFF7FE2FEA63EFFFFFF7F4730DDBDFFFFFF7F40C33ABFFFFFFF7FFFFFFF7FA34A6E3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FF667803FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F4FC890BEFFFFFF7F764A163FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F008E64BFFFFFFF7FFFFFFF7F0E149BBE50490F3FFFFFFF7F55EF163FFFFFFF7F130CAC3C9AC1683EFFFFFF7FFFFFFF7FFFFFFF7F615F0DC0FFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F6E058E3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F1FB6CF3EFFFFFF7F545414BFFFFFFF7FFFFFFF7F03B2AC3DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F2269AEBF44F1FEBEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FF120AD3CFFFFFF7F79BC3E3EFFFFFF7F0E1CC13EFFFFFF7F1ADF58BEFFFFFF7FFFFFFF7F8AC980BEFFFFFF7F5A5A233F441865BFFFFFFF7F3724BCBFFFFFFF7FFFFFFF7FFFFFFF7F53CEBCBEA09514BFFFFFFF7FFFFFFF7FFFFFFF7F3C4C663C017367BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FD3786C3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F0A15A33EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F5508E23FC5661A3EB3CE283F8ABE693E79D3333FFFFFFF7FCC098ABEFFFFFF7FD9FEBA3FFFFFFF7F7B72223FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F7DFDA83FFFFFFF7FFFFFFF7F5C46043EFFFFFF7FA72436BF2D10A33FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F7349B83EFFFFFF7F33CE28BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FDE36983D88BA8A3DFFFFFF7FFFFFFF7F3991883DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FB03FA83FFFFFFF7FFFFFFF7FFFFFFF7FD6F68DBEFFFFFF7FFFFFFF7F282E733DEA12B13EFFFFFF7F0D2F6BBFFFFFFF7FFFFFFF7FFFFFFF7F8DAEAC3EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F64A3023C0A323BBFC8622EBFFFFFFF7F56A72F3FAEE7DA3BFFFFFF7FB462A1BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FEE92A03DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F1D10863FFFFFFF7FFFFFFF7F7D6BE9BDFFFFFF7F69D8CCBEFFFFFF7F8ADC99BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FDF235C3F92204E3EFFFFFF7FFFFFFF7FFFFFFF7F58CE293EFFFFFF7F1E15FCBC2F003F3FFFFFFF7F25CB52BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F902B61BF2E3F123FFFFFFF7F3CB92DBFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FCB5CBD3EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F0A7991BFFFFFFF7FFFFFFF7F27CA27BF154584BE8B8A4FBFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F45BBBF3ED9BF2ABF7603033FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F3032653EFFFFFF7F60017EBF2F32063EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F1AB27C3FFFFFFF7FFFFFFF7FFFFFFF7F1F11F63EFFFFFF7FFFFFFF7F9C9AD13CFFFFFF7FCB6619BFFFFFFF7F012A2E3FB7159F3F15B9AF3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F44883DBFFFFFFF7F1A1D8FBFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F"> : tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
  func.func private @erf_inv(%arg0: tensor<20x20xf32>) -> tensor<20x20xf32> {
    %0 = call @xla_fallback_erf_inv(%arg0) : (tensor<20x20xf32>) -> tensor<20x20xf32>
    return %0 : tensor<20x20xf32>
  }
  func.func private @xla_fallback_erf_inv(%arg0: tensor<20x20xf32>) -> tensor<20x20xf32> {
    %0 = stablehlo.abs %arg0 : tensor<20x20xf32>
    %1 = stablehlo.constant dense<1.000000e+00> : tensor<f32>
    %2 = stablehlo.constant dense<1.000000e+00> : tensor<20x20xf32>
    %3 = stablehlo.compare  EQ, %0, %2 : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %4 = stablehlo.constant dense<0x7F800000> : tensor<f32>
    %5 = stablehlo.constant dense<0x7F800000> : tensor<20x20xf32>
    %6 = stablehlo.multiply %arg0, %5 : tensor<20x20xf32>
    %7 = stablehlo.negate %arg0 : tensor<20x20xf32>
    %8 = stablehlo.multiply %7, %arg0 : tensor<20x20xf32>
    %9 = stablehlo.log_plus_one %8 : tensor<20x20xf32>
    %10 = stablehlo.negate %9 : tensor<20x20xf32>
    %11 = stablehlo.constant dense<5.000000e+00> : tensor<f32>
    %12 = stablehlo.constant dense<5.000000e+00> : tensor<20x20xf32>
    %13 = stablehlo.compare  LT, %10, %12 : (tensor<20x20xf32>, tensor<20x20xf32>) -> tensor<20x20xi1>
    %14 = stablehlo.constant dense<1.50140941> : tensor<f32>
    %15 = stablehlo.constant dense<1.50140941> : tensor<20x20xf32>
    %16 = stablehlo.constant dense<2.83297682> : tensor<f32>
    %17 = stablehlo.constant dense<2.83297682> : tensor<20x20xf32>
    %18 = stablehlo.select %13, %15, %17 : tensor<20x20xi1>, tensor<20x20xf32>
    %19 = stablehlo.constant dense<0.246640727> : tensor<f32>
    %20 = stablehlo.constant dense<0.246640727> : tensor<20x20xf32>
    %21 = stablehlo.constant dense<1.00167406> : tensor<f32>
    %22 = stablehlo.constant dense<1.00167406> : tensor<20x20xf32>
    %23 = stablehlo.select %13, %20, %22 : tensor<20x20xi1>, tensor<20x20xf32>
    %24 = stablehlo.constant dense<-0.00417768164> : tensor<f32>
    %25 = stablehlo.constant dense<-0.00417768164> : tensor<20x20xf32>
    %26 = stablehlo.constant dense<0.00943887047> : tensor<f32>
    %27 = stablehlo.constant dense<0.00943887047> : tensor<20x20xf32>
    %28 = stablehlo.select %13, %25, %27 : tensor<20x20xi1>, tensor<20x20xf32>
    %29 = stablehlo.constant dense<-0.00125372503> : tensor<f32>
    %30 = stablehlo.constant dense<-0.00125372503> : tensor<20x20xf32>
    %31 = stablehlo.constant dense<-0.0076224613> : tensor<f32>
    %32 = stablehlo.constant dense<-0.0076224613> : tensor<20x20xf32>
    %33 = stablehlo.select %13, %30, %32 : tensor<20x20xi1>, tensor<20x20xf32>
    %34 = stablehlo.constant dense<2.1858087E-4> : tensor<f32>
    %35 = stablehlo.constant dense<2.1858087E-4> : tensor<20x20xf32>
    %36 = stablehlo.constant dense<0.00573950773> : tensor<f32>
    %37 = stablehlo.constant dense<0.00573950773> : tensor<20x20xf32>
    %38 = stablehlo.select %13, %35, %37 : tensor<20x20xi1>, tensor<20x20xf32>
    %39 = stablehlo.constant dense<-4.39150654E-6> : tensor<f32>
    %40 = stablehlo.constant dense<-4.39150654E-6> : tensor<20x20xf32>
    %41 = stablehlo.constant dense<-0.00367342844> : tensor<f32>
    %42 = stablehlo.constant dense<-0.00367342844> : tensor<20x20xf32>
    %43 = stablehlo.select %13, %40, %42 : tensor<20x20xi1>, tensor<20x20xf32>
    %44 = stablehlo.constant dense<-3.5233877E-6> : tensor<f32>
    %45 = stablehlo.constant dense<-3.5233877E-6> : tensor<20x20xf32>
    %46 = stablehlo.constant dense<0.00134934322> : tensor<f32>
    %47 = stablehlo.constant dense<0.00134934322> : tensor<20x20xf32>
    %48 = stablehlo.select %13, %45, %47 : tensor<20x20xi1>, tensor<20x20xf32>
    %49 = stablehlo.constant dense<3.43273939E-7> : tensor<f32>
    %50 = stablehlo.constant dense<3.43273939E-7> : tensor<20x20xf32>
    %51 = stablehlo.constant dense<1.00950558E-4> : tensor<f32>
    %52 = stablehlo.constant dense<1.00950558E-4> : tensor<20x20xf32>
    %53 = stablehlo.select %13, %50, %52 : tensor<20x20xi1>, tensor<20x20xf32>
    %54 = stablehlo.constant dense<2.81022636E-8> : tensor<f32>
    %55 = stablehlo.constant dense<2.81022636E-8> : tensor<20x20xf32>
    %56 = stablehlo.constant dense<-2.00214257E-4> : tensor<f32>
    %57 = stablehlo.constant dense<-2.00214257E-4> : tensor<20x20xf32>
    %58 = stablehlo.select %13, %55, %57 : tensor<20x20xi1>, tensor<20x20xf32>
    %59 = stablehlo.constant dense<2.500000e+00> : tensor<f32>
    %60 = stablehlo.constant dense<2.500000e+00> : tensor<20x20xf32>
    %61 = stablehlo.subtract %10, %60 : tensor<20x20xf32>
    %62 = stablehlo.sqrt %10 : tensor<20x20xf32>
    %63 = stablehlo.constant dense<3.000000e+00> : tensor<f32>
    %64 = stablehlo.constant dense<3.000000e+00> : tensor<20x20xf32>
    %65 = stablehlo.subtract %62, %64 : tensor<20x20xf32>
    %66 = stablehlo.select %13, %61, %65 : tensor<20x20xi1>, tensor<20x20xf32>
    %67 = stablehlo.multiply %58, %66 : tensor<20x20xf32>
    %68 = stablehlo.add %53, %67 : tensor<20x20xf32>
    %69 = stablehlo.multiply %68, %66 : tensor<20x20xf32>
    %70 = stablehlo.add %48, %69 : tensor<20x20xf32>
    %71 = stablehlo.multiply %70, %66 : tensor<20x20xf32>
    %72 = stablehlo.add %43, %71 : tensor<20x20xf32>
    %73 = stablehlo.multiply %72, %66 : tensor<20x20xf32>
    %74 = stablehlo.add %38, %73 : tensor<20x20xf32>
    %75 = stablehlo.multiply %74, %66 : tensor<20x20xf32>
    %76 = stablehlo.add %33, %75 : tensor<20x20xf32>
    %77 = stablehlo.multiply %76, %66 : tensor<20x20xf32>
    %78 = stablehlo.add %28, %77 : tensor<20x20xf32>
    %79 = stablehlo.multiply %78, %66 : tensor<20x20xf32>
    %80 = stablehlo.add %23, %79 : tensor<20x20xf32>
    %81 = stablehlo.multiply %80, %66 : tensor<20x20xf32>
    %82 = stablehlo.add %18, %81 : tensor<20x20xf32>
    %83 = stablehlo.multiply %82, %arg0 : tensor<20x20xf32>
    %84 = stablehlo.select %3, %6, %83 : tensor<20x20xi1>, tensor<20x20xf32>
    return %84 : tensor<20x20xf32>
  }
}
