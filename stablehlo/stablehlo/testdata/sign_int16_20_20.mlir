// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xi16>
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.sign %0 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x02000000010000000300FAFFFFFF0700FDFF0000FAFF00000000FEFF00000000FDFF00000000FDFFFAFFFEFF0700FAFF03000200020000000300FFFFFEFF0000FEFFFCFF00000100020000000300FCFF00000100FEFFFDFFFCFF010001000200020000000000000000000100FCFF07000000FEFF0000FCFF0000020000000300FEFF05000100000003000000010001000200FDFF0000FFFFFBFF0100FEFF0300FDFF01000500FDFF040000000000FDFFFFFF0100FFFFFBFF050000000000FFFFFDFF0000FAFF0500FCFFFFFF0000FFFF0300FCFF0000FDFF0100000000000000000001000200FBFF02000000FFFF0300FFFFFDFF0000040001000000000000000000FDFF00000100FFFFFCFF0300010001000500FFFFFEFF030000000000FEFF00000100FEFF0000FEFF0000030002000000FDFFFEFF0000FEFF01000100FFFF0200000002000400FFFFFDFF0000FEFFFDFF000002000200FCFF0400FBFFFFFFFFFF030004000000FEFF010000000100000004000000000001000200FFFF0000060000000000FFFFFFFF01000000FBFF0000FFFF0000FFFF0100FFFFFCFFFEFF0200FFFFFFFF040003000200FDFF0000FEFF02000800FEFFFFFF0000000002000000FFFF00000500FBFF000002000100FFFFFDFFFFFF000000000200FDFFFCFF020003000000FDFF0400000000000000FBFFFFFF020007000400020002000000FEFFFDFF0000FFFF03000100FEFF01000200FFFFFFFFFDFF0100FFFFFEFF000002000100FEFF05000100FDFF000000000100FCFFFCFFFEFF0400FEFF050004000400FFFF0000FDFFFDFF0000FAFF01000300020000000300000002000000000003000000FEFF0000000001000100FAFF02000100FBFF010000000200030002000200FCFF0000FFFF0000FDFFFAFF000000000100FDFF0000FAFF04000100FEFF0000FFFFFFFF03000400020002000000FBFF070002000100FFFF0100010000000000010001000300F7FF00000100FDFF0000FDFFF9FF03000300FFFF020000000200FDFF0100FEFF0000FFFFFDFF02000000FEFFFCFFFFFF0200FFFF000003000200000006000300FEFF00000000FDFF00000200FFFF01000100FEFFFBFF0000"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x01000000010000000100FFFFFFFF0100FFFF0000FFFF00000000FFFF00000000FFFF00000000FFFFFFFFFFFF0100FFFF01000100010000000100FFFFFFFF0000FFFFFFFF00000100010000000100FFFF00000100FFFFFFFFFFFF010001000100010000000000000000000100FFFF01000000FFFF0000FFFF0000010000000100FFFF01000100000001000000010001000100FFFF0000FFFFFFFF0100FFFF0100FFFF01000100FFFF010000000000FFFFFFFF0100FFFFFFFF010000000000FFFFFFFF0000FFFF0100FFFFFFFF0000FFFF0100FFFF0000FFFF0100000000000000000001000100FFFF01000000FFFF0100FFFFFFFF0000010001000000000000000000FFFF00000100FFFFFFFF0100010001000100FFFFFFFF010000000000FFFF00000100FFFF0000FFFF0000010001000000FFFFFFFF0000FFFF01000100FFFF0100000001000100FFFFFFFF0000FFFFFFFF000001000100FFFF0100FFFFFFFFFFFF010001000000FFFF010000000100000001000000000001000100FFFF0000010000000000FFFFFFFF01000000FFFF0000FFFF0000FFFF0100FFFFFFFFFFFF0100FFFFFFFF010001000100FFFF0000FFFF01000100FFFFFFFF0000000001000000FFFF00000100FFFF000001000100FFFFFFFFFFFF000000000100FFFFFFFF010001000000FFFF0100000000000000FFFFFFFF010001000100010001000000FFFFFFFF0000FFFF01000100FFFF01000100FFFFFFFFFFFF0100FFFFFFFF000001000100FFFF01000100FFFF000000000100FFFFFFFFFFFF0100FFFF010001000100FFFF0000FFFFFFFF0000FFFF01000100010000000100000001000000000001000000FFFF0000000001000100FFFF01000100FFFF010000000100010001000100FFFF0000FFFF0000FFFFFFFF000000000100FFFF0000FFFF01000100FFFF0000FFFFFFFF01000100010001000000FFFF010001000100FFFF0100010000000000010001000100FFFF00000100FFFF0000FFFFFFFF01000100FFFF010000000100FFFF0100FFFF0000FFFFFFFF01000000FFFFFFFFFFFF0100FFFF000001000100000001000100FFFF00000000FFFF00000100FFFF01000100FFFFFFFF0000"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
