// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.multiply %0#0, %0#1 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC857E940DECDE2C0BFED44BF4E8B2CC0615AD0BF1F1B3DBF23FCB73F9B50303EC9C7223DEFFFE1409A99B6C08ACB10C006D45A3FB2A131BFC0E292BE27755BC0683E243F228E7B3ED3B804BF4EBAF73D6FA659BFD850B33E991059BFD3DA07C02E8B92BFE25727C0504D4040502D3DC0A8988F408073CDC08E6B4DC0E987CDBF9D97D33DA2523D3F07315740863359403C88034045CFA93F43DBB8BFFBDBCC3F0147A9C0B74069C00998E23FEEFF3CBE977A3E405E7593BF6513D33F405708BEB01A9A3D1D8949403E4E54C0D3DC913F4FCB84BF0D612BC0B3DE2B404A4C283D98BF89C0C436EDBF30621F3FEC6A92C0EFEA0CBEBD846BBE172F2E4079A95A3CA038C8BFE0E04BBF91985CC034109E401A3D093F9EE3B5404C9863C035508F40F58DADC0DE0C333F5C2A05409EFA35C008F604BF92874D4072A1203F96AF8C4093473DC07898BE3FF287013E4D4A01C0CD76BAC040EFFC3E74FEBEC0E6005540229306412F01FBBE30FA1FBD7265D2BEAAA126BFF126BC3C16AA96401F9840C05B867D40D94C1E405C1F99C090389EC0FAF724C01652E4BF036D64C0A8A2AFBE8F84C53FD4316F3F4C781840BC34673F6E1EB53F9C541C405700024074D715C03BAB483FACEE0A40B864B8C017BC46C063F0BABFDD9BCC3E9BCBC63FFBA3853E5DC2BABFE9AEA03FD1809B3FCE4C19BFC3CC2DBFD8DE14BF63D285BFAB790040D173DA3EC15C84BFED05E9C048EC4EC0B49E43C0844280C0ED27B53F7BD9903DE14755BF6134A2C04F19F7BEADCEA23F43814E4038D52FBFEF0AE8BF8DD19B3FFB491DC0CF0B8C3E9373F3BE874861BB0DB223BEE4AB1B4030601540C5A8DABF8A1CD64056FBF5403D9D8840F17A0C40821618C0672A0B406DFEADBF964934C05E77A3BF550DC53FAFF003C1C21AA13F8F73024088936FBEA30387BFEC2696BE72A4B23FFEDAE440BC9D0940B79807C0E4465140F25696C08C0E57C0466ABB3FA93449C0678E13C06FB26F4083A075C07AD6ABBEF98D0E40F20410C0A57984C0363BEEBF5CA50BBFC4D1CCC09CF206C0F360F6C036D09B3FB6A74DBD431975C0062C5CC02EFE60C025134240D9D944401C46B63F7DE4B6BDDC0D38BFCCBEC2BE808992C0A379B4C07EAC97C0A7E5BEC07004133EB05152BFB6FB82C08F23CDBD29FAFDBF0BA38F408F8F76BF0500B7C07C88924087F621C034A7CE3E8CE056C09ACFA53E255A6140BC604240479387C0C5E5A1C08B9D7DC01C1B8D405EB9B5BF3594E24001906EC07ABE2CC05F3C453F4F9F2DBFBA516C3F87148CC027EC3140C4FEB8BFB8D71C40F5ED8C40076D07C0A98DC73F0DEE543E19AB74C0DE3A0D40DA7D83C03BD264C01D3CB0C0905E45405F51EABF648119C00C96A8C02B0548409008914098C82AC0B0F9B73F16FAF93F1E3310C0AB17193E2CD2D73F077411401A5E76BF5C24D83FF430833F30DC553F38805EC02ADED3BF4C6F5A405ED0973FCDB7E63C8022AFC026E7B5BF6E3DB340E24F4140D23C073F0B85CDBF239F06C056096A3FE6E29CC08C6ED8401077CE3FADE0723FE75A2DBD3E56933F407D5AC090AB4E3F18828EBFBFC33BC07DE26F40F9F7963FD76E893F08A9754075BFA53F8EDC0FC00D70AB40B7B5013F1D348140838D3AC0378F2C40A9B8AA3F8B1942C0E6CA773F517CA3BE210C0BBF7508E2C0BCB4603EE662F63FC5535440A1C210C0395BFD40897DA2BD1600CB39D8549C3F639E25409C0D7CC063F189C0AC541B3C0415E8BD628311404A66B6BE6715ABC030B70841CD809E3F95DB01C084643DC0662FB93E6EF10440EDA58AC07A5F973FB3CF84BF941A6AC04A1C9AC0C78AD0BF4C2F5BC0DF81B8C0E10866BF72D6E73F145F433FFB8FD8BE72E71640A1CE46C0868E393FCF297440E0D9A23F2CB731BF18213D405370AC409306FB3FA40756409F09B7BF391618400BC6934079CCADBF6363E63F41B106409E6B364020E8BAC079CD43C0653099C04347FFBF7044023D3FD5183FD4F38EBDB62FD9BF26F3D23F5288843F2C708B40DFA629BF3E03DF40B66406C0DF53094091A6D53F9AD00EC0BB96FD3E49FED73F92A8ADBE75B884C0A60F4D407063DDBEDE7F8DBE81916340AEFBAC4016315B40B8B180C04BD5A8BF15E5C8BFBF1F9E3F7F22D03E6B21154028EE9E4037223740B192013F857A6740BB7B34BF5F2A1BC01416CE3F71A23940B98D0A402FE8A43E42C9EABF08CCBDBFF5067E3F3E58E8BF5325DE3F52FBA740"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<"0x4FB2A03FCD25803FE59B59C07D1D2C40D371C13EB49BA53F515FDEBEB5324AC0B839C7BF77864A4030425D409C2B72C0D410103F9B1A3340BC7897BF332B28C033B4A2409D548F40EA8E1740B94A663F534D2D40EE35ADBF1ABE44BE7D625540CB15D93FF03C853FBF121440540489C0CB3833C0EB16B03FE03DA5C0965B4240BEF0DE3F881EBBBFBB709DC07F0971405A82F8BF4769FE3C1C028EBFAF6BF1BFB1CC6B400E7FAFC0772002405B98A83E9964BF40C12221C0A6CAB74065A0B2C0C6D87EC08DFCCEBE14F174C0931B2240819BB0BF6B23233FC20F1F40AB9B353F350F59C0B3DA9E3F7540C03FE37347BF61A595BF1943CA3FFADE8D403C745540884F91BF371833C064F48B3F7B0E0A40A04978BFFC3F174089FB2F401FCAF73FC8D96B3F4CAECE4080161FC0CEAD2BBE9FDD8F40C196093F198D953F389328BD25EA9ABE78D6AFBF9E77C23FCAD2A6C0F982B040A22AA3C05D54A5BE905238C008A123409178043F3FF4223D6354883F00AFD440EB772940981D70C031F839406DE73E3D354D2EC03EF0DB4045CDCA3FC71316C0B0BFB8BF8D21A03F3DE1EEBFFD6D973F38382ABFE275D63FDBEE8E40E842CD3EA747B0BF92B701C02DFA4940325F81C01FF27FC0E42D07BF0906A64031A477C0646C954075B07DBF36F2A8BFE305AA3DC35343BF399A4D404C432FC04A993740585305BEF15CA9BF9900533D04EAF4BFE30441C0AA107840EA9789C06E44F83F154640BF2D2A7FC0000062C0AC1FC2BFF131BAC05B5D603F2AF922C01B2149BF6F3982C055E316BF3B3504C08B1D0D40B4CC33BF098D4940B32EEDBFBBD8FEBF563023BF587906BFB118C1403085C3BF6482D3BE3571F3C08499763E78C722C0360FC63F6C51A1BD6248224019734540718A4EC00E02DEBFE2295EC0DF2FA3BD7C6F07C030E8B740B4CA99BFCEEF00C1650E9B3EC19952BFA2259DC000D2E4BF83DD2FC04F68C23F1D1C7B3F379A923D047683BF29F3D3C060CD923F82FD83BFF04C0AC0465B06409D53463F39380AC0A67217C053DF34C023E63940FECE8F3FB88F71C07C58C53F9F26A5BF45EFB840D77599BFD6F84D3FD122E7BFC21C94BE425E2BC0195A5BC0DB5C9CBFFC2ACBC04FFB33C0E27656C09DA0163F97170DC0343525C0C9BEE7C05561E83ED6790D406FF016C01D7018BF79E0694029C5EC3F869D17C074F51FC0D9017F4021D0303E930B833FB28BD5C06C8A5C3F1DDCAC408C05564000F5993E3A2BAE3D555CF73ECD16ADBF86E445BFE8651C40597ADFBF395B18C0A7EB6B3FA97EBF4009BF54C0179A48C0B7EFE13FAD9DE040858630BF63F508C06B91D7C0066994C085DAE13F2ABC47C00A1E07C0169649C0767B29BFACBA54BF6C35773D81AC93BFC0EA1EC0C4134FC0FDAE2C3F8B78B9BF1F6C05BF262BE33DCD1FA0C073A7853CAD93D43FFFA0103FF09C80C0798B9BC0E5266DC028BBCA407AE17B3F45641540FB9304407AF732C0B1FFF3BE121F1CC0BAFD9940B7615540F9074940DA8246BF247CF4BECD7E084015CC14BE0DC237C0051CFE3F05FD744028843C40668B843FCC72753F926F19C07EDA5E40DC4825C062A6543EB9DDBCBF791E8A405E9288408CD877C0F5876240A614FC3FB262C53FD3E28A402F238CC0512C6CBFE9A68C4076E989406247B8C090889DBFF916923F1131863FDD6DB440CF7F78C060A05DC0FA33FE3E983280C063069C3F9B243DBF69DC3EBFDB9275C0B572764002DBE63FAA779B3F1FAC73400768CB3F9C88FABF7D19153F5E9EFB3DCB95943FEB209340AA468CC0648B22BFBAF8204011B23340E6FBA1C0993CA23F9BB78BC00BAF0E40037F643FD1841640BDB3273F0AC3863F9BBF23C0F30A65BEE0D839C0794130C0ADDB1FC0F3130BBFA92DED3F02BA8CC070FF89C008D688C0768DDE3F244836C04D24443F2E83DEC0FFBDBABF13EC3F409EBBB6C04E91B040AF4F62C04134B13F50F47740B63B74404DCF893EE658EEBFA2864B40B98085402EDAF0BFBB308EC061804740B4FBC73F3337CF3EB88E29C03D6FD43E091BB44093C808406A3C1B4095B77BBF68010BC041E02640ECCDC0BDCA654F400A699E3F614B493E00BA0BBF8F5DA24027380C40678ED0BF184BDC3F2F677C3FB0A1603D77F058C0E9381EC052AF41405EA68640B70893C05FC8A7C004200E405FA75A40D4F71BC00AAF4EC0969BA83F1A6F72C026C5EE3EE220E4403D9BCD40482D5E3F35BF55C0EC854840"> : tensor<20x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x64791241D910E3C073652740F102E8C0C7701DBFFFAA74BF27D11FBF87420BBF015C7DBDA8CAB241D0D19DC113F908414C4BF63E0B8DF8BF0BD2AD3EEA29104135C650408AD78C3F39269DBFB1D9DE3D375713C0D1A6F2BEE6D1263EAB7AE2C0E788F8BFFC302EC08E75DE40E5804A41310F49C1CD510DC1F9978441860A9CC07544383EF1618ABFD45784C190814C41E75D7FC07CC1283D4A16CD3F433141C088EB9BC101E79F41E25B6640DFF078BD50688E41AAA13940F38917412E443E3FF86899BE27F3A2BF81224B41E7BA3840E138B73F026DDABFCB93D5408EC8EE3C2D976941733213C08B636F3FCB2664408CBF243E7814BABE4D0F41414A52363D8D4CE33F86A10E40DD3271C05A7B2A41A91A05BF71ED5641BC741CC18AB70A41F5E49FC0438E90400782A5C0E913F43E137115C02BEDDC3F00AD3B3F444839BE5A14653FE7E902C017CB443E46812841139100C2753621C0E3B1F63F575D19C1AB08AC41D3E281BEE8A9CBBA7E16E0BEC96F8AC0B01B793DDF508DC1A7E80BC1E80E3D3EF38FD7C0868D03C2FFAEFAC0166CC140F6C5244012E28EC0C0E3233F1AACE93F9E0B1FBF8A757F40F9168140B438113FD94B57C0C8BE83C03271ECC0CFD14AC024E70AC156BC4240A6E280C1D5D5B440B3DAEE3F3F00C5BF1C64B0BEBA12F8BD9D3375BFABC779409BE7D13FE24AF9BF7B109B3DF210B13F29C9D33D14FE50BFE9984740E9CCE1C17A6E5E4109B6BDC0FFA940409D90B4C0FDBF7FBEDCBAA13F66F3EB414190D8BE7E4A4FC0323E22C072E3324077C4883FE6F020C0CC67ADC07BB844BEDEABBFBF3EB9D03B3FF5A23EAD77C6BF4EEE9CBF54EE24C1228723C1723B4BC0ABE901C26152073F7E69C14021565740B348DB3D1593E4C0B4287CC04BFB9EC08ED7644190CF8BC0F24F26BE437EFD3E1CFCC1C04F68B43E21F333C1769D0A40166CE2BF2E792641CF0EBBC00B8F4E41A650A3C0C7D5B73F7B7266BEC98B1740BE73C6C198DA8CC0D531B13EC0069AC0E02B97C0B5424DC03DA08040273AA53F2BB6904146FDC3C05E670AC17C0693C024899EBD421E9E406D0D9FC17BDF8640F9251C4058BBB1C004EAD2BEEDDB743EA2B41D40CFE5ED3E4797E84170C47D4141217E41A9A460C0FC0DA2BE5CBA07407E25ED4138363ABDA85B8CC0DF6029C138D1123F7B2FA7C1AD86074125D8BF40FD1F81BF380B56C1100B653DA2B666408E24A2C1BF9769C028A3DAC1310754C17DB8A93F5A45F7BDB8EE5A40904CA140C88805409BFEF03FC090973FBCA40CC0CA1781C03917854107BD9940DFCDF5C036C2F8409FA56DC1409A89BF22D5E3BEAD06CE41F2BF23C1B403E8C09C873241C2083A41F56A1BC1B9209B3F2C1EFF3FF4CBA2BE80C366C08F1034C163250A410833783F6F1B35C0EB4E963FCAD9873C2BFE06C1D7E0173D0C94CCBFC438743FCED183C0D5F081C0821E4E4132C827C183EB56407A2F314047F86E3D95DE744118602D3F609E5AC1AD9068417372E13FDC63A1C0C9C7D03F6382DFBE7F4C27C1E6987BBF9D3394C08115F13FFAE525BECAFE58401C3F62C0DE26463FB8D32A40017423C140E11AC1F2CE7A3EDCC8CABF5C8A8441F4D8B0407E470B41F8B39741AD727F3FD43DC740276B4AC113EC3CC1CA7F9DBF0A4955C18F7D8540E15DEB3F3A212B3F1BFD00C158936B3E47A72D41281B4EC16AA5FA40F3937B40C3BDA23E3C72F739FC0167BF4BF4F6BF9EC97141C4CB84C1F5128C3C35F10CBE8C810A413BED10BF326E274177409F4057CA1B3EDCBD16C024B259C113F2CABF55D2A8BFD35C2EC1198254409D12A8403C5C94C0C737A841247768C0DFA243C0A5F758C14DB116BFC215F43F88EFF9BF0FC2C13D311ADBC0E7E008417FBDE7BFBAA504C0C0E0164099624340D9E64BC1AF57B8C16A3A5A40BF6518C1523D8CBF343184C12197D7C0D44B82C0817324C1A0CC3941C94321C1A56001C11DA63DC1DB2592C1DA6B09BFB99172BDF302F33F1D1995BED4554C400E56EAC0DC904E4096DAD940835289BE78B593C1990B5FBFF33A4141C44F64400334ADC0A458F9BE83906AC0DD6662BF34EAC73E3021264136FE08BF1F865EBDB26AF8BFF86CDB41D81DF040F8AFD140D34811C07A12C6BFA6BF8A3D9C60B0BF8E57B8C0C87C7041D8A540414AD714C01AB697C16866C8BF878704C1C01D7BC0A4DF15C16D8236400E2B9CBFEBFB5ABF182229C19D05CC409FA5C9BFFA7AB9C038948341"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
