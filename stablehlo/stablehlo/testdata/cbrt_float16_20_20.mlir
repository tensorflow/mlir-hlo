// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.cbrt %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x92392D3F79418F41B9BFF03C6ABC303FD22FF343B331CB43E23BF93CD2356EB31F43113D5FB4C3BD2D3D0CB828400AC158C8EC350C3D553DDAC1CA3E6F34D0C1B6C3233D24BC9342E7C033C255BA303B6DB926C3C8BBDDB55FC336415B3C5443A13BC9BF34BCFEBD85C2BF380ABCE3259CB35C44F34608C05343883D44C0E84016C2123B9C38AC448E45C244E9B89DC154469544623E373F50BC743E1F44993D7EB05D3CC9C2DBB0C4C5E244693E0FC14DB03DB71DC073C909C0CDB9BEC15A43EDC106396344E1C110C0B238FA44E9BD03C0E33FAF409A3FCB409EC4553F4C4354457F375D3DA0BFC6BA70BEE14841C14EB472BAA0C587B7BC3E6ABB8F3D6DBD503619C115BB4EC4E94077406E40FC3997B03FC345C7A431353E1BC383373E40E4C2C6C0D63458B859C05BC2D23CDAC02941144467408DC5FBC6B2BDF9C3233519405143A73B8E3BA9440AB82C46FEC2CCC6C63A76BC54C0BA4416C39342D8C0F3422EBE4541F940D0443E42F2BE65C782C390C061C282445B441043B03994BC79B92E4430440B40D7C04441EF44C9C4C138DC2D39417B3B9539D23A704426C421BE06BC44406DC6AA3F433D4CAA25C16233C6408EC2D340B3451F445744E7C01EB9A4C01744ACC4A741B6433D3FC4C258C1A23AE0C45BBD2FC17E4512C012B425C061C1944375416644674538B4D740C93F2347A235D5C30BBE40B48EB713C01AC53F3ED232C4B8F846353D0C41BDC01F4215C3D3C0C73DEEBE4AC2AA33583F4DAE3B4115BF0BC15EC665BBFD484F9EB0BF4FC25D44D1C1593FDBC28BC3A1BCC5BD52C787BE10C030C06E3C203DF72B0741833DF1C0384534C007469E411732BF3B1DC2D8BC74BEEBBF36C027BA5D3B0B394A3B3BBE14BA5D3DD7C1303CD0C1DE3EFFB758BF06A1F0BB733CD93DA4AD42418DC12EBDD84471C3C5BC7C413A2923BCBB3D5B3C4ABFF4453CC0783C9A43B04112408343D2BE7242B738C741D4C515429BC162BD6EB587C2D74065ADFEC232BEBFBA32C4BB3DDABEBCC152C10945C0C1353BB8411D3C49BD263F903AE5BF0A3899C2BFBE91B211C4AC3C693E3943D8C40EBFD8B9D5C23048ECB7E7BEF5C3C7A297448C3D1FB980420338A6409FBE"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x173BDC3C983DA03DFBBC4A3C22BCDD3CF137563E80384B3EF63B4D3CB639EBB81B3E543C31B984BC5C3C60BA1B3D71BD1CC0BF39523C673CB8BDC53C3739B5BD46BE593C0CBCF23D65BDD5BD66BBB83B07BB1DBEEDBBBAB92EBE813D1D3C2A3EE03BFEBC11BC94BCEEBDB93A03BC8D34F5B8893EA23F0DBD2A3E753C26BD653DCCBDAD3BA83AB03E153FBA3ECDBAA4BD663FA53EAD3CDE3C1ABCB13C6A3E793C29B81E3C03BE45B82CBFC93EAE3C73BD19B824BA16BD6FC00EBD30BBAFBD2C3EBFBDDA3A8C3EBBBD11BDB33AD43E8EBC0BBD043D503DF43C5A3DA9BEE53C283EFC3E373A693CF6BC92BBB0BC464085BD2AB972BB1DBF39BAC23CCDBB773C6EBCDE3977BDAEBB82BE653D3A3D373D433B30B825BEBFBF7C38A13C1ABE383A243D0ABE58BD5F3987BA2EBDE1BD423C60BD7C3D643E343D15BFA5BF80BC57BE7A39143D2A3EE23BD93BAE3E5FBA563F12BE93BF923B26BC2CBDB63E19BEF23D5FBD0F3EA0BC863D6B3DC13ED83DCFBCCBBF37BE44BDE3BD9B3E883E173E243B2FBC0DBB713E723E0F3D5FBD863DCF3EBDBEBA3A3637823DD33B193B963B933E6DBE9CBC02BC263D6FBFF83C623CDDB57BBDE838583DF1BD5D3D253F6A3E863E65BDE5BA4CBD653EB0BEA83D463EE03C01BE8DBD843BC8BE69BC7EBD0E3F12BD12B919BD90BD3C3E973D8E3E053F21B95F3DFE3CB33FA6394EBE97BC25B93BBA12BDE3BEA43CC738BBBAA43F5E3C723D55BDCF3D19BE5DBD853CCEBCDCBDF838E63C64B7833DD7BC72BD6ABFCBBB4E40DEB1F9BCDEBD893EB6BDE63C08BE3ABE33BC85BCC4BFB6BC11BD1EBD233C583C5736703D733C68BDF03E20BD473FA53D9A38EA3BCEBD43BCB1BC06BD20BD54BBC83BDC3AC13BA3BC4DBB693CB7BD103CB5BDCA3C59BAE6BCDAB2FBBB253C8A3C1FB7853D9FBD5CBCC43E33BE3EBC993D83350CBC823C1D3CE3BC403F23BD273C3E3EAB3D123D383EC7BCE83DB53AB23D33BFCB3DA4BD6BBC95B9EFBD5F3D04B712BEA1BC8FBB73BE823CC9BCAFBD8BBDDB3EB0BDBA3BAD3D0A3C64BCDB3C7D3B04BD5F3AF4BDC3BCB8B862BE363CAE3C233EC4BED5BC34BB06BE104054BACCBC56BE93B3A63E763CE5BAED3D5B3A4C3DBBBC"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
