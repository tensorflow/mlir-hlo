// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.sign %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x51A5823FEE291BBFFAAD0340B19CBFBE52240140B3C9F73F8CF4094021E18D403D625740348D7C3FB0A8BABF483EE0BE14AA5CBD9F2F51407105D9BE2ED2B240BB5301403A2014C0CE431CC07B407DC03BDAE73FB9FE523FFC7267C006CDBBC0771931C071819240B05AA63F82AB42C0D90B2A40C1A51E3E0D66C3BC3E298040C0340ABF46143DBFE20A1BC0A1CB02403E6B99C0E71D0140504C8340AE8230C0BE31F8BF58D982C07F60574074B641BF320265C01DFBEE3F3E9F28C08BF7DBBEBA2B013EA8F26DC0E23684BF754746403F6BF0BFC69D3AC0F8858840D71FA73F84D2E4BF126768BF7936D93C0D726FC09443B34053D582BF9BA25040901071BFD2E4F83ED7EBDDBFDF2CA9BF57C9B13F708625C03F6E9F3E2B4E93C032D3804050E1EABFDB9C6E408AB33A400E996EBE25F3F03F04D9C2BE890A59C00E32ACC093A439C00A407BBF3442BF3FD3A98BC03F63594093BDE03F0802C5BF0EABA53D474E62BF01C79440380E82BF1D788840D11970C09D231C404885CC3C2CEC46C0A8035AC0D20AA23E307FE73EEE78AE40514AB9BCF494F2BF32C327BFF06AA3C0651FC33FA764A5C0F381BB3EF1536BBEAA27943FE320903F61C167C008C22E40267E6040539E3C3F755480C0FD5BDC3F290FE83F61DA39BECAD9883F1302E73EC888B93F6DD2524022DFD93E913D023FB7B5783F8F91AC3F60F43CBF8E7F31BE42A7264063A1B4C07C118DC0697985C031BA623F57487D3E85B780BEC199753F28D4973FFA3A9840F1D6B9C08A16AAC07D14D9BFCAFEDEBFE63753C0C74355C026C78340D569843E3DDA423F171077406F381B40CF862440D82E58C0CA26C8BF343969C0F79E2C403D4F2A3E632DE13F883205C0DAAC91BE5D301FBF14122D3E3AA55A3F4A63ED3F8F3B6F40DB62233FA75B59BFD9002BC0997B22C0D194D2C04F59D53E59A35CBF28BB413E9DCB57C04D072740571F5040AB9A8B40AF4716C1260EB73F0BD2463F16284D3FEEB6693F724C95BFA2F6214043FFEEBF06DA5EC0C2C360BFC1E89540143C8740AD24A23F8DC31C4034AF913F7C0431BFBC60AAC0C6E1ACC0DC17AF3FAD311CBF342FFEC058619640C7156FBF23E81E3DD543FFBF46D32840CCB09FC0B19BCC40BB80483ECABB5640C5C180C0FCEA353EE3F5A4BF934860BF4697D33FD0A583403C266D406663C3407FF7DEBF7D622F3FCB10D03F4D0487C0CE7832C060BD60C07CE3793E48D980BFE1A2703FF8D25040DAEFDA3FAA69A24066274B3FDE21404076360D40A23D5440813D43BFB16B20404132D5BFE8EB3C3F7F9A29404D5383BF3EA062C0D33D1BBEF342E1BE86356B4029A999BF93310940E06049C0F8434340474A9E4096D9113E59993ABF9CA9E33D917452C0CDA8A43EE6AAA040F6A7B5C08ACF63BD9F2535BFE7027D3EC89DD73F9F9D39BF878739C0EDAE7040F98576C02546354036F7ABBF00C0804016CE593FB6231EC07AC5CA40AF1C88BE46EC62C07E32B7C05E51D4BFA6A66C3FA13B83BF94142AC0075F46C06C2454BF1FE5A73E89086B3FB5DD9B3F44E5973F561EE6BE88A427C02E310EC02615554094BB7140EBCAB73E52112D400E7E0FC03F6A4C40A959FFBF84B107C0B38FC54040763D3FE60B033F6C35523F5C010F40EF458CBE353A383F7F5405C04C36A0400FBF51C04B7123C01F08813F3FE31940D3E55CBFA703FCBF102A03BF7AAE553FB85F1540A68500C0DAF8F5BF49D630C17A50503F2345A2409BB7063FAE008140092FAABFD43B3A408FF96E3E243B36C098E6E6400E999EC09BCF8DBF16219A3FE5172E402C3D0140A24D2A408B82C3BDEE44923F356CE240C33F5A3FF13366C036B464BFD1EC8EC0BE463AC09C81E8BFF34DED3F7192FF3F44C12EC0B5F12C40745059BFF216DC3FAC74733F391471C0DEDBE63D37BF663F61316240F6AF13405647B43F8403EEC0F7FDCF3DE789EFBDE8FF7FC00A7583BE6B8A9C40B5953640702446C037CB3D3F6A3497BFDEE0AE3FA2630A4107C2A4C0B1AA0AC0D0956D40295FBA3F00C5A040EB836640E62568C00E2E70C0469BBF3F4EB5103E8BC4F3C02AE89340EBCF21BE2A4E65C0508E46C05D0703C07ECEA3BDCE1487C047F80C40724EA8408591594034A54FC0CE9B9B40817BFCBE23EACEBF437914C0E2241F40A22C9A40EB6A953F29A83240559FAC407AA04E4026EF633F1DEA74BE0074E3BF7DDB4E3FA5494EC03589E23DEDF32DBFC6B3ABC09B434AC0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0000803F000080BF0000803F000080BF0000803F0000803F0000803F0000803F0000803F0000803F000080BF000080BF000080BF0000803F000080BF0000803F0000803F000080BF000080BF000080BF0000803F0000803F000080BF000080BF000080BF0000803F0000803F000080BF0000803F0000803F000080BF0000803F000080BF000080BF000080BF0000803F000080BF0000803F0000803F000080BF000080BF000080BF0000803F000080BF000080BF0000803F000080BF000080BF0000803F000080BF000080BF0000803F000080BF000080BF0000803F0000803F000080BF000080BF0000803F000080BF0000803F000080BF0000803F000080BF0000803F000080BF000080BF0000803F000080BF0000803F000080BF0000803F000080BF0000803F0000803F000080BF0000803F000080BF000080BF000080BF000080BF000080BF0000803F000080BF0000803F0000803F000080BF0000803F000080BF0000803F000080BF0000803F000080BF0000803F0000803F000080BF000080BF0000803F0000803F0000803F000080BF000080BF000080BF000080BF0000803F000080BF0000803F000080BF0000803F0000803F000080BF0000803F0000803F0000803F000080BF0000803F0000803F000080BF0000803F0000803F0000803F0000803F0000803F0000803F0000803F0000803F000080BF000080BF0000803F000080BF000080BF000080BF0000803F0000803F000080BF0000803F0000803F0000803F000080BF000080BF000080BF000080BF000080BF000080BF0000803F0000803F0000803F0000803F0000803F0000803F000080BF000080BF000080BF0000803F0000803F0000803F000080BF000080BF000080BF0000803F0000803F0000803F0000803F0000803F000080BF000080BF000080BF000080BF0000803F000080BF0000803F000080BF0000803F0000803F0000803F000080BF0000803F0000803F0000803F0000803F000080BF0000803F000080BF000080BF000080BF0000803F0000803F0000803F0000803F0000803F000080BF000080BF000080BF0000803F000080BF000080BF0000803F000080BF0000803F000080BF0000803F000080BF0000803F0000803F0000803F000080BF0000803F000080BF000080BF0000803F0000803F0000803F0000803F000080BF0000803F0000803F000080BF000080BF000080BF0000803F000080BF0000803F0000803F0000803F0000803F0000803F0000803F0000803F0000803F000080BF0000803F000080BF0000803F0000803F000080BF000080BF000080BF000080BF0000803F000080BF0000803F000080BF0000803F0000803F0000803F000080BF0000803F000080BF0000803F0000803F000080BF000080BF000080BF0000803F0000803F000080BF000080BF0000803F000080BF0000803F000080BF0000803F0000803F000080BF0000803F000080BF000080BF000080BF000080BF0000803F000080BF000080BF000080BF000080BF0000803F0000803F0000803F0000803F000080BF000080BF000080BF0000803F0000803F0000803F0000803F000080BF0000803F000080BF000080BF0000803F0000803F0000803F0000803F0000803F000080BF0000803F000080BF0000803F000080BF000080BF0000803F0000803F000080BF000080BF000080BF0000803F0000803F000080BF000080BF000080BF0000803F0000803F0000803F0000803F000080BF0000803F0000803F000080BF0000803F000080BF000080BF0000803F0000803F0000803F0000803F000080BF0000803F0000803F0000803F000080BF000080BF000080BF000080BF000080BF0000803F0000803F000080BF0000803F000080BF0000803F0000803F000080BF0000803F0000803F0000803F0000803F0000803F000080BF0000803F000080BF000080BF000080BF0000803F0000803F000080BF0000803F000080BF0000803F0000803F000080BF000080BF0000803F0000803F0000803F0000803F000080BF000080BF0000803F0000803F000080BF0000803F000080BF000080BF000080BF000080BF000080BF000080BF0000803F0000803F0000803F000080BF0000803F000080BF000080BF000080BF0000803F0000803F0000803F0000803F0000803F0000803F0000803F000080BF000080BF0000803F000080BF0000803F000080BF000080BF000080BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
