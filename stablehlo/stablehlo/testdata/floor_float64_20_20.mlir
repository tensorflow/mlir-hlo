// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.floor %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCA39027917E500C0DA78BBAB4B610040E42DAF1F8935114074E2947DF09EE4BF0777039AF2EA13C00A3525ED763816C02FBA432352F4BA3FDBCF5B6173D6FD3F34B929E6831819C081A7DC5FD3A8E0BF9255EA1243A90FC0AD24888B3470FBBFDAC344F8BEE40640CC23D04FB8EF0340F9D8369F22071C40DBBF34F3D162FDBF7FC7344574390540BB5E6CC1946ECB3F3616DFA8A119ECBFCF2E60067FBEF33F0307E8A4303604404F8638EE1C5AFABFEC6D5BAAC72F03C0747BED416A53EF3F8C70EE5B86AF14C04419AE9AAB0FFABF5457053E43C31FC0A00C2B3E17AEBEBF457F89BD4DD8CCBF20B7EA2E545409C07A746538543E0040829093A3206DDF3F864142015FEB08C09CEE899E70F7F33F070910C5C831953F6BCF0EE9182E11C096651999DCF20740CE90F8285E6F1AC0F6FD2936111BC33F2C4373430195F5BF2025BFB4B7D9F43F35889E03DBCDFBBF1600223BBD3C10C0F48E17205CCDEDBF1C09B75C4322F0BF6C84B0C5D99BFE3F81BB39AE3EDF16C08B56EA8EB030164035F8C48337AB12C08B076A8AA7DEEC3F5C9CFA532AA811C0251EBDF5AA9418C086659418DE3DDE3FC6D84CD1BA9D0140049DEDB69C2EF1BFD7DFBBFE754E01C05404986D9FEDFDBF73ED0ADD655CF23F537EF0F1F61501409836C334CB3D0040A83801ACA858D93F3F2888A6343B174058F7D7384BEC0B40069CEE38110009C02E06677A34A515402FF16282F55AF63F98DB406F1CC7D23F2670051D3DB3FC3F3ECA4C91F8900DC0D789D9005AF10540A61F40D7335A05C0B0CE2D95F8740E40B2A058D2F83BF8BF301908ED558D18408B4DAF268A88E33FD4663BC3917C0740982A52160D4AFBBFEFCFBCDC859FD8BF8252137A839BD13F0264CC9B9C9AD03F68EB0999352D0BC01D40F80950F2B23F6602C9F2D43209406A3C01EE9E34E43F09912173979F044016AE6BD932DD19C0F62CBE1448BB004092ECB5E1AE810F4094FF369BA130D73FF492C38B2A5EEC3F185D98AB890CF0BF6AA53FC7A7D9E73F82AA97DE8F3405409E014C4F34BCDA3F869C1FA48401F93FE12D2FB81026CE3F040BABA216EC11C01D82EBC437C505C014199123FF59E23FD0382612AF790340BA730FA2DB1F09C0ACCD9DD8740A0140F8C0EEE354B2D4BFC432D9F3F32511408C3209E9930CF63FD3EFF5D10CFA11C0682F39ABC551F6BF0E69D3981318EA3F95638C5327C1DABFA6F6A1196A3DFC3F8A85715B24ABE5BF81E0C91890CF12C0C88CEB1E54DCFF3F8FDA848A0965E8BF5806E6955A6608C0E649707F271BEEBFDB4E7BE136C9F8BF1205012E5EE302C028E0B26DA31CC6BFD8832FC58DB0D5BF64D60D5EEFC7D9BFA0563F3BD744C83F301F7423C790D43F2C8613B2C6270D40BE90121EE83909C0245CB2B6928709405088237397CBF73FED9D077AC09FA03F305B141D09410EC092500CE22A9FDCBF880CAB198A941CC004670CB92276E13F2AAACE91FF7307C08441C4B5EC1903C0A0299417E04A13405A0E7C1DFDF0E8BF33BD6BF9E05410403A2939B749C015C0FAD786FB5018DBBF304A2994F88CCCBF0E3DD2E0E3AAF83F519AF8068E5306C0A9A5BCC6EE16F93FBE9A4696AEFF09402812196EFBFA06C052FE00766D730EC09593F0E8635909C00F3143801271F4BF77F25ADCBD6403C0B82B310B07A305C0E0A86A87436F00C01382E1277BDEF53FE9BEA7EED82DBE3F6F0E10A21D2C0D40EBC545D4F33F10C08CAB9EB2D2EA1140F0EB8A3AE96702407368015E5DC80640089038805B621C4001CC8C649DA3E5BF5121916873C01540210541A71AC407408832ADAB9FABFABF70D1727812D2DDBFBC5F0E11D142014072CADEC630CEFA3FB603DFFED764FDBF335A77C3370B09C06DD30DB7243C0540400976398B9517C0DAF90D9FF7EDEE3FEC5499D5CDD803C0806E01FDE1D60540985F4F63B7E1FCBFDED1B3A2CD12E63FAA176FE780ECDCBF2402C6BEA7E80840306ACB95ECAE0040A8083D637A900140DE390D5A173004403EA82E0689D7F2BFDC20485F03901540D2CDD074FCA0EF3FF636307DC0B1CE3FABB2FD4556B901C0C2993B2B507D094023FAE8EB7DE1F23F8C8B9A2584190D40AC01DD978CC913400585CB25AB4EE0BF2DBB962A4BBD0AC06C8B515B0154D6BF36FB47F8A7C101C0B32231D5DFEBF7BF1C52D92760EB0240CC393E3FED2EE43FDCB6E7884D06F93FC6E72A292972E3BFDC893AE81D69E63F53B4E7B464A7EF3FFCAD1674100512C01CB6DBBD6C95D0BF5E69B90FADBF0B40989A9F6C0517F63F90185C310CFC28C0ED604405DDA10040FCB91A301E5C10C03C5AFCB3D680E93FBE08CE4A7002DBBFE3266D4A448AC03FC0A94ED94EBAE3BFEA3BFBD73B84E03FB808C7A351B2F0BFD4C74A0B0D5BFBBFA0B053536BEFA13FCE94AB3C00A8C73FEAE02AD8A0F30F4082984DF48BEE12404811113A875501C0768A9D90138E12C0D572B61E93AAEA3FF2F6F99D4784DFBF67236C9D651C00C026E79EDC878D0EC07D8CB2FBA619E2BF6071EB9AF81900C06B9A47F1CE0814C0038E4B3D8F68F03FF029F9A980F0F5BF0417E52E10D8DBBF16632F4DC6F8054066A6083476BDFEBF1F903E9EC6250140212DE1583CBCE43F620B6CD03226FE3F1C034BF6736A0EC03275DFD537600840185D59E92A9701C0524A47491F2810C0A3D9624ECF48F53F3B764450EB24064062DF9471BF81C6BFE887A5D2CE37FF3FEB0BCEA4ADE902C0CEFE2C90A15FEA3F6D5A1036D4521640D11E1450B14A0C401CBE7FE074820FC03C887E87F0B41140F2D88204ECF0F13FE6570AE2EAEFD6BF242DA4EDBC4319C04A75C1965A73F0BF55C8EAAB87201140041EDA8C9D7E0940C7D2F922DA89FE3F309DA61BBC1FDF3FCCB2AB7095AC13C0C276DD3D84D6F43F56AAAF765FFC0940820BAA05DA0FD13FCC0A50265690EEBF8769A96EBEB5F63FB13C5197D1690BC03BA214BA3AAA07C07A3F91C823650640727BD04BA21603401469147676CCEA3FFE223846FD3909C0488A2E7C5FB0064087B304A2D0220CC0763AD6E221870540EAE87125B69FEB3FB852A78474630CC09CA0E978731E0A40127CABCA5B3C01403C12F3253365E63F59786C95C2C6F13F2EBB9661B006FFBFED8846D3A73BF13FF2108DFC5FA008C0D2784C7A8D4FFC3F7B1F71C8072506409FDEBCE38C4F0A401661EFAF9644F43F268119CBCEBA0840622BC684CD61EA3F60246EE2B08A17409010185805B70D401C7EBDCD8597004062EA62238A3FFF3F8AE431F4E344D0BFE4792C703A16F7BF35496F06323410C06AD8A41AE10EF33FA64D0847CAC3E73F9C4CD08DD7D8D5BF39CE99950E3312C08CD272575DFF07C0FF50B5DA0CD509C0AAD5AE0604A01AC0A544F2E8E67BF13FBE4DAD82615509C0045084245A09D93F8B0F3F7B464615C03BE221D481BF0AC0C4194F818AEBFE3F54580DFED5A6FA3F2F5F506586D917403B0C5A4D643402C06AE544152D6701C00B06C19ED304BABF9380D427AC040340B308CF2B112CFEBF4850BACE43B2F0BFC7323439D12615C091CFAF0C3657E9BF0B5E90C1BD9C03409BF9D342ED1802C062E93EBE747613401F1367742A99F63F0C50C686EABF17C01CC98A211D6D05C0337BFA552B5BE5BFEC4B7C247AA1FE3F97D68B1E6ACA1040745F8F623EB6B63F36D17726C79B0640D72CE6A6578CE5BF161D1C1B15C8E9BF55119D66BD13EFBFB90835162BBDFCBF2F420C31DD3014C0BA86CEED98BCF83FE17845A27ED3F4BF6B7343DC2A7CF13FF09C5E62A12110403EC3129528E2D43FE26200497C67E3BFC814B562A28112C05EED0F3B7B67FF3F585D94F24762F8BF9096EFAE5E32114030CDC90AA8461B40D8445D959E8213C020A362AC13EED93F38D8616B9372FF3F07F6E3FBDBA819C0123881C24E01D5BF909DC2D821FDBB3F4A7B731E5C4CF83FB8A8AF53AE84C63F82220D21320A13C01E574D8A1AA00D40693C6ED3E10E0CC09811C803F320ED3FC01297B88F3704409C5381DAF02E04C018BC4FE79CAC1840B1F1C58500D61140AECB795CE3FE03C0922FB4A12F280440122BA43E98CE02C0704B5988D6C7C7BF4A0B8BFB6D73F33FC47A5377A9EDDC3F6A7D31CF751A0640E28E99FB375A02403E0B8D0653100EC0A8AF2836B7802340595908C289B9FBBF2074E9D79D5B05403132E9BD5F990040273844E8C8A1F0BF4EB1FFBB902CDEBF996B95D2FC13D2BF4810E96C2DFF0A40222E14E91BE607C043292419987D0FC04FA1321CDD81F5BF0268BB207ACC06C05CDB271EA701F7BFFC4293F147850B404B143E060AF00CC0B038B5559688B6BF71A2B5ABD47AD0BFC4149B4BEEDA1140A2F958F02B1EC23F500FBE17F0370840F49DC2C23D9EFD3F1FF6D4997D4E09C0EA20375C043C0BC0506F5082080510C0EC1F114D9A6F1140DC618C7DD819E63F2A115730EE77FFBF30529DC576290B40EABD4FE1C881D7BF44A812A933481D404B69729CAB621140"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x00000000000008C000000000000000400000000000001040000000000000F0BF00000000000014C000000000000018C00000000000000000000000000000F03F0000000000001CC0000000000000F0BF00000000000010C000000000000000C0000000000000004000000000000000400000000000001C4000000000000000C000000000000000400000000000000000000000000000F0BF000000000000F03F000000000000004000000000000000C000000000000008C0000000000000000000000000000018C000000000000000C000000000000020C0000000000000F0BF000000000000F0BF00000000000010C00000000000000040000000000000000000000000000010C0000000000000F03F000000000000000000000000000014C000000000000000400000000000001CC0000000000000000000000000000000C0000000000000F03F00000000000000C000000000000014C0000000000000F0BF00000000000000C0000000000000F03F00000000000018C0000000000000144000000000000014C0000000000000000000000000000014C00000000000001CC00000000000000000000000000000004000000000000000C000000000000008C000000000000000C0000000000000F03F0000000000000040000000000000004000000000000000000000000000001440000000000000084000000000000010C00000000000001440000000000000F03F0000000000000000000000000000F03F00000000000010C0000000000000004000000000000008C0000000000000084000000000000000C000000000000018400000000000000000000000000000004000000000000000C0000000000000F0BF0000000000000000000000000000000000000000000010C000000000000000000000000000000840000000000000000000000000000000400000000000001CC0000000000000004000000000000008400000000000000000000000000000000000000000000000C0000000000000000000000000000000400000000000000000000000000000F03F000000000000000000000000000014C000000000000008C00000000000000000000000000000004000000000000010C00000000000000040000000000000F0BF0000000000001040000000000000F03F00000000000014C000000000000000C00000000000000000000000000000F0BF000000000000F03F000000000000F0BF00000000000014C0000000000000F03F000000000000F0BF00000000000010C0000000000000F0BF00000000000000C000000000000008C0000000000000F0BF000000000000F0BF000000000000F0BF00000000000000000000000000000000000000000000084000000000000010C00000000000000840000000000000F03F000000000000000000000000000010C0000000000000F0BF00000000000020C0000000000000000000000000000008C000000000000008C00000000000001040000000000000F0BF000000000000104000000000000018C0000000000000F0BF000000000000F0BF000000000000F03F00000000000008C0000000000000F03F000000000000084000000000000008C000000000000010C000000000000010C000000000000000C000000000000008C000000000000008C000000000000008C0000000000000F03F0000000000000000000000000000084000000000000014C00000000000001040000000000000004000000000000000400000000000001C40000000000000F0BF0000000000001440000000000000004000000000000000C0000000000000F0BF0000000000000040000000000000F03F00000000000000C000000000000010C0000000000000004000000000000018C0000000000000000000000000000008C0000000000000004000000000000000C00000000000000000000000000000F0BF000000000000084000000000000000400000000000000040000000000000004000000000000000C000000000000014400000000000000000000000000000000000000000000008C00000000000000840000000000000F03F00000000000008400000000000001040000000000000F0BF00000000000010C0000000000000F0BF00000000000008C000000000000000C000000000000000400000000000000000000000000000F03F000000000000F0BF0000000000000000000000000000000000000000000014C0000000000000F0BF0000000000000840000000000000F03F0000000000002AC0000000000000004000000000000014C00000000000000000000000000000F0BF0000000000000000000000000000F0BF000000000000000000000000000000C000000000000000C0000000000000000000000000000000000000000000000840000000000000104000000000000008C000000000000014C00000000000000000000000000000F0BF00000000000008C000000000000010C0000000000000F0BF00000000000008C000000000000018C0000000000000F03F00000000000000C0000000000000F0BF000000000000004000000000000000C000000000000000400000000000000000000000000000F03F00000000000010C0000000000000084000000000000008C000000000000014C0000000000000F03F0000000000000040000000000000F0BF000000000000F03F00000000000008C000000000000000000000000000001440000000000000084000000000000010C00000000000001040000000000000F03F000000000000F0BF0000000000001CC000000000000000C000000000000010400000000000000840000000000000F03F000000000000000000000000000014C0000000000000F03F00000000000008400000000000000000000000000000F0BF000000000000F03F00000000000010C000000000000008C000000000000000400000000000000040000000000000000000000000000010C0000000000000004000000000000010C00000000000000040000000000000000000000000000010C0000000000000084000000000000000400000000000000000000000000000F03F00000000000000C0000000000000F03F00000000000010C0000000000000F03F00000000000000400000000000000840000000000000F03F00000000000008400000000000000000000000000000144000000000000008400000000000000040000000000000F03F000000000000F0BF00000000000000C000000000000014C0000000000000F03F0000000000000000000000000000F0BF00000000000014C000000000000008C000000000000010C00000000000001CC0000000000000F03F00000000000010C0000000000000000000000000000018C000000000000010C0000000000000F03F000000000000F03F000000000000144000000000000008C000000000000008C0000000000000F0BF000000000000004000000000000000C000000000000000C000000000000018C0000000000000F0BF000000000000004000000000000008C00000000000001040000000000000F03F00000000000018C000000000000008C0000000000000F0BF000000000000F03F000000000000104000000000000000000000000000000040000000000000F0BF000000000000F0BF000000000000F0BF00000000000000C000000000000018C0000000000000F03F00000000000000C0000000000000F03F00000000000010400000000000000000000000000000F0BF00000000000014C0000000000000F03F00000000000000C00000000000001040000000000000184000000000000014C00000000000000000000000000000F03F0000000000001CC0000000000000F0BF0000000000000000000000000000F03F000000000000000000000000000014C0000000000000084000000000000010C00000000000000000000000000000004000000000000008C00000000000001840000000000000104000000000000008C0000000000000004000000000000008C0000000000000F0BF000000000000F03F00000000000000000000000000000040000000000000004000000000000010C0000000000000224000000000000000C00000000000000040000000000000004000000000000000C0000000000000F0BF000000000000F0BF000000000000084000000000000008C000000000000010C000000000000000C000000000000008C000000000000000C0000000000000084000000000000010C0000000000000F0BF000000000000F0BF000000000000104000000000000000000000000000000840000000000000F03F00000000000010C000000000000010C000000000000014C00000000000001040000000000000000000000000000000C00000000000000840000000000000F0BF0000000000001C400000000000001040"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
