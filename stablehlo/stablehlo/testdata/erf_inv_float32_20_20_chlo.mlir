// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.erf_inv %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x957C4D40253F96C036493C40BD44393F28D09C3E243F80C0ED5CA4C0AC9C1240E000BFBDF7C1F23F0C7037C03D74A040F4D3B53FB3FC9C3FAFE37B4038F88A40A75C3DBF0D2D29C0FDEE7F40975CAC3F761FF0BE453BAA3F7B90A640A209B93F813C134082F723408C548AC0146E81C0B36C1EC099355EC0E629A9C0E5D005C062DC2A3F662C4940635E59C0B209BA40ECF4F5BF38874ABFD0C59440D7A80BC0FFF84A40464F2C40CCB0DC3F7FCE8DBF353BF8BD19B9EBBF1B588BC0F8AA55C08F2398402B311D40736624BFC00B0B403068ABBFF08DFD3FB6902340930B03C078E01F40CA0CF23FDD4499BED9F58E40444F4740A32E9FBFD7B24EC0193B5EC0BDFE8FC0A255934076B479403EF5FB3F0F92A5BFD0FAC13F019E5DC02FDD77BF15D88240DB0A263F70B3F8BB8CFC19BF5A7FAE3EA8259C403DCB0BC0C3BDF6BE4D0485C09A89F6BC42757340E5FF194004E64ABF5AEF553EF66C344009C5E5BD458A1C404A342C3FF17D5D4033EC26C0F9415CC035C1B6C002222FC043BF3CBE95B775C09424F63F6622724087FBFE3FA3951AC199E29140ABB353C01FA830C08A7DAD3F911A7EC0286051BF0DD35DC077D3223F089700BF7EC3174079FA44BF2F2B8FC0D8EAC63C3C099CBF5D9775C0E530CD3C591CB83F8D2142BEBEB63EC054AE42C063BB5AC0B52E8540842468BFA05E6DC00453D53EC6EA5A3F41322DC083E0094029C000C0003D2EC025D384405E19D6BF1FCD54C0998408C003DA923EE37257BE807D96BFA8D584C06E0CA640DCE0B13F1E71004037F4D23F0BC143BFF7D865400FE9CC3FFC9244BF1FD40840C63C5040C9FF163F26DD3940665E6CC0772399C0857A5D40DF46E3BF9916C2BF884533C048ABFFC09B33B53E718358BEF202CEC0ADA8C9BF303A1DC0B0089B3F1FEE4AC02955C6BFC6E26ABFFCC39CC00CBD8140B45C39C0774C41BF979D00402A9D12C01F98E8C02F2B97407FAEEABF26A710C05A48C63F8FA74CC05D114FC008518AC0F132AFC03833384073ADB03F0AAEA6BFCDDBACBFE435693F2AC8A3C0CADFE4C0991B8DC077CB1E40E2973A40BED94D403735F9BF18CC2FC04DE98AC0C97ABD3FAA6E5040202C2C40C5C8AA40226387BE51E881BF93DEE9BFAE9D1740927D05C0FAB4CF40C188774055724CC0C986DD3E0759A83E572C4B40A6B7ABBE0A39E0BF76043B3F6C9C2DBFC08A9040942817BE4F1D09C03DC3D6BF71A0F73F475E46C0706E4A404FB9CE3FCA878DC046FF95C0EE02443EBE4FB2C0B169CFC0CE12C0BD76AE41405F1CF53FB07FAEC0ED73BFBEF5463ABF8D8C61C099E473C0F0D1AC3FD10FF83D1A478540BBF7ECBF7C9DB6BFEB071BC084150FBFDE6A6640424FBFC0E1D7FC3E87048CBE3B8D933E37DAFF3E001A85403D8DB13D35130340AFCDFD3FD2BB43C0B99E0D41DBB1C4C06523A2C036840F40F9042F4050A84EC03BAE1CC0506DFF3E5D34DEC0CE832CC0A8C8DA3EDBC947C06BB71DC0C523B83F886BA33FC83BA1C08F8825C0899FCEBE62B0C63CB370AEBFF6D83FC05B2E4CC001FC87BEE62BA63F8DC50440DD14C63E735B01C0C9B5B4C0E7A28E3F5F02E3BFC5D4543F3B48DABF4CE02040FAFB3EBE21F296BFEC738440D89C2ABE5FFF6C3D26B1ADBF88B716406A377FC00B5BF03F5B9D5C40BA9E863F7527C83E29B5B2C00FE31FBE0A3470BF75801C3F84C827C00D080FC0F5A2AEBF49932CBFCE7174BFBC12E6C0E22ACE3EEEC6BD3F1DEDACBF7B1651BFE4815EC088AB073F499DB0C020E8AABFF08AAE3FDF088BC021C204C0C8B7D23FA654AB40259B09C09651D73E809A9DBF50C15A4025C829C0A7FDC03F50A0DDC0E379DAC072BE283FDA79BDBFDC3113400065C5C04C8A9B3E56B12FC05566853F39C2243FEA521DC08CE325C0FA287240757935406AA94B3EB2F597BD4019E4C01CBCD1C0BF8874BF8D129040B8BF83BF47D4C2C017BDABBF309F17404FAF4C3F3065D9BF8F15CDBF8FC5823F052C6ABE39C5DAC0459B8EC0F6F9103E4B1CE43F690007C0AAFFF9405F9385BFD0BF3EC0F223C2C04F4E663F93FFC73FEB49A63EDA258AC0F2335AC086D094C01BC26BBF9999A7BFCDB89B4014AD46BECCA1543EFC889B3F2DDE62C0BD5038BF074EAA3F054450C0522413C128C42C3F2A23383FCDFD5D40F3FE8A4055D116BFE4E30E3E78E169C092043E409B6FC8BF873CCF3E396E57BF6FEB1C3FE48832BE30F25040F2D21FC060BD02C0FDCC65BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFFFFFF7FFFFFFF7FFFFFFF7F7B12453FAD928E3EFFFFFF7FFFFFFF7FFFFFFF7FE0A8A9BDFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FA5C44BBFFFFFFF7FFFFFFF7FFFFFFF7FF9CDE2BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FA3652F3FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F277B63BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F9ED7DCBDFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F7B7426BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F5E2F8BBEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F8456C2BFFFFFFF7F5AB0283FA568DCBB9FD618BF5BAC9F3EFFFFFF7FFFFFFF7F8BFCE9BEFFFFFF7F3E8ADABCFFFFFF7FFFFFFF7FA83464BFA5D03F3EFFFFFF7FC34DCCBDFFFFFF7F824F313FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F01CA28BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FC68571BFFFFFFF7F5656243F7A81F5BEFFFFFF7FCF0759BFFFFFFF7F2A50B03CFFFFFF7FFFFFFF7F2BE0B53CFFFFFF7F1FB22DBEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F60F297BFFFFFFF7FB493C63E54F5833FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FC214853E723441BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F05D256BFFFFFFF7FFFFFFF7F154C58BFFFFFFF7FFFFFFF7F0117153FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F853FA63ECA2E42BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F4D2B9DBFFFFFFF7FFFFFFF7FFFFFFF7F647B52BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F4CEB993FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FA98974BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FD014CF3E29B0993EFFFFFF7F56F69CBEFFFFFF7F4BE6473FFE5533BFFFFFFF7FF7BB06BEFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F50692F3EFFFFFF7FFFFFFF7F529DAABDFFFFFF7FFFFFFF7FFFFFFF7FE568B0BE6AB246BFFFFFFF7FFFFFFF7FFFFFFF7FB5B0DC3DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FDF730BBFFFFFFF7FFFFFFF7FCEB0F03E973E7DBEBFBE853EF606F43EFFFFFF7F7AA99D3DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FE38DF33EFFFFFF7FFFFFFF7F9F39CC3EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FAFB5BFBE541CB03CFFFFFF7FFFFFFF7FFFFFFF7F98A875BEFFFFFF7FFFFFFF7F020EB73EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F1832793FFFFFFF7FFFFFFF7FB5D32ABEFFFFFF7FFFFFFF7F485118BED137523DFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F2325B93EFFFFFF7FE29C0EBEC71BA9BFCD0B1C3FFFFFFF7FFFFFFF7FFFFFFF7FB8D731BFD852B5BFFFFFFF7FCA3EBF3EFFFFFF7FFFFFFF7F20E770BFFFFFFF7F6FC5023FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7F76A2C83EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FB36B2C3FFFFFFF7FFFFFFF7FFFFFFF7FD15A8D3EFFFFFF7FFFFFFF7FC4F0263FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FC766363E92DD86BDFFFFFF7FFFFFFF7FB69EB5BFFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FF5C0673FFFFFFF7FFFFFFF7FFFFFFF7F9D7452BEFFFFFF7FFFFFFF7FEC29013EFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FFFFFFF7FCEB6943FFFFFFF7F93B1973EFFFFFF7FFFFFFF7FFFFFFF7FEDF19EBFFFFFFF7FFFFFFF7F1BD831BE8C9E3E3EFFFFFF7FFFFFFF7F258D43BFFFFFFF7FFFFFFF7FFFFFFF7FF31D323FD144433FFFFFFF7FFFFFFF7F3FDD14BF4492FE3DFFFFFF7FFFFFFF7FFFFFFF7FD455C03EFE467FBF72951C3FC1801FBEFFFFFF7FFFFFFF7FFFFFFF7F81DB93BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
