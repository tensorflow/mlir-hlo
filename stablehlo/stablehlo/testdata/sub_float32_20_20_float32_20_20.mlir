// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x75CE74C0BDFF7E408801ACC0BA0395C029C4D33F73C91041FCBE73BF9CACB93E663FB13F6612CEC028B4293EC3CBCBBE76D0CC3EA75AC5BF7129424056B247403D08D9BEF7AE55407399DA3FF91009BD4DAF8DBFF22A1CC01145DC3F26F5C5BFB1F6A6C03942573FF38558C0D7DDA0C05273F13ED2DC88C01FFB3D4031B25F40DC40D63FE7B19DBF6C031540C91C7DBE04E6DDBF6560553E6A530FC0A55B26400748CABE19F6163FEC4004C052A619C01280973FB876E2C0A900933FF2F45ABF8EE7CDC001B9943E4C79C7BEC1574D40B7DC093ECB3B94C0C70785BF04280A40C03642BE030FA0BF065353408FC901C1E2D7A63EEDD50140D99E2EBFD6818740A6E51C3EE96C16409A02BDBEB1C0F83F3C37583FB40596BF2C5EEDBF3482A3408CA5D1BECE1A10C09BD79640FA0DE33F842B11C01B840EBF0479C640118768BE79C6C4C02FC2A9BFA2A08BBEA1756E3F55C6EABF206401BF8E0F00C0D93325C08E7F3E40E9A1B9C0458D80C0603F30C074C9B3C07D2256BF540007C06B548740ED193CC07AF7273E3A52D2BF27F89DC0106E803F758190C01E08AB3EB8F6504005527C3F16D161BDFF26B240B3218A408CD47240F34F27BF50EC22406EEA563F57D6104010B325BFF7EB8BC0C02A794009ED1CC0D0693F3FF69740BF9BBE50C0D47497C00AE007417C9F5ABFE03912402A8EBAC0CE13A5BF0F0B3C3F5CB30041D013D9BFFF2A0D40C0E3A540678E5740CE0F423F43F87040996C91C06D84833FBB7560BF4B7795C0769B81C0E8743440EE58B23ECED60A40B729B9BD0A64E33EC37253C039A89240146F14BF0B509B3FB97B45C0C447BBBF91A4EE3E49ECB64045E3AC405A00B1C067BE65BFF09213C0629913C0DA0E0D40A2C0EB40A87B87C057B865C0B04FFD3F745E4CBFCC308C3FFE6CBB40DDD90540B62C493EC93549409A99ABBF469015400B561AC18DB906BF7DCC693DE39F213E67896E3F428E3E40EC7212C02C038FBFD44966BD809CFC3FB21FF9BF82D2113E39FA914027A2EFBE64995CBEB6B78EBE690745C0466AFC3E817314C0D36DA73EC895BEBF30278E3D6CA6043E28293140F36E0FC040E30E3FE6670CC1E050A5BFF34CD0C0B342CABF87798E3F0F6F8DBFAB85F03FC63E30404F5924C0221EA640E972A8BF55FF7B3FFB9214BFC5C520C061076FC0CABF35C0D2BC8FBE1DC136BF5CD1DCBF726966C0C88070C05D94A23F12E419C0771E0D407D1C82407AA7C1BE5C5DCE3E3E910B40C9CD6740BF21053F8DFC0A3FA3BE15C02C7648404CF553C0B21599BF1378B73FC8C6DFBF51F900405C9A273F17BA36409EAD633C57651EBD0F792CC0A8713F4032A0074052B48DBF84EC2640995D694078DEE03F992853C0191A9ABF58A9B9C0B27263C015D8ADBFB29E5F405607D24022102040C8B5063E7C0C0540DEF187BF4ADB67BFE76910404B8A613F415635BD9F8F7040862B95C0E3C98140031827BF2BA07BC0A331384085A497C012A030C0D5A3234036C05B3FB3339140792D49C0437CAA401FCBD5BF33D194BF8CC311BE14F06FC00DF68CBF3AA9A23FD9FCE73E0D752140425DEBBF3C4AF9BF4CB78BBFD00207BE88C244C0E3006BC0FFBCC6C0FAF8BF3E97D713C07BE44ABE6E1CD6BE1CD018400650403F35B691C0A1D0BC3D459DBAC0C645D7BE850C69C0AE86B13F25C7BB3E9BBFB1C00C169F400A5491BF6B89A6BE564241408A4D43C0272F33C053A6E83FEE3DDEBF679F833E8ABCC83FFB2FA5C074479B3FAA5E32404C36C1BFE17B2FBFBA1BA44098C7E4BF85188DBF637B35403D7A3BBEEAB2D0BEE3D6083FF23A39C0A213F53E76EB3D40A118AC3E1E6716411D7F8040DAD24DC06042F13E0BFA6A40C7E24ABF9D36B93E5589B840C5C5FBC0BF72F93DD73F2CBE18063FC0D7550FC06B3AA13E60F0B93F2379E4BA3E372B3FC07D82BF2233C63FE2718BBF719C393E7B96603D5DEAE23FD09892C0F569AD40D486CDBF5272E23F62330C4062A416C0FE159940EE3087BF81B046BF0E25F0C0B85771401A9B82BE8376BA3FED49AABF00662A40AD6E2F4033BF8FC06008A93F23B4C140E7F754400BA9DFC0AD4194C05653DEC0C1C4D1BF9D3B2EBEE94DCABF5625D53F9BAA86C0FCE1AFBF9EF26A408E67BD40665B10C0E83EB63E298B6640492DAC406A1C714012F54C40B1D22EBF5EE1CA3F7173D13FF1B7143F179980C02FF221BFCA3B2340C0214140871A413F51C08C3FCF8B9ABFDBF4AB3F"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<"0x7F16F1402231EEBFCC4787C07E92A1BEC0F69540397DC040EE42C43FD704793F395BDCBFEF1897C08B88BC3E94B60CBE656082BF5F61DCBEF5BE00C0E06FD3BE0570D040ED06B4BFFFC00D4054C1523F587E02C046DA104025A0FDBEF7E732BF51A530406E7E09C1143ED3BF204D8240715B73C03D20AD40121A08BF3EE794BF041B58BF9EE1C13F999753C061DC6EBF47499740D2F4F040E8C9C83E0250AE409B4E28C09810C53F28873140AAE824C0DE78BFBFBF52833F89B846C08DA49740437522C04B208C40093E87406FDFA1407E0A1F415F0028BFFFF6613EADA745BFC33CC2BF7E397B40E43867405514D2BD47DE463FD1697ABFDF73973EA895E93FD0F4FE3F3B9D3F3F4DDE04C03BF1643F24E88E3D3D2310C0FBCF2EBF5FC4983F6C3446C01226D23F6CA54940DCFFC5BE653AAFC0B0B9B43F096A5340F095203F9D6282BFFB0702BFE51903C07BD93AC0F898AFBEA78F7CBF77F70940DBE69BC033053FC0481403C0C4B206C02BE9A0C0C44E93BF9B1F6CC0BB91B740F1C0CDBE977690BE569FECBFA6C58940D04AF2BF098944C0EB85AB40809207C0312D16C14F931F40C8D7EB3FD16D21BD82179CC0468A0FC041EA933EF69E194080D3D83FD922EB3EAB1C343FC772EF3FFF5CAF40FB0EAB404EDA4640392183C067FA00C00DAE0B3F2E91D8C0E41F60C02133A2BFC29D96C0D69852BFEC5F6240665F35C081B6C3BE378B01BF839B8340C017FA3F6FBE8C4008108340DDF3AA40452184BF64ACCEBF46C991BFB20F714041CC8B407F51FC3F136F1CC07CFF9FBF7462C4BE0E719940545968C040664B3F6620B7C0FAEA9C4037CC284048B8E2BEC3220140906C433FCFBF7F3F91CF23C0CFDB47BDF9E610409B740041B7F889BFAB45AF3F028950C02C3009C0B250D4C01FF086C0F90692C0010297406176C54026E3044029C22040758A9B40AE26A53FD9D626C0E7388DC0ACD44EC07EB902C1251ACC3F9E90A9BE75946EBF2B03C6403B45973F759EB3BE5DA16840E5C03D40632A543FBAD73D40CD565340F02782C014B969C0ECD7E53F2E71F3BE5FDD1640F00506409CC86F3FC74918BF38D461C09005443FEC2A2C40FFFD2C409B5E863FDE9887C0F302D8BFD8A42E40249AFC3F439BA44052484940878E133FADAEE23FDCD2A03DA564D7C03A96FFC0F6D4BA3FD7C8DC3D70B78D40D0D2B1BF4CCF82C01F53523F984A9ABD354B2F40F67737C0650E3B401681DF3F47C257BF403B82BFEBD56A3FEC7AAB403433923F71EAD13F430A64C0558B2DC0D775D03E363D0540C3A9613F05C6803FF9217C403455443FFA042D3FED026540E6A85040EAB153C0F23097BF714F82C0136C3AC0018404406A073740FEAF49C071C3D33FE4CE9E40272D213F0295313F34A090407C25273EA5B878C0646F8DC057C0D64096786B3F5E345640CBBF52C098F58F3FB6B331C0153BF93E9D4D263F41B118413C5DF53F3D91A44029D04B400491B0BEE9590040D906E1BFB12544C0019E9A3F62CFA1BF6DF51EC03A986CBF2B8F333F3A86EEBF46E1CDBF58D0B8BF04065CC025758A3F370C87BEC418483FBCB301C0B76DA0404838003EAC2EB9BFEA55A03CD9FAA4BF356B4340B7F68BC0B262463E5A74393F16AFE53EEE003EBE3A8F7640FCECBBC0DEF0C5BF004AEA3F054942C0AE4A883F552381C06A64633F49973DC0C1310CBF254E9440212F0F3F598174C09B80B7C08859F1BD35C11DC0317830C0765592C0D46DFF3FBF3BAC400254F0BF391F7BBF73E616400045683F5B8379C070AC074052CDDFBF4802C540889B4BBF200B9040197365C03C3F5CBF7EEED140BDB32A40DD684BC0F53C6F4038424CC04D5A03C0EA8DFE3F470A293EE59DDD3EBAB0063FC05349C0318BA03F0B2145C0F4E34BBFFEAB21403F5F673F0B6C94C0654EDA3F22CB9AC0CF8D093FABFBC53E0C014FC0F74B2F40D018B03FD935FABE455C0DC0F0F2FDBE1AD42ABE5F06FA3FC95527C002666DBF102A2C404474B73F96488840128A3B401B9F13C030D8943F68280840E52D48C02E57B1BF81141D3F0B2801BD8220E24062932EC0BD7281BE106FCFBFD08DF5BEF486DB408C7ED5BEECBE71409471A0BFEF489D3E00FD7E4054C51AC0DC49ABBF2D86903F7ECB6F40F3A86640420B494036E18540CF22ACBFAE227E408E1F0140FDEFE4BF2B7941C0C8FCD3BF94B026C0244B41401FA394C0FAFA93BE7FBCA33F720D3E4013D80ABFD9964FBF0369D73F"> : tensor<20x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDDBE35C1270CBB40F0E692BF92EA8AC06C0B42C05A2B424036111FC0892E1CBF50CD4640DCE5DBBFEE5C4FBE797085BE8294B53F4F428EBF3374A140522062408900DEC037D9974016D101BF64525BBFC69A6E3F9C8296C08DD60D40550259BF5A49FFC092F21641D2CDDDBF7C9511C1EEC4884088FE1AC1A4016040E81295402F272140C2C92FC0824DB4402F952F3FC8C2CEC0CF49EAC0A76C28C05F4436C09A050F40172B73BF0AE49AC08025343E787C2B40B4A501C16F1C88402B03B3C0D95979C0BBD482C09EB593C03ACEECBF0BE31CC17E777EC0A746A1BFEF913B40EBF5A93F80A0A5C0F02E9FBE662500C1ACE4E6BE61704040C8587ABFD8381A401B58EBBF340BCD3FF47BDA3F1448863F385A463FC6408A3F2EF695BF38A27A40BAFF2B40D72D79C09413C83FF8460A4046494D40BEFBFBBFFF873940B4B75ABFD22DA4C0637C51BFA24BE33FE376764017E0BEBF0E57F63E820385C0DD99124060C2BE408A2F70C08CCFF4BFF6921140C3F58EC0FC963640E511FBC07A3094401A0B2AC023CF0040345ABEC0E6CA42C008608240B0031EC184F31C40DF6A4A419CFDC0BF51E6F2BFDB69B3409A1C1341692FC140144571BFA0D5143E92BC5ABFF8E3E63FDEE7ACBFA9C8C7C07C1ECBBF8085F9C0DAFF16C0741C564068889FBF96EAA8C0A12874410578294070536340A0C18FBF8C1DEFBE285D33C0360B2E413026A8BFCD8D2D40F420893F0E05B53FEAF868C0683EA9BE3B301EC1D9D203400DE33C3FF30962C04F23FAC03447C6BF44BBCFBFF0A29340E16C943F3FE3533F389501C1726A0341AAEAAFBF69F4DD40D6A8FFC00C3883C06CAE683FCFB56C40B375944054F8D0C0EEBFD43F817310C02E4092C0C961BAC0681F0741134DB3C0A87AA9BE02EC8340E4C4BA4052FCA940FCB92641252A28C0FB2CBFC046A5883FF68E76C0A48421C0E1FA2EC176280540800C8F40AAEE584014A211415F02B13FB081FABF8CC73DBEBFCFC7C08AAE4A3F1538CCBF35845FC01A67CC3FBBFDA5BF50A14BC0C42D65C0DC217D3F2EA38440BCAF83C0806F4D3F432876C0B69401C0019F4EBF9A3B57408ACAA43F408954BEA17237C16FA67FC09AE4F1C062102A403D3E3340605C75C09047C1BDC0F718C0D0D0B6C051AC9340CB9045C0FAE4673F46D2C4405833AF40EE38A6C011A63CC03DB396C083E42C3FEA3517401D7F8DC073AE6BC00D02BCBF209FEC3EB8BF37BF6F78144014DDED3E97D2B53F86B7A13F1E50DEBFA9441FBF2A6C8CBF40979C3FC000BB4007046EC00FC851C063460D3F664630C05051F6BFC0D6E5BDD8780B403F1F64C07B2253C06CE31C3F108585408A1FC640D423E73F0CA2093FBC58493F9D0F9D4029859EC06A55C5C0FDCECDC0F9EB87C03916BCC05A2C5540D43127417577DD40A98AD2C0AD5C943FA6168DC0F8C8184036DE903F49166A40EFF207BF38FC4640044763C128E508403D74B9C02AB8E3C0C4434E407AD1D7C04B3980BFC3E4B34098F7B2BE8CA7B94030E028BF4A0FC8405AC917C00E6A333FD4A8BB3FE88713C0FE8A1540A8A0413E8884373FB8DDDE3FB051403E46C0DEC055BE9BBF524EA83F340346C0768318C04D3914C147F69740C23D20C0792D6CBFC2E55DBF2BB02440387B46C01CDBA83FE8BDD13FC52FF5C04C602740EE9896C00085AD40D88005BFEDE725C0449CB04028A3B8C0D67362BFD8E1DA40ACB32B405BA42BC02F0A894074B2823F6C8F9A4028C5DABEDDB528C1BBCD454078267140998177C070E0CBBFB46E10413C107AC09A69253F2D8954C0F9BC1C3F4F169DC069D48340232B02C0449DC2C0C8BD993EF1EB6040C22FB54039A0E6401AF194BF523DC2BF67696040DDD89CBFAE5528BE9A990E4149F411C1A1EC4C40FED3203F0B59B0C0A72D49C0B27F9E40147881BEDABC9A40BCA5063EABFCB3BF4E0D9940E80475C042E598BF54240B3F74D17E40A1B982C096C0B2409AC663C079478C40E28C47403967A1C0DA715640D214AAC032366DC08055A6C0A0EB2640CB7B18C093B4924020A8613DE02003404D733140DAEF38C1C98B81404FCBC940B8579E402E50D0C050E437C16DFBD0C0A650ADC020AA8A3F25A0F1BF556A14C0C41FE5BF000413BD88AF22409E030B402C82BBC0654332C00CDD14BFFD35D740406450BE08AB973FA4868D3FED7493401CB8524090DE4B40A93EE1C0D964804029BB35400187DE3FD0C60DC05A2CD23F8A01CBBEA0D0ADBE"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
