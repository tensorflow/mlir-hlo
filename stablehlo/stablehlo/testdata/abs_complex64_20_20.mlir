// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.abs %0 : (tensor<20x20xcomplex<f32>>) -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x87B00E40ABE30A40F510F2BEEF5E24BF676CB540FAF69FBF01042540E2822C40E4A140403CB98EC09F30F4BFC3764C3FFFCF0B4020A903BDE41106C079B47F40F9F9BB3EC05A903F9826DEC066E1963E8E4C42C09E323BC0D4FA21BFA7AA3EC0E2C8983FA640043EE9BBD4C0343B933FBF28BEBFA3E77DC00A63813FA5ACE5BFBF06ECBF2A6988BF78013A40774918408B527A403719FABFFC01B93F6DAC8C3E8AAE6BBF172C59C04D4D66C08FF2BDBFA7F2CCBFB1949F3F7BBB15C0B4F07EC0614BD840208B7140FCFBE03F450A0C3FAFF20B40A93B29BFA5DD12C0206431BF6540FA3F32E2A9BFFB1F3740FFDEA34033E074BE43B913409F63D5C0B1471CBF3E637A406027E53CDC41AABFBD51F63D8D125B3EBEDB2DC0F069D73F60039E3F9C0DB4BF95441BBE7A78804091864CBF837678BFD614C2BF1A57AB3F86E0913F573172C0B7BCE0BD5EFC7740B05920C0627112C059ABBEBFBBE78BBFC11E8840EA665EC0376A03C05E600640688C964010C96FC0279BBEBE318E883FD8D9EA3F311C674046F68640FB06F23F366398C072590CC0DA7D7D3FF6D51BBE1D9C91BEAE7951407403B4400B648EBFB687883D8459DEBF64D3184020E5183F3F27EC3F9F30104030BF953FC4C464BF4DD9DEBE37503D40C59A1ABEF0E2BDBFDA75ACC051ECC5BFEE386440707B543EBFA2BD3F3CD728BF20E0A8BFD309D23F4619723FA9F2DD4087A4034072326EC0A8534840C4F9E9C08C7CDA40BB63A340EFCDB640BB089D3F0E8D893E5903D1BD4EA683401AD8A7C0E41D58C050FC4A4073CC86C0170943C0109B8FBF8A0E0F408F0765C0AFDB6140A25022C08258A3BF1536F8BF8B3F33406F52B040E43CA53E730C8740ADB6843F71979140DFAFD2BF7350A1404D393940E08F47C000253F403AE6BD3F0F7176406EE617C0851DA73FF2496E3FDC576AC02C0E83BFF47146C0B9CD1A408C6BC73FB9CB40C0CB268BBF0017EE3F5DEAAB3FA53CC53F6739E8BF6E5D7DC010679BC08C2113406B439AC036FD01C0111E8A3F6E31DA3CB551813EFC35654083A7C53F298293BDA048933E67E0E03DEF3F68C07939AFC0B8BBB8BDBEACA43F03A64EC0AA53C640681378BFFF3B56C069BD793FCE314840A0AD5EBF95FAA73F527450408068863FD91626406AF196BFF9FC0740C9F0ACC00BD1A0C09DB9793F1E11C34022F9C1C0EA594F40E1334A40717187BFBDB961C0D101AD3FF6489A3F357E0240631D2A3FC46F3340F319AABBB90804BF78B6B2C0D7706E3F5C0D05402BC8D63E87A7433FA1CAEB3FE1FA7ABF78F60241B38103C0AB83C34092746240A165493DA387C43F9A145E4045C85CC0ED658EC0DEED93C098A68FBE6E7F47C0CD1A4FBFD2178DC03B1AABBFE1EA36C0AC7726C03A77B240A553DCC0F9057EBE90BCE53EAD351C4003474DC0C88190BFFDE60140C0A31E4009FC7240AE21E63EF15E31BFEA06AA3F47A38740E10AB6C0837B7CC0EE785AC06291034158E36BC0345F6A402D800CBFB5A4423FDB6872C004C1CB3FD46432C0F3A0BA4016B114C053389B3E6CF9D63EDB1731C0192168C0B54F1A4004FD9B40940FDC3FFDD216BFF1F63AC010CD6DC0562666C09C34473F6D7E4CBF628AA7C01A39EB3F6B21B5BF93DA74409D72A0BF5A25C0BFB2BF2FC0AF6212C074B9AC403519983F0B3B7F401F52204095C7C93FDA2650BE6F3DEA40C984C03FA5172EC0FEC356C0C4B48FC06CD978C08E48944003CF2FC0BFF887C0B3FA5CBFCF1EB03F84A302C04A29143F07D4ED3F80AA7D402DBF4D40CB835840ED621AC0231FBBBF33D010C0AA1651BF21D25BBFCE4CD6BF674D8DC052D04040B91635404E2B62BFCD96ED3F340CBB3F6B83884077D374C09DB6BFBF0237F9BF1BF36E40AAEA1D40843830C0DE0A81BF611F3DC0DB6B42BF5FD275C0ECD1FA3E1C226DBF4902BBBFA5511CBFC9092840A3870A3F9F9C81BFA900EA3FCADAE8C0CCAACDBF686AD8BE8D3887BF3C5E85C019CDBC4047B98340BADD9840D47490404A03B4BF30D110C0001233C00202E4C0E2F3C4C0013CAD3F7A33C6BFEB05A8C00AD492404AD7FFBE0FE2D53FCCCAB44023F6D53FD9AE0D40279A6F40A2354DC09E4F82C0BC8833C0751ADFBFACB486BFBA7F1640C4EFCDC0484C88BF5FB12E3F7F0CA83F8820074054D1C7BEEF67B0BF7604373C1A4F22C09D2E5AC02797FA3FA3548ABFB28CCDBF7D4E833E000BDA3F868ADB40704E22C043C73340FE4B7BBFB868F53F9BE0AB4087C9C23ED4407A3F3175AB409C4ECABF701FC33F338BA2402FEFB4BF9C280A4021DD96BFDACDBA407A30B33F0417D6C03BD61D3EAC2F0EC0400BC93FDBC9A740342214C09677483FA4631EC0282A06C0711A99C0C9E60340066CA93F7A945E3F15E72340F1D1AEBFB1B0C3BC32657DBFF8E36DBFDC6D693F0A7506C077FF4CC02DB2BF3E0C20493F6AD9AD3F5E7DEB3FF91438BF615E36C0683E7B4029659A3F32E3833F48C6853E73A63440BD7B93BF5CE1AB3EBFEC7F4017DDDE406D39354077DFB83F446ED93F4FD52A40DCB9773FC850A740C37413BFABFD41C0A6C259409F8CB1BDDE5CC8BF577662407AE7DEBEFB1CB7BFB0A804C07C174840D1E88C3E7555C03F0A7719C0169972C0C5830040FF0F55BFC18AA93FCF001DC0BBAA67400A6F1940E3BC903EF2116C4011AB0240C0C7E1BE4118C1BF76AF443FCD41104085F66CBFA99254C092567FBFF4BD81BFB5A0673F4F75FB3F3D100C403801ACC0800D4C40A7F14AC05E54C03C3A83513F2C452FBF884C4FC0225D49C00D230FBF4872E4BEABA3FBC0A0C24CC05F303ABFB86C8ABEBEB49ABE6E4CF43ED2FF3ABF95C2AA3E27B127C0CB1DB740E0815FBE6A7F16BE1F55C3C0062B1FC01BEF853F8B61D93F7C35ECBF63F6EFBF1DA1373FDF4FC5BF87482A3F20B34340BECD15408011CEBF1E66173F1015CFBF5FA3FD3F5E66754042EAAFBF518E6F3F92FDFA3D964457C028FAC5C0CC80F3BF9C8207BFF5F8DCC0225E6B4093D295BD1057B1BFFBF71940B90270C002535D3D2920C440CDCBACC0DE97D3400BF94C40FAA1BE3F63469A4099AD24407F9C8AC0F6077EC053084640160021C0FBF798C05360D7C0C944D4BF240A2FBF3D2A5AC0A8EAC7BF0E00BABFD7BB8B3F5D1A124000C33C40107C23C0351F0840889DA7BF623732409A9A9FBF029F8740CC7C1CC0F4A76040AC3D8C3FE75303C0BD9DA0C0FA895FC0CC78423ECDFD91BFC9EF8740B7753B3F4323CDBD4A0CA840C596224044EF24C0425D41C04438A83FAA4ABEBF323B5E4062AC18C05ED81040F5F1CC3E27FCBA3FCD2882BF899B983E4E12E83FF29EAB3D4CD3B6BDFD78AB3EEE38C0BFA48770BF6CD279C0675B31C0B224703F2A3B0041C683184027E6D5BF87A7344031FA29BF4D5FB3BF19C11ABFACF114C0D56F383F4F4624C01CFB0E4022E57F40D32D17C082B9333F7C6112BE92432CC062875C40386B2840BB51813F18F8DE3EC468AC40499DF33F87B35E405A61ABBE298D6E4040AF3CC077644D3F44397140EBC480403D6F12BF6525A43F3FA0EABF44C432BF979008BFA5F2083F8943C5C00C482FC0D65C4B400A061CBFE2B66E40B75359C047048F3FBC16433FA435D9BFF30C9940604B40C04D289ABF4D57ACBF6D505A3E5D8A2DC04E5D3140914F4B3FEC4B2740103CFEBF59A990C0FFC0E13FD9E004C0798F8FC01F4B97C05AB793BFD1D756C0B0B807C0E6789DBF8FC10FBF3A321FBF911EA9404BD21940807CA04081FF61BD8F814740B93839406D5715C07D2350C0C81560C081F7D3BF4A13FA3E776F64BF60171A40024FE1BF3D8319405AAC7EC044BE87C0BF93DCBEF85692406160FF3E99BE1FBF6FD8A840B10712407C5CDEBF5554E53F504D75C05087074086DF84C0E8F4594039E43CC0EA8433402ED474C0315E933D64EA27C09036D93E1AAAAABEA09F1F3E29DF464023F4103EAACF8C3E5A4463407DD9E63F19E4CD3FC75DF0404A48FB3FAD636240B0C63B406643F7400B0E733FB3D4633F0F48C3BFFC30DCBDEFAB57C05EB51CBF48690DBE0416B040075075C0B3C9634025F4B1BFD0444DBFD1FAD13E85EE9D40ABF73D3F53FE7C40B35DA3C061C08AC0F7272D401AF15B408E1C113F5F9CCEBE674F66406DCB00403F9204C026BFA9BFEC8B2FBE2EDB9FC04574BDBF91AA893F356441BFE5B343C09C17C4C0262D0F3FCDC9203F7BB6E3BFF6989440394B65BFE3314C40234427C070C743BFA545623FCDDBB63FEBF9F8BF88977A3F0AB951C0AF74A4BF3BC38840EBCBDEBF3558EF3FC6D2563DE439B6C0CB4EDBBF83A32940DD27C8BF3B8F15BE80A4BE40ACF724C010BAA64086C4CFBE043FA9C0B9045D40C326B2C0EFE480C0CC08E63D2AD7043FF37073C0D76E09C0E88EA3C0E07F6BBF0660C7BFCE66DB3F5B35FE3EB56586C05B712D40C41443C05DDD8AC04CB69ABE0B65C83F984E0CC0E30E9B405F2C4840B402563E2A26A43F376305405D462DC0"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDE1F4740DB1F4C3F60C7B940F5B96E40BB2EAC40FC5C0440DFD30B40475C9040B0CF973FCE59DE4021E7864061EB42402EAD993F15E5D740C58F874056CE03401C4E0840F5647040D2E88B401952BC3FEA056140CF1D7940E7DF01405ED4934055BAF740DFA0EB3F11341240586A1940C63B174061B7BB40AE8314400E48D640E1647A40ADF3AA3F8E652E40B89305409F18B53F5EFD8240C86FE63F2A07E13F674B7240F0A793408DBD2E40BB8A8C40C729814060DCA44059F770403CD507404EACB140E2F5A34067FE19408B25A53E2A44D04071A58E3F50FC3C400738F83F877822400D767E3F4E8F3D40E7DFB2402BC17840987CBF3FFFCCBC3F5F6CF23F9780E740609E9B4030102041462EF54053C1A03FADB08340CD9EC74021BCA84037D54F40AF0487400B118B4097911440ECCAC54064718740FD52954013B2A94002238840A96D55404FBF90401B3DCD3F1355734000AF7B40C00D5940C1E209405ED20240185A8B4083EFAB406A65A740D6288A3FB9C7654086DEC53F0AA69D3EFC35D2403B14A53FBCA0DF40DF075F405BB451400387C93F09055B40B26E3640B0D3B94072D1A340068C094184CF90405FAA6B400DCFE73F953F0940D86F33402779B34096CB114076305F3F838D0540C106074136EFE1406DA1C43F89939C406554CD40E34D4840CA728F4069EF4940C5EBC4403E78DC40CFD31E40419F5940150A4D406EAE744027C4BF3F9004E340F9F0A640062E104146FD6C40D33E7740346F4D4057E4C840D993043F0EFC9140E306AE40A79FE83FC13F9740EE796B40B57AA940BB7014409FD480403F4B4840A797BB40EB288540956C3D408D54EA40A3EE46401565B3400092C14073E9A140D1E8CF3FCFC90740E2138C402F5795401086344068F5194083D7F03FB30EAB40F4B53D4001311740205CB74031361D405B358F4048A93B40C244434026D07740946DDD3FCD852C406AF5923F4017F04022AAD43FF5958940F835E640A452D2402F822A4016F5F44078A8C940532DAF4047B293409D88BC4029893140EBBB9D40C73C9E40DC4E02400D41DB4063E2A13FED1E1F40B757B73F814F22407A997B400FC3F73F0B80DC3F650FEA4079703E40C67FB640C144863F06C3B240AAB4A94088242540D292BE40FDB9DA402C870E409627AF40BB611C4027934F4025B4A64072B4CA3F10C1394016787D3FE5A4A63FAC287540D8CB5E3FD85A1240EE153C400B6B8340CB0F883F0F1F43409B6980407F94F0406AB30E4074B63540E753A84083D191407AABC83F802B6440AD2F214091DD4840461B354090448940BD3BC83F9BED8B402B7F1A4011E98640F52CC93F366818405DAC5C40E505B63F616C0A400EB7B94046E58F404B99513F19E15340C8844C40470BFC40FAFB51401C98CF3EDE5B5F3F860B2940E23FB7409D63C34094AE2C40A1812040C3760040E0E5D63F317476405A88DB3F04B82340EA578240069A713F2158E140FEC0FC3F3D5BFA404F96B13F69938E401D22C440B6970841100D62406CDFAE406501BC40B1387F40E5150441789AE53F66F96F40F7A3E83FDEB26E404ABC544044F04440735E8D4096E4884014E01440A1ADC3405D00943F06F189401D14A8409F9967408CDD524016BE714040735240ADE0C13FBAA2873FBA51E83FAC75B13E9BBEE23F2F309940431B0141CA463A40C19539409B59C33FFAEA1B409AC85940A79B94409B69373FEDEA8B408B673440B6F8AC4017D67D40E9826F40F18B4340F06EB0402EBCB33F3C13FB3F2067413F31DBD740D3114F408569A1405B1DAD3FFB65A240D22A4F40FB7CAE3F5A247840ECD82E4026029E408C592E409C90D040182F634018E81C40667F563F5AC9B940FC7EA040911D8840231680405EE277406935823F3FE13E406FAE94400571884023359340A705AA4086893740AA638740BB2795408A359040D1CB97408EFA2740931E0A3F2D1F47406A5E9E3EFBE57E40D8D0F54056758140833E0441FA91A63F0CC4C33F77335B403524B0408961A740FC6DCD3FDF799E40CBB480405256D64045F68B409C20323F32F083408B691D4045F39F409A30EA3F1C96494042E8C440E07CF13F205697408CFA8340469B953FB3741A4044E15A4011CF8E400C7F2340DF3BB64045FE4940E306C93FAAB8CF40533BA7404921CA40DEE3DB40BAEA073F24C78B40AC2FA640A83A1440495587406D84824071338B4039692C40F58DB8408B50A63F6FAB5A40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
