// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.bessel_i1e %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0AC0423EF53FD1BEEDC0E03C864089C0CDC02EBF2BC07D405140C8C089BD26C0933F26C0293FCF4053C0913FC14036BFD8BE58BFE7BF163FC03F77C0BD3E63C056C0DFBFFC3EAAC001C0F23F7BBF40C06140E6BF12C0FB4002BFE3C08A3EADC00E40AE40ACBF8FC0243FC9407A40334063C02BC033401FBF454027BF8FBE7E40674060BF5ABF04BF044014C0AE3F8A40C63C77C029BFE03E9D3E2B3EC8BF9C3F414060BF42C05A40A8BE29BF593E5EBF43C0CBBF33400B3FDA3FEA3FA83DEFBF0DBF3C405EC09A3F6840A0C0643FEFBE9640D6BEABC0EB3F17C0F240A7400AC079C03BC095BF0E4017C098C0A640673FB6BF03BE8A3F86C00BC0F63D6D409FC017C0823FFC3EA140DABF8DC093BFB23F1A4055BF574090C05D40813E763F32C08EC093C081C03340A1C0904040BEAEBFE2BFDDC060BFA840ACC08FBF083F683EBFC0D5BF71BFBABFDD3F0AC129402D40363E0AC0B53EC7BFD6BF7840813F943F494041C0413E80BF00C00E3F77BF30401940C83E20BD8B3F7B4024C01BC01E3FAB3EE9BFC53F2040C4405D3F21BE9FBFFFBF4FC07CC0AFBFBABF28C083C040C0F9BF0FC084C0D93E173FF9BE4EC03EC085BF94BF2F405CBFAC40674053C0114004C00B3F91C03FC07E40D1BE2040F53E4CC0BB403FC0554021C0A23FF4BF873FFFC02E4022404DC07440E93A6D408DBF1D3F9340173E9C3F094028BFA23FE9404040C23F6DC014BF5CC077C099BFB5BFEDC009C07840C240D6BF19C0AE402D4094C00BC00C40EF3FB7BEC6C0C3BEA8401CBC9BBE873FCD3F8B4063409D3FB63F5AC0F1C08DC0E03FD0BFC1C0C3BF1BC0C2BF894039C0ACBE464043C0DB3EA8BFEA3F0F407040BABFF03D22C01A401EC078C0DC3EBFC0E9BEA9BF064182C09A40BEBFEA3F9F40A0408C40703FAF3F78BF773D663E38C09640243FD6C06EC0F1BE0ABCAB404EBF25C036400EC08F3F2B40D64068BF7DC0A4C0A63F54BF6F4001C0BCBEFABFE3BEAF3F263DE2BF12C088C057408440E03FDDBE7F4037400DC04040383FA0BF8A3F27405E404FBE02C00840CB40DCBD9FC0903F6640B5C0523F3540313FF4BFE3BF013F9C3FE04016BFEC3F9A407AC09C40AF3FA43E403D55C022C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x5ABEA13D5E3E0EBE0EBE5A3C343E32BE17BE3BBE50BE383E443E19BE00BD52BE5B3E52BE383E173E44BE5A3E1B3E3EBE11BE4BBE5FBE2E3E603E39BE053E3FBE43BE5FBE1F3E24BE5CBE5E3E54BE4ABE403E5FBE58BE0B3E22BE11BED53D23BE593E223E5FBE30BE363E193E393E4E3E3FBE50BE4E3E33BE483E37BEDABD383E3E3E4DBE4BBE23BE5B3E57BE5F3E323E413C39BE38BE143EEA3D913D60BE5D3E493E4DBE49BE423EF5BD38BEB13D4DBE49BE60BE4E3E283E603E5F3E1B3D5EBE29BE4B3E40BE5D3E3E3E28BE4E3E1ABE2C3E10BE23BE5F3E56BE0D3E253E5ABE39BE4BBE5BBE593E56BE2BBE253E4F3E60BE67BD583E34BE5ABE5B3D3C3E28BE56BE563E1F3E273E60BE30BE5BBE603E553E4ABE433E2FBE413ECA3D533E4EBE30BE2EBE37BE4E3E27BE2F3EA0BD5FBE5FBE13BE4DBE253E23BE5ABE263EBA3D1CBE60BE52BE60BE603E05BE513E503E993D5ABE013E60BE60BE393E553E5B3E473E49BEA13D55BE5CBE293E53BE4F3E563E0A3E9ABC593E383E52BE55BE333EF83D5FBE603E543E1A3E4C3E8ABD5DBE5DBE45BE38BE5FBE60BE51BE35BE4ABE5DBE59BE35BE113E2F3E1EBE45BE4ABE57BE5BBE4F3E4CBE233E3E3E44BE583E5BBE283E2FBE4ABE383E0EBE543E1C3E46BE1D3E4ABE433E53BE5E3E5EBE573E0ABE4F3E533E46BE3A3E693A3C3E59BE323E2E3E833D5D3E5A3E38BE5E3E0F3E4A3E603E3CBE2DBE41BE39BE5CBE60BE0EBE5ABE393E1B3E60BE56BE223E503E2DBE5ABE593E5E3E02BE1ABE08BE253E9BBBE8BD573E603E313E3F3E5D3E603E42BE0DBE30BE5F3E60BE1BBE60BE55BE60BE323E4CBEF9BD483E49BE123E5FBE5F3E593E3B3E60BE563D53BE553E54BE39BE123E1CBE18BE5FBE073E36BE2A3E60BE5F3E283E283E313E513E5F3E53BEE93CB93D4CBE2C3E363E15BE3CBE1BBE89BB233E48BE52BE4D3E59BE5A3E503E153E4FBE38BE26BE5E3E4ABE3C3E5CBE04BE5DBE15BE5F3E9F3C5FBE58BE33BE433E353E5F3E13BE373E4C3E59BE4A3E3F3E5EBE583E513E403EAABD5CBE5A3E183E46BD28BE5A3E3E3E20BE493E4D3E3C3E5EBE5FBE213E5D3E123E2EBE5E3E2A3E39BE2A3E5F3EF13DB73C43BE53BE"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
