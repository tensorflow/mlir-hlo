// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = stablehlo.log_plus_one %0 : tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1A81F23F20870FC0DB2980C0465547BFA8CB3F40CC0D4DBF219B0B400AD22240C77F9DBF65EFB6BF4BE7A0409758E73F5E508BBF404CD14073F8863F71147BBE5EE42EC0DA045340F4B5C2BF2BB41D3F7A0A8C4062F52BC0E7952A3F095601C004A82F4030BF64C02ADF23C087ADF4BFE11C46405783453FF21FF5402B61A8BF8BFA8EBE2DC6384077829FC06B94B13F9433A43F2C1AA240EC56E6BF732F18BE68A51FC02BD651C09261ACBE7BACAC407BE1834028AA15BF8B04D2401DE3B0BFD0852140B9C847BDB384C93FCD6D92C080E0B2C0A28A4C404C49AABDB32509C0EB80B7C0BD481740FAFE57C076A955401225ADBA8A6D15BF7F071640DEBAFEC08B4AD3BF5C41AB3F1E378040B262DB3EC0B39C3FF9DB92405A272F4032EFE4BE73437E404F048240E7DD4F404A6B98C04E47E7BEAE9F00C0DE585D40495E593F9A7C2D3FC7588240BA7F7DBFA34F6640F458553D425EE1BF3B8A19C03EFB10BD207ED13EE0B235C02F1F2D3DAC86D13FA1E750BF4DFE48C0209A2ABFB39C11C0FCAB8DBF434D04C04CDBD5BF4B052DC0D615F63FCF1A0040B6F55C400981853FBF38493F176B923FCDD4B8C08C77FD3FFAD032C0D825EFBFBED983BFEDFDB2404082CFBF1A6385403BD14CBF66C5E7409D0CA340E47DB8C0BB01D23FDAE241C03BD6854059D2A2BF9ED781BF5E41BAC0CF165B3E25A994400D8A0540EB94333D70D288BE08628340C54D3B40B9D4BABF8684414042FDC73E433B77BC4155163FD4E09E3F8614C93F5212973E9DD41BC15C2653BFE4C20840CA6CB3BF195AB83F8450BB3FC8A2A4C0772CA2BF01DB153F55B767C0569AE73FCA5A1DC019D38FBF709D25BE70EC8CBF36E27FBF6CEBE23FC73355404E88BABF944D27400EF6254030A1E13F567C34C092F2E1C074F4A43F4C1380C0F361E8C0F2FE5FC010C9FEC055BE6DBFEC4EB53F9F6E593F15B953BE1C123F40998C10C05611DDBF819235C0FB76ABC06BAFDEBEC55C0F40640EAFC07E2019BF56C30CBF12459B40517A0ABF1F862CC0F489883F9639EABF9E0AC4BF974C85C07744BEBE28D0EEBD214187400327CD3FA08C3CC0C19516C02ED6873FF61BB9C090FA9740683D3F3EA2C821C09919434021445F3FD14C7EC07AE2AD40A9B6833F783302BFA86F183DB21208C01B248B3E6FA76BC00B6D88404ABF823EC3853CBFCF0D29BF744CDEBFACCDB3C0B313D2C0B8B8614066D690C05190814016AF353FF1B227C048688DC043D162C02E165340F95B83C07E0C2240A58D96C0E7E30E4067149A3F8478B23EC635223F8A234CC0EDA991C0741822C0846B5E40A2D216C0EF405FC095F2B63F5C5A313FE414593E70B96440B52DAEC0F2B4A3BF24A962BF2F9EC140C08FA8400EFAB53FADE8A7C051844CBF3A5A12C0302A31BF9C5AF44066BF3940198BA1BF480B88BF6F7BC4BF13E5BE3F965FEE3FF46D4140FD57FCC099F0E43F8C02C0C052D24C4054F11440340F55400784834095FEE9BF20A564C0BFE862405B9C6D3F6BDD1AC0F8D2BC4015990A405C5AC7BF091E1140AD7E6E40A642BDBDFC58EC3F597C3A3FAB6A1C403153AA40AB852CBFEFBC1EC0D35F69C0C349093FCBFA4DBCC0170340CFF2E7BE52916340674C1A3E8AB7B440BD3FB13FC3536040C0DB37C0B46CC5BFD59039C072EB8340275E9640972654400A6E693FC9714DBF6B0D7DC04B5274C03B0BDE40B9B99D3FC42228BE8442A93F2F49BBC0AB48A4C004479D40E4BA7FC0A05FE63F5520A64002C026BEE9D32FBF32D8123FB6638240F9BE0040068C103E14FBAF4070D015BF722A8EC08909E53F8DB97140CEE711C0A64889C025E6353FE564844015CA80C050CC8BBE10215C3FC2641640BD134B40EFE31A4004A3273FAF2306407D9520C0BF0788C0A3FB87C01FCB7F3F790A8E3FE08E63C00F7A79BF0D6117402E7A73C0C02FBA3FD0A6A33E8DE3A53FE3B324C03B6B53C0CB07543F1EE1CCC06AAF3DC07BF3D840CD795AC013380CC078690FBF1A4DADC0B4CFE23FB331A54052FEA7BF9237983F572B2840A163DC3F099C62C0463B12BF75E60340246CF8BF8A1360C029394FC0BB677CC04967A4C064C71DBFC6680D40FB4B81BD64E0EF3F1CE298BCA1F32740129C9740EFA3A2BECD1C26C01CEB463FDE41CABF4D5AD63E136F163FBC5BFDBE01C61DC022D8A33F64186940E087933F3209E3BF002A00BF87420B3FA3E066BF669A2C3F9104B140FCD980C0BD7420C076C7B4C06584C2BE3A8E7440D3B405C075202E3F04F0923FC1EC343FECA322C0CBF5553F8C6EAB40A1C8E93EDEAB5C3D6BA62DBE145AE4BE66B93340AAF32C402BCBE73F71E7003F7B529340E45C0F4102A60AC0A15290C00D55893D75488DC0E3F5DD40A98C87C09E1440C08CEC264066729940C318AD403BD2A9C080F02940F43A8EC04F00CCBFB70DBBBD8F0EE7BC02048A3F6FAAC640351AE7BF695708C0B7D729C0F0FF35C03C39623ECD8E8ABF03CEC0C0FCD5783E355F45C0713D7EC0C7D4594091231BBE3EC624C0C4AA2E40FC2D80BF0FEBB9C03777FCBFEBA6293F4AEA3340F00A7BBF540E67BD19570140B76D8E3F219A664093B45040B3944DBF8768A3407FACDEC01EE72240D62453403006A73FA0DCC43FEC038040F3C58CBEEFD32AC05A843ABF4766B53FD9ECE840BC40573F1BC4063FDF870B3E603911C0ECC6BB3F2312313F6CEAB540B1DC73BFECFE90C0FDFB0E40CD769140ABBEA640E1B92B4067112EC0CE8A92C0A2477A3F383E0940E33BBDBF533A99C033CD9B3FD7ADA34028B1B7BF72C246409242A2BF19D1384045FF5DC0621A4BC0876E423E8F35994065699FC04B775BC0317A753FAED0B8C0E4C5903F43D986C08B06B9BF12C6523FAD2D4CC0C5BC7AC07EA339C0B3883DC059B492408E777F3FF4F40B4013EE94402AB75C3E3988C2C0D92449C0900AF83F9D7EF3BD0166B340F7A9244093A74F40256A1B40A14C88C0BD00EBBFDEE39740A1D81D3F252605C0B1DFFEBF84C1D640968457C0360E6640A72427C0CB0425BEEC423D406789FC3FCB728EBFAAD52040C79638C0FBAFC7BFA1216B3FD3F309407B3BD8409901A83FDD7F9E3FE51A89BF96237140D357F3BFA386F43F1D570440951DBDBF99F6CA3F5920653D5E346D404DD61FC0569A8040614D1140C73BFB3F3D01A4402E31ADC08963293DCAAC1AC0A7DBE13F42F0BABFD165E040E24275C0C6CA863C6AE9514015AABE3FE32BEF404E85DBBEF0DE9D3FF387B1BFF242EBBF512E944088493FC0A0B740406AC2DB3EED0B22405770344055E286BEBD5B5D4061304A4016742FC0290146BFD85E86C0862F8E3DE1A812C0252381C07E94284082A42340F40116C0180385C06D1E30BFA365343F8FA53BBF81E1A93FB4EC8940A58808C04EFCC63F35522E40E28960400C68C3BF3CEA71BE205945C0A176A7C0A2418E407C155B40478D60C087751DC061D6E4BFC2BB5740220388C03671ACBF134EA13F80D21B3FE1353B407315DC3FD2F047C0F93CB940C102A44003EB10BFA2072A40916B17405F3B1C40250B96C0AFACB5BE8328EB3C59845A4089296FBEFA0023C06B3E80C087410E40423E414021E784BFB798F43F57BE5CBE6EF8F9BFF99B92BF6571134094DFBFBFC9F87BC0887E24402203673F51514C3FBAC3B6C047D52FBFEBDDFCC057DFA0C00DD585400DB946C0DC5DB53CFEBCD83FB664C6BF511B11C08B810B3EF1B8F03FD0E74C40A79B2EBE5FA562402D5F343FAEADB73F3F204340C1206E4088E3C1BE53801ABF32FC1140F74AA83FFF2194C02B64B24088E190BD692ABDC0235912C0DF95A940ED4CE53F512ED13F483AA84012D124C0CFFB13BF0918F1BF7B8B9BC00060943F66DE913FC839883F85D6803F79679E40F984D8C088FABF3F5329EE4011747FC0457553C0D74040409B796EC0689D08409614EA3F7559B5C0C54A0341FEF33EBF55ACAB3F121A2740D9A5314015CDF73E8BF1CC3F17C229C0867BC03FD1770DC0CCEB2040EB64F5BF5135C03FCCCD0240E5A029403F8D5540AEB9F03F045997400AC3BABF263FD3401AD79940C50D2CC034BD9F4091934AC0E9845F4092CA543F6BBAF8BF5B42D1BEB054F33EF2E671409130603F22598CC0A057D4BF796DE5405F498B3FACAFEC3EFFF504C11FE58CBE4D9995C0F03AD3BF16BA563F63797CBFB5CA8C407320FB3EC46467403627B1BF5D2C823EDEEEC83FA885904003BA883FB6AF4EC03CAC14BF06DC0DC04E4B79C0CC34564071AB54BEEDD7B73FD939AD40AAB8CCC0B4125D40D0C3133E26614CC01946F93FADBD0240132A53401420C73F28A6E63EE3ABCA3FA970EDBF490D5C3F17159D3F5CCF923F21F2ABBF551B47C0026EB9C0C1FC23407DF0BEC0C7234F408F9A6BC0B705CC3C7BD626408F101A3F90487840509169C0BF6F47C0A8E761C028B040C072C122400907463FC7B411C0B7071A3F675DC93FD5C7CDBFE44533C0437073C009DBA5C047E910C02AE3DEBF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4322A63F22BF28BFB3FF903FFFD538C013DDB33FE6884ABE94C6B33F32AF2C3F5868BD3EBF86DDBF8774EB3F4C24953E0866F03FA8CACA3F23223A3F1946F3BDA851A83F3E7F0340FCAD5BBE7C7811408290E53F1C4AEDBEBE80763FD29961BF4E73D23FBE1943BFB23B673FF45810C0B6B2B63F13AC3E3E88E30A403F5D1ABED5948B3F64BFA93FF546B83F829E3340F382DB3F3CDE923F32B653BEB74C3DC01013A43FF9CDFFBFB3B9D83FE867B93F7EE7D13F00C9E8BD618A0240A51039BEAC3BA13FC0C462BC0A43D43F9C7787BF7F5ADC3F732222400DA2583F515095BF9644D53FF26C2B408483B43F961A0C40BD1B153EAD6707BF98F70940502796BFF068CB3E88800140B1A5CE3FB6D8AE3D908AD03FDF4B8F3F79A4A93FAFE6F3BDD509EE3F145F2F3FAE3FED3F9BAE57BF00E13B3FB4F8A6BF119EC13F7CB4403EB0CCBD3F830D973F1DE9A33FE5B6C83FBDE6373FA91E84BF2B18AC3E6F7147C09AA8933FD0168EBF5CB9293FE57C803F75B3923F8F92C1BFB02B553F706DB6BFC73F3A3F71ABCFBF741F833F0731E8BF10E4A13F78BB193F1C95C23FC89F6B3EB779403F58D4113F0E4BD23F34E82F4004A5733F617F15C0035EDC3F15C0C93FD120B83F3BFFDB3F977DFD3F8D87C53F6C21084057F141BFDD0BB23F88965ABFAB56D63F0A7976BE1675E13FE160C9BF96D3C83F8758A83F9E46903F5CB6683CA0CAB63F8274B23FF55BB73FDA37B6BE75CDB23F8D30C63D0D2A0C3E39A3093F79E0803F36811C3F853C12401024B8BF8A40433F5397BE3F18F8CD3EE3E1EB3FCADFDE3F56E78FBFDBCCE1BE77D5FF3F6843943F1563224094461C3FCE0D1FC0984DA63E00886BBFA993123F7407C93F7A7EC23F722CA6BEFA09BF3F2C541F3F25C4AF3F24B14BBF8E77E93F46A73B4068F00340113EFBBFE2C90740FF00F0BF10E9B23E7D9FC23F9FFC1E3F2106E4BDF1CDC23FCBFC03BFC38B893FCB2CE9BF590FBD3F37B242C079C3EC3F2E9E84BF30ACC4BEED8E70BF5DB2E23FB0C3BCBD3ADE313FDE1F254030150E3FA24F04C03460943F449541C0003DBB3F70B0AE3FF138AF3FAEE158BFCCC00A3FD07D1E401843F43F9A081740AA73833F20E190BFBDE3B53F4046593E5B6CE93F46930440B4EE3C3F337F7BBEEA6D5C3F60F78EBFF10EAE3F747E9EBF51BAD43F0493463D399DAEBE817398BF0709DE3FD0BFD9BFEB51F13FC8E82440DC1FD73F266312403800923F0D207EBFB10ECC3FB2A515C08B22E43FF72C43BF50D3E23FBF446DBF5E7E9E3F6282B63EC82DCC3E2EE4E03E5450CF3FE03901C0ABD2AA3FE23AFE3FB5F0A83F7789F8BF813B6D3FB73C8E3E13FEA93F0A369F3FBEFCC33FCC1F37C03871E63F41A3C63FF223EE3FB469643E5C58BB3F9A293DC0F220C23E357B29C0A1670D40DDFEA53E8141B93D3601E8BF7DA2EB3E8926F53FBE8BB63FCC05503F1026FB3F14CC38403CFDE33FE89F24403A45C63FCE21493F837FD83F03E8AFBE5D13BD3F2CB40C40BC92903F52E265BF9E42FD3F45B19B3EA116593F12EBE73FE6D4C63F5826A0BC42F5893FCC46803E0065EC3F971A7F3F9EBC6A3F6054B8BF224C7E3F27443C40C24D523F8A908F3F81DFA33F6686B53F4A32E03F6655AF3F26E3B83FC32E793F4AE5623F14F81CC0ACA0C13FEE2900406768F13FD3DD063F68AD3A3F797BCBBEBE7FC93FA0AD0EC0EB5A054085AE1D3EFD19E53EC0E9803F7A3FFA3FB2FE14C0C693FB3F6B1818BF3528E33FDEC0893FC403A33D03E42FBFD8B5BC3F48E3993F59428D3FCDD73F3D7B18F03F68E8B7BD668BAD3F8F622A408F4CD53F7DFBE3BE0B5B9B3F0A733B40871AF03FD31F2ABF8E06F33DBF745E3F5EBAC33FCA1F423F44B49F3F7BB6413E3CF7B03FAA5B2EBF76ADD63F75530EC072B8533FF3B8013F13CA803F0EBF31C0FB04D03FF5B758BF7707683FFF98043EF4779E3F30A257BF2F2B653F7DF83240BEC1E83FD2F228C099EE084099B5D3BE18A28C3E13EC2CC0F6A7C73F6BA33040E299EB3F72E156BED7659D3FD44C603F248DBF3FED596ABFBC8D3E3F4BCEAE3FF0DBA43FB5A9EABFFE7FC13F329005C0FA2DB73F2A993FC0CE49953FEE1EA1BC6E22873F88C6D4BBFC98E43F1AF46A3FF0B87C3FF727A8BFD1C15D3FB7103ABFF296DB3E4210C93E783F6C3FDF30AFBF709CBA3FAA77813F0E4C833F856F30BFEF409BBE2F01543F6C74C4BEB58FB63F3E6A0240706C0DBF8C09E23FB26EEABF5141AD3F5D78B43FF707803EA455254070DF503F11C0A23EC7BD0F3FC7422940D613ED3F68D8923D7AA4853D5E5F23BED89B863F5621B03FB646B53FF0E8E83E6AEDC93F31A8A03FD7961440064F5BBED0BEA03FE4D647400CE60240CCCF01406409BE3F043419C0565EE53F55FC6C3F7E9A0740C30B31BF8E00E03F9EEE61BF5A7402BF324B3FC0C4C9BE3EE357563FB15C00406C507BBEAF98873F379AFCBF02721E3F016E414080E4E53F69D0CABFE6C9993F240598BFD80EC13FCB791240B44B7F3F0050A0BF96EDAC3FDE5186BEAFFED23FFA2730C0E87F973FE1B1843F2C7134C056BC9EBFB6A7953F69B1B43EE773DD3FEBC91D3F1BCDD03FAC20C43F702FEF3F6C392F401151C03FDFE0963EE01BC73FA6B2803F2839823F8A1CA7BFE4BDBB3E3CD7B03F1E9B0740544ACF3DA892DA3E1F56B63DEB9E293F092D1240A1DEE33F4C0AA43F3869C13FFBB8C7BF9207DC3FBCD1733F8CB7F43F1ACCD03EBC34CB3FDC0BF7BF7909893FCC69533FA31BC93FC5CED5BF18F0DB3FEBB4943F954B923FEEE0DA3F054A883F5AE4D43FB61AB23FDFD70EC0D94ACC3FF7E1A93F705ED43F088F1BC0AE6EE73FC2349FBF09B1C63FEA218DBFEE2487BD3A4604407C31C03F192805C0EB0AA13F320C09C0DE2BDE3F3E12353E3770DD3F286B783FFF87E93F11CDAFBF5FCD873F7B021A40AC37DE3F9D1BB53F407BC93FA4BE3C3F2974D93F8CA064BF0E4EC93F5660DF3F3C01783FE40369BF2C10F53FCCD4DB3FECD3BA3F17CE09402AE4F63EFCAE42C0EA46BE3F1DCDEC3E0C296C3FB4CECE3FE200653F49CD1CC083A5873F74F0573FFB03044048A32B3EE6A7683F1087E4BE565DD13F7343C2BEEAE4A23F32241E3FCB1F013FDC7FEE3F0BAEAC3F2389A53F1D5EBA3F4DB7F63FF55AAB3F15610A3F93750640844339BF22B4773F71FC94BF83E9913FA0D7F8BE91C60B404B6AE4BE79E89D3F6698A23F6F190440DAE79F3FC7249D3EE18A913FD15E213F669FE3BFB019ED3FEFDAF9BE4F88B23F9050DA3D7F11C13F53752C3F77ACA13F6F34AE3F1688CD3F423015BF46D9B73FB229C2BF19816D3F112C91BFD00DB23F25521B40A47FB93F7C2815BF441B963F0E543BC06A421E3F11EBCFBE9360CB3FFFB0893FBE81273F00D90C40D4F2D03FF970413F0EB30CBFBA122EC0BB42DD3FBE8FF9BF133FEE3FEFAA0F3FC6DAA03F3A6B17C0AFF19E3FFB72E63F6C07A13F34EA2FC0AEB7593F41B0863E3543BA3F9663D33E1ED7E83FBE13F63F2A89E83FF3BBBCBD2557BC3F7F03133F315CE13F040C70BF33E0DFBE3E20363D8C3DBE3F3E8358BDFC93BA3FDD36F8BFD41DBE3FECB9403FF5D4253F96A0CB3F697D3E3F1D2C98BFD927563FFE20D13F806FB03F1233D9BF18DCA63FF5827D3E7015E53F6C05A2BFAB580440F8FDC3BF9B23E13F9A96154079903E3F8B6348401320913F0EAF05BF6973783E48354240CCE7BA3F708F563F6C46A53F909CAB3F621A4D3F2722333F342EDA3F0B423E3FDE1C13BE075845BF569DA13FB223C33E5E8CF23FC7760940FC00E53FA41AB5BF041FD93FA98CE73F9242963F3497073F26BBF43F2FE8C7BEF45A283F9CDAACBF676FB23FF164364026045F3F9C53EC3E1476D63F82C4973FBB72E43FA8C6384050FC0E40F31DE2BEB066AA3FD9670E4016F99E3F188C1E402247EC3F68CD8DBF48470E40A694A5BD129BA03F69FE563F871AAB3F268C023E47FCA73F66904BBF395C9A3F442739BF168DB13F28B0FFBEAA17963F425D2F3F0A9CCC3F81933D3FC615DB3FBB09833FC8E1F13FEFF2D13FE698ED3F70F8DDBE53ECF43FF5D4F8BE5B76C23F71583B3E22B3E13C65E42EC02545B33F1D6E993F03FCC73F205595BFE9ADFC3FF7CAD43F639D423FFD175F3EFCB6FE3F5FA746C0905AB23FC90C2EC0EB4A3C3F170FFCBE0061D83FFF84B93DE346C93FEE2895BECDA2323F4E8C653F59F1DC3FE3DC433ECCA7553FCAC038C03D01B43F67CFEFBF433DBC3FBC8B43BD80FAE33F56EE923F48C5ED3F92A02440FA599C3F28059DBF8377A33F49271B3F698FC23FDAC0B13EE4A3433F8644543F3138453E27A01640CC196B3FEE7BF33EA40C923F7921D7BF00B8D83FBAA629408CCEE33FC01924404F817C3FAD774840BFF5A53F784C293EB351E73FC76524BF0A17B53F7C1807C0F08C963F61590F4029A9873F36B368BF9A084F3F35C3463F5BC9863FDD67E4BF3A09E33F364404C0022E443FC8B80CC0"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
