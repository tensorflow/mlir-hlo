// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = stablehlo.sign %0 : tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x13A704C0333E8E409CB1F73FF73312C014EF8ABF424C21409C71B1BFFCDA4CBF98D8F83FA1BEBCBFA9EC40C03A94C5BFD2AB50BEC4F06BC008CB094068F5E140C41D1E3F814CD93F35BE4940551FC7C07DA113406DDA2F408ED90041364DB5BE4D20DD3FDDF4A33F60FB6AC0E3BB89C029BB4740064A7DC0A07A28BF719428BFDD3CBC3EE919554076F00CC0EEA94740C68A97C0414D243F06FA2C40070B73C0BC4A234069E0F8BE924D6DBF5EA0844059CE4A403D18D53F0AE395BE094FD33FA975ABC09C083040D5D3BABF5B79A5401736EE3F1F44B33F9C7E0E3F30AE8440ED949A3FBA419E3F6A5C164051BBC340D4DC9FC004D8FFBF5A833540561D42C0ECD281C0273633C0FF5CA4C07BE7EF3FACD94D400B0AE9C04C82FABE5E903FC0879801C0E0926ABF2BA72B4025388940EE96A7BF549BBEBF9368A63E25F0243F059AA13F591ED2BE3DE5814040D3E43F426C933E590CEB3F05071340DA6B6FBFB3A58C3FEEA353409F4DE6BF34697BC0C55645BE1B59E2BF5DF5AF40E9ED2540C7221740B42B443E50C484C072C41F400D8A7CC03FB91FBF08AA4D3F405E0FBF242128C063B871C078D0533FC7B4FBBF84AA36BD50C772BCB5AA26BF4C3671C0A3EAB6BF2A3AD2BF449D8FBF7A4B77401578844098A0D040DC2635C0061C7C3FBAC9F73FFD8FB13FA4C46240FC99DFBFC0B92A4047A88F40EE72133E045E714046FC2340058AD4BF0DE23E3F7ECFA9BFA34008BE08F1E13FDC630B406192A73E1F7369BFD9CF6F3FD274913EDF7C813E7592BEBF1CBAD5BE10984AC0AD73983FC3CB2CC0A39434C0AF2FE53E4F5C8340659EB9BF6779DF3EB9592BBFA1DB2B40F84EA140491B0340D0B20DC07080D83F35C992C086BAF2C0EF57F43E926502409608583F781F6CC0E1CEA33F0DBCD1403B7726C0B1D205403DC1DABF68A213BE455E7D405514DF3EE7DE3840FD5F0BBF4A45073F8D7801C0C46A9240212508415557F73D6EE4E4BF886554C0EED793403DDF03BFDDBD1FC05EDA6F40377C083E5451B1BF6ACFA240AE1698C0E7B11EBFF188AD3F91086A3FB08EB5BF856F523F5BE19E40CB0083C0EE029AC0D880DDBF390C3840A898B53E62B0633F7EE971C04F5867BF3335A6BF473530C01F1E7F3F67AAA23FC26C57BE320AD83F3058153D50F3C73FA9F0554045A06AC02018CF40FCBDA1BF89F5EA3F6AE77540CCA6FBBF3BFD833F656E5B3F87BC1ABF7E626D40CEDB81C024D1AA3FF572313CDE0AAF3F762501BEEF30183F8132BEBFA1232840A01E7040DEDDAFC0276717C0DEDAF6C0E36373BEBB0772BFE16265400CF81EC0F75527BEFB9E70BE6B56914031258AC07248F7BF419439BF9C7090C077F5DDBF095768C003F51640429469C0899EA03F6B1CCABEAAB65840C358003FBA1897BFB4DD69BF12523D402EB54CC050E694BFBD8E5D3F3D02CB40FF7C84BE0D428C4061D536BE5E0A2A3F388BFCBE3C08CBC0D54AE43E8381D2C018A3FC3E781FB63F073929C06B2EA4BFED941FBF9113AA3FC688BE3F044D51C0F20A6DBF05E8733FA39E2CBF47C5284057093FBF4C960D40884B25C0A9F7723FA52857C072D847BF01F1A640D58EFE3FF3E7A6C00E3A10BF691625BF41BF7C40DD97923F7BB88940A6CBD9BE3BA490BFAFFE7EC005F38E3F55C5E03F4A9E6BC019D9CCBE666F86BF6F90AA3F6AD0C6BF34151BC0AFEE5EC0684C12C0663F913F41782FC0DCB056C0AD9885C05DCF2DC0DC2318BE0F2A1E3FB679A1BFE6E150BED10FB63EB484B8BF46F03440C11BA8BFC241833CF7EAC8C0FB5240403227F2BFC1DE5AC0DBD8253F187C3B40B77FC63EB5D629BF98A8BC40574F3940324028C09D3EF0C08A534B3F4198A9BF75C03FC0AD5E253FEDA7973F10650ABE76A184C08CE828C0A3CC4A406A357A4010353B407A2ABBBE5D693FBD50C4AC40914AFABF7FFFF8BF23CEF4BEC88B79C07635BABF74A447C0DFB407C1D620D53F0FB397BEF69AB5BF7909073E34108D40BDC276C0F4BC3AC0CCB9F6BF286B4DC0D6A390C0717527C0A576903FFC76E83EE2F19DBF5CA6DE3E159C6ABF6C8199C06026ACBFF9B7E9C0EAD286C02FF520403C905FBF0834F83F37A27840972581BF5134C3BF7D7738C028D4064191258BC0B3351CC09BD7CE3DFA9716BFBB750F40A73D8BBF62DB573FD0BAA53E1EEC1B4094113C40743307C0E1D583BE7AB8CB3FAF8C8FBF080C104089F095C07C64733FCAB445C0FBEB1440ED538740AB4356405672EF3EB28DE6C048AD93403751FD3F4309E63F64A466C0C06369C0377962C03C3ACBBE4F98FDBFE358ED3D13121BBF43788FBF189B973FCF5A6940BD0EA0BFA6894DBD2B7415C04D0D0541B10A91C0670D444051AB0CC091DDA040A498BA3F8D60F6BFC0C5E7BEC6E74940C34C9B3F52E82FC04604B73F95A7AC40E69FAAC03CA773C0D5AEB240C29FDC3F501FD2BF52C7983D67A60FBF5732A0BFB6464E3FABF6103E4EA06E3DA574F3BFA59C4BBEE5109FC0FDDAC540DFCB0DC058CF85BF5B70C8BFB63A9C407C9E1340261144BFFBFF203F818A46C04C5E41400EBE28C051BFE9BF60CDE43F443816C0052C9BC055D48AC069C7ED3FED4863BF714102BF054384BF8BE037C001C61E3E5E700EBFD805433DC384793FE3F82EC06E5D13C06C29F8BFD3B18D3F750EE6BF63E489C0CB5CA93F418800C023E624BEF425D7BFFB40EAC079E590BF573F2540C1AC693EB59FC83F163C81C08C97A3BFC21B9040285E3D40481863BF238A60401CA590BF0883C3BFE3B630BFCCBBBDBE00C61B40DAD72EBF66A1AFBF6A67364000C239BF0B22BDC07A29A13F35AD254098D6FBBFE79F1A40B3F16540513E41C07631FA3FD878D34001F28740DDB80F3FD45510C0E80B80C07EE6B440E87634C005FAC43E15BE62C07FC4FA406B5F854072CE1740A3D63AC0D2186440376B56C08D408E3F0EFA72BE1EDBFE3FC86E05BF49430D3F44852440BC7DC2BFB83A2440ADC02CC050979F406C34FD3FB47C03C0C6159C3E318AFE3FD7A4F1BF1A5D51406F14CEBFE8C8EDBFB1178CC0F2ABD940A3F6E340651ECBBF9C446E40D2509CC0418FBDBDF47A8CC0B384393C477DC83EF535D83F9D4D7A405E07A4402DCE914067009F401031A23F73BE06C04E52C83FCEB5FE3FDDD5063FC32557406D55E0408759A7BD1CAE03C01461BABF969C8B405ABF01BF0F3783401102DA3FF8AB4E3F659440C0D6C2C4C0747C95BF0BEAB5BED9636A3E33B77C400E498CBF8F630AC0BE912CC09DB0F9BF1A2F053F470C4AC0A780F83FE3EAE3BEF3CB8340DF24DF3EBE99814078E8A43F1C96963F01F0A33F1A48D5BFEDCE40404CD97ABFFD7688C0BC11394077ADC6BFA739C63F38ED0740CA5A0740E313ED3F0BA4C4C0F06E134037FB7E40827DEEBF3DF824C07807453FEFE983C01D384340F1B82EC0CB529340CD6F85C09756F1BF2D140EC0F0E641C01D2A903F067C5BBFC9928BBFF7789C3D713D58C00F7BC0C00B79853F7FB65D4034C71C404FA876C01CFE613E505354406F109A40606B8D40153D20409983423F762DB13FF8583740CC6112BF5EA323C0ACD007408F80E5BED34644BF6D5C28C05A3EA8C09AF695BFF7059FBFE469E53CFB3E854051B3BC405EBE143F33B1B940BCAA1540D52AA84062BAA8BFFD3721C09974DEBFDDB0B4BF37EAF3BE9147F3405D51A1400D8D1DBF43D3333E0413F33D546637C03DCB52C0F9FE17C13E07D240B9D2F53E19EE97BFE430D240406CB5BF0D1938BE224B0B4013062DC03F8B6B40C0B3F7BFDB665B4096648640660A38C0B7F60AC0A1FF75408EC983BEACE2FB3E4D3C8340E4B12AC05BF8FFBF1FD5B5C0E182934089E1A2C02193B1BF5327BABE9A04A7BFD30ADAC006D074C0D42BBA4006BA44BFB66C1A40C16D0A40F6AF813F450EF5BFEA108ABFF9F1A5BF6D40FB3FA52DCE40429495BE2BA715BFCCE9C94075EECC3FCB8B38C0C55A9FBED6AB04BFA3F900BF846801BFDA14863FCC3A64C01F6C5240D4BBB0BD8647803F9EACB6BF1C256B3F257AA93F125A7140E5CD5BC02E2AAEC05B7757C0211E164096FE503FB7BD09407734E6BE3098D1407663A1BF737B374074EAAABE428B4240E84BD5BE05CA15C0EFE675BD254DE3BEAB81383FD41E7E40C21CADC0BF9CA4BEB9A13F40A696613FFD83053F6D2EAB3EB667CC3E6BD2AD408DD6B940EB7F1640ECABCA3FD0DEA8C0F6270F3F31DDE13D44592D4088BAC5BF24025240E3BA11C01FE315C0630126C052D02CC0D96273407E05B640D929FF405EB48DBFAF00103DE7B5E1BF1DF79EBFF46D19406ACC0B407AB24FC0890D05C09F0EEC3F753A9B408B93883ED3C7B53F9A1AA04041FB8C407A9F23C062FBFCBF3C92D8BD6783563F7FD452409E78C23FBC1C46C05A162C3E7DFDA6408D35E63F6F63ABBF4E2081BF99FDA3C06AD1CC3E9849FCBF73970AC0B0D4B8BF909CEBBF2E983D40FED317400EB66A3F05027240A97CDE3FE925244164493EBF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x985FD8BE3804683FB577253F3A5643BFA285CABE261F6B3F8CB65DBFA3F6FFBE82F74B3F64B41ABF00DD63BF5C5CE9BE311162BD1B9C7FBF6253953ECBDE743F2A0DAF3EA192703FE75FE73E7E5E64BFDD99243F4F11443FBBC07F3F95EE33BDC6A34D3F5279183FE32326BFDEC342BFB6831E3F320549BF15F734BFD01235BFEEC3E03D1E747E3F8AA113BFC924513F52AE7DBF3385093EF970143FC29150BF147A7B3FFBA33FBED3805FBEE6D3793FB3A0623FF81FEE3E4DCC32BE3F117C3FD0BE63BF27D2E93E54158BBEA55F763F9D8C4C3F09EF193FE73E083E51B97D3F69E1323F1822373F2495B73E4DFA6E3F91AE6DBF5D31BEBE21D92E3FA9FC3ABF16B052BF3A6B11BF4B7D70BF4682AF3EE6DACE3E3F2D6ABF953125BE98A57CBF793B69BF7C14D3BEC5C0073FB10A593FE50929BF3E4140BF1F9AE63E7B90643FEF75733FE1469EBE2E496A3F365CCE3E2EA01E3EE8E87C3FD71A6D3F600DC1BE8D72A13E8EF0723F0D35D5BE83BF68BF80E0DDBD437E7EBF538D673FB15ADA3E69297F3FD098A53DE55A5BBF80FB033FD0DB7CBFF5EC1FBE5F02523FA96512BFB82D12BF532952BF1691C63EAEF66BBFB4F072BFAA71A1BEA04D2EBE98437CBF180A28BFFB2041BFCAC58EBE71D8753F3439093F741D583FA0C871BFDB3EA83EB616503F461D153F6D9C653F9C67E2BEE0C5023F07145C3F2B461C3D49D07F3F60D5563FA6380BBF34DCFA3EA12A5FBF3BF199BD99467F3F58287D3F9C2B183ED99132BFB06F373FE9353F3F12382A3FA77E76BFE0388ABE079A6FBFD44CB43E19FD30BF54F638BFCB01DE3DCD7D7E3F0E2375BFBB90933E87AA77BE4A66783F102A6D3F88C2C03EF96D4BBF13691B3FF37804BF390F5BBF1988693EF740793FAE52643E208E79BFA23C443E58417B3F868547BF9765203F09187FBFBA28ACBDAA767E3F350BE03D19927B3F10A93DBE8E64813EA9B077BF3F7BF23E4E78613FA3008A3D0B6B7FBFEF5915BF31EB4F3F78F94EBE55B77ABF99D67F3FD894113D488286BEFD01773F92D97DBF307004BEC040543FF01F0F3F457E5DBFA05C003F2584453F24DC22BFB6E670BF373CADBE29137E3FD1B0FA3D0B8B6A3EC33179BF1C3C12BF4E1F52BF82B770BFE141AE3E0E907C3F583D27BEB7F07F3F4EEDB03CA9C2D83E18ED673F505BFCBE8BBE5E3F6F2811BF1FDE523FE9E5633F8E39E9BED2DD443F0AA5233FB4B224BEC7AA7C3F1B3073BF10F29F3E79C1013CF2FD7F3FCF8154BE3F6D7A3F8F0FFCBEFCD35E3F8156103F096E53BFA91C96BE05C074BF55AB79BE314678BF4369523FA1D111BF552912BF5E2C52BF638D393FB25E30BF81AE6FBFE0DFB3BED3F86EBFCF9CB7BE26AB56BFBB790B3F261772BFD678A63EF124EDBD2A477E3FB726C83EF0A06BBFBA1397BE009A743F459570BF9CFEAEBECC690A3E8CA67D3FF66571BD168E7F3F6FE984BE4B39773F3BBC9EBDDA3A7FBF577F8A3DFA697FBFE6C1A73E54DE713F4C5466BFA577DFBE0776D9BE19C3673F8F1BD43EC4FF68BFF86A32BF7D95373F38AD7DBE2B05783F23A5A3BE6092723F1B4A70BFD699B03E885D79BF179E67BE5E356F3F6860B63E01857EBF70EFDBBDCB0625BE58A77C3F12AA833E0164773F4C61B4BE2F966FBFEC7F76BFDB2F8A3E756CDC3EB50F67BFEB43B6BECC3A6FBF32B0263FD54B42BF323112BFE92652BF434D65BFA1A7E33E790122BFA73746BF969756BFD3970BBF7D6C6FBE75E7783FAFB77CBFBA7423BEA83D753EC78C78BFD72B683F50B5D7BEA23D273BCAFF7FBFDAA4583F0F6308BFD3867BBFA2973E3E80C97D3F2159063E5504E5BDF4647E3F70883D3FC5152CBF52947EBF5375D73D1713CFBED4206ABFBF16F53E96C3603FEB7D05BD2FDD7FBFC7D523BF45B5443FFBF94C3F475D193FFDEE7DBFCDD801BE0EB3703F785AAEBECC9978BF266A74BEA3D96FBF4FF9B2BE36BBB0BEF84370BF700A7C3F7B6533BEBDE67EBFBB89BD3D89B1403FD98928BF609955BF991B0DBFE23714BF56BA50BF97106BBF30C9CA3E8ACDB03E9B4070BF197EDB3E684867BFD67E76BF90378ABECABF5DBF98D6FFBECFD5713F09F3A7BEF6A7E43E770D653FD0400DBFC58055BF09B3A5BE1039723F883C5FBF6F9CFABE37462D3EF04E7CBFDE4F663FE789DFBEA4FE6E3F8C7EB73E1764233FBE13453F881E7EBF25CBF7BD2A44513F0D7513BF8BB0DD3E25C266BF5D9B963E8FAC74BFFBD1F63E344A603FC9897D3F0DAB0D3EC49157BF3F140A3FC0843D3FD4192C3FC3F133BF831636BF8F677EBFA54AE4BD29907FBF74306F3D0F6DF3BE1F3761BF792E9E3EE679733F4BCB7FBF233D24BDB26C8ABE6277763F121A54BF3D590F3F851CCDBE528F6A3F448F1A3FA7134CBFE37111BE91677D3FD9C2CE3E8E326ABFA727833E5175773FF25750BF13C214BF819C743F8203973E70BC7FBFAFF1393DB077D1BE729869BF5E237C3F9531313ED9CDFA3C48E17FBF0DB723BDA1CB7FBFB4FE703F88B6ACBE78230EBF25EA54BFC777673F04B6DA3E5ED845BFC875223F806437BF559D323F6A7352BFF7C211BF381A1B3F1FAA4BBF7DC93EBF8FB12ABFCFF9663F30C8DCBEA72EE2BE74AA65BFC5A07FBF86BA5C3D5C117FBF879DAE3D2DEFAB3E552271BFE4D343BFEBE224BF9B40063F22F959BF21B974BF9849963E542E7FBFD5B0A3BD602865BEE28179BF0F95CDBEF0746A3F0B88133E44547D3FE71174BF697A9ABE93F3553FB2920C3F8A037BBE7F30783FBF4118BFF1CC4DBFAC8D61BFB52BF2BEE47A763FB8538ABE6718DEBE2CA9663FD18EF9BD9F177EBFEAF0DF3ED936663F3BA721BF4581463F86FB433FCBB324BFE037913EB37C753F23CB7D3FEA27063E5463FBBE99045FBF6915653F1A88E4BEF517DD3DFD807EBF4A05623FFA6BF03E8D6E213F61AF46BF8B863A3F1E572FBF715B7A3F5ED055BEA3A7773F9BA981BE18EA563E5C4C7A3F366F02BF70475C3FF0B4F3BEB023613FBD8F313F916938BFEF2A1B3E380B7D3FF2E9FFBE34BA5D3F7DA927BFE07441BFE28B0ABFF344573F31E0793F97A45EBE4F2D1B3F929B4BBF43AEACBC70F17FBFF0C8EC3C9EE47F3FBC01CB3E64046B3FEC553F3F16142A3F9B0F783FB1097D3E6D744DBF1AB9183F567A773FC101833E5B61DD3E25D5663F6A8B22BD61CC7FBFC116A2BE36D5723F9739FBBD0F117E3F1F54673FB34CDB3E470EE1BE3CF165BF98EA74BFE90595BECF096D3D2B927F3F2B79E7BE175864BFC3694FBF7B0D16BF7D80263EDC977CBF5586793FE3DA64BE22947E3F3E83D73D45F4733F2E359B3EE92D2D3F9A883C3F32CEF7BEA204603F345065BE997F79BF628F613F4F25F2BED7D3163FAFD94E3F2D96403F1CA9283FB2B56FBF87B9B33EF2E4673F7DE5D8BE864C75BF107C923ED8C94DBFEC45183FF69202BF41325C3F5B4369BF9FF1D2BE074F17BFA47F4EBF63B24B3F5B0F1BBFB85F7FBF9C258F3DAFBFFABEA4325FBFD492933EBE22753F0853093F0D0D58BF53F0873D776F7F3FDA973C3F4D1D2D3FCBF7743F01AF943E33BFDE3EF380663FCF7B5FBE2ED479BF2C797A3F66A053BE44438FBE30C675BF10DF79BFCFB85EBE5CEF7FBF7A9CB83C29AA133FB21E513F9F0ACC3DEDB97E3F5828D03E56E3693FEB62EDBE45D262BF78B546BF0D6721BF441580BDB67F7F3F061D7E3F022EF8BDB319543FC8590F3FC60828BF222241BFAA9E52BF7284113FF9FDBF3EE9516DBF893D7A3FA7FD57BEF998A8BD8D217F3F1A8E17BF5E514E3F60B0FBBEDFEE5E3FB93A533F8FA110BF2ED3FBBE0CE55E3F165BEDBE51D4623FC39B563F68910BBF58F8A9BE637B71BF60D82B3F1BC03DBF04A377BFDCCC81BEF99740BE6F6E7BBF52A40CBFFEE7553FB15F9BBE80ED733F8AD3673FE92FD93E70095FBF2B52FBBE0C160DBF0A9D553FBCBC7F3F8B8839BD7DEEBCBD88E87E3FC989F83EA8D05FBF34CD03BFB9765BBF35B734BF915235BFAB4C903E5E9F75BF70E97F3FBBF0D6BCA91E133FEE8051BFBDEB113F2757523F5F453D3F855F2CBFE3B659BFEFAB06BF39C6713FB34CA83E0D977A3F6D6751BE77627B3F2C9141BE33487E3FDEDDECBD12A17D3FDE090BBE73EA7FBF1010D2BCFB4206BFACF7593FAB79173F5F604EBFE5A5DABD71897E3F514E5C3F9B63023F665D243F0044443FBCDF2E3F7CF63A3F8459543F2EFB0E3F1F937EBF5FCFD73D98A3263DBDC97F3F1C13DABE319E673FC27432BFFB8B37BF995831BF9A9E38BF61480E3F7BD1543F5C917D3F84D10CBE774BA33CFAF27FBFD082EBBE414F633F2CF20E3F955F54BF3A823FBF31E2293F249D7F3F50E6603D9CCE8B3E6D45763F506B5D3F4D7D00BF66A27FBF86D75ABD0B6F7C3E7519783F9296E13ED6CF65BFB2D6033D0ADE7F3F81574D3FFADF18BF62C745BEFE2D7BBFE3AD4B3E80E27ABF6EFD54BF8D060EBF0E1C07BF6171593F92C96E3F1F92B83E519A683F2BD7D53EA9547F3F98FE93BD"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
