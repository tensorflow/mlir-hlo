// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.asinh %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCDBF473EB8C0B240AF408C3E9140C6C09EBFDCBF20408CC0EB3FAC3F8C3F7DC062BFC1BF223F1CC04BC09A3F65C0B83F99BF9440683FD5BF0C3E1CC0CEBF90C06940DD3F6FBF813F10C0FBBFEE40A93FB2BE3A3F263F6DC016BE1BC0AE40B740BABFDF3EC440B0C015C098BE10C093402E4068C04DC08C40C23F673F9FBF784083C0EF3F403E2EBFF33FB6C005BE1F3F55BF5DBE413F6BC082401C3F62BFB2BF4640A8403CBF62C0834054C092BF3DC02EC06A3F483FA64028403DC017406240B13E0D406BC001BC85C0054097BF7840CFBF0AC018C048C08040F4BFCABF7E3F46BEDAC085BD8040084167BF893F56BF00C08B3F31BE41BEC2400BBCF23FCE3F784007BFADBF84C00040DD406CC01240A03F33BF913F6E4011C0433F72C0223F9E3F3EC0F8BFC9401FBF9140EF3F74C0FDBFA43E81BB84403A4036C080C0AF40F63FB7C043C0943F863FDB407740A9C00EC0A5405340853DDDBE44C0A74019BFD6BF27BFF0BFA7C0F440F6BF5440E7BFD13FFB3EA3C0DA3FC4BF6F3F3F3F6DBFCB4085BF8CBF3DC065C049C063C0AA40A34053BF8140C6BF2AC059BD22C0863F49C09C3EC63FB03F1140B03F1CC00741B6C09B3F21C0183FDC3D97C00EBEE8405B3FE54094BF14C019BEBCC025C02EBF48C020C0BDC09940A5408CBF0F4041C006409F408EC0994057C0C43FA53F81405540823FA64019400A40054060408EBF05402C4082C06FBF64C0C640EF40BDBE374067BF8A4040BC963E83C033C0144004407AC0D53F224073BBA240F0BF87406B40A2BFA640ECC0993F90BE6140A13FAC3F8040733F37C0D53F8EBE404036C0453F5EC08CBF1540C0BF7C40E2C064BFD7BE7840C9BEEFBFD63FB14093401340D6C0A6BDA93EAD3F4640C6C062C0AB3E563ED0BF9DBD28BF2440923F0240D2C0893F8E3F01C09B40B2BF124069401240AE3F73C00EC0723F214068BF8B4030BF62BF5FBD1A406A3FD9BF443FBB3F7E40FF3D284090C0BCBFD9C05FBFE93F833F9B3FDDBF3ABE24C09D3FD1BE534082BF0BBF90C031405BBF00C1C340AFBD3240C5C0DA3F363F133E21400CC0743F9E3ED7C0BD3FF5BE1D3F723EF83F0FC07DC064BF4A3F04C0AA405D3F36C00540D1BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xA0BF463E1DC01B4019408A3E0E4022C085BFA8BFD33F0CC0AF3F8D3F723F06C04CBF99BF193FD0BFF0BF823FFFBF943F81BF0F40503FA4BF0C3ED0BFA0BF0EC00040A83F55BF633FC7BFB6BF2D408C3FAFBE2C3F1C3F01C016BECFBF19401C4096BFD93E21401AC0CABF96BEC7BF0E40DD3F00C0F1BF0C409A3F503F86BF044008C0B13F3F3E23BFB23F1CC005BE163F42BF5BBE323F01C00740143F4CBF91BFEC3F17402EBFFCBF0840F5BF7ABFE7BFDDBF523F373F1640D93FE7BFCC3FFC3FAE3EC43F01C001BC08C0BD3F80BF0440A1BFC1BFCCBFEEBF0640B3BF9EBF603F45BE27C085BD0640354050BF6E3F43BFB9BF713F30BE40BE20400BBCB23FA03F044001BF8EBF08C0B93F284001C0C83F863F27BF793F0140C7BF333F03C0193F853FE8BFB5BF224016BF0E40B13F03C0B7BFA23E81BB0840E53FE3BF06C01940B43F1CC0EBBF7D3F6B3F2840044017C0C5BF1640F43F853DD6BEEBBF164012BFA5BF1DBFB1BF16C02F40B4BFF53FADBFA23FF13E15C0A73F9BBF553F303F53BF234069BF72BFE7BFFFBFEEBFFEBF1840154041BF07409CBFDABF59BDD4BF6B3FEEBF9A3E9C3F903FC73F903FD0BF35401CC0833FD3BF103FDC3D11C00EBE2B40473F2B407DBFCABF18BE1EC0D7BF23BFEEBFD3BF1EC01140164072BFC63FE9BFBE3F14400DC01140F7BF9B3F893F0740F63F643F1640CE3FC13FBD3FFC3F75BFBD3FDC3F07C055BFFEBF22402D40B9BEE33F50BF0B4040BC943E08C0E0BFCA3FBC3F05C0A43FD43F73BB1540B1BF0940014087BF16402DC0813F8EBEFC3F873F8D3F0640583FE3BFA43F8DBEE93FE3BF353FFABF72BFCA3F99BF05402AC04DBFD1BE0440C4BEB1BFA53F1A400E40C93F27C0A6BDA63E8E3FEC3F22C0FCBFA83E543EA1BF9DBD1EBFD63F7A3FBB3F25C06E3F753FBABF124091BFC83F0040C83F8F3F03C0C5BF573FD33F50BF0B4024BF4CBF5FBDCE3F523FA6BF343F963F0640FE3DD93F0EC097BF27C049BFAE3F663F833FA8BF39BED6BF843FCCBEF43F64BF05BF0EC0DF3F47BF32C02040AEBDE03F21C0A73F293F133ED33FC3BF593F9C3E27C0973FECBE153F703EB53FC6BF06C04DBF393FBCBF1840483FE3BFBD3FA2BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
