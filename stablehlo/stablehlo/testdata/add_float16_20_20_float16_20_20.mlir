// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.add %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1840E441F342D9BF2941A4ADFC40043597C0E2BBBAB77942174216B59DC1D7BC1FC56BBAABBFFEC6BA3DA8407836D7B800BF8B4012BE0A4286C1D7B06D4185C166C2943AD8BB3ABFAC3EC73B76400DBC593ECF403BC4B43A91C20F403BC5FEBF2FC1F9C19FBEDC47B44386C32144E9B428C01D3C224436C0ACBF65BB94429D3EFEB50645343975B745C0A6C0E5C6613CBF404E422F20333B183F8C395042F6BAACBA2045F23F743EC43F5E43414404BCE03825385DC00039AB410E3B6B3198BED1C082BB693C59C3A239E2423443FA45E23C58C635301DC332468F310BB92CBCBBC435C0FB3C6A3FC3C1B53C724509BD6E4402398EC49339CF410AC05EC492C40C44A63C91B5D93A7942BE34E4C32F3A74BEFC415344A5C3283E7C40EC3C8CC1C8422CB58F43254039C0D0C0E2C026B9FFBC684435C122BE8FA6FFC567A7F9BEC838623A95C215C1443FFFB48040B0BDCC422944A8C7E1BF823D2AB24C44CE44784583B208BCDB3E363E1B40C935D4C88E396DC317B583B83244A241F13AB844F5444DC30C436D390542C9443738194259B003BFBABB0FC1A7C0754170470D41CBBAF9BE10421FBECC43C03635C49FBEFF3F32C40D3C262D7EC370405AC2CCC06B3C88C59A447EC5F035D5BC08C1033D68B8FCC3A1C122C7CB4415B82EC0524326C6FDC01C468D463F3644C56B225B41C8382EC0234393C537C4E2BCB44470C4804074B862BA823811BB4CC090BC1F428B396EBEDD4290BCE94012C3E0C255BB64433EBC1FC00C4015432AC42DC0573C654013C2FC44BA4446BD3D32793D3EC0213B85C262BCC5C2B545EDC03335D4B9AA4560B75134D1BE53C0BF43EAC4E4AA14C19F4052444740EA4145463645A83D874539C183C31240E6C2CFC3B13F8941F1BCEBB85044323CD99E16C630451FBC48BD73C4A3B0EF41FEB13B3DE9C44B39F7396E40ECC026383F40D9405EBF1EC0E72C78BFDBC119C4FC429BBF6932BEB44A3DD1C1DC4078B4E6C29739A1BDE03F7CC08AC52943C7334540D2C1EBB8D63103B4D6BC6AC5B6A0C7417541D53F22443EC758B663421B3798C01F3796C33BB7B43D0CBE4145063A013C51BF62BC62C606C476AA49C12DC0F33A73B47D3E5B44"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0xA24193BA959C154112BE42422FBD133187BFDEC039421ABEA6405041DE3EA43DC1BD4ABD38B167C1EABD84BE7DC2183C84C42F416934C13FEABF173FC04672BFD6BDB93BBD3D03394F44E430484110384FC4FAB56644DDC075BE563EA03B8040873DB7C10048B6BB2841453A59C1A71DE83AD4C4A3358C3E2CC1C3B829C0CDC121BD29C4FBBADFC07F44442D26B9EFC068430A3E903B1CC62831123E9F403042AF3D463DC1401141774152BC364027449C37282EA73F26C63B3E7930714285BD5BB601C4CAC161A15D41A33C8FBE4FB928C57F4116BC884055C1094020414F44224273BD403E08BCCD3906B57643E1C37BC05845FEC20241BFC058C16FC3B8C3D430D34238468E428734FDBD783E16C17C416741D0BD6D449FB414C68346EEBC534271C77AC1DE48D0B9A73661BF0B2D4B3924C12540594720BCB9C489B2AEBB1D4343364C3CD4B8AC424FC49AC5E136E9C203BEA845543D68C54AC6793701B8A4410146273FB9AF97C5E3B2BA41A8C11943DF3646C3D9C226AD2E45F542463E593C6140A6202C3D53BD4BB891C012B7433974420543472ED9B08FAF8B41EE3D393B614479457844042C8A41FCBF16BFD83D27BC46C480433FC10EC4FF465DC4994017BB5DC45738B746A6436BC029366BBA5243A1BD963D52C581C0DB404BB462C48A23873DD5C534433845FF4109C0B8BCD0BF7FC47AC134C370C237C37D3A65B721420DC4B6C22A3D60C14E3B294699237945ABB336BACA41923FAB410DC68BC23A41644086C03FC2B6C5C9BAFC40DAC1D4BFEB3AFEC46F44B54288B9EF3BECB9B84055378BBFA63A0AC0DB40CD40FBC76FB006363746443F1844B6449EBE303B02BFD03CA1C50EBE26BFCC3593B917C32B3A0B4132B459C8BB47FCBC08BF0D44123EAB40DDC4E0419EC2F4BEC130F62B8B442332DFB5A5324EBC4142F4C4494414441BC045BE51C4393F66BBF0B858BB4BC60540A83AACBC37BD8DB6939D7544964460C6C13D87C540469BB6CAC094B95336A1C03133403281BCE7BEAC3AAC3945ADCEC4CB3BEA3EBF4074B8AD3DE63C6F3EDBB978B905C26B488FC78242FDC010B885C3A1C561C29F4084B91BB8E23839401944AABDBFAF7EBC59BA3D3B"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDD443F40F142A238403C1542C93C8E372DC4D6C24241D83E5E45AD405CBC68328FC640C029C0D9C800AA9839AEC1B23644C6DD44F8BCF544BEC47C3EBB489FC4A8C4263F4437B8BCFA45803CDF440AB872C11040603160BEE6C43A4347C40834D7BCD8C55846E5466E46F5C1D23DD2B4DCBC9AC37C4480B781C414BED63CFDBCA0BEE83A1CB3CEC1B9407CC08AC77DBD1446AA44A13B36C5BD3F6C4078457240B23872465D442644AC4435415C464C42573CEA384CB486C56444163CC8420EC29CC1F1C42BBF5EC3C6429A44D93F5045DFC331C31FBB2ABD0F436240BA3F8842A8BEEEC29E41C43A50C0E73A964833C56140F84506C867424038B1C40BC837C833449344DF4522440A43CEBCA8C014BF843CB245BE41D438003DACC3BE4702C48E46C4C72A3CE749ADC1F6BF49C485B8B3B8583F40B8D0453ABC5CC976B368C12844C23C6FC04AC227459FC4B4C2F0BB40AB504100C01AB908C47BC6C4444E442548CD453E3A5F3E0AC45A3F73423ECA3E4491C2E9C3FAC31D44FF4759444A460B46D8BD1143E23FB73E404406BF37412D38E53D1641DDC0F5C039411B490244E02A46414048E041EC43624234C6DAC2EC423CC586C2A9435EC658BFA443C3C6CE426BC6A033F3C416473C41BAC48D3E6ABD50B539C4BCC538B886C16835C94244C9F5C07E47C039FC4300AA05424839A8B80BC46CBB28C8D1C770C4623C41C3273F0441D9C496C18636D6C448B39C48A939BB436242ABBF5A4592BED4B8F8C6C836363E5030A0B3B036F0C8DFC12843D4B9FEC4D94540B43B4219436A3984BCD43034BB1AB945C58A467CC48141B03EA2C0CCB82C39834488B5F84780B2D5BE90BE78388645FBC2C63D7C449345BD39EE3F5CBFF0BC183F12CAA7436A390A3CA241393BA646A1C3DD41B2C8E6420EBB08BD002E002A33413825683322BF4BC408454B4684C432BC63C03B4488C15AC1BBBA14C858BB88C2A64069C2B1B2D4B4C845B63EE4C3A33C7DC8F34648BFD0B6E1C125C5103D7C37A94009C4AEC0113C55372ABD1CC9B83B9E441A459B3D8D4504C6D93CEC40AAB34EC5A448ADC99B4146BC0AC0FA3DE0C460C0B43724BFE5C6D4C21F40D23D02C3FB399BBDA13A4345"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
