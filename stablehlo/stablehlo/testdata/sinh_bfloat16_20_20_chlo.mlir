// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.sinh %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC94045C09340B2BF53C01EC0B0BF3FBF9D40264031BF8D4088405FBFABC0643FC0BE973FAABFF93E5D401C40CABF93C0AE3FC7BFAFC08BBF5A40E0BF02C0A3C06BBF0BC0B3403BC03D40FE3F5440BA3D1A403A401F408BBF9ABE27C030BE7DBBC9BC39C033C0D0BFC8BF91C022BF38C0F1BFB93FD740B53FC3C0CA3ECB3F1B40DAC0474096C026C00B4023C089C081BF7B40CA3F9DBF25BF90BFE13F20C01EC00FC063C0EB3FDBBF95C043C094BFCABF48C09540C3C09A3D5840D23EE4C0A23F02C022C02ABF3D3B6440A13F26C009409A400B40FEBFF6BEB9BF324001C08840F33E633F90C092C02E3E7B40D03E2FC004409D409F3FCD3F94BF0440B5BF8140A43E3BC052BF3E3FF9BF8BBE1BBFCCBF31C08F406CC031C0B63DFABE95C0F83F7C405140003C033F9540D43F8D4050BEC8BF87409C40DC3FB2BFCA3F124028BF53C0C53D813FD83F4B40F53F993F80C0DD3B34BF5940F83E4AC011C015BE18C011BF42BF23401FC1D5BF3BBFFEBF9CC05F4062C0F6BEF04031C0D7BE793F6D408B3F5A40904039BF6AC0BFBF2640D2408B3F2E404D40074016C0B3BFB73F4840FCBF0540E6BF99BDAEBE7BC089BFE9BE2BC0E0BE14BE4C407A401F3F62C074405AC08740F13D083FA23FB7BF24C0AABFACBF01C08ABF14C095BF19401BC0954078C009C0E13F313F3B3F06C0563F74BF823EAABF19C04DC013C01F3FA2BF3B40C93F8C3E52400B4092402A3F86C046403E40CDBF27401EC0324015C0B4C01EC007C041C0BBBF47C0C3C00B3FC0BFCDBF1340F33FB0BF9DC04A40D040933FA93F13C090BF3A40043FB8C017404A40B8BF45C0643F34C001C0AB4089BFC7C006C0D23F59C0304096BE72BF67BF15C013C06FBFE03FA0BEF43F1940883F7EBFC0C039C0A440F6BEFA3E8A3F25C0FBC0DE3E40BD5AC084BE0AC06BBF95BE2C4006C10FC0014035C0A13FAEC034C0304085C08EC082C0263FB33FE2C05C4017409CBE873E8C3F1BC06EBF6E4029C091BF96C03E403FC047BFB5C0FDBFDDBE20404E3E5B3F23BFB03F02C053C06BBF53BFA8BEBBBF62406940CABF474081BF04C032C099C0303E4D3EA2BF81C02D408F400E40B3BF1B40554092C09A4098C0BCBF42BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x86432DC14642F1BF58C1BCC0EDBF51BF8742D5403FBF24420C427CBFD1C2823FC5BEBD3FE1BF013F7D41B64014C046C2E93F11C0EDC2A8BF714133C070C0A3C287BF8BC0064314C1194164405B41BA3DB0401241BF40A8BF9CBED8C031BE7DBBC9BC10C103C11CC012C03AC22DBF0DC14DC00040CF43F83F5EC3CF3E1640B340E3C3334159C2D5C08B40CBC011C298BFCA411440C7BF31BFB0BF3440C2C0BCC094C08BC144402BC052C228C1B7BF14C036C152425EC39A3D6A41D83E1BC4D13F70C0C8C037BF3D3B8D41CF3FD5C0864076428B4064C000BF00C001416CC00C42FC3E813F34C240C22F3ECA41D63EF5C078408742CB3F1840B7BF7840F8BFE141A73E14C16ABF503F5BC08DBE25BF17C0FDC02E42A0C1FDC0B63D02BF52C25A40CD415141003C093F52422240244251BE12C0084283422D40F1BF14409B4034BF58C1C53D983F27403E415440C03FDAC1DD3B43BF6D41013F3CC199C016BEABC019BF55BFCB4022C623C04CBF64C083C2824189C100BF6244FDC0DDBE913FA241A83F714134424ABF9BC107C0D540B143A83FF24045418240A5C0F3BFFC3F364161C07C403CC099BDB1BECAC1A5BFF1BEE6C0E7BE15BE4141C741293F89C1B54171C10842F23D0E3FD13FFCBFCEC0E1BFE5BF6CC0A6BFA0C0B9BFAD40B3C05242C1C186C034403F3F4C3F80C0703F8DBF833EE1BFADC045C19DC0293FD1BF144113408E3E55418B404042373F04C230411B4118C0D840BCC00141A3C00BC3BCC082C023C102C033C15EC3123F08C018C09D405140EDBF87C23C41A643B63FDF3F9DC0B0BF12410A3F1DC3A8403C41FEBF2DC1823F05C16CC0D142A5BF7BC380C01F406DC1F94098BE8CBF84BFA3C09DC08ABF3340A3BE5340AD40A33F95BF4AC310C1A84200BF023FA63FD2C09FC4E53E40BD71C185BE88C087BF97BEEA4008C594C06C4007C1CF3FE6C205C1F940FFC129C2E8C1323FF33F12C47941A8409EBE893EAA3FB3C089BFA541DFC0B2BF59C21B411EC15CBF0FC363C0E4BEC2404F3E773F2EBFED3F70C058C187BF6CBFABBE02C08941984114C0334198BF78C001C16EC2313E4E3ED1BFE1C1EE402E429140F3BFB3405F4140C2764267C204C055BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
