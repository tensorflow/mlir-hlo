// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.exponential %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x833F1BBF0440C0BE0140F83F0A408E4057407D3FBBBFE0BE5DBD5140D9BEB340014014C01CC07DC0E83F533F67C0BCC031C09340A63F43C02A401F3EC3BC80400ABF3DBF1BC0034099C00140834031C0F8BF83C0574042BF65C0EF3F29C0DCBE013E6EC084BF4640F0BF3BC08940A73FE5BF68BFD93C6FC0B34083BF514071BFF93EDEBFA9BFB23F26C09F3E93C08140EBBF6F403B406FBEF13FC3BE59C0ACC03AC07BBFBF3F8CC05940E13FC5BFA63D62BF954082BF884070C01C40CD3C47C05AC0A23EE73EAE40B9BCF3BF28BFA3C0C33FA5C0BC3E6BBE943F903F68C02F4060403D3F80C0DC3FE83F3ABE893FE73EBA3F5340DA3E023F793FAD3F3DBF31BE2740B5C08DC085C0633F7D3E81BE763F983F9840BAC0AAC0D9BFDFBF53C055C08440843E433F77401B40254058C0C8BF69C02D402A3EE13F05C092BE1FBF2D3E5B3FED3F6F40233F59BF2BC022C0D3C0D53E5DBF423E58C0274050408C4016C1B73F473F4D3F6A3F95BF2240EFBF5FC061BF96408740A23F1D40923F31BFAAC0ADC0AF3F1CBFFEC096406FBF1F3DFFBF2940A0C0CD40493E574081C0363EA5BF60BFD43F84406D40C340DFBF2F3FD03F87C032C061C07A3E81BF713F5140DB3FA2404B3F40400D40544043BF2040D5BF3D3F2A4083BF63C01BBEE1BE6B409ABF094049C043409E40123E3BBFE43D52C0A53EA140B6C064BD35BF7D3ED83F3ABF3AC0714077C03540ACBF81405A3F1EC0CB4088BE63C0B7C0D4BF6D3F83BF2AC046C054BFA83E6B3F9C3F983FE6BE28C00EC055407240B83E2D400FC04C40FFBF08C0C6403D3F033F523F0F408CBE383F05C0A04052C023C0813F1A405DBFFCBF03BF563F154001C0F6BF31C1503FA240073F8140AABF3A406F3E36C0E7409FC08EBF9A3F2E4001402A40C4BD923FE2405A3F66C065BF8FC03AC0E9BFED3F00402FC02D4059BFDC3F733F71C0E73D673F62401440B43FEEC0D03DF0BD80C083BE9D40374046C03E3F97BFAF3F0A41A5C00BC06E40BA3FA140674068C070C0C03F113EF4C0944022BE65C047C003C0A4BD87C00D40A8405A4050C09C40FCBECFBF14C01F409A40953F3340AD404F40643F75BEE3BF4F3F4EC0E33D2EBFACC04AC0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x32400C3FFC40303FF040DE400A41A942E6412C406E3E253F733FD241283F8643F040CB3DB33D9D3CC4401240DE3C383B813DC6426A40433D6441963F7A3F5A42153FF53EB63DF840093CF0407042813D143E893CE641F03EE53CCF40923D273F913FC73CB73EB0411D3E5C3D91426C402B3ECF3E833FC43C8643B83ED241C83ED03F353E893E8140993DAF3F263C6142233E274295414B3FD2402F3F0A3D983B603DC03E8E404E3CED41BA405C3E8B3FD43ED242B93E8C42C13C3741833F373D083DB03FC93F66437A3F193E053FC93B9340BD3BB93F4C3F4B404540DA3C764104420640963CB240C440553F3B40C93F8940D841C43FD53F29407740F53E573F5941653B483C803C1B40A43F473F27405240E742443BA23B3C3E333E183D133D7742A63F09403E42344153410C3D573ED73C6F41973FBA40003E403F0A3F983F1740CC402742F23FDB3E8E3DA33DB33AC23FD83E9B3F0C3D5941CE419F42B23886400B400F402040A03E49411E3EFB3CD53ED942884263403A414840003FA23B933B7B400B3FBB39D942C93E853F0C3E6041DD3B17449C3FE641913C993F8D3ED53EA84077422242DE43333EFE3FA340713C7E3DF43CA33FBB3E2440D241B1401E430D40A1411141DC41EF3E4341423E06406441B83EEC3C5C3F253F1D429A3E0841313DA8410B43943FF73E8F3F1A3DB13F19435E3B723FFC3EA43FAD40F83E603D2D42AD3C8741863E61421640AD3D0E44443FEC3C573B433E2240B83E903D3A3DE03EB23F204059405240233F943DDF3DDF412F42B73F6F41DB3DC2410C3EF53DF3430640D63F11401541433F0340003E14431A3DA03D2F403141D83E0F3E193F14402441083E163E843710401E43D93F6142883E9241A23F6E3DAB44E43BA93E55407341F0406441693F484092441640E13CD13E3C3C603D263ECC40EC40853D6F41DB3EB2402540BE3C8F3F1E400942224183401A3A8E3F643F963C463F07438C413A3D06409D3E7B40AE45BD3BE93D2542894019431442DA3CC13C8F40933F003ACC425B3FE53C373D043E6C3F713C11413F43F1411F3D03431C3F4B3ECB3D4041F6424D4083415F43CB411C404A3F2E3E1040243D8F3F023F983B2E3D"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
