// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %cst = stablehlo.constant dense<-1.000000e+00> : tensor<f64>
    %2 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %3 = stablehlo.compare  NE, %0, %2,  FLOAT : (tensor<20x20xf64>, tensor<20x20xf64>) -> tensor<20x20xi1>
    %4 = stablehlo.multiply %0, %0 : tensor<20x20xf64>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f64>
    %5 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %6 = stablehlo.subtract %5, %4 : tensor<20x20xf64>
    %7 = stablehlo.sqrt %6 : tensor<20x20xf64>
    %cst_1 = stablehlo.constant dense<1.000000e+00> : tensor<f64>
    %8 = stablehlo.broadcast_in_dim %cst_1, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %9 = stablehlo.add %8, %0 : tensor<20x20xf64>
    %10 = stablehlo.atan2 %7, %9 : tensor<20x20xf64>
    %cst_2 = stablehlo.constant dense<2.000000e+00> : tensor<f64>
    %11 = stablehlo.broadcast_in_dim %cst_2, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %12 = stablehlo.multiply %11, %10 : tensor<20x20xf64>
    %cst_3 = stablehlo.constant dense<3.1415926535897931> : tensor<f64>
    %13 = stablehlo.broadcast_in_dim %cst_3, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %14 = stablehlo.select %3, %12, %13 : tensor<20x20xi1>, tensor<20x20xf64>
    stablehlo.custom_call @check.expect_almost_eq(%14, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %14 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDCF8BB917295FBBF68AAED1AB0B20540387A47469B321A40A0A0F89CCECBEB3F5E287CB799A0FB3F54E35A8C678304C02F331A1855E4FF3F9459026EE954CF3F7484E0C2B6B510C0409D09D003FA01C0B534AE1DE69CEBBF2A678A3AFD7E0040E289D7FD9A54F33F8C192BD05E820240E82B28311004F7BFB23B3234AFE3E0BF0248BF96435B04C070CF045BF0EE0540A2C06B9930FDF6BF5627420A986F07C06487A336587FF43F46138992292CF5BFF426C73E7247EF3F957902FDC0E7E23FBA0222D6F0B2C23FA5E5F6D9B1EF82BF9C87E67D4D90C73F76CCEC17C595D4BF85B3DC01738D08406E2E8D3DAF14FC3F9D993421813213400D6C38AECC4A1440F21594CCB983DA3F097043ADA0C510C01636FB29C0170E40189ECD8EB73E0C403A70B0BD9061FEBFFBAD46C1F8F7F43FC27AA3BCD75E1640D2A3CEF44DBFF2BF8C2747BDAC081240DBFA242834DCF6BFEC985F58FB440A409A802422205CE73F16C5F503F616E2BFE671744689C4F53F7464D66A7940DF3F06EBC2DDFAA51340C3798DD87A98D3BF6279CE909AFB08407256521B4140F9BF1D5BE843D453D03F086534F5057D05C0BCC1C97DBABFFF3FFD3DA0C5855E04C06A6A5C7A8EC91EC08F62DF004C170240C82E627F5D7EFF3FCB121A57C9B91340600BEDA2D0530BC06600E2B3CE30F13F3C3EBB1B7D1A0940CF7E588DD4290540D0AB80683122B83FA7CBC8518CFC17C0F6DEC1444C53F73FA807D6CAC3D80940A1F5F7416D93D53FF8E24B03554E1AC0B8AD0B6B6B72CF3F1C0EF86E63CBE13F62541AC34FC01FC06A282ED236091940944496D501A203405667456D372606400440ABE9C40AB93F620533223CC9BEBF8525977DB4490840E6E096B2F5A404C069937D01B8CA10C068DB88B7DE3F0C40845FF3C4C34E0E40272808DEE43C02405AF3D7AB00B20540461E54F324330940433631BD44911F4070A3A3FAC241E0BF542E66920D9F1740790017AF402E0540383D5E50E03C11C0BEA7AC5AEEB00EC04358B65AB54BEFBFDDA8F13FD4960740546B5232E9A290BFE93D517325E51540289037C861BD024024C365FFD12CF03FAC83D626F2EA1C407E762963FC541440D179B676D7DF0B409CF624A352AEF7BF6A82389A3C77D6BF26C1EE03F7661440248CD2D4691E104077193A100F5C07C0BED04D025BCA03C05039FB727B0EFA3F52D350B62278FA3F52E758EBDB0D13C09DE53CF7F3DC03C0EE25ECF57F930DC0A1F4CB122288EABF7E0AB3A405B5F3BFB34ADF2BDE1EF63FC23B3A062609FCBF9DCB7AA1E29603408F7D54800C9515C06092AECA66D20040976014AEFEAAC73FB24798B18E1E10C094BDF6FB100BB23F36DAED213F04FABFD5D5DA485FDE1D40BCE35036F82A14C0E1E489C2EA7B03409DE5B9BB34B30F404E953A58037B0FC0FCDA66757052F3BFDC45CF861007F53FD86F027C0700E2BFD72C2124F4C61640203B89CDCC8AF5BFE41DB6640F24EA3F571B9F1C025DEEBF8C6477AF49A2ECBF54E98570337905C0F7DC0FA0CDE0F5BFC122E9620BEFFD3F33B1E48CF43008C01E0BC2032AD9FB3F369C629E261DFE3F087918EFB30D0AC0148F5402A528FE3F8A6D13E1CC600640998D44B4D13111C0896E3230B5E201C0F91FD0FA80B30DC088FC52A565BA17C0F23EA881B28B0C40EB049C3D2931F8BFF45E1D82C7F5DCBFFF2DC7C78E89F6BFB78817BF7F3DF5BF3011EBC7C14312C0DFC76A241DB6D33F54734966C24F06C0E9C01B8B05FCFC3F1E6DC5F5458508400D91BD7EA09102C02D9D7DDCC082DC3F2885D6AA34DBE2BFAE926F859E97C13FE7E63E987C1A06C0B4ED25D83381134012BD54602EF6C0BFFD4924A9CEDD11C0344ACE121BB211406E9234BE66E90FC0DE0C022921BA08C0385E9BF5152D01C0EDAAB8911CBBD23F52322BE68D1507C0DEA620D1A7AA13C078D7C0594FEA0AC0BE6C9839626BFE3F41BC4AF91503BBBF64ABBEBE2A41ECBF3240B99BC43403C04097B9233E20FA3FABEB8A3578A4E5BF7C3EA40CB820F43F4E01112E264F05C095CD23628E5F0AC0B07F683B191A853F608CB77603B7FBBF000E62D99EB60DC0BC4CEA060766EABF71B4231CAFB3E33F6C9F2AA0539F134036431871364CE13FD260161222C807C06947ABEC2F6CE53F7E2E81B939E407C0F1350735CCF8E3BF2EE7DA095ECD1740FCAF5A4446550AC009E9D2D0BF89D73F0DE6AECD509DFABF958C7865BBA9B43F5AFFA78C4AA9F93F7899774FD4F20940C8706BF424940DC021EC880E2B9B0CC0922D17B4CE5006C03A79905892DF0740F6791737A98EB5BFA785842E90A712C03BDA7670F093EB3F314A50E1DA160140C21A1C9D298FF23F328658FCDF9100400A3B134F00260C40843F8F85F8340440954C67AA0D9B07C0D59CE0ED112CF13F4AC1BEDB274EFABFF4B08D2D8F0F11C0320238DF6180074077F1861216E5FA3F20288127BA77F7BFDD6FEF71BC3FC0BF8F4B7AC38AE4E7BF1CA8E47D26FEF03F8E30449251A302C0DCAC2B96732F00C0D64BDFE07B25FC3FC401D947805710C0CEB012412AEC0840AB7413AB7D41EA3F90FBB9DAFD90044080F2601D2F3CFFBF3C4F2C6FB92605C003E1B75DF37CE53F74761E9FFD71EF3F5B67A9640381EABF327BCCE12FBDEDBFD9572D27D19407C0D542E160486201C0AF0C6E6346080BC0A44731F5DDF2E0BF90840FEA6A7DCE3FF453736A337C194090AD86C01CF80C40EB5222D77ECBE23F450B49953C59004011EDAFB3FA700D40E9C67623BAEC14403282F393735A114048E6C55A78B5054020AC2175F6BAD8BFB314D497625305C0386F559B7BA6E3BF92B61FC8DFAFFB3F8CB7E47860E9F13FFF50C9949DC2FBBF12F9C0B8223414C0E66080A1B91B1240C8F11A2BA3A51140AA0A2E641C49F73FC4FF680F0C790A406B0696B1FED8FA3F1019A9F006C71B40542E4E83FA58F73F6643C46B42F00240A6B97844A1CBF5BF407BFED45524DB3F0909C3BC00F800C0A9958597030FF93FA4E28AA300FD0440EABC3F321D280840FE95BC65966AF9BF763101BF77001940C63556E6F92FE2BF8370D369C547E1BF2695E0861E060A4055AA61E006E707407CC167486B9DF03F9DA3A97585CC03402026D887ACDC0240323C3002281C074004A503BCC76803409BFF23DE5180FB3F60BB8A312350014094E8F0125565ECBF22999DD6E7C91A4026842E69456AE63F2A82D549C7BDE73F84F0E62103E404C02A445D9957DB0540B2995627435D0EC05B2D48F6431203403A308A990CD6E3BFE32B024A1C14D1BFC6AB13B4FC2409C03CE9429664871540BC00A42B90BDE1BFAF6CB53F25EDF13FB5516380F722DC3F94964FE6CDFAFABF435AD915293C11C03C5E16EF2C03FC3FEA9026864149FA3F2F2F612E86180940B578D1148E7B04408CFF2D53C2B9FCBF856380DDCF4FBB3FFD94A8D2A5C60640A25439588B40EDBF9BEC506C8B43B23FA8657F652C04FABFDD352771AC4505405882F8A6C4270F40BC4533BDB7B11240215591558BCB05C048DF167BA2DA00C0A211FE362ADB0AC057D8AA74C395E8BF26E854F55C1B0940F7029D15454D03402A4A2CF6A104F3BF52CD79D68963C63F7A97AA89EC9B1540836F1A4503F2F23FC03F6CAF35C1F6BFD003959ADA4D09C0EADA6EAB07C9F9BFB833C2610F98DE3F399912E501210F4043C7DFE0F7FCC0BF6E3CA68540D8E0BF1F0560B20EA30140358101B61F220DC048AF4E30DD5E05C0D09501A356C199BFD2FE4E9F9CE700C018AF15E488BD0540915BD96C283B76BFE70A2B72CBAA01C0AE70DB74E152D1BF7AF84A43050FF6BF30B6C23BDB9F04401C87F2B7879218409091296F8F851FC04AAEF44D7AB103C02ED54E38969511408EF376F279C3EABFE15E19278D8BF13F0A6110A82DF0F03FBA005C94DEF702C0E6028D3FC5ABE0BFBB6293AD727D074068E2A942A040F4BF7460104E796B104084592BFC942016C04C8A48C9A928DC3FA6490717B26210C026E83C1C7A7DDF3FD1E23FFC10D0EF3FEC3DB8C17305B83FB565731A66EDF13FEAB39D3EAF54EF3F0372EB2F74B762BF9EB9318994290B4036391E98E30C813F12204FE67C588EBF9284EB0EFDC215C028CEB8691A41F2BF35108C2C0AF9E1BF5E909E5B62D7F73F611218399859F13F631D9BB8E6EE154054D3784473DF04400421CE4EE28117C0526992D3E80D17402CFB53946472EBBF220D842147CC10C0BC18E48E642BEE3FC62B0083FB93F13F720565B1BFBFD9BFEC9D44105F29024032FA0EBBB86614C03BB6E9A62450FB3F90801919BA06FEBFCECE533999C800C0B121637B975DFABF8CB45BF48F5CDFBFCC0AEC13FC7700C0727D576D235B09406092EF1D966CE63FDB7D4DDC95E113C0CEB703F470BF05409519A742C88DE2BF9FD0141309B10A401F14B1F8D8D0F23F84E10F4C1390E23F7278233BC2831240D8F6C1CDADA404C005AE14FE874EA13F14922DB4610307C0DFCAA90E905113C0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x000000000000F8FF000000000000F8FF000000000000F8FFBBD42A127996E03F000000000000F8FF000000000000F8FF000000000000F8FFC0E57258132DF53F000000000000F8FF000000000000F8FFC790FCE0EDE40440000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF64309924AE030140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF3913A455AC38CB3F33C624F94E0AEE3F9273661477C9F63F6D1F56DBDA47F93F7159C25D9E2BF63FDA8ECE73445FFE3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF40D9CD05534CF23F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF0579C80E5214E83F7B1220156E5F0140000000000000F8FF78F450D365F8F03F000000000000F8FFAE5ACF9B921CFE3F000000000000F8FF000000000000F8FF1E9CD60C5801F53F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF3403213C459FF73F000000000000F8FF000000000000F8FF000000000000F8FFCEA7997288A1F33F000000000000F8FFEC4A375B4529F53FC0C8EFFC7965EF3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF36BDF2BAAA90F73FF4EB8106C10FFB3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF9CA438345BD40040000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFB4E6146484730740000000000000F8FF0435EDB88764F93F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC83ECA5916DFFE3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF9CBDD1CDF7620440000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF9EE9574C3928F63F000000000000F8FF750815F10C01F83F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF1C646AF17C580140000000000000F8FF000000000000F8FF49F6999A41ACE33F9CB550DD2390064088520C3D306E0540000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF0AC66696AA520040000000000000F8FF000000000000F8FF000000000000F8FF8D06F82E9B1FF43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF7F877C50D0BEF13FCD85EFEA849B0140D22BC9E53DEDF63F000000000000F8FF000000000000F8FF831578065B42FB3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFA4872F0D6561F43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF4867420BFBD2FA3F278CEB182C390540000000000000F8FF000000000000F8FF2C7EE5312C820240000000000000F8FF000000000000F8FF000000000000F8FF230DDCF0C6F7F83F000000000000F8FF000000000000F8FF09CDF7D8CC530440FCE0C09B960AED3F000000000000F8FFD08D64648EFDEF3F000000000000F8FFC0235D4052CBEA3F000000000000F8FF66E227CE5AF50140000000000000F8FF000000000000F8FF32781C2A551BF33F000000000000F8FF32CD967203D7F73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF0E39FF974E7BFA3F000000000000F8FFEA13C20EE805E13F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF42D7E7045B2BFB3F06045D36794F0340000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF52BDDAA80079E33F000000000000F8FF000000000000F8FF000000000000F8FFD23ECB11BAB4EA3FB5C5D6783BDEC73FB14D58B2C95F04401B744A8A801B0640000000000000F8FF000000000000F8FF000000000000F8FF54327BED260801404CCDC57ED548F53F000000000000F8FF000000000000F8FFCAF20933472DEE3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF5EC3C0BB047BFF3F000000000000F8FFAE8B415826DB0140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF3EEE842A1920F23F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFF64C7E6605670140C02432ED45210140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFD493DEE49A4C0540000000000000F8FF5793B41A7C6EE93F8D19451D1384E73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF198A30A042EA0140AAF0BA826A74FD3F000000000000F8FF000000000000F8FFEA04D8F574440140000000000000F8FF9DFCCC9584D9F13F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF718AF806296CF73F000000000000F8FFF951206C0FCB054079DB350283FDF73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFEF8FA0DA59930340000000000000F8FF000000000000F8FF000000000000F8FF194565C4D551F63F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFE4F855DA7C28F13F000000000000F8FFA52501263643FB3F8D9B4A2851000140000000000000F8FF000000000000F8FF000000000000F8FFE137DC760389F93F000000000000F8FF000000000000F8FF733AD8833638F93F000000000000F8FFE40CE544B584FD3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF637BC7E0C37D0440000000000000F8FF000000000000F8FF000000000000F8FF46DEF97743F30040000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFE95E37A5EED7F13F000000000000F8FF230D43A2E6E6F03F47938D6109B5BB3FA45DB62213A1F73F000000000000F8FF9DB78CE82C39CA3FB4BBE40E572BF93F000000000000F8FF4FB14273E1FFF83FAE3A9FDFAC5EF93F000000000000F8FF000000000000F8FF2EF2321860560140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF202B403515D00440000000000000F8FFECDBA8277BC0D53F000000000000F8FFF62F4D6BF7C1FF3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFA32D27F2CEA90040000000000000F8FF000000000000F8FF883906733D6BE93F000000000000F8FF000000000000F8FF3873B5BFA9830140000000000000F8FF000000000000F8FF114E88B97576EE3F000000000000F8FF000000000000F8FF30BE81538097F83F000000000000F8FF000000000000F8FF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
