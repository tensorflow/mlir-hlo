// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.cosh %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xBDEDB140AF8978BF6A33D2C0D79628407B3784C0A858203F7BED09C0E688A23EE435FEBF14ED5F40F9FF893FE5770EC0DA760BC008C1ADC0238147C090AF3E401A4C2EC045EC1EC08C7282C04E369640F76C99C03785AA40607F8DBFD90E1E4098D34540C56050401CD0044099092E400E1087BE9805143FF8BECF4075F6CCC0E61517C09419E2BF80F34340652E3E40FE7CB7BF8A2E3F3FA7AC064015366DC097D41D3F448CBB40EB1BA4408DA444C0188C43C0D5FE193F7FD7D5C0E8A891BF054114BF33EB2B404C5E14C06267FEBFDDC485BFB846843FD20EC2BE625FAE40617F7FC0FA21EC3FD0A2133E7E606A3F05F3D13E524890403CB9E8C01B9D3740435AB1BF9E083F40EB146CBDB128823F5E6B104016761940002B534013263540DD0FB5BFEFBE30C02FF4743F3C8E9CC07D3731C0FF0EAC40E066843E33DBB43E07A78CC09A71DD40D53C03C06B7917C0155F82BDE096973F65D4FDBE9BB9D8BF65C206BF5FAA78C0BA845CBF8C48E63F826C9FBFEB4BF8BFC1CFDE3E0E842ABF6F3D9DC05123C3BE7E1B814018F0FB3F620B943FB0F89E40044B96BE52ED594067A730406C4121BFBF81B240C15F03C1153344C05419C73D9B0125C0E7C56E3EB9ABBEC09C0F2740BFFA8D403D6DE93E68BB9740889686408EA18FC05ECAAABF3B10FB3DEE220C40C02B1040FCA19EBFF4690D40833D58BF26A005C03CBE72405CB8C4C0A7FFB63F6EBA06BD616EA8C01638ECC01810B4C04E3E2040D371E4BD6FFFADBE972617407A4159C051CFC440C52D1340CF89723FFBBE75C0A216B33EFEA2AAC0B79A6BBFB60200C10CDCC43FD80B85C0C27EC5BF102A48C065443F409A57823F7B3451BD5A2598BFB6F6BA3E06763040DB836B40CCE24F3FE9D432C057E7E7BFF9BD9D3F1ACA83C0D66F703F17D0CB3EE36C1940258890BFE9C78DC0B708593F3AD88AC0FB6E053EC39099BF25B035C0870970BF4AA08F3F7A2E78BF47778E3F991881409A27594071410C3F9BEF9CC02EF0A3BF500FC03E48282EC0C8BCAE3F8F2596C0E4495740F5F3723FD56C0740E186593FEC1F8FBE506C783FD49C84BF8F87E840F06449C04F738EBEC88226BF78E9AF403163ABBEDF8E9E40B6FD9840F014DDBF46D6B63F3677DF3F0ECE4FC05D39A73ECF1422408304B6409BEC4EC03EB180405E5EA3BF3C7853BEB2CB1C3F35AEFE3FFC9C5C3F8B4DC040D028FD3E7F6A183FCDA107C018C51F40848C953F6F0EC0C06AFE24C0B517D6BE9666403F9681BDBE86E9BA3F92DE2B3FB9A2124185C943BFF80D06C0964BF0BF9E4B103FD378DF3FA019433F0427383FD72A2FC00E4962C09DC41CBF0A7D2AC08F081AC0CB541D40F98A18C04E12AD3FCFE1B5BE3BE2F73FEF89DF40E7DDC2C0FE7A37C0FB3A7940F97A3EBFCECE89BFAE88FC3EF02F1FBF156547BE9D023940FC33C04005FC033F234C63BF0C6A3ABEA6C76CC02C445BC0772F7F400579DEC095DD4CC0A0E3113F58B5C640B642B23FA910B3C0BCF05B40CF5EE140ACEDAF3E7DA090BFAFCC81C0E00D94BF1E6CFD4050C625C056A24CC0E420E93F0FF3F0BFE2544A40E5BC4E400450383F7BF76AC0B07715BF2C2D8140C024FE3FD08A07BEC9F2EDBFB581853F21D51EC04A584440BE7B55C0C231BFBD96E495BF33F2A8BF92761DC00733A03FB79B0340BF594040BE3EA44098299BBF53D26CBE6D73BB3F828D0F40947888BF2F54EABF5BFB1AC0E4ECF43F6CA9A53F0208F13F2E71A640CC2DFBBF3B2E54BF3F4BFEBF4BBEA64057153340F4D9FF3F99EC03414835853FE2771E40F79D95BD0165423CFBBDF33F5B95E040BD19C63D28166CC046CF35C0914532400452A0407A03E03D1A079FC051F6413F68A2BFC0F347A3BF93061440588C3F400D7CA4401062ABBF423C80C0E5E218C07656DCBFB35F7B4081D94640C7BD05C07ADFAEBF63EB8B4007B3704008070C3CE9589BC07DE0BE3F3DDBBDC08A58F83FDF352E402EC01AC0013A483E5FA90740F4FF93BFED179FC01DC578BF6C4F884000EA0AC052168D3FFE26ADC014ECB5C04EFC33C03DCA40C0D2459A3DE6E02A40FA318F40C04FA040F984B8BF128F2F409BADF73F4851B3BF8FB1B640EB9573C08DCD97BF2C33FC3C3E197540108C5F400BB824C02B424FC0467C3BC051DE47C0B501504028E04C40C81B05C0F53BD84028D235C01259D240FE46D0BFDF9C40BF42CF68BEDD05C13C5DF11ABF67092A3FC963B73F12A17BC00ECF8FC0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD2F201437D36C13FEB1FB2438010E0409737F941A5F0993FC0EA8B400281863F0F8F6D400A6E844197E1D13FEEF095405A3A8F406E1CE4426B0735412ED31D41F5C2F440AD00C140B0D1EB411BA05A4284B77142F52FCE425881D63FAD72BE40F75C304172DA4F418C77814051C7F340C07A843FF0FF953F92F8A4438E3A9743E215AB40DCA94040A24A2B418B971C418FD10D404662A53FCC2B854034EEA241641B993F3B842F4311C1A842FF242D41F5372A4198DD973FEB96C7438437DC3F1B12963F01E9EB40251AA44097E76D403B7FCC3FA4A6CA3FF74D893F2C90E84239C2D84191834F402855813F9B7FB93FBDE98A3F17A73542DA09344473670D41AAE9074042AE1E417236803F6A14C83F2A7A9A408E71B1407A165941B1180841EC710B40153AFE409A34BF3F8C468542750B00411457D842C24D843FA811883F512D2242261CFD430BD67C40091CAC406A42803FE5C1E43F000E903FE6DB3340D525923FDAD3C241AA7FB23FF2B446403ACCF03F163D634017508C3FAA759D3F00288842E068893F4227E241BE8869400098DF3FC0B98F42EA8D853FDB3471416BDDFD40A73E9A3F50510443550CE64465F42B41F89A803F6EFED340DE7E833F3182414311D5DA40B10A2942E6888D3F2B4265423B30064238FE31421BF1014088F6803FBEB390403DE49940B28AEF3F418C9340C571B03F05128340779FB14196C66943E5550D40BA11803F1128C142BBD148441BE90A438FF8C44011CC803F7C76873FBE41AB4004B26E41886E6A438223A140ACDFBD3FB225BA4110E9873F29F0CE42F224BA3FE96EBA4470D61B4041C2FF418D8B1C40D7E53641FC411F41D24CC83FC02A803F7B95E53F1AA1883F681BFD409BAC9E411093AC3FA14A0341A51A49408023EE3FD8E9F54198BABC3FB2468A3F7A58B14070A5DA3F0FFF274263D2B03F904519429716813F39B6E73F803D09413A83BC3FBF65D93FF902C13F49D0D73FD212E241CD516E412AB2933F75DE86427124F83F981C893F4A3BF440C47D0540D62D5A42A17C6741E419BE3F53B28640980EB13FA708853FE325C13F8310CB3F36F33244EF6E3A4176FC843F4F0B9C3F2206F442103D873F96E18D42F0746E427CAF3940312D0D40D6F63C4080014E4156E3863F5DA2CA4010A91343FA324B41AE3DDF41E832F73F3ABD823FC8C4983F84666E40758BB23F51A24B43E2F78F3F405D973FCB1E8740D789C34094C3E13F44124A43FBF3D340B65A8B3F6AE2A53F47DE883F4C4111405AF29D3F7A489545774BA73FE1EC83404E0B564092E0943F13F93C409B01A73FFA91A23F4D15F840D664894179C2983FC0BEE640D202B3400754BC4008F5AE4053FA03406729883F5B896240281E0744F09E5C43A41C0D41A58DC441FA18A53FC3A1D13F4CE38F3FEE8D993F306F823FF3801041EEFF4A434C64913F26DBB53F7A20823F58D6A141C84B764169B4D741C8B0024481C944417C5A953FE0C2784349C408406BA50643F9E57841B2130F4488A1873F2AC7DA3F6118E741929BDF3F0AE4AB447686D6404514444107F04A4042175740772C3D41309C4A4109A2A23F81529D419C71963F43A4E2416F706D407A1F813FC0555240AB2BCC3FE9BBC0400A582C4166106141E68E803FBF43E23F6353004015B6BC40B009F23FC4417E4087F621411979A942C623EA3F3C70833F1CCE1140E3719840D0E8CF3FA7C04C400DA4B540FA925D400807FB3FE13857403584B542E0346840688AAE3F3EB56D40AA3BB74214CE0341DC8270409B18EE44D6CCCB3FCBA7BF407B57803F4E02803F649F5B40F4990B446A99803F7D18A041DC7F09410C280241C5E9954238C4803F8AFA8F42F687A63F966C4743E20DF73F223EA34083F41F41FCBEAA427C770240E213DC41F9E1AF40E7AC3840FB3DCB4187313341EB4C83408A9D054071811E42CB0BAC413201803F6B568042435D154061A53C4396526340B96EF44009FFB4406A74823F522E8740A287DF3F4E4690421B58C13FE49A0D4274088E405AF4D53FABDCDF427C38134397A90541CD122341035D803F6624E840F4952F4228DF9542BED70E40C597F94016306240FAC409400BD016436AF9B341F512E53F880F803F8346B84141A68341190ED34081424C41E72A1641B30E364186A74E4166D144413B0C82405B15D7430486094103F2B24340262940CDF8A53F8952833F1809803F4A2B983FCC499D3FA6B80D40D50DCC41F2FB3242"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
