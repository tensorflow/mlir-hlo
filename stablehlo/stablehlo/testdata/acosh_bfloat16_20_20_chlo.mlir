// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.acosh %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8EBE6EC00D3FFBBFD24088C081C0A4C0DF3F974096BF43C07DBF934051C048408DBF11C068C0FE3FC1BF93C009BFDABFDDBFABC095C02CBF15BEE4BF33BEE93F59C050406BBF3F40233F084087BF423FE740613F8FC0DCBF52C0A4C0304027409B3FD4C059407EC0CA3FADBE2ABF32C0C4407AC03F409EBF86C08A3D9DBFD43F5440CD3F1FC0AB3FE4C03140A9C025C0413EB440C03ECEBF953F33407A40F4BF0CBF024089BFD8BFFCBF39BFAE3FFE3F933E264055C0844005BFA5400E40B440AEBD6D401840F93DE2403B3F79BF55C082BFCEBF6E40C9BF05C0C1C0E6BF80C0A640B3BFA9BE79C04740AC40E8BF47401C40FC3F34C08F40833F8BBFEE3FD93E743FB3BFD9BFABC0204047BF0CC0D13F80BF38BE6BBE243F8A3FBFBFE23FE84079C0753F07C02B409D3F7E40143FD5BF5AC012BFDBBF9540CABF783F933E88BE3A4034C0A23E23C0803E41BF4D40C6BF58403BC0F73F36C0ADBF93C09A3F81C073BF83C0DEBF8E40B9C00EBF1DC0B5BF1FC010BF8D3E0A40FEC0994088C061C0663F69C0DD3F3AC0AEC0C63B0EC0373F40402EBF11C0C93F8A3F0D407FBFC03F8FC0973F193F2EC087C028BF3C4068C020BF5C3E4440D43F8FC0ED3FA43E55BE6C3FC23FF1C07F405F40B0C0613F26405AC023C03C40263F8C3F23BF3CC0FBBD40C017BE26400BC003403D3F873ED0BF7440E73C97C03A403BC03BBFB74045C03DC01F400EBEFE3F8CC0EBBEC340B6BF5C402140D0BED9BFE7BF3FC0FA3F6640173F884052C0A1C016C009BE8140B6C0873FE9BF43BFB7C0263FA33FC0BF88C007BE5E3F55C0083FA8BE73C046BF8A40A6400540D5406EC070BFA83D3B3F34C0823F4240C1C01E3EE6BF233F4F3F494015C09640E83F13C084C091C005BEE53FA33F8240A93F60404540BDBF8E4056C08540C740FA3FEAC0094018BD3240D3BE683E0540433FF73F783E0E41513E09405940E03E8E3FE140F4BF13BF443F873EC4408640E2C0483E2D3E004030C00D403FBE114053C0B53FE9BE7C402840324012403FC017402B4008C09D3FB3C07C4077BF263F524001C04F40D73E5EC08BBF0F406B4085C00540403F97BF834032BF38BE833EFA3F45C071C08DC0A44086BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFFFFFFFFFFFFFFFF2440FFFFFFFFFFFF943F0F40FFFFFFFFFFFF0D40FFFFE83FFFFFFFFFFFFFA83FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9B3FFFFFEC3FFFFFE13FFFFFB13FFFFFFFFF2B40FFFFFFFFFFFFFFFFFFFFD53FCE3F243FFFFFF23FFFFF843FFFFFFFFFFFFF2040FFFFE13FFFFFFFFFFFFFFFFF8B3FEF3F863FFFFF4C3FFFFFD73FFFFFFFFFFFFF1B40FFFFFFFF103FD83F0340FFFFFFFFAB3FFFFFFFFFFFFFFFFF533FA83FFFFFCE3FFFFF0640FFFF1440B83F1B40FFFFFE3FC13FFFFF2940FFFFFFFFFFFFFFFFFFFFFE3FFFFFFFFFFFFFFFFFFFFF1540FFFFFFFFFFFFE73F1840FFFFE73FC43FA63FFFFF0B405E3EFFFF9D3FFFFFFFFFFFFFFFFFFFFFC93FFFFFFFFF893FFFFFFFFFFFFFFFFFCA3EFFFF963F2B40FFFFFFFFFFFFD33F293F0440FFFFFFFFFFFFFFFFFFFF0E40FFFFFFFFFFFFFFFFDE3FFFFFFFFFFFFFFFFFFFFFEB3FFFFFF13FFFFFA33FFFFFFFFFFFFF213FFFFFFFFFFFFFFFFF0B40FFFFFFFFFFFFFFFFFFFFFFFFFFFFB33FFFFF1040FFFFFFFFFFFFFFFF923FFFFFFFFFFFFFFFFFFFFFE13FFFFFFFFF833FCA3EB63FFFFF763FFFFF173FFFFFFFFFFFFFFFFFDE3FFFFFFFFFFFFFE53F8B3FFFFF9D3FFFFFFFFFFFFF7B3FFFFF0440F63FFFFFFFFFCE3FFFFFFFFFDE3FFFFFDB3EFFFFFFFFFFFFFFFFFFFFCE3FFFFFAC3FFFFFFFFFFFFF0140FFFFFFFFDE3FFFFFFFFF1B40FFFFFFFFC83FFFFFA83FFFFFFFFF1F40FFFFF43FCA3FFFFFFFFFFFFFFFFFA53FFA3FFFFF0840FFFFFFFFFFFFFFFF0540FFFFA93EFFFFFFFFFFFFFFFF393FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF09401540AE3F2540FFFFFFFFFFFFFFFFFFFF353EE33FFFFFFFFFFFFFFFFFFFFFE83FFFFF0F409A3FFFFFFFFFFFFFFFFF973F393F0540483FF63FE53FFFFF0B40FFFF06402140A53FFFFFB33FFFFFD73FFFFFFFFFAE3FFFFFA33FFFFF3840FFFFB33FF23FFFFFED3E2940FFFFFFFFFFFFFFFF20400740FFFFFFFFFFFFA93FFFFFB63FFFFFBB3FFFFF623FFFFF0340D03FD73FBC3FFFFFC13FD33FFFFF293FFFFF0340FFFFFFFFED3FFFFFEC3FFFFFFFFFFFFFB83FFD3FFFFFAE3FFFFFFFFF0540FFFFFFFFFFFFA53FFFFFFFFFFFFF1440FFFF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
