// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.log %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x33BA373D26C06E4532AB1D46FBC346C14B401A44FA4133BC9041B6C13F40DFBFBB434F42C5430BC1A838E13F2F4449BC973C914480BCB241BBC6E2C41CBEC6416444EC3B313334415CB3F5C0D8C311442FBD14BC6D419F4046407CB6893EE5C527416BC46D3E89C4AB3A433FBC3E83B770C0674193B5C2BB89C07ABFCC3B343DC8BC313872364ABCA2422744463E6141FEC21DC3D6BB67C46740A6431D47B2C5733CA0C2E33C543DBABF0A41C4C266C0DB44E53D40B9DB33D03888414942764357C229C4B5B4713BB4ADE52B553FA1BC28C11C44F6BF083DC343E04332C03942B0C0033A503ACB40FD397EC0DE397AC0A44426C33D405A476B428CC42244D6C4C1BC0FBB7F3C554230BBAD4427C2F344D535D240953CEB40B8C73CC14E4176C1A04403C1384258BB473C46C258C11D3961BF49BAB23A6DC556C5DE350144D8430BBDF24418B7293C16C123B52740EB44EF4005B8A5B90D400F4451C0C0BCA7C387B2214788C5E84508B7D2BB4BBE873B8BB09242E3392C447B442D40263EF04591375B458BC42CBE03C82C401344F1C03CC0C3C48B44E744B43DAFBC1ABC90C382405341D1BAC9C3B73C3335ACB9AAC2262485C4E645BD39AA28AB3D91C06DC624C489C1F9BDAFC25CB59C4719C34C4546419641AB429542F03DA3C39B43D7425940AA4240BF2BC458C2FC37B33BAFBE6742D4C1774566C4193587B990BF29C3D8390ABB27BCE4B62CB5523CC4C2CEC35D386AB89CBF9F4292C48AC078413B409AB75BC269BB45C0FBC50543B1BC6447223DE73FEB4196BC2D42284040C46B34063BADC0893D0FC38DBB35BE2DBC7FBD713940C705BD4B44663F38BA75BA714297C0BD4152BC0FC005C67EBEA2BE6643CFC4104839BA843E54B485C6FD344F3A023F3EC4DDBFFC4071C268366EC080261FBE63B99442184602440543E440F8C3583A97C095413DC15041EA3F2D3EBBBC5FBA2F31F4C026BEDB4005B5E8BE463F4443D242D038A13F77C4BEC08FB8BCBF1744CBACD7368EA526C55344EBA9A73DFEBAC6BD0838CCC21E45C3B7A4C29540E83EAC410B3C723DBD3CAF402AB8A345C4C483C0FD3CAFC00C3BEEC42B454F47ADB9DC407D409E3926361EC401C46E2F"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x007E3E34007EC43E007E3E3F007E007E1C3AA53D613C007E173C007E063A007E683D983C6E3D007E54B86C39BA3D007E6730133E007E303C007E007E007E3E3CEB3D06A1F9BDA63B007E007E007E9C3D007E007EFC3BB33A133A007EDB37007E923B007E9637007ED4B1C5382B38007E007EF33B007E007E007E007E95A63534007E2CB946BB007ECC3CB23D3337EA3B007E007E007E007E503A5E3DD93F007ED02E007E68329634007E653B007E007E523E3436007E9EBD11B8123C953C443D007E007E007EA2AC007E92C1D938007E007EA73D007E57336D3D7B3D007E8A3C007E92B495B3FE3AA2B4007EF6B4007E243E007E023AFB3FAA3C007EAD3D007E007E007E7C2F9C3C007E2B3E007E663E09BC0A3B5930333B007E007ECE3B007E203E007E8A3C007E4A2C007E007E29B7007E007EB2B1007E007E03BC8D3D773D007E653E007E0629007E007ED8395F3E393B007E007EA5399A3D007E007E007E007EDB3F007E1B3F007E007E007ECCAB007EC23CE8B4B73D003EE439E136203FFEB9B63E007E007E007EE2399E3D007E007E007E0E3E5C3EAD35007E007E007E803AD53B007E007E43317FBC007E007E1FC4007E193F51B5A0C29435007E007E007E007E007E007E007E0F40007EAB3EC23B1C3CD13CC43C5236007E583DEB3C363AD03C007E007E007E90B9E8A8007EA73C007ECB3E007E93BC007E007E007E06B5007E007E007E007EEE2C007E007EDAB8007E007ECA3C007E007E063CFE39007E007E007E007E007E063D007E0040FB337239573C007E833CDA39007E26BD2BB0007E3235007E007E007E007E007E2BB6007E007ED43DEB38007E007EAE3C007E373C007E007E007E007E007E3C3D007E3140007ECE37007E007EA9BC9AB37C38007E007E4E3B007E53BB007E59C3007E007EC33C3B3F8E3D063D273B007E6CB3007E1B3C007ED13B7539F336007E007E48BF007E007E183B007E007EC938293DE83C11B82A39007E007E007E007EA23D007ECCBA007E007EDB3D007E8835007E007E7CB9007E883E007E007EA23A5E382B3C7821EF346C31CF3A007EEB3E007E007E1133007E0FB0007E923EF53F007E1A3B773AA8B5A7BB007E007E4FC0"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
