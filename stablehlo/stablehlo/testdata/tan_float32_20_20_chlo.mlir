// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.tan %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x79579BBF330AACC0918F29C0A0761BC010851740566273C0E3DB96BF70E47B3F21406B3F918C4540C68B36C0B28187409E66283F508AD03E4310443FA344DA3FBD1F33BE1D292DC07A0D6E3F373FAFC004E5CE3F25BC6C40780410C1D2826D405B9235C00B6DDCC08289FCBF52B1CDBEFD2F43C082491A40C457BF3F7DBBDAC0F108C6BF81D0483F4496A6C073D98FC07E374C4013B33DBF57D7F93F5ABF10C0C7B5A9BF38F0BABFC141D03F6DC49B401D9522BFC994513F4A28C0BE656B4E40E7988BC012F89940AD238EBF63457B3F0DBA883FF2F4BBBEA9D122405AEE8E3FB4DCE33F80EF3F40BE552640C7B4904023E43B3F94AA89C045B8753F914A053F529D6540592A81BEA30E09401E59CABFF4A047BF8564383F68E7D14054AD4B402A0431C09D97943F410CA83D97A7B33FA692203F901C92BF84CD8BC013DDF03F0904833FB15C86C068672BBE836E37BD22EE6F4005B1FE3E96FC97BF70208240C29E68C08779CABEBB80E63EE8590CC04BB063C034B58B3F398411BFDEA352C0343567C0B183173FB77801C097240FC0FD4747C0BAA54AC05B2FEABEBFCEBB3DEF87C8BF01DC47BFC1ED77BF8F2E0A405B4677BED834A240DF67B3BF3EBDED405C858240194B4B407918CC3D3CEB0CBFDE2F8C3F3E011A4170598CBFF9DA84409AFBB1BF8F468E3F6B840740A29A8F40379796BF305D064064E9C63FD7E90EC0AAAA0740F8FE88BE8B96AF402362083EA740933FD073B2402BF27FC03E068EC0235C8EC0025AE3C0861F1A3F607B3BBFC06061BD9ECD87BF73C7D7BF7DAF9540E6B21D3F0DAF6840084AA1400308223FAAFC5ABF83DB2B40EB1F1CBFB0B8A7BF3225CABF7B56E33FC6254A3F0830B9BF7195C9C09DC6843FDC0AECBFA7FAC13F7DA5833E7F22CAC0CB521E3F863D0D40F65ACC40A74A1E3FBE0D1EBFF1FC483DE27E15403A6C50BF8F9862C00F3AD6BF68DD0CC0F888C34054DC5EC0A64A08BFCE5D683DDEF2ADBF47D3C4C05A033A40DC40DFBFE0467CBE1CE0EC3F20B9B0BE09638340C5023D3FAF48423EE31A9BC0063129C08A434140AA53BF40DCE19DBDF19D4EBFADD4FE3FC223FF3F04CC3840D1837FC04D63BFC04B3BC33F3C18C63F87262AC06F1E34C05E77B740C341C63FD6C958BE28997E40B434EE3D4D35A44023CE4A3F8D8FF63B78D318407420D5C0B23D6BC09A900AC09A8744C0F9DDF53C7CA6844098FA25C0C80A2BBFF466DB3FDBDA6940F817D3408875953FEB53F8BED0A50CC0946F9C3F2ED4AC40012191C007498F3F8D2D9340A95064C062349240078A363E32F95FC05A70583F53C0ABC0B0A016C0FA1C10C157E7AA40C51BA640D0FBD540650ACC3E596F69BEA63134403F3D2DBF43F825BFA15378BE390C4EBF8CC962BF814ABB408DF4D13F673F0441CB3DD7BF9390AFC04D4DE1BEF5D83440107808400B8E3C3ECAF69B4074EF29409430B4C07EBD33400A464BC0EFE1BCBFD137C23F56FA7140F6DA34C09918A93F0B952FC09BC1A7C044535BC0328F8E4073E72E40C5A92E3F8790B53F91D4A03F3BECA3409896D53FFA994040DB23EF3F24F07840542D58C062F0833FF9E1BD3CF44B38403749503F03F74FC0C317B4BB666AD33D1AB30340AC9C91BF0BD843C04C3F31BFCC0237405C90D13F246B0FC0EBDB6AC06EA0B53F00C66740AB4D023FB8891E4031DDA0BFDE091CC0364E6D3FC4C6E13F3E6249BFA9A274405E4048C0D38915C0A26F0BBF1ABAD1C0119CF53F8C3B0CC02307B3C0571C1F408C4B1240F9F123BFBCC30E406D9C34C0CE9A2AC09A837ABF607305401FA460C0FB1265BE962F7940B640C4409178CF3DF0FF7AC0012D2FBF8138CFBEF23614C108F81F405D7100BF014349BFC3696FC06D010240DBB6A83F651A6D40C02AECBF90A462C0726256C02E66A3BFC4A1BDBF65B18EC0004B8FC0861F8ABEC1C75BC07EB35DC0DE834B40A432E33FB8DEF33E2C41DDC0E375A6C0ADC022407CDFC5BFE97E5BC02D38893F6A23114088584B3FA63A3D3FB026F13FCAE2A0402A8485409E4B4FC0A1C21FC093C5923FB664C34024213240695D0440FC3B1D40536A1C3ED06046C00B923B40AE3E83BF5ABDDA40B43A09C0EF2FE7404B5356BEA96E8240E10C41BF134203C0956E43BFCC124F40750306BF4063A8C0FD1FD93FAF0C1540675349BF2746103F3B418140A7509E3F621AACC01DDEBCBEAA5D403F1EDCCDBDFA7109403EC50CC0B6CFC0400F4811C0C57A2B40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB27D2BC0A09EA33FF845093FF9245D3F1E477ABFCF3547BF28B91AC0D37BC03F2ABBA73F460C61BD5067983EDC2FF73FD6C9453F8AE4DC3E8431763F4E9EECC03FF934BE3584EE3EF597AB3FEC93853F0771AFC1F0911F3FBFE9E63EDEE9233F82EDA03E761231BFAE781640EC85D9BE4F83BC3D6F7E65BF685052413EBB1DBFDA1C29C26C817F3FFAFDED3FF81391C0C0124A3D2C3A6ABF08BB1FC04BCF9A3FE20580C0B46A10C1352C8EC17C57CCC0DCA73CBFDFD0883FF5B7C9BE1CD8AB3DC6572FC098DA20C1611101C06979BF3FE6D9E83FADE1C4BEE3372EBF5B190340469896C0200513BE0A5D1ABF021AA64023ED663FB81F13C0C7C4B63FA8CD123F42E3F43E29FA83BE7A61C7BF1C08C74246267DBF6FA8603F962F913E3476273D77F5C93EA2481340116DA83DAB8CBD408D92393F9DCE0BC0E3E632C0D62447C00513D23F0FEDE2BFDC052DBEEE8D37BD17E7313F4E010B3FB1AA1EC05BCEA93F479109BF04BCD5BE7973F73E6377B23F1238E2BEB344F63FED8423BFC4671ABEFC5E02BF1E182C3F1AC003403CF6A23FE2FDE33C51FACABC5A02FCBEF955BC3DB01471C32D9B7DBFBB2ABABFD5E0BFBF2F327CBEF7D12BC05C54BBC0B28C0D40103BAE3F69DE0E3D20C6CC3D5A1E1DBF9D89F83F9A22503E6750F9BF54DDCB3F908CAFC0F2690140A958D2BF77F78B4052CF19C09C24DBBFF8166E429A2BA43FAF3ED1BF9C5C8CBE31C282BF0F32093E592A0F40DE815ABFCDF293BF459763C05D1A6DC05D9B89BF78E82F3F692F66BF0C9B61BD37ECE4BF1F8B0A417257E6413339353F51E5093F06233CC079CE3B3FFF4E93BFC353FBBEE4DE32BF0B2070C0984BEC4245B099C01B17813FF55900C1669985BCCCB9D83F10546440786D90415BA0863E5C5F09BDA329363F9054ADBF2B86D33D601D363FB4C135BF4726493DDC4F85BFB59487BF19D9D7BE47041B41AB79AF3FFAA332BE4276B5BE45D116BFB49D683DCFCD94C0AB5E083EC25175BE08B9B64003C180BE82BD5EC0B617B8BE0E7EB83F11F7683F34A6443E3B3AEC40652E0B3F1CC8FABD83C0A0BE1E329EBDDDAD85BF87490FC0105D0EC0E3FE84BE38F391BFD4AD9F3E2083AF41C3842C424D40063FE4CAAD3E36E81CBFB47F36421E165CBEFFCC8D3F3049EF3D77A70FC059C1813FBE90F63BD54170BF67BCCABEDD6317BFC469BD3F4546913DE1F0F53C49FEC83FDF4F1C3F570A4ABFC0CDDDC01100103FFFFAA53E4E0E16409DE906BF51BBB03F361230402F8F9BBF0DC9B2C04606044013E40C412C3CE8BEE278DD40617F383E9F8BBFBE6C61903F12B2A63F45AD803F823CE33E3B2AB0BF7BC4F6BFF4C4DA3E5893D73E82906DBE861FADBE64A14DBF31EF41BFDC4F7DBEE31585BFF1B49CBF6A06EBBEF1E965C173A612C0D5D70F4104F3823F0311F1BE1C51A7BE5278CBBF17B73E3EEC6EC4C0AD5907BF6386433F862DB1BE469A0DBD34A527C1D07A954157543E3F5D3FA73E71EC7A403E56D73EB776DA3FC63496BE9D1D734005C0DDBECDFB4F3FCB73D04008DF4440F22B13C030F922C1532908BEA3C050C096906D3FF77076BE7686D53FAFEABD3CC24689BE966F873F5BC1DDBD3A18B4BB792BD43D83B6F1BFA4600AC0EC58A73D184F54BFFA5C94BEE88770C17086A13FD45515BF0421D140B43B053FEFDB0E3F5A8248BF310C45C06528593F808DAA3F02ABA3C07E5280BF095F4F3F797F4F3C4522853F9B151BBFA4218EBE516830C09A2AB33F36AB523FA5D644BFE96693BF4CC43EBFC8F5A4BFB969A93E77F1033F1441BEBF1481E2BF94A8C5BE36F968BE9E6A6F3FE30F1BBE022FD03D5F647DBF03D650BF4D54DBBE80AF263E8A6E3FBFD16D0CBF313380BF45DA2EBF1D0001C096D577404F9F213FEC7963403C4AD8BE964B58BE083253C05AB332C1044E77C0ACF585C009938DBE062B9ABE0B16ABBE8A141D3D0B899AC0D913043FBF0D3BBF8243F03F5C9B2EBF818520C248B097BE3FFDEA3F09E698BFF54D823F4E5D693F649E45C08B3644C09988D53F811AC8BD67BC403FF1BB0D40775037BE9EBCBFBE25C1EBBF740F51BFB0A41D3E73DC2B3D5D1E5BBE44ECD2BFCECF1D3FC434C63FB8C8AF3FC88259BE0339AD3F447570BF50CCF53F09FB74BF83EFC03DBEC313BFC9E6D03FD4A7FDC07E2F87BF9E4380BF77C6213FA383A03F327638408CF4A23F80EDC5BE4A2C6F3F548ECEBD1ABFC4BF1C05B03F980387BEA634983FFD16FFBE"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
