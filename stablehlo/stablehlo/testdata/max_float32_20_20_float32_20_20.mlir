// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xEA1EEDBFA044523FB98B92C0145F803F6EF8F13E818E12C0AEB4D2BE2CF4323F2B970940136853408225953F83439BBFCAEAC33EF8D585400E8888BFD01402C0BD4A01C04FAD6CBEF1E9BDBF2CCFE7BF0D247E4078415A3F2A1CE0405030EEBF7CB00D3F5D90813F866742C0A9B9A3BEFB1C8D40DF0E1740AAAC27BF70760C40075540BEA7FB9B40C21B2FC0801C28BFFA3F9140817880405F31414074830BC00A11C43E058F9AC06C4B5DBEF0A248C0CF68DC409C7229405A315EC08EAB8AC00A4685BF3B9EB0BF95A6C7BF1BA1B1BFF613C23FF10193BF992E8A3FDF55904041E8B540114A3AC0D3AB0F4069B19C40B5B9454044108AC03290BF3F3BE0D7BF47B0D83FA12D3A40AB913B40B052F43EFDE3B8BD9A8D99BF7A41F83FCD89F6BF6CE431C006F45DC0EC4B1BC0F6231BBF9767184073118E3FF30D93C00E5975C0945F6840D96888C095B189404436A440149FB1BF91BEEE3F557033C070BB054040AD14407E248FC091DB57403233BC40860CD6C082AA7240F1E936C0FAB49FBFB9A5D23F8A8035C00394A2C0E57209C07D935F3E73A4FCBFA2AB2340ECCB94BF3842B6C0E2F85940C198ECC0DBA0BB3F4006C7BF18C44AC091741EC0480C6C3E31F2A0C0F8A678BD9F5F17BFE92C05C082A7343F4FA6563FA1729C3FAC0736C08EE6D23F5995B9408BEFA43F5D83D0BFE2C00E3FE91E4F3F2E3AAB40B3DBC940321D3BC0E75EEEBFAFE4953DF59210402D0EF5BF3ED339BFB54F69408AA0CAC08E272E40BEA9A2BEA9CD2D406258024062D082BF401EF33FD3A68F40CD3140C017128DC0D56F5AC0573C5040548C44C099AFCABF9E9817C02AF02D3F156C863F7AE596C0CE188540F312E4BD77D9A7BFB94F08416206A44066CE453F8F82CDBEEAB6B6C04F7F7FBFF19AC73FF6A99EBF8BBEA2BDAD3305C0FBE1BFBF5F4F91BF6D42A340447A04408ECFD23F16ADABBF7877DDBFD04B4640245A0D40822910BFBDDAFB3FEDCF57BEC947A2BF592439BE1D042F401406FCBFE24A0D3E3D1E01406AB81BC0C73765C0F891FF3D7286A740B1B6B140A0704D40CE3770C02F50A0BF0258CDC014A4793FE5F749BF2D7BA33E4179F5BF1062B2BF7DDDAC3E6F6CF93F195C52C0D1B0AEC0DC4761C0475B793FEA8C32C0320A73403EB37A3E2A348340D46FC5400BE4FD3F334F3340B9CB943F3EB846403D712E407AD8A6BE6AB589C0A07029BF7F3B803D9376B93F6A6146BF7A056DBF420F61C01B4A04C02AF66240F4B5ADC05F6F303FF001D6BFD71804C04E486640C63DAFC0942F8140B9FA823FD9C4C6C08C60483F38EAB4BE8FB5B1404BB5483F5B9DF6BF679D1240A35ECFC063BAD43EAA026A405DC248BFA77A18C06CB86240E6D18040DB681FBFBAC8D5BF361AAC3F9CF6F83F00C57B40207CB33D8DF7564030942A40E9F22BBE9F324E3F0F0F7DC0D247F63FF317234094F6E8BF1BE693400FF015BEE66EB83F1592D03F7975E63FC358F0BF1838CDC01E0147C09D50224048F95F4017E1633FE6689D4084222240A6B7E33FAD3C413FF2DCD43F6436B4BF0B1859C08BCAAF3FB0DAA7BFF7DC5CBD9D16A83F3DAB1DC0AB3B6B3DA6C311411079E24034365C406D97BFC052A593C03CE1CE3F2E791E4032D019C02319BC3FA7D7253FACAC92BFDBC8B63EA94022BE5162C33F882695BF384DB83F68994B40F2B9B63F88176BBF5D9C92C0890703BFD2A2663DAE7A9E406BD4A0C0F1D07C4039B34F4030D25F3F164A083F4166C13EFC508F40C4F5A1BFCA8CFC3F60F8573F7405CA3FC511443FB361CABF3CBBB63EF69AD9403BA3B5BE390421BF95CA87C044A7743F2B924B40B4B5C9C0395ACAC07880FFBF255DA03EDADD7EC000041A408E9E81C06792D1BF0EAE2EC0077A8B408CB42EBF0302AFC0E0C355C046E7EDBF096430C075FC074048E80040FAEADC3EF0E732C0DC5C683EB663F83F32C240BFF8AD6740AC0E05BE08E86D405D931EBF7A99AB4049E805C0A5F641C0202111401973E6BFCCEEBEC0EB4EB2BFF2F4593F973427BF02758DBF3A49633F46E32DBF185D4340ADF49EC060248540C2DC8E3E0FD981402A8BFCBF45A2863F24A46AC0C71412C0DA0D5240E253B33E66F9E4BFC3CC98C0DBFAE0BFC3D36C40EDAA28C09FD83740ACF68140CE2829BF7574633F909D0F3DB3B0593EBBF220C016B43440462D0AC0439FE4407FDD06BFC876293DBD0C29408657B5C0FBCA54407C84D03FC0162140E10F1DBC74D6C1BF"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<"0xED34EEBED6B68240DE847C40E9A572C09B071340D4C6B34077A63E3FE94167BFB36027BD1DEBC63F2FCA67C061F4B940955AC3C002C11FBF0F65CA407646A940CF9942BF656F3AC098971B40938125BF63258ABE2DA45840BEE16F40F3DD6AC0140876BF4C545E4051D4B33FD30F4440431AA7C0A798A6406C28ABC0CDB6CC40D1FDDFBF48E15A40471B1A407F1B1F40BEDE70405C9BF73FDB6718BFBD48313F1005E13F7B2A9ABE091E343F4CC752BF1ADE60C0373546BFD07D6540B9F07FBE85AE8BC01F14B94096EC92C0CE522D3F7A5FD6BF71AB4040D08109C0DCAB11407EEB4A40370D7CBFA33A04C0000A3B4095075A3F492D13403BE45DC0C1939CC04AC89CBF0EFB9FC05B6A99C02CCCD13F634B2F403AAE9B3D091E0A40DD628140EFA52D404753C33D2B6C04406E70B83F0F5A8A40BAC8CAC078DF22C05B2011BEB475DABF5E802BC0F13A85BE89B80840D1CF85BFA36A183F0224F93F23052AC0AEC0673F90A2833F13A408C0E8F3284084D908BE293DDCC0CA8D7640D469EABF20A3E6C0E241EB3FF3C8373FC8F472BED07C18BF96F03E40F7BE923F5D9E0940BCDA994058BEBFBFD35E0EBF15D18C3E4829DBBF3013AEBF608393BE06888F3F75219E40597B22400EFD32BFA31C6540D91FD6BFB9215F3FF5A83DC0DBFAC640919817C06B416CBCDAB826C0402E0540F13547C0357A2C3F2EFB96C05F4547C0967B8640567DC3C0C161964017EF58C0F7D45EBF3ADEDBC0022D02C0B5CFC24045F1A23F1AA9243FB41053BEB9AB1E3F730FD4BC1EA74840591EF43F2E94203FBE4A92BEC2F91240A2E90440B4D483BF4239014098F8A34063AD94BE5DCE2B3F7DC4573F74AE0D41AAF892400F3132BF294378BFE08AFABFF6775B4022D95840D96882C069E01F40CED09CC0D25E8E405D96074046FAD4C00F9B00BFE37DD640C65713C0756633C0DBDD98C020E1693FF3D953C0FB0D1040E53306411A22FBBFFB922E3F08076F3FA14A76C0DAC21C402FBC2ABE37D88940E0248640BCE7D33F21851D40CF4A3EBFFD649740A1F7FF3FB63E893F08479BBF4A60873F7821564016EF6740667CCABFB3EE9DBE1F0223C003F53F3F837237C020CED83FD218A44084DD0BBF60A13040708B6D3F3551BBC0516842C04B532A40B46C6AC0CF1FE33F9472633E1B6061C0B839B33F8AA883C09BA142C06CFDA33DCFBA6CC04962444072F7A0BD60E598C03B38BEC000981FBFDA8833408CDF6EBFA1168640CB5C77BF65C6AA3F9507B1406CE6883FA4E67840CAE78FBEE9ABB83D655848BFD1102B407BD99F406EDC7FBFB154D63D9E349EBE9848D33F025176C0D478F6BF02D91B3F082C2B40721F5F3E248DA23EBDD6C83F2C94284069AF0340BC51523FAFFED3BFF78B733E75600340B6C343C0E8FAFEBF5A8695BE764815BFA4073BC0AA0BF5BFAAE92BC0EB47853F45DCA240BBFC8E40AEA740C078BD1B40741A39BF324529402FC82240E3B7CF3E021FF93EDF06F9BE9E2F4FBF0A3C23C06EE99940562B963F91E729C01F10EF3F3B013240C4ED4240CFFCB8C0C5B975BFB209C33C0CB4D53E31659A3F035C353FF55F2DC0C55C60BFE51141BE87FFFDC04AEA9E3F5F02B6BFC6E758BE0446FABF27946240E9CAE83F8AA1ACC0CBA4A03D42F11ABF8D8243409D641EC0F6E56840D2F63EC05F5D64C0772ED2C0E6566940DCA110C0A0191640498B624009A8B03F98AB12C067AE87BF9B1130408E7DC8BFF8BCB2C02A424940B0E72AC0013C763F719904BFC7336BC0818F81BEA5BFB0BFB79BABC0E0D82640FAD4C03E330F3440BAAB39BF8CDF8E403FAEE7BE479C92BF56254B3FA431023E3E5ECCBF2137F03EE5960C40FE1CC640B470D6BF55D1EBBFCB2B11BF21444ABF80F9983FE4E701BFDB7587BF1BB91140846D21C04739C140A439A64064EDAFC099807A40F1041840C22EF33F53B5B63FE2089A3D0CA389BF096E60C012EE183FF86B1FC0CC53D43F229B52BE1896093F81A924C0E9F96FBF2F94FA3F498A01BF018730409D8369BFBF670C40C17CAAC0777D2CBF26A14BC0439FB84084B00840EDBE5F40155C62407AFBE93FF63C04C075230DC02D73CFBF0AD906401259704053F168BFE95D473EFC2192402F176B40230AA4408D1171BFD96CBCC08800D6BE7D43D93F2DF7BEBF30E63D3F87474EC0E1E4073FE77D9B408A7ADEBD517537C0562306BAACA30E406D6B76401A9272C042BF223F9B92CF3FFE0430C0C90921C0"> : tensor<20x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xED34EEBED6B68240DE847C40145F803F9B071340D4C6B34077A63E3F2CF4323F2B970940136853408225953F61F4B940CAEAC33EF8D585400F65CA407646A940CF9942BF4FAD6CBE98971B40938125BF0D247E402DA458402A1CE0405030EEBF7CB00D3F4C545E4051D4B33FD30F4440FB1C8D40A798A640AAAC27BFCDB6CC40075540BEA7FB9B40471B1A407F1B1F40FA3F9140817880405F314140BD48313F1005E13F7B2A9ABE091E343F4CC752BFCF68DC409C722940D07D6540B9F07FBE0A4685BF1F14B94095A6C7BFCE522D3FF613C23F71AB4040992E8A3FDF55904041E8B540370D7CBFD3AB0F4069B19C40B5B94540492D13403290BF3F3BE0D7BF47B0D83FA12D3A40AB913B402CCCD13F634B2F403AAE9B3D091E0A40DD628140EFA52D404753C33D2B6C04406E70B83F0F5A8A4073118E3F78DF22C05B2011BE945F68405E802BC095B189404436A440D1CF85BF91BEEE3F0224F93F70BB054040AD144090A2833F91DB57403233BC4084D908BE82AA7240CA8D7640FAB49FBFB9A5D23FE241EB3FF3C8373FC8F472BE7D935F3E96F03E40A2AB23405D9E0940BCDA9940E2F85940D35E0EBFDBA0BB3F4006C7BF3013AEBF608393BE06888F3F75219E40597B22409F5F17BFA31C654082A7343FB9215F3FA1729C3FDBFAC6408EE6D23F5995B9408BEFA43F402E0540E2C00E3FE91E4F3F2E3AAB40B3DBC940967B8640E75EEEBFC1619640F5921040F7D45EBF3ED339BFB54F6940B5CFC2408E272E401AA9243FA9CD2D4062580240730FD4BC1EA74840D3A68F402E94203FBE4A92BEC2F91240573C5040B4D483BF4239014098F8A3402AF02D3F156C863F7DC4573F74AE0D41AAF892400F3132BFB94F08416206A440F6775B4022D95840D96882C069E01F40F19AC73FD25E8E405D960740AD3305C00F9B00BFE37DD6406D42A340447A04408ECFD23F20E1693F7877DDBFD04B4640E5330641822910BFBDDAFB3F08076F3FC947A2BFDAC21C401D042F4037D88940E02486403D1E014021851D40CF4A3EBFFD6497407286A740B1B6B140A0704D404A60873F7821564016EF674014A4793FB3EE9DBE2D7BA33E03F53F3F1062B2BF20CED83FD218A44084DD0BBF60A13040708B6D3F475B793FEA8C32C0320A73403EB37A3E2A348340D46FC5400BE4FD3F334F3340B9CB943F3EB846403D712E407AD8A6BE4962444072F7A0BD7F3B803D9376B93F00981FBFDA8833408CDF6EBFA11686402AF6624065C6AA3F9507B1406CE6883FA4E678404E486640E9ABB83D942F8140D1102B407BD99F408C60483FB154D63D8FB5B1409848D33F5B9DF6BF679D124002D91B3F082C2B40AA026A40248DA23EBDD6C83F6CB86240E6D18040BC51523FAFFED3BF361AAC3F7560034000C57B40207CB33D8DF7564030942A40E9F22BBE9F324E3FAAE92BC0D247F63F45DCA240BBFC8E401BE6934078BD1B40E66EB83F324529402FC82240E3B7CF3E021FF93EDF06F9BE9D50224048F95F406EE99940E6689D40842222401F10EF3F3B013240C4ED42406436B4BFC5B975BF8BCAAF3F0CB4D53E31659A3F9D16A83F3DAB1DC0AB3B6B3DA6C311411079E24034365C405F02B6BFC6E758BE3CE1CE3F27946240E9CAE83F2319BC3FA7D7253F42F11ABF8D824340A94022BEF6E56840882695BF384DB83F68994B40E656694088176BBFA0191640498B624009A8B03FAE7A9E4067AE87BFF1D07C4039B34F4030D25F3F2A4249404166C13EFC508F40719904BFCA8CFC3F60F8573F7405CA3FC511443FE0D82640FAD4C03EF69AD9403BA3B5BE8CDF8E403FAEE7BE44A7743F2B924B40A431023E3E5ECCBF2137F03EE5960C40FE1CC64000041A4055D1EBBFCB2B11BF21444ABF077A8B40E4E701BFDB7587BF1BB9114046E7EDBF4739C140A439A64048E8004099807A40F1041840C22EF33FB663F83FE2089A3DF8AD6740AC0E05BE08E86D405D931EBF7A99AB40229B52BE1896093F20211140E9F96FBF2F94FA3F498A01BF01873040973427BFBF670C403A49633F777D2CBF185D4340439FB84060248540EDBE5F400FD981407AFBE93F45A2863F75230DC02D73CFBFDA0D52401259704053F168BFE95D473EFC219240C3D36C40230AA4409FD83740ACF681408800D6BE7D43D93F909D0F3D30E63D3FBBF220C016B43440E77D9B40439FE4407FDD06BFC876293DBD0C29406D6B7640FBCA54407C84D03FC0162140E10F1DBC74D6C1BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
