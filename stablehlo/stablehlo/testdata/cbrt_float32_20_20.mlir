// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.cbrt %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x6C1A2C408BFEC83F62775C3F9D731D406EED34C0B8FEA93E7B3D003F385602BFA23CA9BFDCAE2F40A3E294C0DAC09FBFA45AD03C46EBD6BF99E485BFFBA434C093B40F3F32D73640827F0B40A90396BF3056FABF77EDAC3E0E615AC0C40F1FC05FA6ADBF4A448140B856ADBF2AB297C054F15E403C36BBBFC6FF1BC094F1993F13D0BCC0EDA0B6BFED24E0BFECF91FBF1E0C03417D5595401B41FEBE574383C02E0D4EBEC1F024C04DA185C0942C8C3F3D948DBF0432404000D0803F98894F40B867AEBEF9A7B8BF470E91BF48D636C03DACDDBF788EE2BF6A9497C0E00F384076A2D13F03F5973EDF76963FCF39EEBF094A1BBF3EAF8C3F4CA7E83F14B81440342E0AC0BC1002C016E9A9BFA51E9DBF2C36A53F4DFC32400F34A2C0BB6191BFAEEB643F70F037BF4288D5BFBC4B9BBFC76E4E3F2AF99F3F1910793F6C9C0A40D8F30A40C08E82BF721F4D404C2D57C05F0561C0D98D9D40EDBC9E402F226040C50C643F8BE869401B76473F9A1D2640C51043C0FAC25A40FA0DD03F00673B402EDB61BFB2E32140306B853FE672C63F472F94C0F9BB333F45B1CC3D99C8733F02E0AF3F60B4613F8FDF44C00DB596BFD0FFB63FB1F6B6BF8BDD53BF4C136AC0F7D015C0F5509CBE940DA03FD1DE30C0459FD740764D4440201B61C01D0799BFA05C9B3F83AE103F40D2D7BF4A6C6EC078295CBF536FFABFAB1FA93FD4149BBF6D9B383F1590AF40C737073D436181C06E5E7FBE4FE4AA3F0D140F40F53F403F2020784028FF373FC52100C1CBEDC8406C97293F30C8C1405157F23FE5FB83C0F0074640D0B9A3409843B0BFFA9F2AC085D84B4041EAAA3E7D110440852758C0373E933FA5543D403785A1400351FE3F6B463640F6AF72C028580E40E60019416FD0FD4081D2D13F3A7D51409ABA4DC0D36A6CBE45B0B3BF9923ADBF75601840B1B949C083331CC05E1A32400E1124404E0FDF3E90A70940DFF36CBE84A1863FB08FB8BF475192C09A2F193FCCF94D40A307903F6F2803C08FE9B8C015D10E40B92229BF7D115ABE305D904012B2EB3FDB9F833FB21DDE3FCEFC303E85371EC09ED126C091B79CBF0FB00B404005A93F9F4E3640FF564D3E8AE5843E2A8C5D3FDD6A6B40F01408BF7CC54E4000BB86C062DC7540F9909F4020F203C0500CEB3F224E13C0CDCABCBD225FBEC0A61B2CBEF18BFA3DEB3140C0AC4D3ABFC3ADF23EC04EDA3E8E85ADBEC593AFBFC189283F1B211EC0C80A5340AAC8C4C00640BA40AF78923F6B413F40D9CCE3BF932A06C0051DEC3D55FC28BF55A8D6C0D920FEBF67CFFEBE4F21EC3F6367B9C0E3A1BC3F5C098AC08D57943F328A22403A8D8940B2F1174035E8BDBF622EACC0F3C24B3EA6EC2CC041999A3FA06D5D40C9D40CC0A5887C3F17E11BC0F759393E70B29B40497B923F92AB98401F5CDB3E641586BFE5A7F7C0E15D0BC04621A4BF96887E4050F10C3C8E721F40629DBFBFCC59E7BE9EC63140CA9D8EC0F8ACEDBFCF390640C11C1FC0AE9CA740D17C833FA52907C02EC38EC099EC4240BC45983F9183173F82DABF40B6FB38403F7662C0616E4EBF730C40C016F4823EC57714C0351D6FC01D64D9BF368D3C4009A57D40D92B063F8AD05BC0B04C1A3F781098C0F4DF0D41E8D6A040DDAA6B3E80CBA1BE3F0C833EFEA15240F53EC84053C58640D89F40C089E60040E9F90D4045911540381DC3400BB842BFF71E8DC057D3553D32576BBFF8600041D9EA903E32332F4074395EBF9EB7F4BF357E0E40CF5BC7BF20F9B03F4A05B53F7CBF9E3FB4523BBF67C6A13F65BE273FD4BD124058F0CB3F057D043FA37A93C02657C2C0915225C0850094C0135709BFED447CC03F3BA3BFFB2C03406DC69ABFB8E232BEE27D2BBE34369EC07EC0E73E0AB713C04C89ECBF20F6AE3FC9EBC8C050CBFFBF5279B33EFFFAC6BFE666AD3E2C0921407527A6BEC6A23AC0FBAEF2BF7D1D823F6FB92E3FED48A6BE07C5AA40171887C047B316C03EE479BF47FA28BF24162840888A6C3EF734E9BEF44FC9BF0FDDE5BD1C9DD03F60971640EA19BC3E8798E43ED0A824C001AD5DC050C5BE3F0B55B83F512FDCC0D33FE8BF2A5E6C3F265C083F0460B63FB2B15DC06AD4A0C0EFCB903FAEEFCBC08E8C77C02F5826405FADEEC051F8B8BF184DEC3F6DA9AABF120F1DC0B6B494BF14604540DE1C7E3F35E6EE3F361AA9406EA1773F343C2E3F226DABBDD9CD293FA1FEEE3CB83C42C0F494E6BF37E8AE405EE322BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x43FFB13FCEC6943F918F733FA4CBAC3F1CFDB4BF6F44313F78504B3F976A4CBFDA7C8CBF0A39B33FC4AFD5BF1CD089BF1D92963EC82298BF57EF81BFF0E4B4BFDB2D533FD99FB53F04F6A53F1AF486BF6112A0BFE747323FCDB3C0BFE761ADBFC8B28DBFFDDACB3F1A9D8DBFDB05D7BF1309C23F8E4B91BF3243ACBF251F883F184CE7BF831990BF3F489ABFB8DD5ABF01020140A8E6D53F74B94ABF43E6CCBF980316BF217EAFBFAF1FCEBF90EF833F076084BFA9ABB83F3045803F8875BD3F86C932BF86A190BF2E7385BF8B9FB5BF8CB699BF6ED59ABFCBF7D6BF2707B63FECE0963FFAC22A3F9D16873F9B729DBF18B558BF8218843FDA359C3F3E8AA93FD46FA5BFF721A2BF82AC8CBF2A0D89BF6C5D8B3FBF56B43F87E0DBBFC18C85BF98A2763F314A65BFD5CE97BFE08488BF7B476E3F4BE0893F9AAA7D3FC59BA53F8FBEA53FD0D880BFB2B8BC3F7EC1BFBFF3A2C2BF81C1D93FC94CDA3F5C61C23F7152763F7B2AC53FF0906B3F93E8AF3FD395B9BF97D0C03FA37F963F5B1FB73F988775BF6567AE3F05C8813F5625943FD359D5BF7387633F959BED3E7FDC7B3F104D8E3F8779753F2428BABF362987BF7332903F0E3090BFF55970BF7E36C5BFB7F4A9BF0E612CBF28E6893F2BA0B3BF82C3F13F0CFAB93F38A9C2BFE7D987BFD389883F02A8533F355998BF266DC6BFDD7273BFBC17A0BFD5748C3FC87488BF2791653F4CC1E13FF73EA43E37EACBBF232321BFB4F18C3F6C5EA73F39B1683F1015C93F4E50653F410B00C07924EC3F7E2A5F3F0D4FE93F60599E3F1D46CDBF6085BA3F1890DC3FE7678EBF6B7CB1BF3A54BC3F2896313FF0F5A23FB50BC0BF091E863F99BFB73F6A91DB3F64EAA03FDC6FB53F359AC7BF0815A73F10D80740F244FF3F72EC963F180DBE3F3CE8BCBF590C1DBF7B528FBF2D8F8DBF30EBAA3F79ACBBBF3B56ACBFBE0AB43FA72EAF3FC411423F073AA53FAC2A1DBF572C823F2E9B90BF7373D4BF7DB9573F92FBBC3F7222853FDC95A2BF86B1E5BF4B44A73F42F75EBF18E018BF5380D33F65E39C3F6932813FC1D0993FB6990E3F3113ADBF0728B0BF2BEF88BF4309A63F856D8C3F9572B53F54D7153FF94C233F53F5733FCC96C53F70604FBFC839BD3F21B0CEBFF977C83FD2ADDA3F08E9A2BF96BE9C3F4300A9BFF049E7BE99EEE7BF18470DBF4D2BFE3EA1ABB8BF9B4466BF9A99473F6BAE403F1C7C32BF7E388EBFF6B35E3F040BADBF0585BE3FE281EABFFC3EE63FF5E1853F795EB83FD31D9BBFAFD1A3BF1031F93E62E65EBF1467F1BF3BE0A0BF3FDF4ABF10FC9C3F94E5E5BF65A9913F6E5DD0BF3E73863F1BA3AE3FE61ED03FBCC1AA3F34FD91BFD34BE0BFCC74153F9F47B2BF7F50883F5798C13FED7CA6BFDFD67E3FE637ACBFEFCF103F9EE5D83FC0E2853F727BD73F8AFD403F1EFF81BF1630FDBFADE8A5BF640F8BBF72CCCA3F29D1513EC485AD3FE56C92BFD77144BF81EEB33FF3A4D2BF8E539DBFE2D7A33F9F66ADBF594BDE3FF126813F3E39A4BF5AB7D2BF5A8AB93F95A0873FD4EF563F4488E83FC454B63F140DC3BF53476EBFA09FB8BF3880223FCA71A9BF2E9EC6BF89B798BFFD7EB73FF18FCA3FD2664E3FA91FC1BFFE3E583F6032D7BF9C7704405142DB3FCCE11C3FB45E2EBF358A223F7865BE3FE7DFEB3F68B5CE3FCFCEB8BFB0A5A13F20F0A63F9EDCA93F9BD7E93F28AF69BFCFE7D1BF815ABF3E65EB78BF4B2000403715283FF20EB33FDE3474BF70DD9EBFEA23A73F355F94BFB9988E3FEDAC8F3FF285893FF4AF66BF4F648A3F3F5A5E3F02C9A83FE47F953FF9884D3FFE02D5BF5F88E9BFCBA0AFBF6043D5BF920350BF0A32CABF4FCE8ABFBD97A23FC55D88BFC01B0FBFE01B0DBFF50EDABFE48E443F5828A9BF18139DBFE00D8E3FB023ECBF073AA1BFB280343F2D4794BF9871323FC918AE3F0DEC2FBF5ADFB6BF766C9EBF83B3803F2565613FDDF72FBF7BAEDF3FB0DFCEBF214AAABF8CF27DBF7BE55EBFF899B03F5E131D3FF9F744BFE1DA94BF29F9F6BE1FA2963F9D3FAA3F8F59373F6CA9433F9A64AFBFCEAAC1BFC635923FDC8B903F0575F3BFAF1E9CBFF947793F96844F3F6E08903F2BACC1BF2F41DBBFD25E853F9650EDBF2BEDC8BF3EFDAF3F2317FABF7DB690BFC3059D3F82E18CBFD4A6ACBF5E8F86BF9D50BA3F8F5E7F3F8D989D3F85F3DE3FE22D7D3F3E2F613FC8F7DFBE5B425F3FEB9D9D3E7B52B9BFCEBE9BBF4179E13FA12F5CBF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
