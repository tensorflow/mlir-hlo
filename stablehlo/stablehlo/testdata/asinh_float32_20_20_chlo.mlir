// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.asinh %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE7E369BF451C22406FBC9E3EB507EDBFA29E4340F94907C0C0045A401A9BFD3F6EA9663F14CDD4C0212C5ABFC0480CC0FD002EBF440707400779E2BDA8339F401E1ACFBF99A5124094365EC0D0B9ABC0873E5F3F49D45AC089890BC08DA6E5BF0EA0CDBF14C1C54035D330C0307F763F76A91C40EA888C40411519BF3BBB35C0D7DA37C0076578C0A6E134C076592BC0D4DFFD3DA828F13E8A446040A59399C0D5971140DD1BB53D826686BF691A124081A1793F01A45E4005149A4029AD8AC0A410A1BC1AE160C0A194403F906381BF151ADDBF943720C0C8E08140B200BCC0D3C90C3D62A354C0695108402155A8401A6D98BEFCF893BECA14B13F312A32C0EA84B9BF58AD96407FE858406E86FDBE1199BA3F8B3CA6BFCA786C3FEB9E22C0770EFE407DA306408C4E7240CB43CCC0194012C03A34373EB02FABC0DFA8163F0365E03E359BDA406C0F463F6FBFBE3FA26DA83EC0A168404B4EB2BEE561FC3FA9292F4095F8C9BF40934340ADA7304065B3D740F5ED9BBF1A866A403C738BBECD11B1BFA9C81D40C350B7BF87B1FABF4FF028BFD601994052B19F3E1D3FA4C0C67EC4BF019E1C40A71F04BF0D459B3F1CD89A3F84C12DBE7A81FBBFC07E1C402C132A403B9B5F40C72389C0BE6009C0082EB540CB63963FE62E314075868FC060D7204083540340CDF5D7BFE8B1E6BFCBAB863F72C88A401BB81AC065BC21C0C2B5BCC056CFA1406A6FB13C932677BF64D0E6BFB92950C02713B93F519740406A32AD400DF2FA40B7690940CDA5B940FC7BEEBFCC7DFF3E8C4C06C08FB944BF89CD91BE5C3E644016A92140DEB95240E4D897C0E5455540DE66D3BF7575903F4FB7D63FF609943FCD978240697BAE3EDE4800BF1DC933C032C367C094E984406F52F1BEC0EF09C162A94EC05E858FBEF785DB3E4B4B313F976B39C0CFCAC8BF4EE352BE51AE1640CFEF79BF82F90F3FB366AE3FE95472C034819E40EB0EC5C0DD889EBF66FBE4BF21B18340887C273F08AE8EC0502940BC23312C40B442333FA6628E406C30D3BCA2374FC03622AC3ED8DAD23F3BE580C05201154196961F40A391A7BF3BF382C09BDE44400DBC7B4077560940A2D09E4018F809C027F0BBBF659BBCBF2A952E40F6278F3F184297BF9661CC3F5534ADC066108C4066F9B13EB4D79AC0D518853D2CA51CC03D7CB0BD02417FBF91A7B1BF0B13C13E6F9AD73F7F88A8C003D857C02E0084404BEEBD40A2ADB7C0DC4B6BC045C8B03EE80C063F3DA24BC0FC3A05BFBBFD1DBE6ACD393F63B3983F40456DC031FBE6BF225842C0CD1EB9409FE714C0E09393C0EF6A88BF44368AC08CB6B6C003328C3E17B1A73F56040540FC074BC0CF7CD5C0E6AB71404AEE8C40405D953F265A8540BF202F3FB0AC29BF872F0A3F89CA5FBFB3930DBE387B82400265064019664BBE8B1B69C0CE1FF9BFF2278CC026DD943FE9769ABF94294940880BC33F3A1F15C01E2084C025E38AC00AFD823F2551F4BF27C9E03F2666E5BF15D9154040A9E4BEDB1A3340982B9B3F6884DBBF1EAE474033ED3D40029E03C048E09F3E9F9352C01B5152C02EE408406413633FBE1D623F8EC3F93F33B96E4036BE9E3F14178840FDC27240392A0CC02EB33FBFAC7BD83F60BF50C0655C784019C88C40F5BE63C006B034C0B527AEC0D2BEAC3F2D373240C9BC11BF4282A3C0E2B485401DBC46C0CE78B53D65C0D9BF81720A3FE7E4E53E72D5FF3FD9800EC0CB233940DC10A1C0DFABAFBFC3B036C024AA86BF76D8B53E033FF2BF0797B13FA06B2F3FDF5F2B40C444D8BE275130C0239D2140DB92BD3DE7273240139F7FBF76F00041D2E6F93EE5102640D7594EC06575B53FB94028409F3E85BFB9C42ABEDFBD18BFAE9F2D3FA2CB2AC0C84EAF400CA975C0C1A1154031EE21C0119F13C0414A0A4038EA5A3FC2C5183EC2995FBFE38378C0AECC88BF2C3FF4BD48DFE33F67ECA63F16BD01C182A322400582DE3FDFAF06C10A7E94C06C6F153F41FFB4BE49B22CC0DE0D62C082E58D4080D3873F15F2ADBF2F175B3F81FF98BE60EAA1BFB0883C40D3334A4000A8CFBE334A854043CA98400C9857C02F494040D527ACC053918CBE5E55D24099DD1AC0A1693AC0AE9760C0D465DA3F752B0740274881BFC78F083F61009240E5A800C03D4777400998FE3E865910C0DFA09CC0459C60C09EE2FBBEDD7C9F404AA7DA40D8811EBF75EB703FFD3C1ABD89C9DF3E1D1D013FCF2DA440008688BF69CC90C0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xCBA751BF8267D43F164C9C3E930AB0BFFD07EB3FFE28BFBFD848F83FECB5B73FB6434F3FDBF925C067DF45BF765EC3BF36CE22BFE6EFBE3F8303E2BDA6AE1340C415A1BFCA8DC83F78A0FABFBB7018C0CAB6493F8EBDF8BF61BFC2BFF57DACBF7D4EA0BFBC56214067CEDEBF61D95A3FF757D03F9AE00B40FA2C11BF021BE2BF4882E3BFD63004C0288AE1BFFE06DBBF853AFD3D9E07E93E5EC2FB3F406D11C054B5C73FA6DFB43D2E926ABF441EC83F91195D3FFCDCFA3F8AA11140020C0BC0FC0DA1BC2F18FCBFEEE8313F2E9763BF1E45A8BFBA01D3BF63F7064068251EC0BBC20C3DFB37F5BF9A09C03F632F17408B4296BE88FC91BEE36C903F15B7DFBFD24A95BFA43B104056A8F73F2C2AF4BE57E7953F28F189BF7C8E533F54C7D4BFD6353140549ABE3F73A70240DA6223C07F3CC8BF8F3D363E0C3E18C06B170F3FDCC4D93E0CAE27402F44363FC83B983F9087A53EDB2200409FE2AEBE8628B73F8AABDD3FEF5C9EBFE800EB3FC3B0DE3F2BD526407C8783BFDAA20040FAC789BE236B90BF8730D13F250994BF6E64B6BFE0981EBFA8311140EE359D3E0AA415C034679BBF4B4FD03FB2BBFDBE2E1C833FD4D6823FC7EE2CBEE0C2B6BFA437D03FE921DA3F5165FB3F2C5A0AC07EEFC0BFA7D01B4014F47F3FC20CDF3F23310DC01678D33FB8BBBB3FD7ABA5BFE4FFACBFB2F16A3F47180B40C5DDCEBF0621D4BF0F621EC0BEB31440DD6BB13CE0515BBFAE0EADBF259DF2BF2A0A953F6C22E93F24FA1840926D304012F7C03FD6591D400CBBB0BFEAECF53E9A4FBEBF743535BF9EE68FBE73ECFD3FD012D43FA51CF43FA3B710C08795F53F2A54A3BF262D783F1A09A53F61E47C3FBB4E07402045AB3EB6E3F6BE80CEE0BF70CFFFBF056708406A2DE9BEDA7136C081BAF1BF76B48DBEB44CD53EC084253FC988E4BF0EBB9DBFC76C51BE87BECB3F9C515DBF204C093FF5D88E3F14A902C02B681340B91D21C0862C85BF8A2AACBF1CD407402B621D3FADD20CC02F2840BC989DDB3FDB21273FA7B10C40702AD3BC900EF2BFAA0BA93E930BA33F997E06C0AE5A3B40168AD23FBBC08ABF317A07C068CEEB3FD6040540D0E6C03F93871340196FC1BFF1A896BF380997BF7645DD3FB171763FE18980BFD2A59F3FD7FA18C001AB0B407192AE3EEFF011C0E400853DB854D0BF8144B0BD8C1A61BFC8C290BFC5C4BC3E3A7DA53F8F4217C0C40DF7BF66F907403CCA1E40ABAD1CC0D5D600C02072AD3E7E93003FCCECEFBFD0B2FFBEF65E1DBE71752C3FC677813FF75A01C06E23ADBF573CEABFE92B1D403A59CABFAFEE0EC0B1576DBF76D60AC0A3581CC003808A3ED2D38A3F1C34BD3F2D90EFBF092E26C0DE7D02408E0D0C40129F7E3FA29B0840F4BB233F00361FBF333A043F42204ABF36210DBE1E410740A464BE3FA3154ABE224300C04DADB5BF7DB50BC032F87D3FDA9882BF4F6FEE3F0C9C9A3F1D85CABF710808C045240BC057D5653F8D76B3BFAF1AAA3F975EACBF6A17CB3FB3ABDDBE6C59E03FFC0B833F5279A7BF7388ED3F8171E73F0EFCBBBFC1629D3E6806F4BFB3DFF3BF2386C03F4E974C3F5EDF4B3F0FF8B53F8EBB0140074E853F9DDF094029C502401D45C3BF9F3431BF09F0A53FFEF4F2BFAF2E0440A2FC0B4096A7FDBF0969E1BF095319C062DD8D3FDDBFDF3FE2D40ABFA75B15C0EDC5084067F4ECBF393CB53DF394A6BF2075043FC9CBDE3E03B6B83FFE32C5BFE759E43FAC6914C0E7988FBFBEBDE2BF6CEF6ABF7439B23EB57FB2BF1DB9903FBDF9233F7A0BDB3F0A4ED2BEC475DEBF030AD43FD14DBD3D88B5DF3F245D61BF98283240B9E9F03E7447D73F698BF1BF12F8923FCCD7D83F23F968BF95FC29BEF4E110BFB47D223F9AA3DABF59BD1940488103C0ECEBCA3FA645D4BFCE54C9BF2DB4C13FFA6F463F1C36183E86FB49BF893804C05BDD6DBFE4ABF3BDA79FAB3F4E5C8A3F158D32C0B0CAD43F06F9A83FEBED34C0A2510FC0FE080E3FBA6CB1BE78F7DBBF72BCFCBFAE7A0C4036886C3FE6938EBF2592463FD6CE96BEC04887BF108DE63F5E10EF3FF758CABE31940840E41A114060E9F6BF1CF1E83FFE9818C0EFDB8ABEE83C25406BFACEBF2A2EE5BFF8EFFBBFB1E8A63FE30EBF3F9E7063BFDCCB023FCB420E40CD5FB9BF61E90340421FF53E38B4C6BFF8A812C07BF2FBBFB6B1F2BE7ACB13408CB127402ACF15BF4CCF563FAA331ABD6E36D93EFA5EF83E6B9D1540BA7C6DBF68BE0DC0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
