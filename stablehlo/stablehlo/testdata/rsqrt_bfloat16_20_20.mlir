// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.rsqrt %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x15C066BF85BE7C3F48BFBBC0BC4083402F40E33F4FBF37BFC13FB3BF984083C08340F540094142BF833F76C0BDC07B3E1DC0FABF4AC031404BC0BC3F643E55401E3FDCC00FC055BF3DC0F2BFDF3F15C02CC0293F1FC0C9BFA63EFC3F963FE73FAB3EB13FDD40C3BF143E7F40224030BFA93E9040573DD240AD3F7E3F2DC00E40A7C0AF409EBF193FCABFD2BF66C0C5BF3F40214055BF8B3FDC404CBF30400440B1BF3440B2C017C06B4053C037C004C0D93F8D3F03C0B9C0FE3D9CBFCF3F95403D4036C07FBF92C011C074403D400B4029C0FF3FF8C0A5C0E6BC19BF00C04FBE4FC00A3F0A4185BE1240E6BD12BF25C0F5BF0F4199C0273D8CBE40BE074030C030BF63BE3B40F23F7140A7BF93BF5E4046C097BF634022BFB0C03640C9BEE2BEBABE95BFC23E273F6CBE6FC099C01440964003BD77BF1FBF85BEF5BF51409140DA3E963F29C02A3BE1C02C40434008C0F13F62BF47401B40FABF9C3E90BFEF3EFFBFA7408EC045C0243FC7BFB840A840923FBF3FA4C0EABFAC3D88C04440504045C01F409EC0AD40873EE3BC1C3F244014C056408240E84011C0BABF50BE8F4015C01940824052C062C0ECBF643E5E40B93E16BF25BD173F12C08B40FD3E70C0F93F3D3F89C009C0073F81BE963F25C05540674066BF183FF33EFF3EAABD17C0F53FBFC0983DA640ABBE8FC025C0053FA240034030BFD640963F6A3F174085BFADBF17C0A0C0173F6340053F47C02DC0DE3F313FE63F66BF1FC091BFB13E7640F53F1D3FCD3F6F40A3C055C0653EBD3E3140C0C0EABFD7BF8E3F4DC08E40D03F043EFBBDDC40163D60BF9A3FE0BF93406CC0E93FDA3F5BC06FC0E0BF88C077BD6940603E9CBEDBC0CA405CC0A5C0A9BEC63EE140D640894077C0AA3F6CBF904061BE39C00B409040FA3F2740A6C0E4BE8E408F4058C0D93F0E408DBF11BF474019C029405C3EC33F6BC07DC08240B8BF3BC065BE3A402EC08FBF2CC098C0F0BF0C403CBF5E401B403D40A73ED93EE03FFFBF94C041C044C0CBBF19BF0140EB408A40163F0AC0183F9E3EE73E16C085C09BC080C01DC1D83F6CC067BF2BBFC0BE1A4008402E3FBD3FABBF2040A7BF4B405640EB3FFD3FBE3F0DBF0BC00D4038BF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC0FFC0FFC0FF813FC0FFC0FFD33EFD3E1B3F403FC0FFC0FF503FC0FFEB3EC0FFFD3EB93EAF3EC0FF7D3FC0FFC0FF0140C0FFC0FFC0FF1A3FC0FF533F08400C3FA33FC0FFC0FFC0FFC0FFC0FF423FC0FFC0FF9E3FC0FFC0FFE13F363F6C3F3F3FDD3F5A3FC33EC0FF2840003F213FC0FFDF3FF13E8C40C83E5C3F813FC0FF2C3FC0FFDB3EC0FFA63FC0FFC0FFC0FFC0FF143F213FC0FF763FC33EC0FF1A3F323FC0FF193FC0FFC0FF063FC0FFC0FFC0FF453F743FC0FFC0FF3640C0FF493FED3E153FC0FFC0FFC0FFC0FF033F153F2E3FC0FF353FC0FFC0FFC0FFC0FFC0FFC0FFC0FFAE3FAE3EC0FF293FC0FFC0FFC0FFC0FFAB3EC0FF9E40C0FFC0FF303FC0FFC0FFC0FF163F3A3F043FC0FFC0FF093FC0FFC0FF083FC0FFC0FF183FC0FFC0FFC0FFC0FFD03F9E3FC0FFC0FFC0FF283FEC3EC0FFC0FFC0FFC0FFC0FF0E3FF13EC43F6C3FC0FF9D41C0FF1C3F133FC0FF3B3FC0FF113F243FC0FFE83FC0FFBB3FC0FFE03EC0FFC0FFA03FC0FFD63EDF3E703F523FC0FFC0FF5D40C0FF123F0E3FC0FF223FC0FFDC3EF93FC0FFA43F203FC0FF0C3FFE3EBE3EC0FFC0FFC0FFF23EC0FF263FFE3EC0FFC0FFC0FF0840093FD53FC0FFC0FFA73FC0FFF63EB63FC0FF383F953FC0FFC0FFB03FC0FF6C3FC0FF0C3F073FC0FFA63FBA3FB53FC0FFC0FF393FC0FF6B40E13EC0FFC0FFC0FFB23FE43E333FC0FFC63E6C3F863F273FC0FFC0FFC0FFC0FFA73F083FB23FC0FFC0FF423F9A3F3F3FC0FFC0FFC0FFDA3F033F393FA33F4A3F043FC0FFC0FF0740D33F1A3FC0FFC0FFC0FF733FC0FFF33E493F3240C0FFC33EA740C0FF693FC0FFEF3EC0FF3E3F443FC0FFC0FFC0FFC0FFC0FF063F0940C0FFC0FFCC3EC0FFC0FFC0FFCE3FC13EC63EF73EC0FF5E3FC0FFF13EC0FFC0FF2E3FF13E373F1E3FC0FFC0FFF33EF23EC0FF453F2C3FC0FFC0FF113FC0FF1E3F0A404F3FC0FFC0FFFE3EC0FFC0FFC0FF163FC0FFC0FFC0FFC0FFC0FF2D3FC0FF093F243F153FE03FC53F423FC0FFC0FFC0FFC0FFC0FFC0FF343FBD3EF73EA73FC0FFA63FE63FBF3FC0FFC0FFC0FFC0FFC0FF453FC0FFC0FFC0FFC0FF253F303F9B3F533FC0FF223FC0FF103F0C3F3D3F363F523FC0FFC0FF2C3FC0FF"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
