// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}, tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4BC063BEA2C06D4035C06B4065C0DE3F2C40A8BF4140FB3F33401CBF954023C0A34023C08B4001C0EC3F00BEE73E38C088BFBCC0F83F193FFEBF5740E54007C0F03F5CC0FC3F35C064C0E8BF473EB5400FBF38C031401B408D40CF3FCBBFFF3ECF4003C1493F053D6DC069C07D40304069BEE93F833F8540EC3FA5BD44C007C0BDBFA8C0FBC097C0ED3FE03F45C0C94029C0B0400C4107C0C33F38BFB640C33E54C02B405FBF99BF7B3FA1403AC04B402B3EA3BF253F2E40163F26C040BF08C03840FCBF8440A63FCD3E4D4025401DC091404640264001C06A40014039C024409AC0923E0440833F9EC0024081400340DC3F7CC011C039C0474035BF4D401DC03C403F40883F05C0433F4D402CBF683FC0404C4017C0E8BFE2BF6DC049401040D540503EE83F0040533FBF400EC039BF21BF66C06D400B40B53FCE3F2DC056C08EBF9ABF8A401DC0713F693FBE3FA83F97BFBABE9EBF87C0F83F13C048C0E53E73C07C40C7407BBE1F3F06BF7EBF56401B4094BF71400FC0C0BEBA40C540FD3D0C3FBDBF9DC034BFBC3F22BF80C0973CC7BFC2C0A0407B3F903F1C40AD3FCB3FF7C0FDBE9EBF8AC0ACC069C04940D73F21C033C013C0EDBFBE3FBD3F0AC028BE0CC03A4029C014408E40224017C01340CAC039C06140564097BF2A40BD3E683F9240D4BF483F1EC0DDBF9EBE1540A2C045408FBFA7BF39402DBFA03F0E4042C0C8C0CBBD83C0D73FCDBF3C40F8BF36408BC0993FBD3EB53FFC3FBCC085BF40BF1BBF09BFE4407F3D08BF10C0ABC0D0BF1F404FC0D9C0B6BFBCBF8BC0AA4033406BBFB0408A407E40474082C0FB3EDA3FE4C0FC3B403F6340263F7DC028403640803F35C0813FACBFF4BE4340AB3F69C0413F88C0B9C0B3BE28C0A54078C0D03FA33D2F401CC002BFF23F034089BF1940DD3F8EC01540EBBF3BBFDD3EA9BFE73D1E409640B8BE62409AC0F8BFD7BEA33F58BF1D3EB43FD7BF063D813E77C08A3F0C3F3CC0A7C0EE404AC04140B63F4AC0283E6FC0424028C02AC0F5BF8D40B94037C0803F51C006400ABFF53F4C3E1F3FA03F81C03840CBBF69BE01C09CC03C4058BF99BF383F09C007C035C03FC05C4024400E40534040C006BF6DBF3D3F17C0"> : tensor<20x20xbf16>
    %cst_0 = stablehlo.constant dense<"0xC2BF7BC013BF2BBE4DBF36C05F40653D99BFF9BF1840C73F703D89C0C3C086C06DC01B3FAC40EF3C35407D3E8D40144046C07B3FA24065C0ADBFDBBFE7BF6C3E2F3F1FC0C3BF57BE1040C13E78BF2140034023C034C0434062C003C05BBF53C0A0BF31C073BF13BF04C00E40943F41405A3FBB3FBDC090BE523F5240964058C0EEBE89C09DBF3BC049C009C0D2C0F73FE1BF99C06840BCC0AEBFFABFFBBE2CBE7240C03F33407A3F20C0E83F47C0EFBF1C3F83403EBE0FC04940F63EF23F42C07B3F0D40F3BE7840A5BE8BBFDABF9640C43F3C40FC3F89C09EBFC5BF22BF9440603F884027C026BF4BC00B412EC06F400B407BC0A0BE4C402DC04FC055C0E53D0C40824087C00DC104407FC00CC0A1BF69400EBD3940BC3D32C06C3F0EC087C08DBFF7BE96C0B7C0393F44BEC23FAD3F573FBEC09EC0563F01C1913F4FBFD03D013FD73C6F4091BF92BD0B405CBF1B406CC0664011BF82409CC00D4099C0AABFE53E003FC7C007C09D401BC0ED3FB5BE27400940303FDB3F65C0AEBDDCBFC2C0E9C0764009401B40BB4018402BC0F83F7440AABFF6BF8E3FC6BE9AC0ECBF84C086C0BB3F74C02E3F2CC0A24045C052C0473EEC3FF7404240DA404A40303F09400C406A3F72403EBF88BFE2BFA4C0D5BFABBE234006C08C4031404E3F54C0FCBF3FC0823FCE40583FA740FF3F503F58400D3F6BC0E03EB23F9AC09BC06740ABBE76C0A2C02EC0EE3FB4404FC0B6BE09C0CCC055C08ABE4C3E2B400D4100C1BC3F884045400D40723F8440883F903F9CBFA9BE263FD4BFB8C00DC0313E3CC0E33D3A40CE3FD440BBBF5A4090BFF9BE4F3F973FA1C0E5BD1BBF15C0A6BF223F7E3F01C1BCBF9540EABE2640713F80BE05C00E3FEC3F6DBF1E40143FA8BE8BC0633F97BF0EBE53BF1940F13F15C0F440D0BE4AC0CF3F53C09FBFD5BFF83F2F40E03F04401F40093F0A4050408240A8404BC0ED3F39C065C04B3F14C03F40A7BF8AC078BF223F85C0E73F7CC0F53EEE3FB8BF4AC0A240B93E3440CBBF37408DC0F83F21C055C00B40D5BEC33FC0C0B6C028C0C63DDB3FEEBF0A4072BF3C3E0A40DDBE403FBD3E0FBF06401D40C340423F3B40C13F65BFFAC069BF0E40AEC0CDC00BC0"> : tensor<20x20xbf16>
    return %cst, %cst_0 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC2BF63BE13BF6D404DBF6B405F40DE3F2C40A8BF4140FB3F33401CBF954023C0A3401B3FAC40EF3C35407D3E8D40144088BF7B3FA240193FADBF5740E5406C3EF03F1FC0FC3F57BE1040C13E473EB540034023C0314043408D40CF3F5BBFFF3ECF4031C0493F053D04C00E407D4041405A3FE93F833F8540EC3F5240964007C0EEBE89C09DBF3BC0ED3FE03F45C0C940E1BFB0400C4107C0C33F38BFB640C33E72402B4033407A3F7B3FA1403AC04B401C3F8340253F2E404940F63EF23F08C038400D4084407840CD3E4D402540964091404640264001C06A40014022BF9440603F88400440833F4BC00B4181406F400B407BC0A0BE4C40474035BF4D40E53D3C408240883F05C004404D402CBF683FC0404C403940BC3DE2BF6C3F49401040D540503EE83F0040533FBF40C23FAD3F573F66C06D400B40B53FCE3F4FBFD03D013FD73C8A4091BF713F0B40BE3F1B4097BF664011BF8240F83F0D4048C0E53EE53E7C40C7407BBE9D4006BFED3F5640274009407140DB3FC0BEBA40C540FD3D0C3F764009401B40BB4018402BC0F83F7440AABFA0408E3F903F1C40AD3FCB3F86C0BB3F9EBF2E3F2CC0A2404940D73F473EEC3FF7404240DA404A40303F09400C403A40724014408E40224017C01340ABBE234061408C4031402A40BD3E683F9240823FCE40583FA740FF3F1540584045408FBFE03E39402DBFA03F6740ABBE76C0CBBD2EC0EE3FB4403C40B6BE36408BC0993FBD3EB53F2B400D4185BFBC3F88404540E440723F8440883F903F9CBF1F40263FD4BFB6BFBCBF313EAA4033403A40B040D4407E405A4090BFFB3EDA3F973FFC3B403F6340263FA6BF28403640803FBCBF9540EABE26404340AB3F05C0413FEC3F6DBF1E40143FA54078C0D03FA33D2F4053BF1940F23F0340F4401940DD3FCF3F15409FBF3BBFF83F2F40E03F1E409640093F624050408240A840A33FED3F1D3EB43F4B3F063D3F40A7BF8A3F0C3F223F85C0EE404AC04140EE3FB8BF283EA24042403440CBBF37408D40B94021C0803F0B400640C33FF53F4C3E1F3FA03FDB3F38400A4069BE3C3E0A403C40403FBD3E383F06401D40C340423F5C4024400E40534069BF0E406DBF3D3F0BC0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
