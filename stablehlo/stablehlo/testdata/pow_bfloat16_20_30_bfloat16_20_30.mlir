// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x30xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x30xbf16>, tensor<20x30xbf16>)
    %1 = call @expected() : () -> tensor<20x30xbf16>
    %2 = stablehlo.power %0#0, %0#1 : tensor<20x30xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x30xbf16>, tensor<20x30xbf16>) -> ()
    return %2 : tensor<20x30xbf16>
  }
  func.func private @inputs() -> (tensor<20x30xbf16> {mhlo.layout_mode = "default"}, tensor<20x30xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDEBEC63D8240934083404240BC401CC0CABFA6C037403A40C14088C0AEBF5EC01340174067BFAB3FADBF5DC0593FA9408D40884005BD4F402140D2C0E2BF6EBF18411140FAC0FBBFABC03AC0E83E174015BFE63E8CC0294082C09BC0F6BFA14032409E3EDE3F4CC051408C40AB4050C0CE3D6E406640A3BEF5BF7CBE0C40B5BF233FA540A0C0464093C074BEB43F253E23408B3F9A3F9D3F51402EC0A9C01440193F41407040383C5CBF9540F73EF83FFD3F2FBF8140C4400BBF2F406D4023408A408240B93F59BE21C0A1BE004079BF723F0240FCBF85BFD6BF8CC070C0B6BF87BFE13F72C0943F2FBF2E3E0BC0924073C07B3F35C05F40EB3CF33E3EBF8840CCC0AEC0D3BF80409940053F183EA1BF01BFBC3FD6409D40EBBF0D40884012C0073F253F18C0343FBB4014C08940BEC0953E323FBCBF0BC079400ABF0DC181BFEA3F3E40BABFAA3F893F244013BF2640E0BFCB3F3DC0874061BF763E533F84C09BC0D63E37BE89BFACC0A9C020C0543E223F36400FBD84C01C40A5BF86BFDCBF7C3F0940CAC07B406DC0B4BD913FCDBF89406EC0B5BF873F9F4014BF0AC0C440ADC023C064C090C063BE01410C4037BF06C0B040F83E58C04240FEC0A8BE9B400DBF25C064C0133FACBDADBFC5C09FBFE13F10409C3F9B3F09BFAABF673F3EC0F9BF7940A6BDAE3FDA3FDDBF2F3F32BF48BF1E4060407EC0153F5E3F10BFC5BF31405A404B404DBF47C098403D40E3BF41408DC0D73E6EC01FC0243F9CC014403DC086C0CCBFBB3E804003BFF53E8440234004C0633E574006C09BBF843F4DBF67C058C0CABEBDBF09400EC06ABFDA400440AAC0FDBE0C3F26C006C0DFC006BF614043C041BFB2406DBFC5BFFF3DD1BFB8C006C012408EC0BBC01A402B400840A6C01C3FC03E42C031C0C0407B3FA13E82C03EBF5FC0AC3EB7C006C0554069404840A33FD93F3F3F4ABF05C0DFBF9440B0C0D6C050C0D83FEC3F5FBF89C07E3F693D8940DBBF95BF3540843F29C04F401DC152BFA9C044C0673FA63F2540A94004C0A0C025408B40BFBFB23FD8BF90C0243FD83E6FC0843ED8C0EBBFAC3F403F093F10C05EC00B3EDD3D7340EC4093C0CE3DB8C02640134048BF3FC0AB406B3D8A3EEABF90BE793FA9C0F13F11C03040053F80BF6E3FFB3F7ABE5340C3C0A9BE68404240B8408F40B2C05A3F96409BBF603F7540C0BFFA3F5FBF2D408AC036407EBFF740093FB43E0440C5BEFC3FD9BF16C029C0B93F8DBF0ABF7DBF62C0223F743F89C00D40DE407CC090C088409E3E3D3CF23EA23D18C057C0E8BFA9C061BD84C077C0DABEF3BF8540604087BEED3F40C097BE9640A140793F0840A5401D40D2408DC004C104C011C0DDBF9EBFB6BF3CC06440F44002C03240253F30409F4088C001C136BF2CC02BC0274024C06EC024408EC0C2BF634092C0BA4038BE3B4046C026C077C02740D63F14408AC0BFBE4440AFC0EA3F58C06640E33F33C08E4063405640C13F93C08FC04F3FC4BC9D407EBFC63F003F22C067C0AABCC63F40C07440C2BF6FBF1AC00BC093BF2C40CDC0473EA2C051C0A6BE13C03840024078BFB5BF2CC0503F0A4012C0E1BFD54046C0864070BFD8C011C004BF2840AC401141024028BFEFBF38BFE93FCFBF2140B9406240FBBF7B40CD3F7740AF40743F0540E9C041BF813F8340713FC9BF134098BF"> : tensor<20x30xbf16>
    %cst_0 = stablehlo.constant dense<"0x42407FBD25C06440AB3ECEBFDC3F20C0C9BFB2BFE53FA63E814071407EC0C23F0F407D40873F723EE4BE9740993F83C005407E40B63EC7BCCABD81C04EBF2B3FBFBF9DC0AEBED440253E903F393F403E223F1BC0164024BE5140AC4009408B3F25BF404082407C40D93E41BF51409940A5C0A2BF0340573FF03F3D402A4031BFEA3E9AC0A3BF0DBF1A3FC73F983FA2BF2DBF24C080BF9740F1C03E40B0C0843F05C0673FECBFF6BF7AC0D83E5AC0DC3FA63F293F9BC048406EBF8ABE2A402F406CBD89BF49C01B3F19BF3F40773F28405F407E3D2540A2C0B840EC3F52C010C0D63F9C3F843F463E42C037BF8F4063C09F4027BEAD3F4CBF0AC0BBC017BEA6C06F3F863FC4BCE4BFB44008C0F7BF83C0E53FC73E14C0EFBF39C00A40FA40F3BFB6BFE93F35C04340CFC04DBF1241DAC069C027BF6B40A0401FC0733E32BF31408CC0DEBF184112BF92C0D140CFBFE3BF9240EE3D90BF86C02840833F4040683FE9C0F73FCBBF983F733FD0BFE1BEB8C057C0C4BF624026C014C0BD3C593F81C0EDBF1A4042C0E7BE38BFA9BF4940DDBF75407FC021403B3FEC3F3F3F1CC03F3F7C3F8EBEF9BF27C024BCEE3F473F21408A3E13C0583FBB3E51C00B40C5402DC03B3E4FBF9A400040933F7F3E8C3FDD3DA73F6EC0C43F394037BE9A3F6F404CBF063F203E9CBFB2BF4F3EE23F233F85404D40993E44BF4840A3C0074109C0D2BD5640C33FAF3EA33FB4BEA1BF1F4010C0CF40BD3F22C0B9C0443FAF3EB7C064C002401BC0C4BFB1BF443D66C0884083C09B40994024C0D83F014081C0C43F06403640884013BF853F043F69BFB5C03D40E8BF4B40CBC040BF54BFF53D24C0514090C09DC068C0D8C08EC015C0763F56404B401DC0983F0CBEE93BCC3FF9BFABBDF3BF8B402CC025C01C4018C041C08040124025C1E8C09CBEA2BF8F3FC0407EC04DC04DC0E94028C027BFC93F6B40F5C0B2BF34C0AA40863FD53FBBBF0C4025402B3E893F24C0ACC0D2BF72BF8E4090402EC043BF5ABD3140C6407340FA3FBA3FF9C0543FA13F06C095BF66C0F5BE963F76C098C00A400A415CC01CBF023F39C0783F4040583F57C06E3F714007C1ACC017BE34BF13C00340E43F40C0A44098404A3F1F402C40FF3FE6BF68C0A1402A4003C03240E5BE824023C0BBC008C063402C4000C1A040DAC0783F3540C8C0A1C0D6BDADC0253F19C00AC0FC3F434065BF9DC02EC0C0BE3CC0DF3FACBFCB40A8BF183F92BFB2C0D8BF333FD83F4CBF6CBFC6BF4EC035401A4090BFBCBFC63FADC0A1BFC53F67C050BE06C03F3FC340E8BF124098BF3DC0173F873F60BD1C404CBFF73F2D40DC3ECCBEA1C04E40ACBF7240313F6DC044BE84C035C00C401E400AC0C640B8C08A3E83BFB4BFE3BF2E40733FC0BFA7C0A63F40C03D3F34403CBF2240A64098C074C051BFCCBFE83FBEC064403AC02F40B73F1D3E11C025C091401C3F3540053F063E43C0D33D1BC00EBEB6401F3F823F3BC03740A53F2DC0A4BFA23FABBF46BF823F994032C04CC096BF13BFABBFBEBFFEBF37407D3FCB40D1BFC83E533F0740A1409C3F8D3F8F3F66C0E6BF0C4066C0863F1CC02DC05E406040014019C095BF0EC0543EE3C09DBF6A3F9C3F91BF8EBFDC401CC0BE3E91BF6F3F124089C06FBD05400F3F35C005C058C0B7BF42402FC0394084C0DE3EF1C084406940"> : tensor<20x30xbf16>
    return %cst, %cst_0 : tensor<20x30xbf16>, tensor<20x30xbf16>
  }
  func.func private @expected() -> (tensor<20x30xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC0FF943FDD3C6543CD3F2C3EA841C0FFC0FFC0FFD240B53FAF44C0FFC0FFC0FFCD40EE41C0FF893FC0FFC0FF523F903AAE419C43C0FF793F6A3FC0FFC0FFC0FF0E3D943CC0FFC0FFC0FFC0FF103F963FC0FFDE40C0FF5B3FC0FFC0FFC0FFB940043FF13C1641C0FFD33FA83E6E43C0FF0848423E5B41C0FFC0FFC0FF0041C0FF503FC439C0FF093FC0FFC0FFC03F2141083F4F3F553F28400D39C0FFC0FF18403B402D40B33DAE45C0FFF53F404147401B40C0FF993A9043C0FF433F02424E416B3F643EA13EC0FFC0FFC0FFFA3FC0FF523F863FC0FFC0FFC0FFC0FFC0FFC0FFC0FFFF3FC0FF843FC0FF6340C0FF963BC0FF803FC0FFBD3E04459C42C0FF103AC0FFC0FFC0FFAD3DD04581401F42C0FFC0FF953F4A3C523DC0FFB0409E47C0FF1F40E63EC0FFAF3E3837C0FF0D49C0FFB342A23FC0FF41C20C3DC0FFC0FFC0FF923D1B3EC0FF5A3F3C3FE943C0FF3D3EC0FF873FC0FF1E3BC0FF6E3E0F3FC0FFC0FF3E3EC0FFC0FFC0FFC0FFC0FF064695404F3EC0FFC0FF023EC0FFC0FFC0FF843FC840C0FF0A3FC0FFC0FFBD3FC0FF8343C0FFC0FF853F9A41C0FFC0FF7740C0FFC0FFC0FFC0FFC0FF4242EB3FC0FFC0FFA33C0B3FC0FFDB3CC0FFC0FF663CC0FFC0FFC0FFA93EC0FFC0FFC0FFC0FF0640493DAD3FDF3FC0FFC0FF2E3FC0FFC0FF9E3FC0FF273F8F3FC0FF493FC0FFC0FFA83FC43EC0FF7C419A3EC0FFC0FFF041CF40BE3FC0FFC0FF103E6C41C0FF9E44C0FF1041C0FFC0FF5C3FC0FF4F3DC0FFC0FFC0FF8140893FC0FF333D463BB942C0FF3E42F740C0FFC0FF863FC0FFC0FFC0FFC0FFC0FFBE3FC0FFC0FF90438A3EC0FFC0FFC93FC0FFC0FFC0FFC0FF653BC0FFC0FF1C37C0FFC0FF0A3EC0FFC0FFC0FF2A40C0FFC0FF8240173E703FC0FFEE3D5F41C0FFC0FF683C883F203CC0FFC0FFC0FFB23FC0FFC0FFAA44C23BD53CEC3E3B420A40C0FFC0FFC0FF0837C0FFC0FFC0FFDD3F3140C0FFC0FF7B3F1F3F9840C0FFC0FF3A3E793FC0FF4543C0FFC0FFC0FFC0FF083F2C40CB403441C0FFC0FF53403D3DC0FF9D3EC0FFC0FFB1407142C0FF0C37C0FFC0FF953F13400C3F36C1C0FF4D44013E18434D33C0FFB43FC0FFE53DB040C0FF1ABDA845AA35B63EC0FFC0FF723FC0FFCF3DC0FF6B417540C0FF843F7741C0FF763AC0FFC0FFFF411339C4451C38C0FF233F8638C0FF823F393AC0FF4F3EC0FFE340C0FFC93EC0FF7D3BA23FAC416240C0FF9342C0FFC0FFC0FF043EC0FFC0FFC0FFC0FFC33F8A3FC0FF1541D342C0FFC0FF164110448943A23E1446C0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FF90406F3FC0FF1D3FC0FFC0FFF93F063F933F3541E23DEE416B40C0FFC0FFC0FFC0FFC0FFC0FFC0FFC0FF303ADD3FC0FF733E0B407A419340C0FFC0FFC0FF53BDC0FF6D41C0FFC0FF0443C0FFC0FFB63EC0FFC241C0FF3642C0FFC0FFC0FF943FA03EEC3DC0FFC0FFBE41C0FF8B3FC0FF923F803EC0FF96450D405A409A3EC0FFC0FFE33FC0FFF040C0FF373FFD3EC0FFC0FFC0FF1A3FC0FF2B3EC0FFC0FFC0FFC0FFC0FF4C3EC0FF853EC0FFC0FFC0FFC0FF5040A03DC0FFC0FFC0FF4E3F1D3EC0FFC0FF3E44C0FF063DC0FFC0FFC0FFC0FF9D3E95406B41E53EC0FFC0FFC0FFA03FC0FF17405B42943BC0FF8941A73FB43CF03C973FB43EC0FFC0FF833F443B793FC0FFF741C0FF"> : tensor<20x30xbf16>
    return %cst : tensor<20x30xbf16>
  }
}
