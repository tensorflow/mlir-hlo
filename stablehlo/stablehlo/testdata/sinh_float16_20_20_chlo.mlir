// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.sinh %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x76BA583C3A3FAEBCF83E3C4519C2C33C4BC0D7C3CAC37BC2184114C40FC452BF3540BEBC91399FBE9BC699413F3E073E6531084379BE63C2A23B824276B839332D4156C084BE19417937D5442DAF1CC0243E86C2C9BF5338C018B2395AC11440CE4119BF364098C14C409AC1D33D4941C6C1AD3C4B3BC93F9F3834C41AC6034068C0863515BC2EBF884480C4DAB9DDBA4B4392BF433299387BB40A402E413E3E60BB7CBCE4BD0F4333C183C17AC335B5FE42124081BA9943DF30DD44DEC328BD65C1F734B5443DC17C41A13F443892C45DBDB54376BDE3416D2F15BF12C5A1B447BE59C191BDC73BA4C304C0953FCA4522C118367E3A2C3D5C45E03DEAC601BEA0BDBE3DC8BEE8BCE9405CC13BBA8DC7CFBA974126C2A33DB7B9C1BB2239FBC295C61CC6ECC4C5BA37C0654360364BBDF2BFAFBFE0B66F40A2C360C328B746320BBB6CB221400ABDACBD9446993C973E81C50542FB3C0ABD0A4110C2244284C1714570BDFF3DA6311DC27DC121C1264498B3C5BD0BBFF4C15D9FD7B5AB12DAC6574651C693B918BC1A41E23EE040703B1D410D3F4B372EC2B34571C3754368C3DD40C5BBC6BBA0C46F3853AC25BE2FC06638B338F5C315B6DAC014413CC42DC240ACC33977B9103CE93D4BB802400DC114C8C1B99D3ABD445DB8A4C3A92E99C12CB018C2053C683681BC7040EBC385B6C8C1AE449A417DC2063C0EC21747E3438141A8BC08BD873FDBB6442DA6BB5AB3E8BCC5C561C43C400F44B5C13AC410C5D7BF90C14244A83A7E41A939FFC045C355C0D7C0F1C42C3898C097459CC445B52E284A3444C13B395638EA36BE45EBC1BBBC63BECF469840763D08C25EC5E44061BB0BC0E9C2F2B877372E3EA93E68C29BC246BF5C39C04034BDDC3F3BC0434099C3A9C1C1427BC363C0643CDD43AFB5493B4A4035C4B6BD21C2DE412444173DFB3F0540B1C102B9E73AA8C5C2449D3EF6C3883FD1406CBE59C155439C3B4A46C7B7EEC06FC12A3747BE1CC69A2F3CB572B4E1C18EC13A3439BDCE3D3C4401C1674129BAD33E4F3C4342683B4E48B1C309B87EB8503E88BCA7C52B46D9BF4130433E4442CEBD46B9F2BAF83DD8BB28C0AF42F73F47C4463E3933B3C2A5468C46"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x30BB403DED41D3BD8941DD5543C9F83D38C44CCE24CE60CA584661CF3CCF13C20944EFBD073A0BC1C6DD17488E404A406C31334CD8C015CA6C3C774AB2B849339D4650C4E7C05B46BF37D75331AFADC36D4084CADCC28A38C018303A3AC78E438A48BAC10B4415C83A4419C80E40FD4678C8D13D2C3CDC42E2382ED0FADA4C4379C4A235D4BCDAC1CE51A0D163BABDBBCA4C7CC24D32DB388AB46743A0468D403CBC7CBD22C0424CB1C6D6C740CD4DB51F4C86433FBB944DE4300C5462CEB5BE63C70B35EB52D3C6BA479642783809D21FBFE44D53BFBB48712FB4C1FAD4B2B498C037C78CBF883CB3CD50C381421B5979C63E363B3BBD3EA5561D40DDDF43C0ACBFEE3F44C13BBEC84542C7E1BA6EE3A9BB134866C9B23F37BA83BC7E3918CCA4DD08DB4AD49BBB0DC40A4D8C36FBBE27C3AEC217B78944ADCDFDCC66B75032FDBB77B2C1437BBEC6BF9E5DAE3D0041ADD70F495F3E7BBE2C462BC96049DAC7365746BF4140AE314DC9BEC775C6EA4FAAB3FDBFA5C1E4C85D9FF8B5AB1263DF6D5C53DC09BAD9BC5F466941AE45473C6846A8418C377BC9AB5829CD334D12CDA54586BC87BC60D2AA3854AC6EC0FAC3A038F938ADCE3BB69CC54B4650D079C941AC463AE6B9CC3C274081B8484335C6CFE643BA653B245395B8B3CDAC2E17C82FB040C9BB3C943685BD8B448CCEB4B67DC8BC52194866CABD3C26C9B060724ECE47C8BD78BE6A4211B7462D6FBC6BB33BBE02D9FCD018443C4F53C847D0F0D4F5C205C86A50743BC247253A0AC6BCCC4EC494C560D45D38ECC42F5847D25EB52E285734ECC69C398D382237DF58CEC8EABDBCC0135FEC44533F17C9B2D6B9453CBC6BC3E8CB44B9BD377940194124CACACA00C2C5395445CDBEFE4216C4274494CD39C8504B43CD6DC4543D5F4ECEB52B3C364432D0DCBF58C9AF48DA4F943E384354434AC857B9CB3B78D848530841B1CE6B428345C8C037C7E24C683C355C0BB8D7C588C7683798C008DB9F2F54B581B4B7C801C84734D7BE0940505010C66A47CABA5341313DB649413C5B69D9CD35B8BBB8A44091BD74D8755BF9C244309340B94909C0AAB9DABB394095BCDDC30F4B304381D0974049331DCB015E725D"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
