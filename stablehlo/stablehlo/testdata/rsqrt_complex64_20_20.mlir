// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = stablehlo.rsqrt %0 : tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE5DE8540076CAD3F29C4A2BFCA188ABED1ED86BFE289B63F683A20409B2EB5405D5109409915B040CE1E343FD4E562C0932E1FC0AC9EDC40CC7EADBE800503C105E46C4052746BC0979CA83E6AB2B6BF11686D40599F05C0633771400DB69F3F8D6FA23F629C1240A26511BEA500624066A23DC05104A4409E915E40EAE6EABFE698F23ED9CE35C01D25B93F6D1C19BF5A3C9C40C91F08BF6D5F5DC0353E26407A2CB13FCC52A5C09DE5BDBECF2300408DDD6AC0FDC6843F0CFB69C072320FC0E41DDD3F9D7B6CBF35939EBE2BCB7F3D8846D2BF3C338140365BD03FC8D05640058304406D002AC0B49833BF6A73313F0AAC43C0828BA23FB23FF8BFD6754FC0003EE13D3C39A5C0B70E5D40C3FB5A4001AB1CC071DC213F3F1F2C3FD504EABFD09DBBC0B594FEBF47969040501BA04061704BC0A87847C0D5D0ADBEBD78BF3E6936C2C0239B3FBFACE66840B49F3FBFA933B84023D191C0003F064030AD4E408B8950BF4540083FCA71963EE189D4BFE44F0DBFC09B0840384CAF3F3410B13FA05553C074D253C0843AD5C0A304794028BF60C0D5C22D40A9ABB1404133453F579692C0BF67BF3F58C7FB3E905D00C0EA1335BEBBBD4F4040C082C057F4C43FEF13A440C17904C099A201BFA621304067C04240BBD316C0D8AF8AC09E6E893F5974513D61D456C0B21D2C3F8CEBB0BF95D696C03BB9C93FACC4B9BF22C1AC3F23DE2D40D831A2C06787A7C098A6CF40A9764C3F69F8C73F4772A3BE647A58BF698158405EF783C08DCB653FD3468DBF80CCBD3BBA2391BFB3B85A40D6FD453F0F170F40CAAB1540415184BFADFDF53F91445BBFCCB3CEBD8CB1BDBF4ED4573E790C773F14078DC0B1C0713F8CD6ED3FE921933FC1F85AC0EA9B6B403CFB7FBF06E43D40E749073FBF5A5240692ED1BF6825344078D7DB3FBEBBEEC0B60626C04DCB82C00E9227BFE11B8B3FD35DC1C03BAF5F40C69B423F773984BEBEF56AC0CA0286407674CDBF841C1A407636A1BFE031933FAC7D18C04A8431C0ADD978C0916CEC3EDB34CEBF93597D405327524024733140D9F8833F1230B23FCDAFA53FD47D06405E4C2440E09E59405FEDC9BFEA56DB3E9E8037C0FE4EFE3F05447B3F2683AA3E581AFF3F4C362DC02CD0093F1AB9AE3F37C7EC3F15C5BC4009B3CABF06EE234049502A403C4DBEBE08D986C07064F2BF2E2D6CC043419A3E0A862140B071C93F0F32BA40C525933F7BE506C047F341BFC1218AC0D3BE6F3F74175DC0A830E33FEE36AFBE50ADB2BF9D091E3EFA419B40AFEAF9BFF1532BC043F603BE341F89C0F78733C0A2C3CFC00DFEBE40CE633E3E22DA7CBF1759953F9E483AC02C86C33E33F20041B924F93FB5DB1E400338193FF44EE9BF1F5248C0DCFFBDC012FF6DC096E2013FA8CCE5BF72D0E43FC88E824083B5A640ECABF1BF73DBEC40091A8B3FD3FDBBBF790BCBC0D86FA5BE00468D3FD12EFD3EB155853FD21FE4C09CC58340D7E19640DEE3064063D092BEE7C8E93EFF0F0940C7D25BC03EB021C0852CED3E9EFC19C07C1CB53DF5FC0A40A5633D40F9AD5EC02D5438401D809AC0EE8FB33E1F150740C68AC84053604940CE0317C036AFDABE0E1AE83FF4DF03C0C72B1AC0C93C39C00729CA3DA60B4CC037188740B47C2ABEF1A43740EDA68740C567A0C0EFC1B2C0C9F783BEE9154C40FDAC00BF3EA941BF5D25B840C12608C0AEFDC1BE62C3A4BF5CF6B1C0AA44D03FBB8C90C0BCFDB83FEA8C1640E67BEEBF8E5C0840A333013F35714BC0462B4E40203AB8C08E0800C11FB6A0C07A3DD33F053AB44023CEE53FBC37B0BFC33E193E721200BFDBB248C0C2FA98C0EC8110BF16095BC087377B4072F0A9C0C803F6BEB671EA3EDD1F9EC05C5DDF3F154B1EC007A487C0E0B1BD3F05A2583FF0628840BE8B954077F74640D9D2CC3FD594BABF5C6BE23C9AE1FD3E1202093E37DD06BED531774073C474407265D8BE43E037C0AF8BA5C05D7113C00449A23B257EA53F1ACD664079C335402B687DBFFDA153C0C38074C06728C4C0770FE53FD1651FC074E5A7C048694E3F068BD340659D76C07F8FA4C039D876C000F81EBFBC2199C0F8BC433F61BC2F40DAC2FEC0C172DE408EA7CE40768023406D94D9C093531F408292C140B4660A40C2EF87BFF61F86407A42B7BF8A7020C07B9107408F27143F408307404C8014405A4F5F40299394BF6F5B5F3FC823083E168CF43F728484C0E8E18F3FAE9986401DE11FBED000D340391C4F3ED4D819C0B5C3B340F3311740EAC42840DA1FA7BFF269D4C020D5803ED37389BF47B03C3F6AF95ABF1662AAC0DE25C2C073B215BFB8186D40953CDD3F20FD15405A4A903E76945ABD4DF87340C3CE0C405E7554C00A3153BEB414AFC0C4F4003FE4A977C0CE9B10C014CB6CBD4D89793F4C24843EFF4591401416B7BE016CBDBEB66625C07783903DADB2CC40B51CB73FD45F204088A64BBF17CF1FC087EA02C08C5214C0354F2640026CFA3ECBDD9F3CA3801D40A8AF283F7B0FC4BF1B8716C08309A5406E4DC2C06F4BB74056C59DBFAE47DA404EB06DC09A365440E92584BF8A4FDE3FBD7402C090EAA93F302B4DC08FEA1040FDFD19BFDB2F01BF3E3027C072886BBFFE4F27406D24B7BF21A041BF8C6F86BF9EC47B405427623DAD2B5D3F0757FCBEFAFD0D3FAF4095C0C47C2B409AD5B13FF408AE402750664093EBA2C0824952C0FDAE21BF7A8BEABF9F16F13F7F5F3740227F8EC090356C403096ADBF36ED95BF5E02323FE5B004401DD1C2C057B9A2C07D41AFBF62B974BE1DF74AC01FDABF3FD83113C0994384C06B91923E67F3EFBFEBCE8CBF1B0ADE3F1D712AC048A0E5BF3FE6AEBEE407F3BE2F55473F51841F3FF69780C081FEF9C07C0D28402FD9F5BBD6EF86C06832B4BE29403EC0B364C2BE264634C0B0C8ED3E598AC1BF6CBE9940FC4DBC3F7C890FC014D8E8BECF33E33E3D5DAEBF8629E13F55599FBEA80C5DBF16B3803F2193AA3F9F63AF3FC6EB8CC00B5999BFDDB14ABF1328FBBF528F4EBFA17D17405AEB533F5DABD5BF77E171407EF925C04E64C53F5FD00EC0C3B92140AEEC0EC098C087BEE26CA33F87894D40EE9D92406146813FCD6E134134D50D404B1FF3BF459622BF89731FC0686059BFB04BAA3F4729D53FB0ED5B4031D7AB406E6C0E40E5C1C83F299622C0723F9F40979693BD269CC1BF3FA8833FEE7DBF3FCB0D25C08B1082BFF3A3AC3E759C40C07413FB3F6FE3863FBBC77E3F3E063DBEA91B0141267BA1BDEA6B1CC05A49F83F5D5BA84097E7DA40DB535B40A12363C0774E4340828308406A0B1A3EDBCB95C0258E1B3F71D562C074F233C0664616C0A52E76C0A3007B40CCBD214018848EBF83FD8A4038036C40EF9310C084CE97C0441787C05FDBA03F815960C0CB8B373F68E18C4024956A4087218D3F8E2045402886684046BF9E3FFB0E6F40BE78A83F1ABEC1BE3ECD83BFC6B4C3BF433C18C042081D4095E2813FE9115D3F63119AC031E30DC0B443CDBF5163593F5677B8C07DF36FC0F9C3AF3F2B740340A23FF03F28C026BF372652C0C47949BF052DFB3FD2E9AEBF083738BFBB1923C02483633F918F50C0CF111CC074FDFAC0069B5CBF102C1A3F0421643FF9AFAFC0890F04C01F898CC0DD2180C0EC9550C0E3DA2C3EEBE3B8405BD49B409C753F3FD7319F3FC6B4904065608F3EC30D00C03CB958C0D8D197C0EDF623C052E42A40FC82C2BF7C23B540FF94D9BF8342AF3FE659D53FC1C29B40C313584084D338407C53383F23FFA9BC206B98C0A322F7BFB6D4A0409868913F64E9A83F22476E4093FAF93F2A52CEBF74C659C0B4F2B4BB64B7244002CE6BC010C314C0045ACC406ACB11C0D118893F839927C0589F7D4067ABACBF2628883FDA901B403C0CEA3F76BA7CC03AC90ABF8413863DEB952CBE95BEA6C081BE02407CC5C3BFF2D96CBFA4B8A1403172AC3F4ECE21BF4B9351C0950BD0BF953A61C0351023BF910BB63F97A560BF60814040821CFFBF78BC56BF491FD33EBF056EC07BF4F53DA01BBCBE428B9B40317C654083AC56C06DAA45C020EE0A40FF8951C0C44281C0E7CD3A40EA18B73FDEA286BF4AE0F43F4EB9C8C077F3F03FA9728540361616408083BB4047C28CC05F76DCBF3FC349C0340971BF116429BD6EFB6DC0FD688EBF4B4069403671A1BFD0730D40BA9037403518E13EE3AFBF408B8A88C01F12DE3F4617A23EB69C2740EB9BE940D660EEBEAC0499C034F937400493E5BCDF85803E726B28BF74E12BBF2575703D60827040984402C09A17FABE700504BFF7ED51BF4E4AD6BE2A462D409FE745405B7B38C0D2712C403867073FE9A415C0586490C0BB31953C421A99BFA00CF4BC98EF8F40CA6FA8C07395B2BFA460F9BF5258DB3FDCF4D23F373B1DBF391FEE3F8794E33F8F42A8BFE64DD2BFCCD858C08F1C6540607E05C052BD023F32E2D4BE30D675BF99726B40F91B7EC015B9C9BF518C0CC0D27CAE3F4E6555BFD6D2B4401F71BDBF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDC2BF13E4C5198BD5E61BB3D734F5F3F5E23AD3E63A42BBFC16FAC3EDE9660BE3DF0AD3E12BE6DBE2F24D03E9EE4AA3EB663593EB6C39ABE96A3773E970C813E6631CF3E16E82A3EF086253F38AF033FBA0DF03EA3A9FB3D19AFFD3E9E99A3BD1F4B083F1B9DA0BE2BACBC3E4969C4BE9F52523E1F43B6BE78A0FA3E1F4AF83DF536E63E15FFC23ED7B3483F516E1F3E89B1E63EA067C83C93D61B3E6B84E9BECCA2AF3E25C6863ECD71E53EF6EC09BFF7FE8F3D92D901BF461E063EAF09EE3E9F6B313FC4D5313E8CEF343E0398E2BF48E2883EDE79CBBEDEA6E03E50BA8CBEC6AFFA3EBBE2743E68DDC33E2C746EBFF51FDC3D03FB09BFA2EF813E8528E53E7EFFA03EEA9A9D3E9ABCD63E8AB530BED558A23D7CB71FBFA56C163FE0E8D13EAEFE853D8806CB3EE733B43E582520BE1884373E3DA5E03E02D8113F53AFA4BF1F1DCB3C23A8CE3EBA21043FEC2C573D4178B23EF35BF83D1C4DE53EC2F878BE4A1B943EEFBA78BFE30E173FEE58FD3E251BD33E855208BFF857293FB4488DBE147C353E04B7DA3EDC91C03D75EBB1BEE5111D3E19FAE5BEF1BDD73EAA50EEBC2194923DE957E6BEDF290C3F57E6DB3EE742C33E3830CEBE5F8CAF3DF511F1BE7FBDD53EE70FA63D19DEC33E3032EBBE90F0F63EE2E1283E73CB6A3D0A85F0BEBE17C73E3615C43E250E2F3FF407DB3E248F933D66ADE2BE580F853ECE3C29BF3D31B73E44515B3EB0F6183E3AF99FBE85DA243FCBBCC9BE8721193F007D5D3F0D65C83E299D3D3E9BD1413F6E64B83E8A6D2A3F3E8F293F34EA073F74FE72BD85DE023F75C15FBE9ECBB13E86C214BFDE42813DF097893F3A496C3DD4B750BF9FCBBB3E7F1F973E8824173F6C74B9BE5CD0DA3EC7519D3E81EB013F60A48A3D5EE4123F82AC4FBD2D14023FDB6EF43DECB8073F0D8D18BE29B9723D33A2B33E3DAE1F3D17DCFA3E1D849E3ED18C843EEC95063FFF7967BDD2F9B53EF939C33E49BAED3E9AFDAF3DF4CE163F543B143EF54C053F545BA73ECB87563E0F47D03EFDEC1D3F5009EE3E795DD43EB23A19BEDE7D123FE3D7D2BD61CE2C3FD2DA87BEFC08FE3E7FB070BE611E013F40F2E33DEDCCE33E064BC43EF776273FD16F1CBE7470093FD7C1E8BE21AE713DF05D19BF6BB8163F3D3098BEC563CD3E93B5583DCE24F53E269750BE841CA83E8197B73EDC0B833E8C8AD63E002BF03E0134D5BEE298A53EFE837DBE91110E3F12AEA83EEA479D3E294ABB3E0EF2D63E016FA43ECF8B3D3F48D9903D71323E3D04B157BFACCCDB3EFF44AA3DDCAD703C2B541C3F954E013ED5CDD83E3576FA3DA5A2A0BEA38E443F4D02233FBA7AEF3E7C01A23E8B70823E66CF78BE049C013F16497CBE25B2153F77CFD83EE62B4C3EBB37A93EB13C0F3DBFD603BF4A8E753E50A814BFBAF1B23E4F4C2EBECA4F633E634992BEF11F293FC77EAA3EEA57253CB30FCB3EDCA3633FF0A842BE7E4D903EBB7F793EBA4EBA3EBB4A29BEBD202F3F17BC3D3DC77A063FE3A8D9BE37A01A3EBD97EB3E5334FC3E9D47D03E3B84FA3EDB85F0BEE874D93E760B493EBBC5BB3E7E43553EEF82053FC450E2BEDE22BC3EF14FB2BD03846C3DD5A7243F26CD0C3FC59A7E3E7CF85F3EC8E6EE3EE0D2CD3EC08CC73ECC0AF93E1E151D3C2CE5C73E092754BE6851183E76AAAA3EC415C23ED867D2BEA6DDFD3E93BC6C3FD179CB3E84A0913DC661043FCAF6303F0E58713D3A8CD2BEA804913D044AE8BED1910B3FAE4E423EF0D52B3F6297A0BD99AE393E750BDEBE0EBE143E0520913E0DCE8C3D4EE2DBBE6015D03E1B7481BDE5593C3D5C3959BF5F79BA3EB394DA3E2D4BDB3CD4F4E83E0CC7393E423ACCBE3300A03C9D7FDD3EC3D9A93EC6D69A3E30A3023F426B873E82C4A13D7E35EEBEA5D6BD3E2DDA9BBE5EDECE3E7217FABD7A43223F3B4E7B3E75F5833FDD9D79BF36AF0840D5F15F3F3219CB3E581427BEFF61C43EBE62E33E8CF6B23D9E72D23ECB801F3FAEE41EBF5ECDE13E377A1CBECB91A43E590CDD3E97EA383E3291A63EF212023FBE6A853EAB68073DF993DDBE86AFB23EC81AC13DEB70FF3D1494BF3E42D7993E0318AF3EDA7EF13E0270B7BE1444DD3D7F7493BE0CD9BE3E848291BDA9E0843DCA59BBBE8709C73EED078ABDEC38973E3B51C2BEBD47973E694E023F11392B3F88C0B7BD0126043F383D69BE40C8033FCEC1AA3D75DC873F31ABA4BD75F0C93EBF3A813EDB9EC23E9C7095BE744A8B3EC9A08EBEB8ABF23E411CDF3E984ECB3EE209A4BDD94F113F1F04083E29D8F03B549EC6BED4E7843EC03E56BFFA008F3E8ACFA73E4B599F3CFB24CF3EBD38F73EF655DBBDD253263F1E6F1FBD051EB83E77B6BABEC809E23ECFBB723E0FC8973E599C9D3E23BDC23E3A08AB3E66610B3CEF432A3F9DCE7C3F379B03BE0DBEEF3EABD6963C1595CF3E266AEF3E4CED8F3E1A598EBE2B55023F3E5797BE8DA2BA3E2256FF3EB4856F3E11B9043F39C01C3F91F969BDF3B0E73E79DCE5BE1095253F580BDA3E3DA0683E77E1B4BEE5D8023EC3B1A4BE585F793E6A3C95BE1190233EC964D6BEDA1CB23E428A1CBF8FE03A3E84591DBF36701C3EE651F6BE4098C53E82BE873F085ECF3D78A0173FFBAA0F3F68F9123E9228CD3E1C48483FD00F013FE2D967BB181D783F5396833E1CA3B03E4EE09C3ECD280F3F8CA10BBE9CFDBF3E8E12E7BDE828EB3D8583C73E7584D53E28B8153F555CF33E8E4183BE8D6A103EC246C8BEFE5F853E363C333F28880C3F942FCABEAAEEF73D63E5AA3EF8E8953DCA55583F4070EF3DE45E05BF94A26E3E69F0CA3E59060D3F9C3FF23E3F27AC3E10831CBFAEE8263E04A2083FBBA6183FDCF6943F6AE4713F99BEA9BEEAF1333E5875933E3CFB1D3F471D673ABAC2A53C56AFF83E842F163DFF94133F96D8453D100217BF97F2863E43F1B7BE708A093FB08A943E9E28F23E7DBA94BFBB22973EB4181ABF7C9B193F85A55A3F6058313F35B5B0BE5AFFBF3E4C568D3E79FC753EC9954C3F3645083E2A6C2C3F70611F3FD886D8BD6580893E760CD3BE8B3D1C3EE51B0EBF814C653E0E32FEBE0C4B213D46692A3F90E5E33EEAA49ABE4DFCEA3ED8BB4CBD2528A53E72A61CBD0C7AE83D8F8B323F0264CE3D22AB1B3FB8031E3F760598BEA7E0B13EA8B442BEDFE5133FC6863BBE8E35623E36BAB8BE3E8F0F3FE28F163F7D26283F42E6B0BE1D7EE53DF20F173F5B51DB3E271EC43E435F263F4C7227BEE1617D3FD265BA3D033CB43EF16BE13A3FD23E3E28D908BF375B9C3E63FF19BE042FD43EC324343EB418FD3E055F1FBE51F4A93E9594A43E2A6BCE3E980AAE3ED765363E327CFB3ECA25293E8469C9BEB1BE163F33E1FD3D9358C93E17E413BEE17F6E3E94DDBC3E18AD8C3DA368F1BE1B105A3D3EA606BF2228C93EB68D11BE5272E73E5BFAA2BE7FE4003F1A25ABBD3B98FD3EF37CADBD7DE10B3F856E483FD3E8913E929E053F8F181A3F2DDBF4BDD28EB13E5E8B943ECAAD3E3E1D3D133F378AA03E9B9F8A3E19FEB23D1D4BFCBE6A130F3FFA1A5EBE4595B13E5845D83E7946C53ECBD511BFB9BD453E26FA473F962AD03D80A319BF583F203EC2CDF03E107C9F3C29FFB53EF1005A3F3D94E7BEC930973D5F01D03EFCBF173E26D6C33ED6A16A3C51A90DBFDBF4AE3E7B94FFBD01F9383F3138D1BE996CF03EB8FC6DBC53E87F3E2B39E03EE61FD83DCDC5D53E16310D3FE173153EE25DD03EEFE2743D0D961D3FA7F994BE3AC4C83ED63FFBBD5548133F6EAB90BD2886A53E2B3FA63E5EEA793E26DDB5BE7B57303F57C1A1BEAE74F23E8EECEEBD16198D3E6FF7DE3ED16DE13EC4E9E1BEBF3E083E1EA8EB3E69C0C13E0118863D86B6FC3E5CACA93E1FE2F63EB879A33DBF88033F3E08ACBEB3D2CE3ECE26843E286EA63DFCE6ACBF97F99B3EFB19A13E8B0C183F5C724A3EDEA0903E5D82ADBED9D34C3F94A3363E8B91F43D745A023F1FA7413D96D3063F36833E3F442D583E810A013F3E7D1B3E8ADD6F3EF8F480BFBC14093CA9B104BF5EAD9D3E820BAABEC1EAD63EE2B4293E50ED1E3EB73FFBBE093D413EFEAECA3EB1520A3F0A4A00BE7B62B03E002215BF537F683DC3F2C5BE7570E23EC034EDBD1E6EB33E8E68EF3D92D0893EDD55E83E352FB93C71D1833FFD93963D4092003F968D003F0FECAC3D2B70F13EAC836DBEDF08993EF4368EBE561DB73DEA20EABE63E6EB3EE219D1BE3635BD3EEADF403C62CBE73DC1DED0BEC9CEA93FF6D1BDBF7691CC3E5A6D733F0933BC3E4748B9BEF04FA63D85B72F3FE38AFB3EA2AB633F1555C93EFDD8EABE2DB3E73E467D363ECEC3193F79306FBD0F026C3EEA0DC23ED3C2263FC13D243FF622AA3E6344ABBE1EC3623D0692D93E615D603E4DB314BF40F83D3FDEFC083E821E143FE0976DBE8DE4983EEA101F3FB858363ED3D3D3BEEA62A73DCB6F2DBFC55F093F8E2D513FFFACC93E1826303E7F318E3ECC870A3FC6F1423F04855B3E871BD23E7F78583D"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
