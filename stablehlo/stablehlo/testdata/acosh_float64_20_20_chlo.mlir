// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.acosh %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4350B1B7E2ADF4BFE3EB5DF987711340C68FF06017B8F4BFC64EA15145A811407803A343D5BEF7BF1CAE257AE242FABFD820F420EC1D08C0E3C6E3FA1986F7BFC0988E449FFE00C07C9B128EB6AF0E40719BDB320BFF01401CD376DA4834184026F25AEA71F6C3BF140104274D8E03C05E6074594BBADFBF58E23572363EE7BF952802B8639114C0E2F0EEE0F2CB0FC010AF5F2EAE54014078055861C177F13FC6A0260250C40AC0565B6454E74D773FBED13D5813B8EBBF4084E724E44C05404EDC35D59AE4F23F83D22CB1F195EABFFAB579ED55A20C40E09B5DAEF2BFF1BF76DAE88ECB7104C0AC0F424E04160D40CC1711D93FEC06409418541B0FE8B8BFE64FE3027672CEBFD0575242DF83EB3F389B782B6149E93F56B219F3D04AEB3FEEB9A274C29616C013E6EAFD71D8F13FBC1F8856876215C03A741DB9BEB801403191F7BF3FCAF2BFCF471651F3AF01C0E6EFF05E5D1AEDBF0F42ABC1F03505C028B34003017F1240D121ECD6CFC00540ED1F4F299917E43F80168126D64DD73F480140E3394417C0CE6B6157E081E33F47E545F380840F40526C75F64EDE04404611142730D5D4BF4CC751777C3FF8BFCC6C61BA0CECF73F0907C953A9D6D03FFAB64E01EBA802C04A719638F7F0F5BF5620B746259A0E405C936B615FF7F1BF5756C714DF6CF83FC96D02ABDA07EBBF4A0EBC027D0AFDBFC0A95EF7A73AE6BFB886C7F7AB68034066A8A8E5E5F215C0AA41184A09DD19403863086FCD3D0AC03F4DED36AD04F93FBF0346D8281E0DC0B18D7576B0F60340CBEDEB538294F43F4C84FCD6ACCAFA3FDB26E050E4B6E1BF186A4E064ECAAA3FB0A45B56E1171AC073B0AEA32A37144074673BA370E710C02A2CFF113F73D93FE6949E754A7B13401307647260DA0940C0665249132BEBBFD59B8729B1D2F5BFC8282C4A4E4D0DC0C64C5004ABEF09407984ED6EAE02E63F129CC651FB0714C061414CF37BA0F9BFF0AF2351EC56174099690131088E0FC0C2EB00BCD31DFCBF80ABD1908814EABFD166016A05EEED3FD71CE04CBB0B03C0BE6A145CEF17064018699D45A655C93F0E5A0662D396CBBF5079B19CFBCDE43F6841A07178ABDDBF82A1DA9C318BE33F89277FB71BB4FB3F847B33C5E3A9C5BF9273E595A268F83FD5D21B396E3AFBBFFAC8AA6680F6D73F88071BDC83CF21C06A61615AB07E0140451B0ED278F10E40720D33D7067EE23FDEC04F79DE390840230E6A59F300E2BF0402FF063113C23F8F97C2BF200CF03F6357851D157D0040C90C2710C5191240BFFB7E54DF4804C04106088783F4EA3F8094C054738F0940D8C5B476402DF5BFEE3856EE0B0A0FC0FC41E70E0DE7CB3FCC430FC8AD34F83F593075CFDE8103C0F87215468BF2FABF44381833A7B7EBBFA662CE8787BC13407C44B2EE545602C038107674C9E5EE3F2F371D310E77F03F93AAD164CA11D9BFFCBE1FF3D88A154070BD4F509142FE3F09FCBBA079DFC73F5A4B357063830AC0D67DD265CBDCFF3F78D108C7E19CE73F8003A8802A05BFBFB09E24967CB0FCBF1659EC1D39B3EA3F52D4ACB911C30E40BEC6A05232CA0440D6206D04024B2040FAD161E294EDEBBF56C068D6F6C807C014D059D2C3EE0140263F17011E6DFFBF14E3146328380C40F3FDAC068F7FE23F683950EE599E04C070A62B485A18F7BF6D53E704180302407A0D595CD9FEF9BFCF209834947AC3BF86903374D07515C08DA106766FE1E1BF02A363A17A2517C0A8031750CD2B0B407695569B16E5E53F1D4AABC5D7D3F33F153CE3820AE703404A3B9ED123D5F83F0D78646B0EE70240B4FC5A22A407F13F68F57D600756EE3FC29E7D9B8CFDF83F62BAE3C628050DC00109922B54E91840DED6FC636D2BB03F37332917E97301C0841EFD209D1EBD3FD84B1F2AA3CF02C01FB250EC6F02FF3F80B5172ABC3711C0BB44418E749EFD3F97AA44A9E336F03FE62CF93755CF11C0D7570A0210E20440F307381785E30C40D70FFB45B830F73FB17E12642D86EBBF26F6A6F20F4DFDBF18A10484F1ADEB3F292DDA8DC28F064093C723A2C13EE3BFD46D3FDE2709F6BF6CC7C85F833003C0D2B29349CA7000407FB093B6A6BF10403622E2495120FFBF463DEA134AED06C0A40723EE5574F63FE0139762C4BA09C051912B5EAEFFD0BF3F9EF9D67461FE3F63FBE39F833504C0DF21A62A8C7303C0B6823E531F1EEB3F282482BBB51BE03F96151ED6C4FC11C0D496E26208AE1540CA167BCE302CE7BF10FC65572BB1E5BF7A3A8A53B86BEE3F0E8D7267A720EB3FE86986285BC7EA3F8F18553A3AB200C0DE8EBE180D48CABFCC8181657193FABFB4EA4FDF4CB012C08205B937D8D4F23F408AE95B53480BC0C778A6B80C770440507AC0285B40F33F27A2C135BBB51740E1588B4085DFFC3F6544C878D3940540E938B738081D0DC0EADE8ADCCC51E0BF396D145CEBDFF53FFDE25BA45465F43FED27D8E1E921F5BFFD69C47C3FB20DC03890AACAD34DF73FB953D7B2715807405E8C4A84C52AF9BF6C3D959B9A901140F09AAFD6FD8917C04588F63F70CF00C0C2865468A29D0EC0D0D1B3C6264F00409C6619859EBBF1BF247DB6657FAEDCBF6CE11949BB9512C0A9B6CEFE672B17C0B09B4E17EEA1F4BFCE7728615AB4E2BF2EA74883B15AF73F9695E53FA4B606C089B4C30A6DCE04401ADC3DF1CF7900C0CABEC4212AB7D23FBAF8FB9FC28018406D2B4B4F408B0240D82A90284705DEBF27E949C525C7F4BF38ABFE1CFB6008C07B92E2304EEEEA3F3AC00BD26C8FF0BF488A8C0E0C5B07C0CC2DAFF158130D4054C7DAEA5DDE104046680D62B308CF3FD4503F15B5CC014050FCF4D7565811C0AAF6009318C40840A3865464B899F4BFDA37F5744B6DFD3F3C95C77BA2950E40C2FD3DA7F40B0840E2DFB8E5E5E1B8BFE0E6B5C308BC0040BFEEAC5037CDF93F96DF0214039418C008DA28DD69DA11C06689A9B5D566EA3FF2B5FE5595ECF9BF27C34EDCDC29F13FA6943F65A8E8E43F31150B76E1E21240986CB5CEDE85E03F75F0B54C4DD31940E29A4B76BADA084092BEA2F878DC97BF5162E2EFD10BFEBF540157E2D905014034BB01993F8BE8BFCB650D971F4A17C01B709F2A7E60FDBFE062CDD3BABFF4BF26B7A260BF98DDBF69BE35BED41F0A406AB5D2D5D4270B408E8BD70D0331FE3FC32D6F0D5C72EB3FEB3E0CCD4E02FB3F15F2BFFA749D1440FE52E55577C3F8BF6ED836767CF11DC004F8BE63BF3C0340C358A68A3C6506C0241912512BEF0240088C417199720540E0A986A8CC491640C843FC5126E7FE3F8109A04B745900400E11D23338751B400BE6CEB4CEBA09403B9857D800E0E8BFCE2D649BBE57F03FDE917234BB0812C0988C04EC684AEDBF85A0A16D1D35C53FEE82A1B00650084051B63AAF135B12C089B658BDDFA70440331F61F5B4E8F23F4EF12449E6E3D23FA867BD4F4C8EE6BFEA6DD240EF0202C0829217C92E7CE9BFDC239C41EAE806C0EBBA01B09DA307C017673AEB0F8B14C0A6BC9C09652602C0F271A391EA25064098267DC3DEDE0BC02281A5A6535311C05360E1108DE0F33FFDB6304243E6F1BF2C1DC5865E91F3BF0F5EDDACFD81E23F3447EEF260B9E2BFEB3147A2ED580FC03A49C61D9695D1BF6DD6AF647F9B114058270E546BBD1240F0ECE3E0DA220040665601C3582109409C5A7A8CCF1302C06043DEA6247204C04C24519EB70107C00D960D5C54E1FA3FD22BF1EE4AB91040CA2CF327780920406213C3877B6E1240E20FB828788DF83F5635990C2CD10240C956FDB064A1194006715EE61BE9F33F070E0A604DD600C034CDB203B486EBBF7CB563915F7C18404B99265280BFE1BF30B0734DBE87F5BFAAD285AE313D0EC088709469C133B93F2C5E74616862F6BF5C9C67973E42CABF5AB0E5FD3A6ADF3FE2C52071376C04C02E451B4003D6F6BF37FE3C7225980B40036E175E7A85E9BF94A416BDAB1DFD3FB026AE2A99B2FC3F6CA3FE1B6D2809C0A068C04E91D81BC036ACDA3B704B064054EC4B6138B7E13F7158BA6B28CF03C05BD1C61C0898074095A0ED5BF84916C0DC487EC7A515E5BFF50F89740989E9BFD04690DDD05B0AC044FAF437C3D20040D45FB1419C6409402CE47AE179DBE5BF501500295EA4FCBF29BEF31F4A6C084026CE830284180240C0598510099216C0C3A9AB210611044057E4EA1B76290840CEE980BAA815004000D81669ECF4E2BF2A181562B5FCB23FB5941E919C4FF23F418E48AD85FDD6BFCAAB261DF321C33F283155722D66C3BF8AAFA1DAA98E0BC012EEE8FB80F612400263719C75091B40C517C095105EE7BF60C6183B175B09403D6F09C8FAB0C7BFEA3CE20C34EE0A40CCFABB9432940D407087D3239972FA3FB265B2B63961E03F5AFBB73DFB3311C0853C662EF2EF11C09A6D14F73700F0BF6B8D0DFCED2105C0F40AF07B038B0FC03A5DE5B810ECFABFF5AA6F110CF20C40328C0540429DB93F2537669AE4D20240"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x000000000000F8FF10F75EA1E01B0240000000000000F8FFA46324F7C0510140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF974CCE4121290040F29FD5AD9A34F73F0CEACA8B50E40340000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFFD7301AA7A87F63F54F46F925535DB3F000000000000F8FF000000000000F8FF000000000000F8FF9FEBECF78529FA3FA6CACFDBE8F6E23F000000000000F8FFDD46769FCC2BFF3F000000000000F8FF000000000000F8FFBF0E29DF8C6EFF3F15AED5471F6CFB3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF4E9EB4627673DE3F000000000000F8FFEEDA904E28EEF63F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF0B8E8FA338B30140825991905586FA3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFA85FFCF4C56100403ADDC5EAD1CEF93F000000000000F8FF000000000000F8FF58167CB061A8EE3F000000000000F8FF000000000000F8FF000000000000F8FF000CF5164C230040000000000000F8FFA4DE66E1E68BEF3F000000000000F8FF000000000000F8FF000000000000F8FF55F4F08C228BF83F000000000000F8FF4A966C32DF6D0440000000000000F8FFD6BF1ECCDA46F03F000000000000F8FFB44C9C4C7909F93F615BC3EC5EABE73F4240D6B9D5ABF13F000000000000F8FF000000000000F8FF000000000000F8FF296D1CD94B6D0240000000000000F8FF000000000000F8FFD14F7706FA1F0240CCF4650FE975FD3F000000000000F8FF000000000000F8FF000000000000F8FF253AF823BE83FD3F000000000000F8FF000000000000F8FF000000000000F8FF384594A1BB980340000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFCA91BC18A1CAFA3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF7F726FF53855F23F000000000000F8FFAD853C538D84EF3F000000000000F8FF000000000000F8FF000000000000F8FFEFE1F412F0B2F63FF0E66BE5CE3A0040000000000000F8FF20FEDAB4EA5CFC3F000000000000F8FF000000000000F8FF9C57A1E4FAB1B33F214AF1A7D69FF53FAC9437EFDC850140000000000000F8FF000000000000F8FF6DAAB5A5D644FD3F000000000000F8FF000000000000F8FF000000000000F8FFD9B714EEB029EF3F000000000000F8FF000000000000F8FF000000000000F8FFBB49DF1A2A3B0240000000000000F8FF000000000000F8FF7A03FA0994C9CE3F000000000000F8FFD9FC5947F4F1024095989A343907F43F000000000000F8FF000000000000F8FF6580020BE0FDF43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF7B262696592E0040C5064F6916BEF93F38DA92E5AA4B0640000000000000F8FF000000000000F8FFEE2CC7466924F73F000000000000F8FFE77DDCC084EDFE3F000000000000F8FF000000000000F8FF000000000000F8FF42E527329F38F73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF1C0070D38E4BFE3F000000000000F8FF90F9947B11B7E53FB359629FC2FBF83FEB7BABE30E1FF03FD1DEF817F913F83F02083AA859D7D63F000000000000F8FFC186ED7AEB40F03F000000000000F8FFCDCB893418200440000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF403BDC37BF7CF43F000000000000F8FF5E71647B739FF33F546BAA9B85EEC43F000000000000F8FFD42EC761EFD1F93FD309B8288D51FF3F11483213874DED3F000000000000F8FF000000000000F8FF000000000000F8FF7765AD8B9B26FB3F000000000000F8FF000000000000F8FF000000000000F8FF39D351D62B92F53F3C92D2CA7FE20040000000000000F8FF000000000000F8FFE00FFADDF5DAEB3F000000000000F8FF000000000000F8FF20C721AA691AF43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF9150C04A35FF0240000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF5C7F32D96BC4E23F000000000000F8FFC2C142521D78F93FF286F86AE311E43FC0D69E8873B90340788B76CAA522F33F7291EB2C6263FA3F000000000000F8FF000000000000F8FFF27729633AA5EA3F9E5E674C6335E73F000000000000F8FF000000000000F8FF8FAFD1CEC184ED3F329199F0DFBBFB3F000000000000F8FF864BD4DEB6460140000000000000F8FF000000000000F8FF000000000000F8FF63C87326806CF53F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF1AC543D6019DED3F000000000000F8FFA71853C69CC1F93F000000000000F8FF000000000000F8FF359AAA58C8FD034090EE8D6432BDF73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF38FFAACD056DFF3FD54D59F78CF10040000000000000F8FF699245CE4C02F73F000000000000F8FF98C191E671BCFC3F000000000000F8FFB03EAEB8BF7FF33FB8E62F3B132200402C2D6639A83CFC3F000000000000F8FFD95A68DA06E5F53F8FE2D63171E9F03F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF4CBD62F30E43D83F000000000000F8FF0277292DFCDE0140000000000000F8FF112AFE67D26A0440B52B6532DDCBFC3F000000000000F8FF000000000000F8FF97447D5C7F34F63F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC4225D56DAA2FD3FD3038B4D1C49FE3FDEB2A61145FCF33F000000000000F8FF2C99B06BFFD4F13F668FB5812C960240000000000000F8FF000000000000F8FF391AD8D92D63F83F000000000000F8FF33B9EE6F8B1BF83FE3A98AA1F647FA3F63CB4BA2DB380340472FBC99456CF43F7937259E1478F53F9E44E4BACBE90440B3F064534F61FD3F000000000000F8FF40152D308872CA3F000000000000F8FF000000000000F8FF000000000000F8FF26E7A89A636CFC3F000000000000F8FF14F1752C5CA1F93F01733E7EF403E33F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF982136E579D5FA3F000000000000F8FF000000000000F8FF5DF44BE1ABD9E53F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF01D19DA5CD4B0140C8A897A8AECE01409E87F3BC473AF53F7FB56DCB95FBFC3F000000000000F8FF000000000000F8FF000000000000F8FF37597BBBA8BCF13F8B08657B5EDF0040232D471EFB2A0640C16ACC82E3AB01405D3409122BC4EF3F7841BDA778FFF73F0096C5A41C5B0440CC083EF3D5F0E53F000000000000F8FF000000000000F8FF0C74258F54FC0340000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF6AA9E315C18DFE3F000000000000F8FF385F09E2C54BF33F0101A3459C04F33F000000000000F8FF000000000000F8FF79074F5C6FF2FA3F000000000000F8FF000000000000F8FF3C747F86FCE9FB3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF5E9ABBDFAEFDF53F6396F2118028FD3F000000000000F8FF000000000000F8FFFD3E3C350980FC3FF7267B9FCC4DF73F000000000000F8FF446483A87020F93F8640E1596B51FC3FAA23327E2E2BF53F000000000000F8FF000000000000F8FF65E269059AFFE03F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFAEAC36DD78E70140F15EEF42CFC90440000000000000F8FF101BCCCD2C22FD3F000000000000F8FF4A0C56C96A25FE3F8F2170A817B6FF3F884B988D9769F13F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFFBC92077EA59FF3F000000000000F8FF1A85FE6D1601F83F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
