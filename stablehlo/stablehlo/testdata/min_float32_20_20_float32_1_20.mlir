// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<1x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.broadcast_in_dim %0#1, dims = [0, 1] : (tensor<1x20xf32>) -> tensor<20x20xf32>
    %3 = stablehlo.minimum %0#0, %2 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%3, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %3 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<1x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8E1DF93FA1A47D4045763C3F29FE00C181695AC0F722104075290E40A13045C00A481CC0F8DDD3C0176071BF2CC8A7C05772F33FD825D6C0AB1BF33E87F4ADC0CBAB5740C0ECA440EE1551408103C8BD7C0BB33D5E9A97BF56FE033EFA1D7D40DD0249406D906F407EB44940A2575A409182E73F8E5EC7C0EC1F713EED95F9BDED51694090E6AB4019546440E85F1F4086C986BD76BA18BF9705B53E265C9940E0B8B73FD211B640CAAD4FBFE337BF3F512FBD3F040EF03FD76069C05B23E43FE0CC2B3F2B41704076021A3F410383BECB97C23FB89383C00E9CA7C02A9C2A408CE978C049964EC0C3B314C04D7A52408EB1813E97A8E2BF7E4106404F7E823F9AF2063F8E3EEE3F77388F3F0DB3CA3FD92C33C0F1829D402CA9553F3342BB3FAA6BB53E96730A3F8D8D58BF66DE61C056C755BFB91744BF9A5420405E219EC0FB8E8F3F1EEB3840EC760C40E95599BF9C06043FADBC90BFFA12E5405438CDBF78EADDBFFE8AC4406252C93C43EBA43F241DAB3FA74B8CBF0649F8BFECF2ADBF81B9EC3FB39524C0641A1FC0FEBE913FDA6F0C40E83D2D40CA04DF3FA420AA3FDA9EE93E818885C0427A08C073331240735AF43D6D959CC0B9D4824023714DC0C98DBFBEF69593C0399900C06D45863FDB62C140EC88A1BFE225514090B18EBEAA0BEE3F9CA471BFA4D984BF77ED59C0013F353F906A4CC097F526BD806516BF8A44AA3FB039BA40DDE47ABFBE176BBF264778BF0A1477C0B720A8C0878A26C02641243FF7D201C191CB9FBFD9E60AC01D14E4BE422ACABFE1B515BFD23B46C0CDF99E3F86AFB9BFA7A928402A6178C0B70B3E406A9192405E0583BE1A4F18C0CADAB83FE2F1493F887FABBF2BB3763FC94A883FC53EA33F96FB97BFCCA3A5BFD39720C02958723F9E480340A95D6E408A811B405BBF5C400E5509BF2F6C92BFB7A86AC073CFCCBF6DA6474031BFF3BF209E29C082A4B6BF25A968C038D825BFD952B23E221575C0397B74BFFCA42E40750BED3EF86E10C0322D83C0CC134540E98B163E6AAA7F409CD2D8BF2C30A7BFB56AE8BFF0150E4155E957BFAA58F3BFC8BB2DC071B51E408DD358C0163D443D8210763FB770173E850D31C0E14C83C0908D61C0A3497C3E8FEBB23FAEB4653FAEEF50C0D1B2E23FFF64384007A530C08C2F3E40FC4492BE47CF0FC1BAE744C002A186C0C95CFDBFA3D0AF40794E9F3F066EA2BC8A5F7ABF1381A23F1FD010BF43D6B13F1AB788BE8C2123BF022340404EE9313EFCC08F40AD21A63F513EB73F2157A73F2F2E2FBF77A94CC0E3C38FBF2818A040A378D6BFAA3B884072131E40DDF1B5C06732903F048FEA3E623326BF2420983E1136B63E6DE840C0807ADBBFA3AB154074229F3F16CA2740840DBBC06F8A8F3FB0E33C40A81D9B3FCAEF5BBFC69741C0C97A06BECCC9A1400655B3BFB09216C000D149BF994A0A40D36EA9C088A53DC0040957C03940A1BF07BFD33F46578BBF28EDB4BFA83215C0C9827C409AA918407D28473F53B29D40ABC9EAC06BF9BFBE6DD0813F5779013F196AD63F7FBA404061122CC0D2D1BCBFB6DEBF3F6C6C4240A998DCBEF5368D40FE2554BFA96B1AC02B5B493FCD9DC3BEA460E0BD15220E402E16EDBFED9C66BFBD2031BF7C8C143EC198B4BE94C8C6BFD0A6393F6800D6BF07273140BEE201405573C4BDE73328C01489A7C0BF3A00C1E97E0740C8462CBFA2A5CA3F279E753F1E7D88BE386DB63FA816333FF46481C06AE4E33FA393993EFD98EFC0784951C0B5BB6EC09894A8BF813B65C00005DBC0113FDEBF0745E23F6C9A80C0E9C702C046C181BFDB20AC3F3E4797BF7A4313BF781A59BFAA20DE403171A8BF44BA0CC04CA041400FDB93408BB728407ADE0140400F80405F28333F9F2C413D031866C082B2C33F761BA4C0BF29B540D27354BFA8CC22406CB66FBFB9D28C40BEF41F415D9E144085FD2CC015F00040AA245FBF9D204D3F42DE3AC027796BC058430940B0F19ABF50840340FEE96DC03036FF3F81D6E8BFDA0F33BFF2098640499FA33EFF11B0BE122AE2C06699763EA19B0E3F07C89A3F0C0A484025A5FD3E45D33C4060A74EBE2BF30141FB62003FB66BA43F12371ABFA04F863F03A704405EF24DC0B0643FC068200940063F943EDECC0240C8F1A0401829843F3FAE15BFEB3317C0A30F273FCD2B173F1DE2A9BD0A3925C04761C8BF907526C0AD2557C06F57F6BF6157EA3F8C1734C01202643F0BEF85C07FC9BD3E"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<[[-2.19057083, 7.11125517, 2.0088315, -2.74729085, 1.5299021, 1.38012218, 1.75997758, -3.31948543, -2.50263882, -2.18362188, -1.80968022, -0.997264504, -1.2354666, 0.116742551, -3.3716743, 5.11169147, -3.73235369, -3.42895508, 1.40230548, 3.60332036]]> : tensor<1x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<1x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x50320CC0A1A47D4045763C3F29FE00C181695AC0D8A7B03FF246E13F737254C03C2B20C0F8DDD3C09AA3E7BF2CC8A7C0C5239EBFD825D6C083C957C087F4ADC0E2DE6EC000745BC0BF7EB33F8103C8BD50320CC05E9A97BF56FE033E9DD32FC0D5D3C33FD8A7B03FF246E13F737254C03C2B20C08E5EC7C09AA3E7BFBA4C7FBFC5239EBFB816EF3D83C957C0E85F1F40E2DE6EC000745BC09705B53ECD9C664050320CC0D211B640CAAD4FBF9DD32FC0512FBD3FD8A7B03FD76069C0737254C03C2B20C076C00BC09AA3E7BFBA4C7FBFC5239EBFB89383C00E9CA7C02A9C2A408CE978C000745BC0C3B314C04D7A524050320CC097A8E2BFB29000409DD32FC09AF2063FD8A7B03F77388F3F737254C0D92C33C076C00BC09AA3E7BFBA4C7FBFC5239EBFB816EF3D83C957C066DE61C0E2DE6EC000745BC0BF7EB33F5E219EC050320CC01EEB3840B29000409DD32FC09C06043FADBC90BFF246E13F737254C03C2B20C076C00BC09AA3E7BFBA4C7FBFC5239EBFA74B8CBF83C957C0ECF2ADBFE2DE6EC000745BC0641A1FC0FEBE913F50320CC0E83D2D40CA04DF3F9DD32FC0DA9EE93E818885C0427A08C0737254C03C2B20C06D959CC09AA3E7BF23714DC0C5239EBFF69593C083C957C06D45863FE2DE6EC000745BC0BF7EB33F90B18EBE50320CC09CA471BFA4D984BF77ED59C0013F353F906A4CC097F526BD737254C03C2B20C076C00BC09AA3E7BFBA4C7FBFC5239EBF0A1477C0B720A8C0878A26C0E2DE6EC0F7D201C191CB9FBFD9E60AC050320CC0422ACABFE1B515BFD23B46C0CDF99E3F86AFB9BFF246E13F2A6178C03C2B20C076C00BC09AA3E7BF1A4F18C0C5239EBFB816EF3D83C957C02BB3763FE2DE6EC000745BC096FB97BFCCA3A5BFD39720C02958723FB29000409DD32FC0D5D3C33FD8A7B03F0E5509BF737254C0B7A86AC076C00BC09AA3E7BF31BFF3BF209E29C082A4B6BF25A968C038D825BFE2DE6EC0221575C0397B74BFFCA42E4050320CC0F86E10C0322D83C09DD32FC0E98B163ED8A7B03F9CD2D8BF737254C03C2B20C076C00BC09AA3E7BFAA58F3BFC8BB2DC0B816EF3D8DD358C0163D443DE2DE6EC000745BC0850D31C0E14C83C0908D61C0A3497C3E8FEBB23F9DD32FC0AEEF50C0D8A7B03FF246E13F737254C03C2B20C076C00BC047CF0FC1BAE744C002A186C0C95CFDBF83C957C0794E9F3FE2DE6EC000745BC01381A23F1FD010BF50320CC01AB788BE8C2123BF9DD32FC04EE9313ED8A7B03FAD21A63F737254C03C2B20C076C00BC077A94CC0E3C38FBFC5239EBFA378D6BF83C957C072131E40DDF1B5C000745BC0048FEA3E623326BF50320CC01136B63E6DE840C09DD32FC0D5D3C33F74229F3FF246E13F840DBBC03C2B20C076C00BC09AA3E7BFBA4C7FBFC69741C0C97A06BE83C957C00655B3BFE2DE6EC000745BC0BF7EB33FD36EA9C088A53DC0040957C03940A1BF9DD32FC046578BBF28EDB4BFA83215C0737254C03C2B20C076C00BC09AA3E7BFABC9EAC0C5239EBFB816EF3D83C957C0196AD63FE2DE6EC000745BC0D2D1BCBFB6DEBF3F50320CC0A998DCBEB29000409DD32FC0A96B1AC02B5B493FCD9DC3BE737254C03C2B20C076C00BC09AA3E7BFBA4C7FBFC5239EBFC198B4BE83C957C0D0A6393FE2DE6EC000745BC0BF7EB33F5573C4BDE73328C01489A7C0BF3A00C19DD32FC0C8462CBFD8A7B03F279E753F737254C03C2B20C076C00BC0F46481C0BA4C7FBFC5239EBFFD98EFC083C957C0B5BB6EC0E2DE6EC0813B65C00005DBC0113FDEBF50320CC06C9A80C0E9C702C09DD32FC0DB20AC3F3E4797BF7A4313BF737254C03C2B20C076C00BC044BA0CC0BA4C7FBFC5239EBFB816EF3D83C957C0400F8040E2DE6EC000745BC0031866C082B2C33F761BA4C0BF29B540D27354BF9DD32FC06CB66FBFD8A7B03FF246E13F737254C085FD2CC076C00BC09AA3E7BFBA4C7FBF42DE3AC027796BC083C957C0B0F19ABFE2DE6EC0FEE96DC0BF7EB33F81D6E8BF50320CC0F2098640499FA33E9DD32FC0122AE2C06699763EA19B0E3F737254C03C2B20C076C00BC09AA3E7BFBA4C7FBFC5239EBFB816EF3D83C957C012371ABFE2DE6EC000745BC05EF24DC0B0643FC050320CC0063F943EB29000409DD32FC01829843F3FAE15BFEB3317C0737254C03C2B20C076C00BC00A3925C04761C8BF907526C0AD2557C083C957C06157EA3FE2DE6EC000745BC00BEF85C07FC9BD3E"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
