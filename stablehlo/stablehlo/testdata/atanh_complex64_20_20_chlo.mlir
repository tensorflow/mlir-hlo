// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.atanh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1C0856BD3AEE793FA89129BF4B0092C0904854C045E707C0F80C6D4021161040A0F31040D7546C3FDB52F2BFA27E8EC0F171C9BF918D883FC460F03F2F61513FB79D804035E129C0D7202340744D9BC02C9FF5BF698635BF5FD632C04CBA08C0A940A83FBCC3AB408D82AA403726073F192D704078270841DF4193C0A7951D4083384840053651C0194D38BE09500040D0BA5EC0D6BE17402E38A43D0FD020C0523E57C0934ABE3FB091B14036CBB7C07933BEBE9D9B18C0F746B8BFE0DD27BF7ABDF43F0008F53F55356C3FC090BA3F20E918C0D1B48140C26854C05F97E33E4BF0F5BF6B7E0DC0C07877C09FE6C43F294289C0CFF3303F609143BDD18743C0F8EB02C06A6293BFDADA9CBEB4F7C8404E97513E641C28C0232E47BFE90C28C07CD0C83FC4407F4062C29F409C34474031380EC01A842040B9D9713F936F0B3F549A8640F0E1DEC01A0A373DE6DE373F01B32ABF2AE64B40AA3967400F0C76BF5A01764079D4BF3F16D579C00D0A2F40887B5DBFFFA5FD3ED65F58C002AD6D4090720DBFED6767C052EA99C0A6BCD4BEBB6682BEC2F49CC040F1C4BF5E1985BFD9597DC01F5538BFF93499BF1036A3C01F7E50BFC1CD8140426790404C7D8EC0B10BA43F18141A3F78152640073BD23E5A078EC0CAEE85404F235040FC2A92402A8B294022CE5B40E22764C0E1BD083FEA354DC0AEFAA240BA5BA8BFC4B6F43FA8516FC0DDA938C0D6AD0E406E7D9A3EC72730C0D57C4BC01892F13E4B81AD40B3E55C408647EF4094488FC0623FD5BEAB8E70BE8E171FC081879D40B62A70C01ED912C04DA5863F9276D6BFF826A140442B8340BB2D2D40EC79F8BECCF680BEE68389C01B8283C0C885BF3F3C6EB53F70062140A26A753DB8E651BFA6239B3FA7C0A240A66720C0B6A9EF3FCCA174BF41128140CDB463404BBD8A3FDC76003F3FEBD93F1EED2C3F756E89BF1775803FB3318A40E3D8A53F278CF5BF2B6786BF0E463FC0AE0D0D401D5DE4BF6896CD3F1FB645BFFD9291BE454C0B3FF5ABE2BF705EAA40CABC9BBF8B181B40930292C00F190A3F807124C05510E33F7992C13F5F47A5BF8F2FB93F7DAEEFBF9927BFBFD29A4C4015667B3E47E38C401E6C7C40969883BF920D1AC0E263D0BF645A15C0433582C095E4A4BE712FCA4018CE2CC0A7A37040527D36C0BF07174051FDD2BF22659E4067393C3FB00026BF4C4C0BC0C69CDFBF44589740279A9E40EC80533F2B418840D1FB113FDC0FCDC0AFD403C0DD90103FC2BAAE3EA7DC453F5B7622C0ED067C40FF71683E2636CBBE42C5AAC0444D9E4029079540239C873FBEBA59C04A00C63E9ADBC6C0F050D040452C1940A94E4540E4F015BF3189ECBE57E2073EE5FBB6C023C5AABEDBFFD83F85B40140D4263CC034F6B8C06A720C4089A6C83F2532E93FCDDC5CC0DAAF51C017618F40F9E28B3FFE29E43FDAC07640F6A521C0849506C01B219EC0FBD226C08217C93FA28C42C059B40FC0BCDBCEC0F3EF27C08FE7483F83E71BC0BC07233F2E9B8EC000C0DA3E1BBB8D3F3E0AE440FFEA3340D970A6BF04CED83E05B4F6BFCE34CFBE732B03BD34CC6C40958E973F397AD8BE3934CABF8FDD8C4002756140E5F31240BBCC8DC0D89948C00C8081C0BA47B73F678421C0342EE73F35AA9EC0AA99F13D435509C038BD843F01BA31C099FBE9401498D63F73863AC0297DBD3F4E44DDC05F3FBDBF5EBA66BF741C95C015A20ABF9327843FCC4EDC3EC4FD9DC0CF354CC0075908C07698823FCAD4953FC96AFBBE509E1E4020A32BC0AAC0793F1CE056C082254240E5A249BD1ADD9DBFE6D81E40FCE88DBFA540CD3FA99327404F96E13FCCF4B93F91FFE43FFE935CC06225453F896EF43F740A0341963EC5407F9E28C015965B40B7778A40446A63BF185CD63FB0E8A63F40DA793FE1D015BDCCEAD1BF18250E3F46832A3E9006DEBFB04B9CBE4B39633EC1FEC0C069886EC06D1453C0F33FF7BE06A723402E63E6BF229F4340558C864094A2F73F9F788540ED26BB40432D1BC041882AC08D65D23E95D7904020919EC0F3F7A5409FB387C0D4D58540C4B1DFBEB3A975403C2974401F5B80C00CCE46408E9F17C008E64A3F534A58400835EC3F30D51AC19A7CC4C0AC0AAFC0FEC04BC03A03D4C0B09B783F4697C23FF06AF23FCB65A83EB7E934BEAC2630C029FD04403AD142BF493E15BF0F2EBD3F1A7D8FC0E8A6A1BE834E2ABD1FEFBEC05DCD693F6CD143C0A7240440E7C65140D372854055F310C021A7CD3FC779EAC066D35040B4C5A93FA87E1F405F16813F7A6DC83F7C05CF3F6FD39DBE5D83A53F5213BEC02FEE6D4098E086C0B2E24140D749F73F13270EC0A4866140CF9515406CEAFD3FDB786D40FA8C7B3EEC53D6BEBA600F3F0C523D402F6F43C024A5EBBC36168DBF44080A3FAEE3823F6C3E97BF57D334C0C7AD4CC07613B8BF4ECD27405F5A18C0E759023D4BA8A440571782C029E457C0F6140C3F87C0843F578439C09D95EA3F86A30140D94F4EC0F96320BFCACEDBBFADE5863FCA6C68BD92899E4041AC3F3F2529753F90FC32C0DA6E8BBF1E9B9E406BBD783FD6DE883D9F6B55C091943EBF039D2CC059E7F0BF3B4940407C192FC0B3423EC030722CC0FCACF33F1EF38FBFE2F296BFF01C69C013B28840016373BF045AAA3D771B60C0FB3D98BEF82ECC3E1A2EB33F9BDE0440FA504F3F2B73BA3F2203063F82D7BC3F4A99E04026F4393F485191C014A252BF13786D3F398D1EBF24AD663FFB6A1EBF7B61494012420FBE2C764FC07896BF40A661FD3F1D14AD3D5E20C1C0E933953E519CA0C0395197C06E1CDCBC22E5C5BFA5DFD6BF0C289240DEECACBF9E35ACBEF82B7AC0F2638BC0866293C0622008C0F395AC3FE1CEC73E30E558C0FD3096BF5E49D8C05767B140980F5C40C33F1FBE977AB23E29189E40BEE98A40B9DFDD3FD258264027160FBF5EAC3140BCF5384018159DBF7C8DF6BF1B2DA640EAD91EC0A62222BF5212F0C05035BFBFD17286BFB89904C00A259FC032EF3F40F8AE65400DEA114085579CBEECEAFCBF83ACFCBDEDC77F3F98C836C017B4AF3E26BD65C06E11D8BFC867C73E6D2BDBBF3AFBE8BFD667A43E2B109E3FD0E19340EE248ABE728C27BF94E82DC0B1F6B83F55427840BC806DC094129D3F4CCA824073524C40999636BEBF9E4EC08B79EEBFFFC02F3FE2A48CBF408808BECD3A99C04E2056C0EA0E913E4134FB3F51814ABF61D0DABF765AE2BF2FF5D93F548736C01A877DBF2D817640DF5292BF6BE3283EB87B60404CF364C0A6F7E9C075FC2C40BF5036BF19DAF3BF966F22C0081900C06682E040F0130B401FA3C93E9A5C86C02C804BC0570C6640A24868C0783302405DB7C63FFDA983C09C6900401046173E186C9EBF2B32CF3FCE90B340BCE121C08C60D5BF9D15513EF1DE3FBEB330DABE32977E3E706B3F40F683BEBE9D059FC0181E38407B9AFEBF646CB03F91BB5CC02467A3401DC2163E16623ABF58383BC0942C5BBF64FB0F40BEC53FC01860D4C047600AC05DD67A40AE9C763FFC55EF3EDF2945BFB1525940D678EEBFD2463C40E3B5363FFBF4EB3FEF961FC03419233F184F57BF0C8E1540230A1B407ABACD3F923133C06866B2BECB881B40FC6361C032AB953FC42879407A421840249B9F3EF0C68A3F5EABA43FDE89D33E8B57C8C0E1105AC047CB3840F57D823E8C9C8FC0CF87803D3E1A9F40D4BDC23F8146EB3F256F8DC010A28240A92A8840CB7FEF3F7F81ABBF85B8B03FF9173840BECC1CBE26B7B5BE7898C5C042F498C09E5D7240A3174A407812243FFD6888C0996E3140CFC2A9406FD70240767AF8BEC957B73F61F19440AFDFD03F6687883FDFF7CCBF5B800EBFA53E9E40DCF05BBFAFEC8FC039B6CE3C3AEF603E9C1AEB3E47BD0640E06D003F297429BE3AE8253FE8F07A3FAE6D62C011D6CC3F62F3DEBEBE1DC0C0477C59C034A629C007453EC0A7749DC03A17483F86EEA53F19A83340CF0C04401E0682C039254640E9B8FABEE93E04BF08374D400FD0953F927515BE86CADE40E8375C40F9C7F13F94AE91407840633FE0A228BF548376C099A38D40DD2D49C02CFC8640F3B4D63EB8DBB53F38EBB1BF0ACDB540CAF4604084C895BF5BB10CC0AB8F4CC0EB6DFB3FD61EB4C0588D923E6578543FB75CE3BF62332D3FE67F9F40CF9DC3BF8AE083BE6CB1234059AFD4BE24A538C0F185DA3F88069F3F9549EABF338FF6BF40FE8ABF93B1A6BF947C74BFAB1339C0CEABC83EBD15C5C09951D2C06D5602C03989FC4047DD9D408E1B88402A7FA33F6D698FC0CE8B45BD51689AC00C4BF03F3EA79BBFD0A648C08B00653FE59B9540F49A58407A6E19BF07360E40B247ABBF11DD53C08E9D1740A3B04CBFDA3F9CBF4AFCDEBF2D51973E2963043F94D850C025BA7FBF4A0787403B15F03FC12794BC4B8639BD5A3B68C0295F25408361CE404FC7983E09F6FF3EAB53A43F16A001C0942084C058C01EBFB1CEF9BF437E81C0BEF0A440"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xA011DBBC7C2B463F601AF4BC04F9ADBF48FE59BE0DD7B6BFF877493EC831B93F53F0C53EE458B23FF01BA0BDFFDAB0BFAC3AD5BECD429D3F00E7E93E86C8AA3F6CC6303E240ABABF18A7A93DA66CB4BFD26BF3BE9040AEBF30EE63BE880FB2BF401B2B3DB0C0B23F0C7A403EFC9EC63F401C303D7F7CBC3F3C2F2DBE4C30BD3FCCA3193EDC54B4BF182C12BD222B8E3FC8CA47BE6763B73F4080333C759E98BF585B80BE0224BA3F682DB13DD17ABDBF38DF5FBD8C2997BFD4E014BF25239BBFEE5C7E3E8234A63FF6A9803E2AA78A3F5890D6BDD09FB13F39F09BBE2F81C33F229B59BE7643A7BF049366BEAF22BD3F1C7A6CBE531FC43F805E97BBB094A0BF8D21BDBEA3D9AABF80ACF7BB70E5B43FA051D33CBCB99ABF3499BDBD15929DBF185EA73DF181AD3F3880133E8457BD3F88FE42BEA6E1AB3F1C15273F40125F3FC0DB803D8297BBBF5075F13C169D1F3F009A6CBD2D8BA33FAEB4863E6BA6BFBFB854693EA439BD3F2C0C2FBE7C45B93F7E7B29BF7747483FC41307BEF704B63F30B51DBD7E39A7BF345356BECBADC6BF001F26BC0C62AFBF9DECD9BEBEFF9BBFCC027FBE1703C3BF80C12CBD6480B1BFE09F38BD9137AB3F0010E43DFDC2BABF3835223FBE0B913FF27BC93E0F37C03F1845F2BD6286BA3F1021D03D0667B63FE8520C3EF481B13F17E28FBE6560C33F4834B2BD4A0BB73F584260BEBE2A9B3FAC4B2ABEA322B8BF02DEF03EE39EBF3FCC721BBE0AC2B1BF80877C3C08E2B13F201A4E3DB4F8BA3F907166BE4D4AC6BFA83105BDB87198BF8000033EFD5BBCBF5AAABABE6F2BB13F00536CBD4A57B23F30682D3E3859BA3FC574F7BEB0839FBE20BEF6BD8608BABFB6DAA53ECA229B3F0232D73ED59FC73FD94194BE62B1803F0C57223EB1D9BEBFF496D93E7170A8BF44810D3E4718B93FDA15383F9F837C3F186E063FD9B9A73FB90AD4BE7A11863FF8EE5B3E5088C03FB58CCCBE23A0A8BFCC725BBEF6D1B33FCC3B96BED315A33F34254CBF33FE06BF1C57003EC10A8BBFD871383E06ACC3BF9816B53D1838B3BF38DA8C3D1D2A9BBF90D59E3E9CBFA23FAC909BBE444A953FCD7DA0BE1E0EA5BFF38DA43ED7ADC53F040C003E6272BA3FCA4A09BEB9FF9CBF40C33FBE34D4A3BF18257FBE5D6EC6BFFC67093EE59DC1BFFC9F2B3E9E4BB8BF43758F3E22DEADBF8CEB4C3EFA26C53F3CF1DABD035495BF603788BD2D69B13F306E4B3E15B5C43F5455703EE1E2C43F5C7F11BEDA20C3BF4014083FD230E13EE453C73D52559CBF2C6F843E1B11C73F40785BBC8679B1BFC80FDA3D740BBC3FF0B39F3D7A57A7BF40591F3C04B7B4BFF8110B3EB794C23F342AA53E25A3C0BF8E67F9BE30282A3E2C4A34BE52B8C7BF7038683E06F2A23F08BB8CBD9E7EB7BF7742973E5266AB3F38E6E93D1D28ACBFC8FFD5BD7F5FB63F701F5D3E7903953FB027393E7269B9BFF04991BD243BB3BFB65C8FBE25CEB13F389557BE1932B4BF106608BE770BC2BF1007D83D3DF49ABFC09EF53C7854ADBF10E53D3E6F6A603F9855F93D02D8C23FDEAD40BFA9A9973F223109BFE284B7BF00DC0EBBC946A73F9C6D493F4C0B8BBFF8598EBD4E84AF3F0C1D4B3EAADEB73FF46519BEC52FBBBFD81D63BE6CA3BE3F202784BEE1B1AF3F584451BE0D6CC83FDF29C3BE135DAE3FA06D37BDF8CDB93FA0220F3EAF1DA8BF000BEE3C5075B7BF6014F3BEBA169ABF8C035CBEDAC3C5BF2F2B493F46676D3FF00412BEE308BDBFAE67C5BE5C3CAE3F4F233A3F3B2A88BFC8A7383E84CFAEBF3833983DB08EA6BF1945AF3E424BC8BF209715BEC32AA03FEDDB7FBEB678923F7720853E6B14B13F48DE7E3E22BA9C3F57A390BE3085C03F0051DA3C544BBA3F5CDB0C3E2E6CC1BF18BCE23DF3CBB63FCAE350BED2B38E3F152AE53EBD7F913FA06222BC6BFE82BF4A93183FEB086E3E65D81EBF64F8B6BF804DC23B9F0EB4BF707518BE9CBCB7BFF8D47FBD84A89A3F24040BBE24FBA93FC4DF493EF613BD3F50C6A33DF385BA3F584D39BEB245AEBFA0849B3CBA70AD3F88D2C3BDB415BC3F008AF2BDFED3B93FE0F9E0BCBED0A83F20DFFB3DAA25B8BFC80C4E3E9888B4BF80027A3D42EDA53F00409A3C1E56BCBF203EB9BD46A5BEBF80066EBD2F64B9BFAD627C3E845C8D3F0A110F3F7BBDB93F2041A8BC869A9CBF786DE03E6D3BB1BFB10230BE4C00833FDC0567BE62F5C6BF00E494BADACEB3BFE092A83DB47BA3BFB823073EEE0BAD3F74CC3D3EF1C8BBBF200EE63C8079B8BF2F27883EE66FBA3F03C6B33E2204B53FC92F923EC4109E3FBC0AE8BD0CF86D3FB081F7BD3F3FBF3F286B1FBED060BA3FEEC0583EF472A7BF9CD2483EABC5B73FA091DC3DBD4DAE3FEA77573E90B0D4BE80E3643D988DA03F770FAEBEA59EC8BF48FC2FBFBC97803FED23AF3E7C9787BFFC2F1BBE114AB2BFF27618BE58B7A33FA635E5BE7830C83F38FFF33D22D3BCBFCED597BE9686C23F706CCD3D1DADA2BF98756D3EE038A53FE73E9DBEF4E8C0BF7EAFD3BE6974A23F009011BB4892AF3F6633B33E0E59683F5297A1BEC40FB8BF7034493E93FFC33F00A0B43B66C8A3BFAC5CAEBDC5459EBF70DA11BE2467AA3FE07327BE865FB1BFCC627ABEBC87B13F36A8B7BED2B28BBF9861E9BD3497B73F005AC0BFF4100A3FA22895BE31B6C5BF08EB053E71B7793F5405DC3E7A3FB03F9285243F07E09F3F20B8E63CA2B0B73F6084063DBEF5ADBFCDD1C5BE88276D3F5092A3BE3CE5563F608961BDBBEFA23F00E146BC6CD2A2BF24F61A3E4C8CC23F00F7133B440CB4BF00BC353CDCF7AFBF90DC5BBEA3E6C8BFF3F58BBEE5F69DBFA839503EFB20C1BF402DA8BC5C37A9BF10EADBBD3E49BABFD15BA9BEA624AB3F004BFD3C1AC1A4BFC029C8BCC2CAB6BF0043053EFC90BE3F37920EBEB439AF3E788FE83D7C17BC3F720C2B3E6AC9A63F20247FBD463B9E3F8CE7973E45C3B7BF304D7ABD5484B33FC25EC9BEF6BABABFF8EC03BE8DBDC5BF32A32EBEAAAF98BFC0DD16BE1A76BD3FA8944A3EEF5CB83F78877BBDE40F8EBF083F7CBD68ED493F79E5B7BE990AC33F58D66ABEB6A5BABFACBFC53D228387BF68C815BF5E6FB83F908E543DC87BAF3F17A840BECE741ABFB82E93BE8E05B43F6858083E1960B8BFA089833D0CAFAC3FC856A53EBD96C6BF7CAF6DBEAA0EB7BFB2F5903EE2666FBF8074B6BB84BAAEBFD3899CBE2A89C53F6190E63E28BCADBFCD8C87BE24F5A1BF88F7143E64FAA7BF305A72BD4460AA3F385992BF2332973FDC130D3EB297B6BFD820F7BDE349C33F8ACA11BE1A9C90BFE0F373BEA969AFBF68B6053EEFD1C33FE0D7AB3C7C5FABBF94CB0ABE03E0B43F38B956BEBB6AB93F808D9D3D6A11AEBF62DD0A3F72E0C23F160986BE0CF1953FBC16183EC456C0BFA6092CBFB6F0BA3FA7FC22BECADBD3BE00B0CB3CE2FF9F3F000E6CBCD4C6AFBFC47E6E3E1C47B3BF400CC13DE36AA9BFA8FA4A3EA24FC83F30DA94BD17FBA0BF66E003BE68D3983FB01E64BD0213B9BF708AD5BDE80FB03F2AD43A3FA7F55C3FE07C71BD66FBA53FBC7415BEAAEDA93F2A59193EB6448F3F6053C8BE5ACDBA3F1CDDF4BD3E029A3F03F6903E51FFAE3F27A8BBBE0AADC2BFC4B6033EEC53B0BFE079893DD24EAB3FE021E03EBFB8C03F2E49A43E341B8C3F80B7273C5ADFB4BF50D92CBEAD20B63F00F4443C0E15ADBF00E31F3B07A9AF3F56227B3E41899E3F0812F8BDA279BA3FC8B34A3EBE90BD3F21C3A5BE7E18963F3B16B93EAE60C6BF002614BC7293B4BFF0F302BE8DDBBB3F6219A03E1E5FC03FD05728BE1A04BB3F58E4283E29C1C03F72D11BBE8F1D7F3FE06B453E5D2AC03F418C7A3ECF6191BFC019B1BC5CD2AF3FA08620BDE0F8ADBFB53AC53C608C5D3E7024A83D292E923FDA45073F325A5CBE90429C3E7A9F613F4CD871BE46C1BA3F40A63FBC880AB4BF147B39BEA64FB6BFD8AAB4BDD0FEB5BF7234843E5D1B823F6CCF693E295AB23F2C6E1EBE6B94B93F337EC6BE160A10BFDCFC8E3E8A37BB3F004441BB44CFB63FF0DB643E74A6B83F349C5B3E6589C33F903326BD9F61A9BF0426193E5527BBBF48CC743EC4E6C53FE746A73EB5B398BF783A023E94D6BE3F8AA32CBE45279CBF80BF67BE7C61B63FA45F37BE05DFC73F14D9363E52BC8FBF60E9D23CF625B03FB46B3BBF4F86B2BFE15ECC3E68D2BFBF051183BEE275B43F8635663E24C598BFDF4FC8BE8278A8BF795CE9BEDD5091BF0E93B4BE5269C23F60BF9ABDD9A7BEBF40BAF7BC84E9B93F98C6EC3DBD19BC3FA04A673D8FEDAEBF002702BB4EE8AEBFB6E1BB3EBF1EA6BF9D5D9ABE2F4EBD3F24240F3EA4D8BB3FD057C5BDA6B7953F88E5C9BD4F38A8BFACFBC73ED824B6BF5EFB72BE362B97BF446F6F3E00AB013FCE2A92BEA630BDBF8CA94B3E5B61BD3F30DE93BC557539BD340B3ABE5EEEB73F9CB51F3E891FC83FB132383E5621743FD064BDBD8C2BB0BFF85BF9BD736A90BF30C6BEBD46A3B93F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
