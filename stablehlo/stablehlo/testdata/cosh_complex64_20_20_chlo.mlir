// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.cosh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0D3B2FC0313886C07FFC8AC085F92940EE249F3FE4BD08407E43FC3FC6D04DBFA2DF69C048B7BD3F436320BF9BDB723E2D218140B32FC83E96DA06C1EE517FC0E4BD75405E5D40408ECE0EC01BAB5340D9598ABFC2FABCC0884A85401FF0233FC85FB64047203CC05627CA3FF6343CC004C7D740787A1040EE9DBDBFD7FC47408B5210C0B8F91B3F684FDC3E41859FBF21F98640DC1FBEBEFED347C0B9BB0E403553EE3F3569A840F7BC4EC0116405C08F10B63FDF3A6E3F6901F23F5EC475406BDC87C039E40CC090A03FBF16668CC008216AC004A769BF71ED58409D57884045F2483E50FF10BE5B3757BE49E7A93D028AA24027489D3E844ED63F9D031B3F2C121D401889234003BADEBFD9D7C34046CCCFBF295722C0A16947C079E392C043EF58BF76237F3F9699E3BEB8AFC8BFA79E4AC0C0031BBFA0459EBF376B183F158011BEB2BC07BD69124CC09E1C95BC57C67FBF9EC88C40F72B0C40280E78BF726E11C0FCDB9E405BDEE7C0E580EFBF6088CDBDEBB8073FB6E7CB40BF4CE63FE331CD40C9AC6A40694A58C0ECFDAB3DA6AFE7BE46589F3F68F0EFBFB13B17C0D144C3BF97333C3F0B0BE9BFC80861C0D84E4EC017B9E33F3425A73E6FE4C04009A2A4BEE40A06C06969ECBEA60F1BBF1A895940A0B330C061FB35BF2B7EB5C05535FFBF4FAA313FAC8D55BF79B2DB3F19C1FF3FA7B1F1BEE7842FBC912DB0BF0289B03E255842401FF518406382D83F5604F4BF5B3E8FBF8A7D0D40810656BE0EC717C0DE61253FCFBFB64061352140F7E510BF581164BE015B0DC0A7BC0840946FD2C0E6AD05BE92EB64C0E93D15402A13023EAE2FAFC06C0600C15994DF3EA1D395C08DF88E3F7D0D823FA097C63FE08650C05E5D8140C12F6E402AAA13405D103EBF03AD1640A3A540BC121B543FA7FC743F76BCEDBF6CC05E40C6ECADBF0A1FC93F3349573C1B5A2540185D7FBFE7CA5BBD77EA5BC0BF82F23FB631CBBF97C108C0C5068CBE8AF2CBC0FBFAF63F3AA6423EA89007400D50FCBFAD6108C01CD82FBF16677C4061832240AAE5C23FA78CFD3FEC66C240A205F63F6BCB7E3FEA1CA6402CD71040C37D3ABE8D0C9CBF8CF72C404AAA51C05E4E1640BCD12B3F973664BF3A473E3E1F1964BFB38267BFEEF13B40FB5F6BBFD3FC8A40C1115BBE95787ABF8A257BC065991F4012F2283FC1F871C0FC49A0BDD9C14D4090798CBFC241D23F219987C0EC9C0140F9242C3F9DED02404B4710C0884CCCBFF7AD1C40107CC2C079007EC071E69440B7CAA13F18CEB2C075DF0E405D60BB3F36D512C05EBA8F3FC3ECA7408F302E401E4405BFFEC518C0793455C0DF10B23FC846583FA678B03F9A75C63F24D120409CFFF93C9A1D8F3F9FFD983E52F02BC07EF2CBBF195D3E40EAD7E13E0BBA9C3F50D72840017C273F7E536BC0AC849A40361F62C0746C7AC03D482341E8BD033FE2858EC034A35A40BED8B03F38EEEBBDFCE4AC407631BD3FEDEB5D405EC6294031994E40122A084109657D3E5C3B554031F8A64073AC803F9FD074C06EC58DC04807973F6AD1F33F01E717BF3C6D983E9FE33C40862EAE3FDD0465BE28ECC6C0C448E93F80C97F3F17C6673F861AE03BB7230CC07955B83FE125E2BF15E69D3CB572CE3FDFCB3EC03BBDD240BB4003BEF6854C40B99A993FC4303C402A5353C0A91D8FBEAF6EBFBF030D2EBF009873C0B7272E4050A928C04F6D9540AE51194052563CBF009F35BF902E1FC05613E43FAE2697BE94755A3F430BCD3E25F8E63F96B200BFFF260940E091F6BF7ED2D8BF401B3940CDAFA4BED340A140503E3240AE72F13D6AECF33FAE4F67BF526967BFFDC7DB3E1D6006C03FD104C18D26FEBFF46F16BFBD3A913D5F9255C073C69840353D3EC0ED20883F5B68AEC0E74A13C0D7FEEFBE763247C0BF122A3F4A3B04C09520B0BFB2A278C08122033F40103FC069F055C01FD354C0E4A21B4034E120406ED5C0C0449D2E4054DAB6402D9520C0CAA251C0C26CDAC0660414BF8698AEBE42C707BFC72D80BDB82689C05D67AB3F9EFE024083D2963FA385AEBF4D8708C0E4DDA83D3053D03F107E84C06BDE02C088613AC0B0EA8A3F301A7F3F15264340D76DA1404FDC06BF6A7762C0D03E1DBE4B3C89BF4F237F40325DDABF0581B840BA0746405E70D33F79C8B03F078955C08C5E4DBFC37E6CBE9EA5C0BEEF80B03FB1F2DB40C47ECD40DCD2EE3F1A98AFBFFF30D0BE85568ABF556481C0B846A5BFF03C4EC074A4BEBF21354E3E8D0B82C0C4CA84C054540C40F5A99E404DC8A2BF14E182408855F9C075352EC05FA44DBDA774C2BF5F84803F40590340F3D03340A734CFC0C3D12A3CE2BFF6BF9E43B64056106EBF21710340E1C9944080027B408BC8543FC061CDBF0F60C4BC77B3C93F764A43BF732FFBBFB542194020CBACBFB039913DB14F1840958C1DC0F49695BFA4E000C0F91F0540EE5C0740AC12D73E21F92040F6C6F53E9ADAE9BEA71415C0090E8C3F5B4C863F0D6EB6BE7E0D2DC03F77D13E793A053F6BD4D5BF7EE43D40E95D4F40F2A82F3E10C384C0C885D3409C2F4D400B6D02BFD972F8BF1798054060E41EC04C769E3F518F0FBFAE2F5BC04BFDB0408E446F40682544401BE6BC40DC3900C0FB9E40C0E2323DC0126684C0F39A5ABF69D5773F197E663E421F13C0B1F4A33FBEE2233F0DF286C0428B7B4041212DC0E6654B3F164CECBE9F5C253FB5A6DEBFA6126B4092743540F605F23CC30D6C4030A7A6BFE88F80C00EF0733FE8DD0EC087792540B4508CBF466516BE071F3B406D0D8BBFE7E69540D50E19BF0E210CC0122EE53F581B89BE5C2443BC4A1A47C05252DDC0BAD47C40B35730C0890355406D6396C0E97E223F5CEB893F75D8C43ED1645D3CA750703E2251D8BE73D22DBE5A96684050C7503FBCB6E0384AAA57BFE7F630BE0B793DC0CAFD5EC0038C84BFEF571940B0B5A6BE4F198EC03357ADC0F2BA233F496E58404D73B9BFF0F66ABF4DB81AC0D552823F182B33C02B084BBF8CFBBC40575643402D40CE3EC31265C0BD0581BF7E199C3FD32137C0954132C0571349C097B267BFE7D5BDBF41D8D33E0CF1BEBE06D2B83F02DBCA40BC6C0040F94C5BC06EDEA2BF42AE5440BAADEDBE5B99E5BF2BFA92BD8F7A963E2BFA1540481525BFFE7104C01EAA80C08D3CFBC070AAE83E94E8673EEB9F953F1048A2BEC25289BF7206C33F781A9EC096C9A9BEEC5CAC406E6DAE4084BF56C0EDF5C0BF1E4B91C0116D3740BBDD96C001218340F1B868C0055E1E3F3961633F75BE7E404F813FC098A72840F8567BBFBDAAA13FF96A4F40E29DCF40F254F53EC6B7BA3F464F3640CA4D4D40D88F6F40D37987C0F8589E3FB3F781BF390180BFE4BF10C0413AC2C0D918BF408D04CF3F076F893F231D1940A3F898BF98C443BE05DE2F40DFC212C0B6FCA43F9C21B840CD56643FB96A52BF6AB90CC037310E40860F15C030195BC0CE9C6140FB0E853F2B9BBFBF9B27B53F33FC30BF44CC2D3E84CD733F3EAA8DBF847568409E137B404730D33FDFCEF7C01F560EC11125A83F73F8BB3F12CD183F25C5414017ABEEBF06D4A0BF59BEFBBDC39FCFBF20A50A412862753F478DA03FFCD135C0ED5C803F6DCDBFBE0CB158BFBE4304416FB7A8BF1054183E18BB29400E4C2AC0F7D992BF39293240C4A905C007012B3FB41A38C0D5D5963B31A82BC083CB4AC014EA45BFC5EBBEC05A6A2EC04C949E4046A3383FF2373240AB2B03C014371E406E3F364061AE1D3FC60A79BF5FC84FC0D2F652C00EECEFC0F4070ABF95BA83BFC8D1503FC83A863F059250C082F921C0402C5940565C444064322CC02E4193C016219FC04E51BBC01E4B024161011F4010DC88C07E922DBF3229DD40C77E6BC04F2FA1BFFCA20D40CC369B3F296AEEBE3F71AB3F08FAC2BFE04DD4BEDFED1BC0155548408AD0FDBF41AA254006E7C0BE3A2D15BE27A5B3BF8BD21640205593BD969719C0FC590B403E0B27406D37F1BEF3038FBE5C458FBF127F67C051103D4050F843BF383CAF3EB6562D405E3761C05C9366C09C1EDD3F6D257DBF2C62CDC00717ABC05F45C5BECB7E73BF59DE15C065EEED3FBFE41440CF5082C00E7EA9C04AD67640FEA882BFBA7E26C01D3B12C01B6C86BFBD5FA73F65829C40307EB9BF8176DBBE2E0FCB3F83BAC7C0D0721BC0487623BF516E8ABE7DF60840B77584BE68F9224005A57F3FFDCAC43F363EA3BE4309204079F0FA3FC070023E4FBA3B3FF0DC9A3D21C40DC04C8A60C02A6F2CC011D9943E5571833F34614E3FDC9C1C405733243FFBAFC53E9D9D10BF4A5455C0FB7B7440F547953E5712CB4007EFBCBFC5DC40C0F175CA3F794A38C0FB9C4CC0A7B504C09C13B1BF1AF73D40668835BF42578AC032BB2140A654DB3FAE2CA9BFDA554E40156F14C0B8680040DD2AAABEFA87B43FDBB391BF728E8CC074AA4740454256C060BD83BFC313E03FD9692540CD680E405F0FC6BE83BBBDBF3D3E6BC07DF3C03EB5F266BF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x73ED75C055F2D5C0E42408C216B38FC18AD980BF51BBAB3FA66F2240542922C0AB0FDB3F16D999C1F4A4953FAFC920BE2E3BD1411C632C41C130BDC4AF66D6C4376BB8C1568C49402DA794C0E15F423FB485C33F3F22F6BEC1A8CE4164EA99416A4612C304CBEFC175981EC0E645EDBE986C86C35EFAA343AE0514C01E670FBD73FC7C405EB42CC0EC9CB23E1350D7BEA51CFD41FB0945C184EFDEC0033E0FC1C3A8DC3F3F4B2BC0C208C7C07FEF2F4179C3A73FB378C83FD20426C0B73305C067ABA4C1B374E141EB6BD3BE620A47BFA6F03D41156075411150CFC0B72C55C1AA2A813F4E54E4BC3163823F8BB98FBC4E2799429453C241C34B11407283BB3F613E9CC06E894C406B7239407C87E53E6AA40AC0C364B13F332BB0BF4EB832C1FA05403FA8BE4CBF0F95533B552BEB3E113D1C41AF8DD74046DAC53FF65962BF2C39813F5DC99A3B7A564241CCA5613E1408F3BEE1F48E3F5CEF234009C868C093739C3F13BD9440336D4FC31572274469F85D3F0C3750BD0D8684C2D5828E4393CC83C38CC018C3654D6A417A6B9DBF8500B53EBB0EE3BE30FA17C07A050F401F93E43F7904BCBF63BF3CC02CD28CBF527826C0E74844C17782823F1BDBABBDD1AD06BF590B913E554B693F096F8B3EB8945EC125BBB1C0986A843F7302E3BE55FC3740BD8413C0D64F4BBEBCAA6CBF080D5640BFADD2BFCED4453E6D372C3C00F086BF05EA163DE59429BF37E2AB400F20C03FB0713D405D819040D2616FBF67118A40BA984CC0E86FF5C2CD38B042FD5F913F4AF8063E7C091EC0DFF672C02DE9B143DEDD3A42DD7A45C19FFD4EC14032323F51AEBC3D7B17A94413D71DC43767BD41DD1B42C2DBE3F63C8895993FD95401C164D92241943A5EC142D47441BBCD68BF2D5D13BF600E2D3F50F90DBC722BD8BE1C4688BF76E25A4099BF7DC14EA4204031D6F73CF23267407906B1C00C5375BFC9637FBCABFD67BD6FF54FC0BE568440CE69903FA6BFCDC2B82D89C3FEA707BF8E35273E9ADDF8BF2ED93E40359C5DBFFC96083F2A229D3EE43AC9408E476740AA113CBFA42CF33F038F3340BD5D65C2FC488A42DB4BB33E330C303E689BEDC068C67E3F206284401D774E40492EB33F92E43FBE8659613FA4F84B3FAA63B740A934EFC0B072164271B302C151C989BF6B2A4EBF1D139A4031E36B40B4F5AE41A350DB3F4CECB540380731C126EF9CBF5F960D40240041408D69144037EF1EC0C1B33CC024CDFCBF128BC1BF7A9313C3357420C3A07F7D4187024842791BA4C210C0D2C2FEF0C0BF0E42C4BFD0EA5D3FC54A97BF58FCD34057FA70C0516DACC0913C82BFF857B53F4979B43F11C72F3D1DE3ED3FCFA0C640E97F3F3E8D18CF3FACE5CD3EDE342ABE7FBEE94067010E411A648540CF33CFBFDFF23F3FB18086BF2158B73E752E67C289E0BE41394F8EC10EC58C411CA094BE420F053F3576374096066F41DE25243F4747B63DC3D40BC03B592ABFB35BE3C03C2E1CBF07721645BC0718445B15D940C3A743C194BE99BFE5563F3F58F47F41CB3B1BC21F2F3640D217EBBF934D83BFF3F4693DFEAB0140CBD5CEBE1E8479C23B8972C33CBC733F2B686C3F098414BF2E8AB6BBA23DDEBE511CFABF79562CBDD0C49D3C0EEC1641AB5F3BC03DDD80BFFEAAE33B5919E3BF66649A3E392C514121836F40BA37E93FA083AA3F9A52A4C1A9C812C1558C99BE2FD1DD407643834040BB69C0303580BFA81CF03EC4083B402FF956BF7575A33F7FC6BF3EDC012F40124EB6BFBD87C0BFA4387CC01A6C2EC0F70526BF05ECAC3EE6AC9E3E3832014127FB723F3B170840354725C01B44A73FC6F3DBBE7144E5BF6D016840699E45405E8BFD3FB9C17BBF69D8613CA87969C2DF6D1FC1E7908B3FD7A0713F39029040DCF30E40EDD80D415448DDC0C0BB463F6BDB7340C0BDA941B8BB3EC1368D1BC17286FCBF2DF828C111CB10C19B5FC0407EB4C73F2C35CF40AE6783C0E33AC4C06BCB50BF70E2C0435CBF7B431FCB693F5616343E8B2ED4BEF48D69BD352A6FBF8324CA3FB56FBB3EF531B8BFD28188401781AFBE7B30B7BF28B4034039D874C0F3265D3F0F56653FADE98C3FA6B85C407D321FC158CF86BFBD545ABEB9BFF73E2CA40A3E8F6068C0766ED5C160691FC3F7D2F1401186023FA4EA1D401F921C41718521412678743F3C59AF3D9386E03F4174843FECD4B2C2521F9343B3A8F63FABC03A3F796C82BF85EC82BF4C8FF9BFAA130BBEA21A12405983D7BE737078C163DCC4C1454A8D3FB54C89C0A48D8FBF28E7AA3F62278AC41C81F6439E92533D59744D3DCE8337BF6B07863FC1DC02411F08CABF84E7B2BE530E20BCE2EEB1428E8CEEC295727EBE62ED74C07C358841552C95415A9A2540B7616A3D863BE93F02A7CCBFD2662AC092A617C079650340148502BE3D9287C0C67C57C0729041BF6217A83F76B406C02FBB5740A9F761BF36D2813EFE5E803F6B3661BEBD39184056A590C0BA45C03F37B4DFBE6F46DC40E54E3DC0B631E8BDBCA10ABF94221BC1D10674BFA2C60ABF3039153E3540B9C37E42BFC125D0D1BE57D6FD3E9A2A4FC0658F1BC00DA0CA3F500857BF5E9B334119BA2741A6BFA7C1F053CE3F218E99C2B93426C3FDDB1FC1FBA4EE3F10ADA441E2D9BC4194F3BB3F33BD803EC015B83FFA3397C0C17B13BF7D3D1A3F48AEB8C19F262CC1E0B9983FB2D1C8BEB00551BE1F972EBFF63E96C13CDABD409BC65ABFB4B27BBCADCBA1BFB060A7BF56396ABF01F75EBFE82743401FCABBC0C4A67CBF207902BDD9F03CBD4AFFA73FF7D02FBF173F043F63113E40FD4B45BFF0E57FBFA523BF39620EAEC3AF6EB6430940F8C0B71DBA3F8A033142765502C27E76C23F2957F93E5C01793FC5EE4D3BB396893F958F963DDCD14F412A6F5C4189672A3FB9BCA7B882957FBF6A1D003DBA2405412A186041F1D0A7406FE7DEBFC8C7DB41623E01C241A296BF6E9A26BE2FB3AE3F6185CC3F1EEF3D405E8D97C05634B94095B0BA40ABD436C3BE2D834125F07ABFB099333E98C1083FE5B98EBFBA8803C1209142408227E540BA5A114171C20740481857BF2FB30A3EDCD3C1BE711AEFC28D5A804337E39040CC0A6B418DBE4641B182C6C0EB314540739B563EEA753ABFBAA15A3E54C814BF2C3D1B3F982CA23D0EE7DE4150D5893F6C3DD83D7D9FD63F8D04E8BEC9A79D3D600AA5BF354284420825B641CD0593427B81A1C2AD4B683F228764418E6834C29AFF4BC1B9AB00C2574636423A83774152F12FC14D2673BF854340BF0ECA0BC121469AC0200FEC3E49F48BBF987C48419B182640DFD2FF3DCE3AFD3E2E440AC1B2DC11BFA5BA1BC1BFD89541C8257C3FE195ABBF8ABC7BBFCEDD673F40DB4D43B38484424DDD9F3F012B0840A18601406577A1C07FC070BFCC1997BDAA1EB23F21B196C09217C6425D89F54215254CBFFB183E3F655A4DC09BC453C072CC63C1AB7CB740F272F03D49EB9DBFDBFDD63FC51B9EBF2190163FD6490E3EBE67BDBF2C75223FF1CFFFBFBE82C9417F1179C4248411441E7F503EAFB2DB3FF98096BFC05F933D7DC2823F4DAC3F40F67B53BDE10BFC3D7446D044EE471445E4B8E7BFA420F4BED736B83FF0FDDCBEEEA90DBF5D145FBF3F6CFD3F7A9B83BEF935CAC0EDD150C004D7CFBF16EEFDBE9FEA4D40988D1DC0D97B0E419BD726BDBEDEEAC01AAC49BEFDD19F3FCF0288BE7235EC3F3EF5EB40A38098BF33818C3E1E0F46C06BA117C05EFEE140F0E29E40B06EC0BF6A5EF3BDE50297408B3E4A417FA3173F622CF83E808E2C3F10BF493F24CA2AC12568EE4080BE6DC1D9A58B3FB55C51BF1152E9C01F5183428090F0C1A13EAAC4F35883441B63E0410BA6B4416F70D7C3B08F8043EAEF91BF56FCA5BFF447D13F002530BF657CC63DC93EE3BFA3F053BF0E978D3E5BE892C0BF6127C11D24C74013D11BC054592C3E3D9D133E8DF4A940E079C0BE41B64AC075B28FC0D9F0C240947644C06429E83E645D823E296B92C13DE25DC006AA9D3FE8C490BEAF2EE0C0A32A30401E6837C092E390C10111C23FC1A91F3EA380C24281C21D42A5AA84BF1A354A3F3F3910C04ACE11407F89814108C8C3C1DCF045418F46A1C12A118EC0C123A2402EA8D53E6E009BBFDF2D0141BF1584C2FCBF8BBCBC37E2BECF4E42C3FEED2743945C953F7FBF3A3E784A8540973E89BF487C5E40489DAA40D8E91340290E32BF732C15C01032B34054BE3F3FC816AF3D09341ABF5ADE77BD8B1971C15AEAE640A71C0A3FA22B813E211484BFA7DD123FF1D08F3FC653843E853E92BFB14FE8BD50D0AE412EA8D140A5C9D7410EE98DC3235BE4BD227622C1C4AD0EC1EC02FCBE74A5403FEF18764027E4EC40B82DCAC0F58BF6C15DEDADC11BCA343FFC7A26C02B0509C1FC0F13C1D1026540CC7998BF59ED683F15EBDFBF1BA721C253A661BFB4DBEA402FB84241981F21C09BF0BC3F96BC8A4091D8DCBF4B0FFFBFFB0B88BF281B2A3F6C029BBE"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
