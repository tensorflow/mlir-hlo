// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.minimum %0#0, %0#1 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD6F0FA3FC1E34FC0CA80F03F6ABBC1BFA8A80B405C60043F18E1F0BF843778400ACA994005C1CBBE34E648C0AD31864064362840513B86C086B4263FFE33CA3FAD1913C0965928C0DDCB09C051B75DC04136D23F7E28DD3F8C8C5C3EC6F8B4C012FF4F40A8DF3D3FFD278F4056BEA5BFDB0722C0C0CE2EC02C8E883FB7754FC058E005C00975A540471976405FBFB83F58C5514010FD13C0B1DD8040B12B793F36C213C05FBBBFBF426D60C00F8E1140C7308D4073D8AEBF55E793C06A18D3BFFA379B404DFB0B401254B1BFBDC1853EAC9C27C0AF76A7C0AD84734061A41DBF46677D3F99A396401CCCC1408CB34F40047669C09D7CC0BF8CDC18C06F168E3E0C1AA0BF601CDEC0B8FE2F40E1338E403C06483FB205AD3FC0FECE3E2C00D6C0A16D1E40EE3AA8400B1D39404AAFE33D0F3EAC404E8A0CBE63E32A413BF583BF0759174084BE04404F22E1BFD80FC33F795C2140058588BFA32D8C40A5C62DC04F4357BECECC9CC01A20F53F968F1A40094830C0E8CE40C02E14863E6F7AD83F05B0D93F1912D3BF7DB5483F99C7ED3FFA09873D8B0F9BC00D1AC3C04882C8BF886C74C00C6823BE94B096C03AD4CF401C0D23402F2725BFCA2C1D3F434964BFD02F3540E61D02C16C1D47BC64FA204037A823C0B6D536409EC8174073E13EC0A059453E3B258ABF4D03993F036D8BC091CF8740B4ED3640655A073C6DFDEEBD991CD1C0612500C0CA8AEEBFDFA8A0BF7986FBBE4233ECBE084FFD3F17CF09C056F2F5C030F434BE044718C0B65E97BECF08CFBE22AED33FC4DB4EBF0BE4E63F2A96B1402A364540DAF6B7BF99D80FC005086BC09BC52740EF3DB0C0C6975040929D82BEFC5A23402CED8ABE4BE55B3F5912D3406AB347BFDD75C83FF33F2040B0D4793F4BB0FAC03C71F1BEBAC4BF3FB4FB5F4076DE8240F37C6DC0D25E22BDDFC72D40B3C2F0BEF08904C07CFBAD3F7A0F293FA45C3840BD7A99409270AFC006F68F40759C7FBD9F532CC0573B54C0F55B753FC2B020C08663A93FC343E6BD5583B440F0A7EDBFF3BC38C08CEB86BCF1665AC0D570CBBDAAB445406D01103E95F68440CF3DE4BF780BC1C030BB29BF43C4FA3F6AFEB73E43B42740C09FAE3E482B3840B376F4C06C15143DA35DA7C0FEBFF23EC86188BF959FC1C0E514393F73B863C014D092C0E72E08402EB99ABFDE7B8E4070F095BF9797C3C0A0F11B40274D7D3FF32ABC3FB05FECBF6FBC384056101A3FD1A9ADC0DE1485C024F140C079056D40EF4D86C08D321BC03FD2B5C0B2CD52C019D4943F394F3BC0EC2A44C093C809401030C7C0199D3DC0EDF927C0D3EA3340D64AAD3ECE1D9ABF9FDBF9BE84B428C0D086D6C0B1FF17408AE283BFB7F883BE381BE93F5A92BA4006D720C0BE2082BE0984CD3E834CFC3F020D8ABEB4B736C0321F0A40029B843F2C7806C0A7D78FBF74D7DE3F5817E73FAB4EBFC0928263C0B517ED3E874D29C0A2706DC06B2DDD40022103404549ECBEFF1179BE1250D240A5D1B13FFFB786BFB915F93E83765E3CDC6213C0302D113E11AE0BC073F245C00E1FD3BF5D5379C0122218409D8153BF5B1444406B014AC0685CF5BFA4CF04C0CB97B34048FAB040CA71C53FB73128C0149B8140FECEFFBF20EA914027E9023E8F0827BE68FEEB3EE4D897BF49EFF9BF01BA4040807855BF2BDB113E2EBDB63F31884FC0A18D6E4096C2E3C0D578FF3D805825BF3F04E73E9044B83F01109040F5FA0FBE0B76A9BE232B0C3F6F630B407D8C83BFC57B98C09B5DD2BF095170BE6FD01540ED161E3F34D3FEBEEEDDEFBE0489124078FDF0401BECBF3F6211114099BF03C057C67540B34816C0C1DABBC0C999D03FF7AFD5C0D1E791BF70430FC113A8CA4043BCF93E24B87AC02DCD9840BA84BDBD3C02A43F73BF5CC040159E40B809534097AF2840E66509C0EDC74440DC9C2ABF456F0040A4C75B40B96F89BF0C8BABC0ECAA58C02117D6409819CFC01FD100C0AB419A3F32AD09C012A8893D4963D140F57DE4BFC4BA8740164557C0A459FDBFE19737BEDF691F3FA11B2B4064D0D53FDFF6EB3FE76936C0ED2D9F3F7C2AD03F746A0CC0F22C8C40A27621C0E969733FEEEAB53F42DDA740161C80BF7EE48340C3F4D53F38D300C081E168401C22873E2FC42CBE84FC87C0C984FA3FB937493F6EB501C04EC2344096D433401DA6C9C079C1D6C0EAF160C085563740104021C0D03CAA40E67257BDD10E1A40F5FCA3BF3F4867406EFB34C0"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<"0x36EDD5C0E977D4C0EFDC4EBFD34CF03FED2F3BC0C71A833F1696CD3FE43184BEACE26BC04E2FAFBFFD2307C0A72D74C0E45690409F8AF4BF040CA3C06AD21F4025506FC0B6092D404798A2BF8321A8BF10ED303EC719F13FEDD9E43ED8D1BCBF62B16E40612D85403C57603FF47923407C3586C085E771C0B1B011BFD65AB1BFCABA70BF16413140E73B3E3FA638E13F9DEBB9405DEA12406A61824034EA7C3F0BF9A9C0975785C01E067AC0564F0840D09C763E1B50D0BF2E041FBB6B573FC04E6C9BBEFCF175C0843935BF2AB461C014660D4009BA83BFA1F086BE49F4B4C01C6E0740085124C07C060B40F1942EC05A672840F6C2DB3F25C7F2BE83425B3FFCD89BC066B5F93F8D43A3BF9E65DA3FFF24203E23BBD540D9B2C0BF6E62F2BF6D1F22BF9E454C3E607DA4BFC6481540EE27534069D85D3FA32B48BE40AF13C0F5EA4C3EFB882340823EFEBFA0E967C0D444C73F2342004062B53C40A6F93AC049BFC9BFDF065BBF2E3B9BBFBB3360C08B242A408138B3407D8A0DC08571A5BE12013D3F80F5594076389140CEA15ABF585CAB3FCF769AC058CEC7BFF1BB67C0CF208240DBB5C4BEA6D8AF3F22AEF73F1240BCBFEBD9ED3F41D65AC0E4FA9EC06A210440BE6EB7BF13ABC6C0FA64FCBF341D22C067D6FCBFD1B536C0BD8C6D3F428D193F425702C0FA8D74C022365AC01956BFBF0546C33F140F99BF1206D9BEDE4C8E3FBEDDF0BE462000409DD203407A5A7AC03FF456404A3C7C4026C204C0FEFB3C401284AD406B0539C00914CCBFF6DC963FA52E28C0152462BF6CDCBDC02F862BC0188BFDC04CD071400B60A6BE71AAB1BDC78FCF3DA6BE3540669811BE51B866C0139635C0B129383F56F2B640393885BFF11C4D3FACBD4A3CFF398C407857043EBE0D47C06D6E53C0A9BE5340D39D033FCE225340AF7D5C3F76A467C0BCE9224000AE60402E2C9D40157BEEBF17DF09C125C67ABE8BB898BFF62E6540D945293E855DD6BD8E1D3840D2AD683FE576803F01DF2B40EA7C9FBF442982C07E1B6A3F74C23340813C91BC4D743F40B8807CBBF65BFBBF57265F3F5E8A0BBF279CCEC0911D6EC0D07F9A40D8C2AFC0A5E2D2BD7B98863F7C030D3FBC2D1DBF23E29540CCE1BA3E7DCD43C0D7A6BFBF417ACA3EBE1D82BD56525CBF90E85D40A339A8403D925CC0B8331D406B1226C0E232F6C065D781BEDBB2D240B6CFF0BEE4FA1940FDBB6CBDD1FF9EBF7D0E63405DCF5B402B0907BE41C20DC019283C3F4A23A8C075A3E9C07FA422BF31C1F1BE647A853FDFF384BB3E964A40D39E3AC0EAD2B23F3AE881C0CE53A0BF90E5F7BF87F159C04F803E3E296F7240A4D4F7BF8C38B84090F4B4BF275ECABF1F6D4740D6026C3DD8C287BD608A5740914F6ABDC41146C086B72E40649392C03519E13FF4C153BF7EDB843F862104408C5E18405BD59240E40AD4BF68D301406C234F3FA659E7BFBAE179C0CD83843F5764154069389A40861550409546E4BE9B7C8FC0A230BCC06230824075EF99409CC36240F292953FDE35BABFC35B21BFF522B43F82B96C3F39802EBEC2B0314046AA61407EF3A93FD9151AC0698BCF3F8FBA4740098D86BFC19452C0BEEA32C019E2C03DD581124091E630BD05F375C0798FB3BE7F7914C009AD41BF821FE8BFBB9EFFBF137DCFC0013B73BDF84B7FBFD6AD5AC0BD5A47C0B08CF5BF5FF998BF1A5239C0E72248BC0C948ABF52177BC0EB7EC43E1C6A86C067038D3F0CBD5F3F272DA43EC0618E4018111A408F581B4077C149BF2FDDFE3FF0CD3F3FF59CB13FE55CC7409C6E6EC096FD9B4056B49ABFCC2AEF3F75AE96BF4D7098BFF3551EBF2B696EC071353CC0E09BDE3F361DBEBF89959BBFF2849240C7C6F2C052329D4087AD3BC0E43BAC3F756A97C0861C8BC0576C57BF534DFEBF6DFF7940E9244A3F5518A0407341FE3F78692B3D1889DABF2480C6BEBCA8B1BE75056A40D71B7B404FAC1BBFBDE9564089059AC07B4A72BFC97A9B3F206B91BEB9C9D1BF450418BEEED250BFEB596EC02560BB3FA45C8640DCDD71C0F1E8D7403C55C1BF04868EBED5623240DA2886BFC268F13F0398103F366F49C01B638FBDBB87B0BF520763C09CDFBEC07DBD92C00624FA3DA09DA93E45081EC0A34DD3BF361FECBE395CC63F4308BF3F6476D4C02A2CBA3F37823A401D1815404E893BC05851044103DF373F7C040740A79E8ABDDE7EB2BF85DC7B3E7CE420C059268CC0EBDD903F0B402FBF920729BF"> : tensor<20x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x36EDD5C0E977D4C0EFDC4EBF6ABBC1BFED2F3BC05C60043F18E1F0BFE43184BEACE26BC04E2FAFBF34E648C0A72D74C064362840513B86C0040CA3C0FE33CA3F25506FC0965928C0DDCB09C051B75DC010ED303E7E28DD3F8C8C5C3EC6F8B4C012FF4F40A8DF3D3F3C57603F56BEA5BF7C3586C085E771C0B1B011BFB7754FC058E005C016413140E73B3E3F5FBFB83F58C5514010FD13C0B1DD8040B12B793F0BF9A9C0975785C01E067AC0564F0840D09C763E1B50D0BF55E793C06B573FC04E6C9BBEFCF175C01254B1BF2AB461C0AC9C27C0AF76A7C0A1F086BE49F4B4C046677D3F085124C07C060B40F1942EC0047669C09D7CC0BF8CDC18C06F168E3EFCD89BC0601CDEC08D43A3BF9E65DA3FFF24203EB205AD3FD9B2C0BF2C00D6C06D1F22BF9E454C3E607DA4BF4AAFE33DEE2753404E8A0CBEA32B48BE40AF13C0F5EA4C3E84BE0440823EFEBFA0E967C0D444C73F058588BF62B53C40A6F93AC049BFC9BFCECC9CC02E3B9BBFBB3360C0094830C0E8CE40C07D8A0DC08571A5BE12013D3F1912D3BF7DB5483FCEA15ABFFA09873D8B0F9BC00D1AC3C0F1BB67C0886C74C0DBB5C4BE94B096C022AEF73F1240BCBF2F2725BF41D65AC0E4FA9EC06A210440E61D02C113ABC6C0FA64FCBF37A823C067D6FCBFD1B536C073E13EC0A059453E425702C0FA8D74C0036D8BC01956BFBF0546C33F140F99BF1206D9BE991CD1C0612500C0CA8AEEBFDFA8A0BF7A5A7AC04233ECBE084FFD3F17CF09C056F2F5C030F434BE6B0539C00914CCBFCF08CFBEA52E28C0152462BF6CDCBDC02F862BC0188BFDC0DAF6B7BF99D80FC005086BC0C78FCF3DEF3DB0C0669811BE51B866C0139635C02CED8ABE4BE55B3F393885BF6AB347BFACBD4A3CF33F20407857043E4BB0FAC06D6E53C0BAC4BF3FD39D033FCE225340F37C6DC076A467C0BCE92240B3C2F0BEF08904C0157BEEBF17DF09C125C67ABE8BB898BF9270AFC0D945293E855DD6BD9F532CC0573B54C0F55B753FC2B020C0EA7C9FBF442982C07E1B6A3FF0A7EDBFF3BC38C08CEB86BCF1665AC0F65BFBBF57265F3F5E8A0BBF279CCEC0911D6EC0780BC1C0D8C2AFC0A5E2D2BD6AFEB73E7C030D3FBC2D1DBF482B3840B376F4C07DCD43C0A35DA7C0417ACA3EC86188BF959FC1C0E514393F73B863C014D092C0E72E08406B1226C0E232F6C070F095BF9797C3C0B6CFF0BE274D7D3FFDBB6CBDB05FECBF6FBC384056101A3FD1A9ADC0DE1485C024F140C04A23A8C075A3E9C08D321BC03FD2B5C0B2CD52C0DFF384BB394F3BC0EC2A44C0EAD2B23F1030C7C0199D3DC0EDF927C087F159C04F803E3ECE1D9ABFA4D4F7BF84B428C0D086D6C0275ECABF8AE283BFB7F883BED8C287BD608A574006D720C0C41146C00984CD3E649392C0020D8ABEB4B736C07EDB843F029B843F2C7806C0A7D78FBFE40AD4BF5817E73FAB4EBFC0928263C0BAE179C0874D29C0A2706DC069389A40022103404549ECBE9B7C8FC0A230BCC0A5D1B13FFFB786BFB915F93E83765E3CDC6213C0C35B21BF11AE0BC073F245C00E1FD3BF5D5379C0122218409D8153BFD9151AC06B014AC0685CF5BFA4CF04C0C19452C0BEEA32C019E2C03DB73128C091E630BD05F375C0798FB3BE7F7914C009AD41BF821FE8BFBB9EFFBF137DCFC0013B73BDF84B7FBFD6AD5AC0BD5A47C031884FC05FF998BF96C2E3C0E72248BC0C948ABF52177BC0EB7EC43E1C6A86C0F5FA0FBE0B76A9BE272DA43E6F630B407D8C83BFC57B98C09B5DD2BF095170BEF0CD3F3FED161E3F34D3FEBE9C6E6EC00489124056B49ABF1BECBF3F75AE96BF99BF03C0F3551EBF2B696EC0C1DABBC0C999D03FF7AFD5C089959BBF70430FC1C7C6F2C043BCF93E24B87AC0E43BAC3F756A97C0861C8BC073BF5CC0534DFEBFB8095340E9244A3FE66509C07341FE3FDC9C2ABF1889DABF2480C6BEB96F89BF0C8BABC0ECAA58C04FAC1BBF9819CFC089059AC07B4A72BF32AD09C0206B91BEB9C9D1BFF57DE4BFEED250BFEB596EC0A459FDBFE19737BEDCDD71C0A11B2B403C55C1BF04868EBEE76936C0DA2886BF7C2AD03F746A0CC0366F49C0A27621C0BB87B0BF520763C09CDFBEC07DBD92C00624FA3DA09DA93E45081EC0A34DD3BF361FECBE2FC42CBE84FC87C06476D4C0B937493F6EB501C01D1815404E893BC01DA6C9C079C1D6C0EAF160C0A79E8ABD104021C085DC7B3E7CE420C059268CC0F5FCA3BF0B402FBF6EFB34C0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
