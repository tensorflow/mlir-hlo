// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.atanh %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x7128E53E5B82573F3BE6923FE3B7C9BF3015C74009E000C04F07923F1A13AEBE7CF40A40D6EFA0BF758A6640D54BE1C02D6F494035533D40191FE23F6709C340F7FA04C031FCF63C896591BF239FFF3E8EF0BEC0B7F916BEB3B011C0A0F0D1BBC48B2FC032FE4E40AE5F7AC07616A9C06CCCCDBFAA2DE440A0150340AA6E0140FB09523F1AF6F740DDD4E2BEEF481540616550C00E3BF53FD24A6340EB1A88BF9DF053BF4F630B401C6161BD579888BF9D2ADBC0096A2FC036A547BFB76310C088C1A3C00C2D1E4082F20A40C4279E40C57B6BBFC454BEBFFD8D1D3FBF5D9EC0D175033FAE025DC00225BD3FA396B23EC90072C08B9246BFAF6A6040E56047C079034B40370B8FC010334CC074A016407CB53740BC8F0CC142A5FDBF4B73F33E1CAF74403CAB2BBFD14A6CBFBA42FBBE6E4D733D309AB3BF4257EDBF424F33C052B657C069ED64401DE15CC0657D54C0BC794AC0DD8ED3BF3C307FC067C9C03FB1A568BFB510473F1467EEBFEFF8E93F1F9809BF8338B33F40206840369FB8402498E3400942BABF0B4C47BE14EC64C0D196A6BDA77A8DC04132163F85D9584010F2824079EC32C08BAF06C0F85611407D6DB0C0BF3B18C008BE4CBFD70DCCBF4BF010BF1C20F4BF68D20140CB1B2440FC05043FC9731A40DFC2763D179E68BD83743C40969C26BDE26D5F409E0230C083CC0A3F2AB393C002ED0A4085CD40C008D5C2BF2C72BC3F3E09F2BFA7FB5CBE9D5A06C0CC76AA3F0268BA3F6AD8BDBF9FC8E43F9A2E823E7F83F2BF99A2F24031D89140E9A1F4BF87E3B93D97EA3FBFD7ABBE3FCCD7974015970F3E6D8C13C0ACB662C0B8D801407E39154011DA78C061B32F3F4664D13F9E0F0E407ECE694039A77B4080988DC004545DC0EB3C3A4098D495C0F92300C0FC93BFBE913160C02CACC9BFBCE160405D640BBEED2343C0F967DF3E4B6714400D6BD1C0CFA7114015538A3F6E00E73D9FB3B73F55493F3FE7314B4040D8FEBEF97B7CC0C638AD3FEB113D40A390954019E70340C585F7BF17F0B34052FA6EC0F4E300C01D507A400D3E4AC065C901C0BECF00409971CEBF67C67BC02C3BC13F1C1897C0F4589D40C568F43F01A86440D1C11140B0126ABF4467794020B3B4BFC0E59040D7D1B4BEDA7787BF958FCAC0DC2D76C00C0F91C054966D3FCE5819C07FCABFC0BE22C5C005B9EDBF858111BF4DE2B33FBCF2F53E77D9413D8E2750C0055F36409EB88040743530C0EFB8473FC2E99EBF4AD8963F990B254030BEBBBFE5C743403E14D0BD1C07D1BE95560EBF03714E40DCCA2BBFF3BE88BFB0B7F040DBAAC63FFE4F8BC0099788C0A7D7F43F17DAA73F01E17CBE8279D93F9B33A2C084A42540F661CDBFB0B3804018A45340C7E6B5C0323269401350AB3F09407FC0BD4987C067CE62C0864C7D3E0AED93405F8700C0CA828340EB0A933F10219CBFD79AA44007BF79BE965F3BC0FAA64D3F291532BF73E1943F9E1B9BC058CE203A2AADB03E16D2C23FA4ED88BF84F5B640417C564044ED0EC03A3566C09BEE82BF9D3EC3BF0CBEC5BF842BAABE702103BF0EB98340298622BFB7A3DE3F98CD73C0E7980FC00FB505BF8642AAC0EFA8B6BFB52A963F0376D5BFE3509A408D6539BF1529863DEE169DBFD4B44BBEF0EBC8BF83EB814022F053409B407AC02D7CAFBEA90FB3BF2F8706C0211641C0A774944036B7BA40D41402C027E61A40D586A3404F0B863FC8E3D0BFB95EDFBD1F45DBBFF8E03AC0A547BA3F45B027C0A41210C0CC1A0DC009D2E23FB265E83EF8AFBEC0185EF2BFDB65A0BF62D5033F895611C0AA1F56C0F36EFF3E06F28C4060349D3FCAB65FC0B52186C004AECBC092FD3D3FB3A65AC094DB02C09BDDB63EFAA31EC05DAD7840E53E88BE6C0B38401D48E4BD11792EBF3F2123C01BED64C029FE4840FA0CEABF40525F407CEB3B4094DC254086B757C0C4F0FB3FF24C19C09BE53A3F6453BA40A119813EB7ECD5C01E4A72BE05C1CF40C50A03C0EEEA22BFF7865BC051AB92BF16F6ACC0C72486C0E847713F9FF34640A68280C0249BD6BF123CCFC077916140A2BD1140419305C050A25440A2D3E9BFA34C78C0950D963F126FE63C8D0AE1BF7E18074047D1ED3F672E7FC019262ABF18BEB6403BCDEA3FA2584040EDE9E63FE60D02C05C8543BE2D9CDD3FC3BE79BE08D569BF3BA8A0BA197EAF3F8F8B893FD7DDA6C0DBA3653E00430DC104660A40CA32B23F80DF8F3F1EFF9F3EBEC5B2C00CD16440"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x7B9CF63E7D1C9D3F0000C07F0000C07F0000C07F0000C07F0000C07F0E4AB5BE0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F5C0FF73C0000C07FC95E0C3F0000C07F7A1518BE0000C07F5CF1D1BB0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F2441943F0000C07F96B5F3BE0000C07F0000C07F0000C07F0000C07F0000C07FDF3797BF0000C07F729B61BD0000C07F0000C07F0000C07F61C385BF0000C07F0000C07F0000C07F0000C07F0000C07FD246CBBF0000C07F84B7373F0000C07F4947113F0000C07F0000C07F1C69BA3E0000C07FC26784BF0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F3C63043F0000C07F12D24FBFB5F4CDBF667B09BFD796733D0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F859EC2BFB806853F0000C07F0000C07F05C119BF0000C07F0000C07F0000C07F0000C07F0000C07F4BDF49BE0000C07F40F5A6BD0000C07F30312C3F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FD38A8CBF0000C07F1F5124BF0000C07F0000C07F0000C07F640B123F0000C07F760F773D3CDE68BD0000C07F22B426BD0000C07F0000C07F3E741B3F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F3E8360BE0000C07F0000C07F0000C07F0000C07F0000C07FFE19853E0000C07F0000C07F0000C07F0000C07FDC66BA3DACE278BF0000C07F0000C07FE68A103E0000C07F0000C07F0000C07F0000C07F0000C07FD84A573F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FB25AC9BE0000C07F0000C07F0000C07F42430CBE0000C07F8A76EF3E0000C07F0000C07F0000C07F0000C07F26FDE73D0000C07F0974773F0000C07F75DA0BBF0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F64D6C6BF0000C07F0000C07F0000C07F91F4BCBE0000C07F0000C07F0000C07F0000C07F5279D23F0000C07F0000C07F0000C07F0000C07F422725BF0000C07F9A01063F91FE413D0000C07F0000C07F0000C07F0000C07F90DC853F0000C07F0000C07F0000C07F0000C07F0000C07FAECCD0BD1BF6DDBE808520BF0000C07F920B50BF0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FAE1B81BE0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FF054813E0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FFCE17EBE0000C07F9ED08D3FDFD95BBF0000C07F0000C07F5ACE203AA83CB83E0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F1AE3B0BECAD410BF0000C07F3AE03FBF0000C07F0000C07F0000C07F665914BF0000C07F0000C07F0000C07F0000C07F0000C07F629B6ABF565A863D0000C07F8D754EBE0000C07F0000C07F0000C07F0000C07FC2E2B6BE0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F1943E0BD0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F2CADFA3E0000C07F0000C07F0000C07F36C9113F0000C07F0000C07FB33E0C3F0000C07F0000C07F0000C07F0000C07F0000C07F3C8B743F0000C07F0000C07FF04BBF3E0000C07F0000C07F069B8BBE0000C07FF83BE5BD48FC54BF0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F57CA6D3F0000C07F0CF2833E0000C07F22F876BE0000C07F0000C07F508940BF0000C07F0000C07F0000C07F0000C07FD047E13F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07F0000C07FA37EE63C0000C07F0000C07F0000C07F0000C07F03144DBF0000C07F0000C07F0000C07F0000C07F0000C07F4CF345BE0000C07FB4E17EBE5C1BC6BF40A8A0BA0000C07F0000C07F0000C07F389C693E0000C07F0000C07F0000C07F0000C07F6188A53E0000C07F0000C07F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
