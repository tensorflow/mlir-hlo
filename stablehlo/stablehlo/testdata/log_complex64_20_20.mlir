// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = stablehlo.log %0 : tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x63551C40308954BFEA59B53D3809B0BF3E988740D19D62C0590FA240D685D7BE3D8E86C0792E203F1A6915BD00999540EC1C65C093C6EB3E17E1B73EF8F58AC0C81B2C40D115E440CEE610BE89ADBF400A8E2440C77331BF999A273FF9765540538E054035388DBD0C64E7C0EA9A113F72DCAD3FD14BBE3F56913740FE0126C0AF38A8BFDFD863409856CDC0A14890BE1A93393FDD67B33E010C9EBFB47A48C094AC98C09A619AC00DEFD3BF2E00813D01DBD0BD0F2B1EBC0F830AC07F22903FFD04AFBFB11C1BC1537554408617163FF0FEC23E01BBB0C023D09E3FDF287C40A1A4C5BF66FAA24035C905BE054981C0BA7F3F3E597051BF12FE2E3F753FCCBF65F31840D1A9D2BEC64A17BF981732405FAA3C40A23D6E3F29D6AEC0D50105C07FAD95C08EE96EC0AB75BCC0F66ACD40E54DD2BE9D6E3BC09C20203F1A2361C0303C9AC07EF76C40E31D66C0DE0F5040789FA63EA9D4ECBF9D0F05BF5D292EC0E8EF31BF9D4A67407048673EBB85ACBF57AEE5BF58C1FF3F5166A9C0F43CBB4077248EBFA44658BF5238D6BF903F42C0ADAD123E7DD4B43F716CAABFF4B9A43E035E25BE53A3A340CD7B92C0FDEB9F405A09453FAAA71640E4804EBFE16EA1BF8C0DE3BFF9210640B3A55A400F2946C01D4A9EBF916AE5BF3AAEEA3C93F6DF40359F25C0A3FB363E659332C011D54740AC6482404695863F9DA32DBDCE5DBABD882E213FB7B0A8BE6807EF3F0C14DDBE1DC6C1BF2FB715C0501600409481063C884193BEFEBA8CC0D7BA48407BE21BC0F5C402404DC0B6C0D741C640CFDBE2BE640868BFDCA30140629A0F40B6E15BBDE8CFCFBEEC861DC05B8B853FC7AD59BB81693640F2C492C071E6343E5EC33C3E46BA3B40DF8003C069DBA7BFE9E3AFBFB3C55B4066E910C0A36920BF5ABC9FC0620767BF84BF4D4016095340980D763F7DE5BC3FE336E23FC2A4D73FDEBC67C0950FAA3F822D6E403B7EEDBEFD8B82C0FE399E3F251A0AC07224D1BF82254840443021BF46F14E40664CADC02C5B8EBE44EA043F68A4A540CA7BDBBFD21BB43F281784BC07B957C0599583BF4646A13E0E42533E603E70BFB48D9740C5D06D40471B02409057793FF55A133F2023F93E26222BC01AD6D6BD9D8F03BFC73C7EC01EFEC0BE4A2502BF247A1940BD801840C0B28C40799364BF63A254C0F678DEBF4189094095BA85C07CE48140115E17BFBE81A5BF25FAA9BE57D677C0966B67C0BB62ADBF945AFA3EB749C43C1E31433FD07E1040C649C7BF93B0D7C002500740661E18402003B7BFF011394063631FC163FAD9C06947B0BFD2FD853F86BD80C0CC2127C0CB32A33F0D8329C01054EF3C530D1B405A006C40C1F6EAC016CFA0C0E5501B4050F1B1400C75804025D64940B57C77BF762D64C04B0EA640D020FD3F5C488AC023E17BC0730EB73F64676DC0B3E3553FE79F6740AF264CC0210F6340B2DD6D3C93A607C003BD273F99AC29409A983DC07794C83F1900563F91BCD7C020A507BE69F3A840E99300C012FEB13F52B22040BAB1E43FEBFA27BF80FA0D4017029040FDD3FA3FB8DF1C40488129BFB40FC0BF138F364057FC5B40D5A66D3F049DD7BF36D7453F0A1D9B408F83D33D74FA09BF24E80DC0FB324BBE2989343EE66A6F3FD7D93EC073C1273F658098C0B6073BC01AC8DB3F6E22A5C0A05BF5BF3BAF40C0E62F1ABF918DB13EE9101240C54CFE3FCB815A3F9DABE7C0B6BAA5BFFBF70B3F5BEA84C00D46264004B6183F99BFE23F6B533DBFFA239EC04BD7C5BDBDBDB0BF4CFA99C003B0F43F4447A6C08A311A3D9E3528C0F2D69FC088BE563D771484C0F259AB403D60F33F71C3274025C518C04860ACBF4B27EDBF50022EC081CD08C1D6AC494088BCC1C0F97AA93F7FD49C40C2DFB83FF1A9724044D63C40D3CE4140641D323F11D0764090AAAEC08B6F80C0814EDE3FB47477403B380A40ABB0A03EF9850C4005291F4051259CC0267A73C0922C60C001CB92C0AD313EC00B778BBF7BD241404EFD81C07E020FC0FB470EC0FE93BDBF3F0F3240409088BF4A80FFBE4323B7BE42F9A9BF9100D23F2103513FB1278CC0E7A79DC0A6CB38402CE9BC3F5B2EE2BFD237723E53F28F3F1C3547C0A4465A4034E0413FF21F1F40AAED5240F9A1C23EA89083BFF1BBE3BF23751E4069D51B40A6CCB43FFB693C40538E94C006E9B3BFDB4554BE3D0C69BFDEE8B6C097931FC0CCD99CBF4194D4C02EFA22BDEA4B893DF65C58BFE296B03FD0289DBF5F4D07C0C572DFBE90E79ABFC9E720C010DDD9C07325DBBF7B605E3F9F2906BFA165B0BF772594BF3ACD53C0B2D1F23F6125BD3FC6909040E052F53C37BB38C06837E8BF3DDDA2BD884A10BFAA4F1A3F27778BBF39EC5B40D532BB40D55D15C0B7CC0EC05BC8A3408FFF35BD29E8D6BFB96D4D40F8A1E740C611244004645D40ACB505409B5396C03AF1343F3BFB32C00C6172C0DCBA163E406E54C0104269BFF157554040FE2B3F2B0D3D401D933E40659911C08A577C400A387ABF6F940840FCD9DFBF31DA453EC4F878C04C207E3F351423408D810C41F7C9053E4F033B404F33AEC0EF808FBFC85407C03397543F48FDE73F9ADFEEBE54EABCBFB17B9940D9A854404CAA3CBFC59CC3BFEB41584051F27240BE01873FC3C198C05C8DCFBF761FE13F912BC7BE7343403F889B22C0BC0ACABFF51AAF3FF8A59D4052C07F3FFEF09AC074E0B1402E74744096BB85BFD4996D40C042A4BFE0F6274062A2783FFE97C2C0622E61C0DF9392BF41573C40E967ADBFC3BBEABF7043C4BF8580194086608BBFD30BD73F6FA2CEC03263583F14FC25409348353FC01EDDBFA760DABFDD56AF3E47CB9DC03289E53D292CC53F80C40BBF49ACD93FEF609ABFE1C87A406A8CA940ECD435C0E63E54C0FCAF2440821719C095619B3FB628B540CFB25E40D66A6DBFC25C56C0AE41EBC033875A40DE8E9CC0210986C0446A72C04BD285BFE43E23BF2DE8163EEFA71A401A7CEEBF31FB83403FB81C402FC5A73FF4438ABEA2DA244049048CC0B64973C022849FC00C91B63FBBEE8FC0EBC87EBF73B24AC01A19C3405EB6773E2BBFF7BF9E85E1BF88AF503E8D9B26405A218E3F95AB583EF10602BF55701B4073F1053F32DBDDC0E919C440F68A703F19B5B33E9A686AC074D63A40271377BEF7E5704019721AC04A4C103FEE98D6BF81C4BCBF5C99A63F73F91D3FEE00B3C01B7AF83FE2AC07C0FC1518C0A6071C3FA44101414C3BD13FF2753740457C1D3F5F2FD43FDEDA1EC0F5B8FD3FE61EF5BE45597DC067D6B7C051493BC0726D04BF4449E7BE2C816D40B0153EC0ACFAEFBE36A377C0E14AF0BE324A9D3F5C204840DF057FBF1928B640CDB69E3ED25205C0C04A39C0EF2F97BF340A5D4046078C3FE9D50FBFDCD0213FAF8411BF7A281E40D67FFE3E7CE609C1C8E797BF9855C4BFD8255940C966053D849521C0FFED2ABF81E5B13F603544409614B5BE2B01D73F8EE2C2BF2A985EBFF2E913400A524E4069AAB1C02CF76BC0C6C893BE73AE583F02737EC0F35BFFBF742494C03EA758C088632AC0655429BE2DFA893F7D52F3BF33AA50C0F4E42BBF34C029C0BD1841C0E393923F4FB626C01E5E5FC0CF6244C02D7429BFF8B971C06C6194BF1B9A5540457B1DC079D41C40BD2F16BFD3ABACBFBE522CC04D39D1C0998605C0295B85C030B4B9BF257E3ABF3FE3BEC021589CC03F029DBF717F9E3F2B911FBFFEEF75BFD9F7153FC0038FC0A912123F050CCEBFE65F8C3F8BEA3340A9D096C0115DECBFF8B9BABFB362CEBE6673773FBD5842408A4DA33F8AE40240E4E101BFF04638BF092BB7C083F384C0CC7AB8BFA9CBA8B902B7B7BF0D9E9340CCE59F40EADB8BC04A3BC3401232D8BD0C986940813ED7BF1810ADBD3C8A2F3FDF7E80C07AC58F3F949468C026BE5140EA0242400D25D9BE150F8A3FC823ECC01FE153C114D74E40F2E50B3F08072740BBF3B3BF3129B840C5D15940BED68F3FA30CC5BED2172DC0876D05C11B252140D9DB273F196CB8C0BDE4B23E3CAD38407FAC29BF7AC0A9BE524188C09EDC02408F5AC3BEEADAB7BE12E5B34022D3AF3E65EE4FC0F03FDF3E40C021C0137FE6BF46D05D40D63A8F3FCAA785C0FEED743FF12893C01F21F5C06A6329C0DAA4B43F3D54C340948416409DDDB3C0206AC2BEABEFA63F335992BF9B5C9ABFD4AC7B40A0E2DD3F09E023BFF011D7C0432D4F403B656340E0640E40EC930BC0EF011DC05994A23E929D20BF090566C0F9427CC0F5EC2DC08CEECB3F854ECC40CE8E9E3F4E8981C05D45E93DFB38824072108D3FF4DC0AC0B8F13BBE882A14404BE4F23EEE4100BE86488A40AED20D40508391408E342EBFB46754404E8ACF3F9232D940809107C0A96D58C0F8CCDF40FF965540776F413F8D5FA3BEA1B5FF3FEC880F4012C6A4C04CD137BFFB6C733FA25FA9BFC7E50340DD91A53F055B7D3FA2D02ABF32296740DF5305BF8730EB3F321D59409FA3B5BF6600A7BE30975F3F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDCA0723FBDBEA7BE5336A43EEDD4C0BF31B8DA3F733332BF0C16D03F13D6A9BD9B3DB93F939B3F403F68C53F870FCA3FF84AA43FCFDF40400C66BC3F0080BEBF24F40140ECE19A3F7F2AE53FD115CC3FACBC7A3FAFD386BE5F9B9C3F9340B03F7E763C3FAB4B07BD5BA0FD3FC70944402933333F9A9B543F781FAD3F9A363CBFAEB5AA3FC953F63FC110EE3FCA4046C05EEE5DBED088E63EA3659B3F571FF9BF0216F53FCE7016C08045013FDDA0464034D311C07E0543C00251643F945B2A409702124042FFDABF588C9B3F9001333EA20ADB3FC33FC0BFEF8FB53F2803A23F10FFD53FA7BDEE3F99CAB23F2233CDBF7D7C33BE134CACBF31320D3F974195BF49C6623F20962EBE2ED2853F33D9E33FC275903F89909C3ED301E23FADCC31C05A03E53F02F41DC0BB890A40EC0A14407AC98A3FE7E5DABF72FEA23F9C89B2BFC9FEE63F8E231F402B0ACA3FD9031A40AC6B213FB4C6B2BF216F823F2138E1BF4CC7A63F1862E13F88EB9F3E52CFB3BF02E67C3FB45C1340C8330440139913402F8FAA3E5D701FC05A1A9F3F34C804C03F87B33EBE20BC3F6C17A13E40E339401CF3D03F551ACD3F8DEFF43FCAFD1340302A683FDA9CA03F6E9BCE3ED7F208C03249813FCF7B1140C8A1C33F3A7D3CBFB637473F362F0BC0780EF93FBB89C83F1905743F4FA64440C84EB73F8234134032F1B73FEF4A813EED1D13C0B06E00C0F9E9AEBEC2D6F6BE848D263F80AF68BE382B833F474A09C0409F313FF569863BF2DABD3FC56BD1BF8184B03F940929BF1BBCE63F23159DBFD2C6E93F863792BDB4104C3F89EAFE3FFAF64E3F09F4C3BC5A046A3F2AFBDDBF7CB42D3D08A450BBE3DBD73F0EE481BFBEBFAEBFA4814E3F344BA33F926E1CBF533E243F134D15C0E304B53F443B15BF0FCCCE3FCF0BD9BF3A549A3F9E17EC3FF4F09D3F4837913ED07E553FAB03603FFE3DB13FEC5191BFFAE2AF3FAE2B9D3F21CAB43FAE8DD7BF0638693F1F7986BF6863A13F3C580340E898983FC8ADE13F6E65D83F6DC745C0B015D33F1644BC3FB5F24B3F23151D4022899B3F9BACC9BF3070943D6E083640D98823BD055DADBF40C4E53F7A4F2A3F4013503FA0C2E43EFDC190BEDDA8333F00FD7B3F6F8D46C0A39FB13F9487D9BF813AEABE035D0DC0A8E99B3F313F483F9F23C03F2D284DBE8F2BA93F0B372AC0F110C63F03448CBF0AABB43FCA1E14BEFBEA933E2AFA38C04E6CD53FE8FC18C026BEBA3E16E4324050998ABE710AC53FF622813FE48C1ABF603EFA3FDF9B3540FC95823F48A30ABF88B5154053E6A4BFF826F83F794B3CC06060B63FAB7AA8BFE08C883F6CFE2B40AD5E793F245B4840B7FFBD3F15517D3FDFE30B4089A622C052C5E63FA963943F9CAAD03F0B792A3F7242A73F77F4EABF2571DB3F146BBA3E3FFEE13FB3C819C05FA9B03FF9F599BF10F6A73F5A05AC3F9401C83F506613402F50403F682FC8BF1998803F6C0CAA3F8ACC9A3F32EC2940E33DF53F7345B9BF1004D53FD145CC3F66B3643F435022408B0F903FBE521E3FE2B6563F6FDFED3F21A4CB3FBD44D23EC5886E3F0B1587BE62CD953FE4850340788BA23F8E0E873E89F11D3F81882D402111CA3FF283AE3CA132533F8795E7BFEAC5A9BF68921A40B2DB913F8B29A2BF1C10C93F3A92B7BFCD3E9C3F59102740BE52DA3FC94C32C0DA968F3FEB6C3CC0A62A563FB0C2B53FDC6B453F90C2CF3EB166FF3F5DBC3DC0595EB73F284FB8BF22FE7A3FDB1C673ED0F2263FDE7CCABE4589CC3FA1CF47C05C29CE3FDFD4ECBFF90EDB3F70F09BBFE967773F8C3AC7BF02E3CD3FE46348409EA0F43F208F0E40CA67963F3679713F430D813F1E3028C08270983F32D00AC0A16A0D4096763240DF7CE93F39483B40DFC6D03F1DBC923E77E6C83FB04A293F441D913FF141673E1A26F33FFBA874BF8BDDBC3FC6EC2E40CE7ABE3F9E67023F31EE4B3F8BE3B63F49AAD93FFDBA8CBFAB51D23FC86F19C09B68D93F884524C01E9F953F8344F53FAB56C43F3EE028C0F0897B3F357323C035C18B3F2C7CBBBE5EC0F9BEAC4221C0D73C3F3F431410406F3EBF3FD578B1BF0904DF3F702227402F7B553F76FC5FBF10650E3E9186AE3F79D1C33F13E01340E285743F6037A33FD280993FD72EEB3D8D5B383F080F06C0D2589F3FBAEC463FED77973F09CD8F3F3F1FCA3F183F36C0FB9B8CBD7AB8E5BF0049EA3F93BC2EC0FC84F43F1A69E0BF264D23C0E8CF06400057F63E4EB5074016DA643F8C3406C03FFA803E135DF5BFDDB3FD3F6D57F6BF5AF9263F20032B40A9C7C63EA493F7BF3592A03F1920F4BF629D603F4F6A293FC306C13F9635D93B5DFD9C3F4D2625C0D04010BFC600DBBF478E603EB26188BF2C13F53F8A14853FFC07963F153C18C0F700D13F7D3B0EBC00C1A43FE85F0340C47602409A45AE3EAAC1B23F1C170B3F4975C73F1C813F40004DC63F1D3D0DC006B1993FA663C3BFDFB99E3FF836EB3F8EDE8D3FB16FAC3FE817A93FCA0327BF9B6BB33F7CD478BE6EE8813F47BF2FBF430AAE3FB1B5C2BFA2C4803FF482993FB50E0B4055BE733CAC18E93F40018ABF84695F3F4CBB03C04EA0303F4611923F1DB0DF3E7E40F0BF0BC6E13FD0191B3FA655073FEE4901C0BA17D03F8BEC573FFD20CB3F3C3AADBFF6485F3FE93214406E7F2BBE101E03405A3E8C3FF27B25C0DDDDD03F5664A63F6290CC3F6E04AFBF0751F43FA61F1A3FDDC6AC3F072DEC3F4339893F30A30140C4ACE83F2FCAB4BF7E78A73F93EC34C0F475963F38E4DCBE51185F3F6F7E1CC094F1773FAA32DABE87F0F23F4A7BA8BF4472803FFFBBA03F92D41F3F234497BF69CF0D3F3C623C409A43CC3F879B4740A480FB3E2C65AEBEEB143C3F70EC1DBFA659F13F0A1B6F3F01AEBC3FEADD11C025D7A03F89B93FBF67C8E03F5606AE3FF1FFA33F225C85BE2BB6054003C8FFBFEA9EE43F042376BFF096DD3FA2021AC0A27B4F3E6B0226C06259623FF943C13F6040C13F505FFF3FC2C1823FB49FFB3EE09E733FB96ED63FDFEBE03F6D481BC00FA8D23FF73937406985C33F09203BC00FAFF63F983103405B0A2B3F8D25B9BF42B2123F22B14140BC29853F156DCE3E87F018BF938996BF1DF9683FF446593ED4650E4038BC1A40D6AA463B9409B73EFAA4C53F50FE1D40E6ECA93F7E41D13F3753683F61603A4004A44D3F9FE31AC0C5D9BA3E0BADE23EBBA6E33F32AF33401A43943F8C2613C01BE40540516CBF3F4DD1983FF6B9863FA4E7113FBA939B3F5DF0933FEAEE1D40DE0AB13FAC77D8BF738CEE3FF7E82AC0D062C0BEBE1E1BC05C87C73F75C92CBF7E20AE3FF07DD8BF325C8C3E93C2F73F731D983F29E89DBE5CCCDE3F88D55E3DA4C5A23FDF720CC0D6BAA53FA13DF33F49D5533EEBECF2BE284F26BED07F3BBFD9AE6C3F24424B3E0F740A40F54D40C04047A83F7168FF3F1E1D6D3F2D69C7BFCEB2DD3EAC3101406D3E903FDA38EBBD5F88513F93813CBF7668673F2C1FF73F0102EE3FC6B985BFE267A73FD00F44C03C81B33F6836AEBFBE0DCF3FBB24FDBFDDE6BA3F14691EC0C589B13DB38BDC3F2101AA3F625006C03ED5803F9ACCE8BFE3F6953F92D831409F54BC3FCA900DC0A36C923FEA763BC018DDAF3FD60036C0300DB63F20A322BFDC946C3F5FA070BE901D8D3F8E4102C0268CF63F174B35C0A303BE3F029F33C0878CE53FD59DD8BF29F6CE3FBE5139C09B3CA73E70C4EEBE649CF13D4A04264087ADC03F51EF404042AD2A3F70C92240D8EBD93F583884BFC6165B3F52451EC0F43F3D3D54A2FB3FAD94983FB8A4CB3E92CF3E3F5DFF78BE6152E03F2213D9BF6293BD3F29B133C07B03B93E3417C9BFA060F53F9147533FF6FE0040BD500C4078C6A53F52C3CC3F8160053F38D945C0A7C7B33FB369B3BF2001AB3F26B1A2BF7780BF3FAE173F3F0113173E0A04F93F41FE2D406F1105C0CEF4973F87862B3EF6178B3F1BFDFCBE1D34F33F22B8083FC53F303ED6F0A8BE4CF10A406F34F1BF6ECB743F946F823E006DE03FC42F45405FEF8A3F5F3167BE1AD5B93F3102D3BFC67C3B3FB1E83CBE2245DD3F193AD13F5D89973F2095BBBF731C713FA331B3BF9964AE3FDA3203407D6ABB3F738EA7BF2103C63F72CEAEBF78EA05406EC533C0DFE0EA3F90FAAB3F5A50E73F7C5696BFC2CE9C3EA553ED3F9A05023F651715C032A1BA3FEB93D43E7972F43F7637D5BF52F5C83FBEF6543F9275913F548146BF28DD673FE6D2404055ABA53F012FDFBFD973C83F226E22C0E429F13F8BC2A93FA7B3B83F040DA3BF05B3B33FEF7AC53F40AD633FF2E78CBF94B3573F4230D33FAE4636BFD62984BE3A47CA3F5E9AF23EF446C33F411C18BED23FA73FECACE83ECF13FB3F36E29ABE57340340065B014034769D3FEFFF633E2E61343FE555DD3F68E3DC3F9F7B94BF8872333EB0EC0D40CD4E653F880F0940A0BDF93E5631273F7F87A63FCC71E03FD5A1253F746AEC3F53ADA63FC4D8CABE2D868FBD9DCFF63F"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
