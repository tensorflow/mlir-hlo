// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.atan2 %0#0, %0#1 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}, tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xBFC0D03F17BF5C40FA3EE83E8640E7BFDDBF453F0C408AC019C0733F944045C0913D3440983F7BBE64C0A83FF8BF87C0AAC04FBF4940E5BFF0BF43BE0F40823F9CC00CC0DFBF204021401340D93F95C0EA3C1DC0C5BFBEBE6A3F6D404BC0AC4037BF7F400ABDBBC05EC0C23F254082BE05C186BF44BFDCBF03C0FFBF2540C83F7B40D3BE33C00CC06E408F3E19BF32BF1D40BDBF72C098C03F40D64054C0843F41406F3F68C01CC0FA3F2CC06BBFACBF46BEC93F28409DBFAA3FA44028BED03E6D3E5240E7BF943F8BBF9BC0E5BD35C03E3FB5BF20BFDCBDA63FEBBE7CBF0B3F39C077BF4540D4BEAABF04C0A5C091C08F40A73FA2C0083FF63FA4BFD0BE08BFAC3F9C400FC010C02DC026C0DD40413FC6BF15BF8A406740DFBF0640A33F9BBF843F493FD63EA340DBBF13C0863F3F402EC0224074BF4D3F62406640EEBF7240AD40973F3BC0AABFA5C086C011BF9940A0BE27C0F93F38C00CBF57C0F73F514006C01DC0204028BFB3BF13404CBD75C06F40293FD140553FABC0653F0EC180C0D43F2B40ABBF4640D93F9CBDB0BF0840783ECB3F4EC0B03F9E3EA43F6ABE44408DBE0CC03CBF494090C0E5BF473F2C400CBEC63FCF40C2BE3240983E3FBF0AC0913E5FC0A3C085C050BF893F543F3DBF0741EC3E9EBFAD3FE53F4DC046BF9DBF9ABF143FB93ECBBF71C00E3F08406CC0C7BFFEBF44400240ACC0494014C0B8BF3FC04640ECBF06419C3FDF401F40193FA940A6BF104042C051C03440F2BFEEC0213FAC3F17C02ABF0FC0E8BE3BC01A405BC0433FC2BF87C09BBFADBD923FBE3E5B400040CFBF3AC06B3F00BD0B3FB8BF4D402A401740AC3F1A3FD6BF4B3EAF40813F4FC022C038BD58409DC02440A5C0A940683FA13FC1BF5A400B40A3BE39BFE43F04C0B1409D402FC0933E93408440094192BE7EC03AC0053F18C193C0D1409B4080BFB2BF303FBEBDF2BDF83E5A40A03DCBC0C6C0C1C039400C40B9BEA1C087BFC2BFCAC0BC3E17C0F13F7EBCD93FAA3CAEC000C094401240383E804040C0D1BF393F46BFEABFB33F7AC00E4173C032404DC040C028BF914048C01E40ADBF75C02AC0A940DF3E5F3F1340AC40E6409B3F5C40CCBE8640B7BEFE3F86C02FC0"> : tensor<20x20xbf16>
    %cst_0 = stablehlo.constant dense<"0x993F08C029C008C0254091C0FDBF9BC00CC0C43F9BBFA040C0BFE740D7BF89BF2440BEC01DC0A0C0A0BFAC3FCCBFA9BEDFBE7EBF0B403FC053C02EC0563FB53E4DC0DABF57BFC2BFB2BF7FC088C0E03FBCBF7EBF8BC0EB3FE03F2040CE3FB7BE883FBEBF403FBB3F68BE81404A3F57C076402EBC2CC0D13F27BF92C0E33FAFC0B8BFC6BE1940523F253BFFBF873E453F1640B33F1AC02DC010C07FC00BC1963FB0BD0B4072C09CBF8ABFFB3F8D409B407C40B63FD040AA3FDEBF144013BF573F903FEAC0F5BE28C09D3FA1C0B23E5BC052C00C3F573F2DC014C042C035C0494054C035404340044033C03BBF5E400A40FE3F1A40CEBCDCC0A5402D3F64C042C0204023C0673F8B3F05BE77C08BBFB13F7DC08D3FC03F10C004401340653F5DBFA13F87BF6BC0A3C032C0D43EC94083BFC23F6DC00C405FC0823FB93F5B40553FBC409EC03B40AFBF1DC024402740183F3B3F6E3F86C06340AEC086401B40CDBF713FA7404B40983FE9BF2C403640ABBF4FC016BE48403E408E3FC1C0D1BE0D3F663F45C0C33FE23E5A409E40EEBFB440B0C0CFBF1B4082C09BBFD8C0B7BE67C0DE3FB83F37405E40814031C0E63F00401F3FBB4078C095BFABBF1240943F83C0003FDB4068C012C00D401E40A03F613F89C0A43F70BF2FC0B6BE7FBFFB3E12C1404045BF8E4060C08940BC40273F55401A407B3F1FC035403E408EBF83BE38406440E2C0843F0BC004C07D3F994044406F3FB2C07C3D5B3FBE3F92C074C01041EE3FC73FEA3FC83F02419B3F11401BC0B8C029C06A409EBF723FEEC042C022C09B3F483F6CC0E93FD3BF054036404240F33F95BE644004C0E03FCEC045C0A03F5CBF9C4053C096C0934018BE573F1740BD3F48BF19C0E5406CBFB23EB6401240BBC01A4034405E40803E3240973E3B40923F8AC039C002400640E13F7FBFF3BFC0C0EBBE914040BF13C0563FA240B43FACC0EEBE313FA23FB2C0B2BF53C0BC3F2B3E554024C09EBFDEBF06408BBF1DC0CE40733E9BBF22C05DC078BFFEBF2DBE904062C022C01FC0A83FD33F8B3FDEBE14C050C043BED1BE813F0FC0974068BFAE3FC0BF38C09EBEAE3FE6BFA4BF383F903F9BBF9A3FBF3FCB3F114070BEA1C0"> : tensor<20x20xbf16>
    return %cst, %cst_0 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB0BF1F403BC00840403E4340014032C01EC0EE3E054036BF08C0063EF63FF4BFE23C2D402C4046C0F4BF463F11C0D3BFD4BF1DC0773F26C028C045C09B3F9E3F0AC00FC001C007400540284031409BBF4840FABF33C04CBEF63E7A3F8DBFD23F18BFF73F38BDAABFD1BFB83EA33F44C092BFCABF37C050BFF1BF2FC0783F3740F63F15C05DBF9BBFC93F404094BF3CBF4F3F50BF09C006C00E40074032C0393FCD3FD03E18C002C0054071BF52BE8BBE49BD563FC53E3FBF1F40933F37C0E73E503E2E40EABF2F403ABF18C09FBE1DC03B409ABF24BF47C028403FC034C02F3E1BC0A8BE4A3F4BBE2DC0F5BF7BBF90BF943FFE3ECABF4440B73E8BBF42C03EC0FD3E034098BF90BFCFBF23C0DD3F003F31C0F9BE9E3F084034BF3D3F753F0CC0303F20404240174026C0B2BF293EF33F88BF2340D2BE3B40A53F983FFFBEAD3F3E3F3A4049BF18C001C083BF5BBEB93FCFBE9DBF2D402EBF43C02DBF2C3F024093BFE1BE2B3F01BF1FC0353F8FBCF4BF1240E53F903F8C3EAFBF4040CFBFB8BF893F1B4038BFB73FEC3E7DBC20C0B93E464017406DBF344039403D4025C01C4021BE7DBF81BE3C3F57BF24C0D13E6E3F5EBE843E074035C00140053E13BF2AC0043FF1BE0CC005C0B5BED13E163F33BF0340B13E0EC02C40E23FF0BF81BF41C0C3BE2040A63D2EC039BFC13DA33F56BF13BF8EBF10401F3F88BFF53FD7BFEDBE33BF2F4088BFEA3F2740B73FF53E453EB33F3AC0C63FA6BF92BF26402CC031BFA73E363F69BFCEBE89BEB7BE69BF174027C03740C9BEEDBF68BF48C0324040409E3F993F2FC081BF294076BC413EE3BE853FD73F163F2440AA3E39C04540AC3F124016BF1FC048C0223FCDBFA13F92BFA63F12402A4055BEEB3FB53F65BD9DBE364035BF8D3F753FBDBFD33DC13F743FB83F45C00DC076BF793EB2BFE4BFED3F1E4000C098BE1A4046C010BEC33D973F4840D2BFBBBFAFBF2A40094042C0A5BFB5BFDBBEFABF37400DC03B3F48C02240533BC3BF07C0054024403D400240D0BFB2BE3C4036C020C0513F96BFB93FD8BF114017C0D1BF08C0AD3F0CC0F73E0AC09DBF05C004400C40123F0F40E73FBC3F523FF43FA4BE9D3F63BE383FD0BF29C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
