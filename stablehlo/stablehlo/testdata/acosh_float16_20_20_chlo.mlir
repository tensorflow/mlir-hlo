// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.acosh %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x19C88BBBFF35E7C287209E481130093D7FBACBC23332E5400540A0C51E3F71B7153BE5375A40E8AC9FB68036FC3B073B5A42FBBF0B35DFC52BC1F93D523600386C42A6B3D2BDC2405DC1AF39F03AE4C174B914C16D41223F45355FC0B9BE57421D44E1C3083C4F3B56A89BBE96C27CB94EBCF040A7A9FAC3CDB100B062B8ADC1C14121BB57409BC3423E59C337441CC348C52D3DC73F18C31FC67833873E6B40E8C21FC2163D003E87362EC30AC1C5B3833E51B0C2418936C2B721400DC839C0F03CB3B7B8C4EC408D41DEBC13448EA0383FB444BBB98AC0B24332B8A24242C421C631BD27353DC2AAC5ABC467416ABF3D381B4488B8E1BCF6C475C56EBCCAC08A3940C27D440645A03E563A98474CC5D43C3E44EEB8633A124607BF7CB853B642C18D445641103671B411B0614140B776C8FFC20EBFB9BF4637DF3FEAC477BE65B981B8604913B2D3C3D3BEDD4278B24642383CB0B769BDE3C3CB3E30C4094033C1A0B1C236D03F28459241F5BD9E44F54104BC78BC56BC99C06CBC6C3DD7391239F3C472C450BFABC5CB4032C078C2DD446BBCF8394036B3C3E7BCE3BACBC1B63C703EE1428E43F74375C0D6B9953893AFAAB24A454FC13C4111378542C5431F437D42E93F0B3A4BC4A5BC2F409F42ADC1FBC59F38BC3D20386246B9C05F40C1C2DEBC18C53DBA1139964461C0E8BDA43885C2EEBE6341FE3AE8BAD53F05B41E3CA7BDC94450404237E8BC613C753E6B455DBD41415CBCB9C020BD9FBFE33E44C14E419ABF813E4EB9D4B614384EC202B40DC43DB7D53DCABC334013C19B42C7BDB1423924DF3776B6CDC495C5514775416D43C1BCB1C28EB4C3C42FC449BEA1B400C0BE4524C0D7C3AB41B237CB3DA2BEF0BF17423DBE4D429440AAA9714253411DB29EC00D40FB4480C4A8C4FDC0733815B476B90648C5BD11BDA3C5922368AC98C6D5BB66BEBC3D6BBCD4C1503F51C177B6362E433E86C624C48D24F0B8AD4043C6AF419FBE39424A3CED3EC94061C3CCC5AC408AC21FBD733C83B7A7C30DC24DBA0840EA363735EDB894B5AC42E9331445D2C7E53B5C42BFC583AD7FBEBF4217BE1E3D6440BCC0AAC6C7B89D418BB59640D442F8C496455237903A303B"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x00FE00FE00FE00FE00FED44100FEA33900FE00FE00FE2C3E4B3D00FEB83C00FE00FE00FEA73D00FE00FE00FE00FE00FE4A3F00FE00FE00FE00FEA63B00FE00FE563F00FE00FE0C3E00FE00FE00FE00FE00FE00FE9F3EB93C00FE00FE00FE483F304000FEFF2F00FE00FE00FE00FE00FE00FE363E00FE00FE00FE00FE00FE00FEDF3E00FEA43D00FE133C00FE3C4000FE00FEFC39233D00FE00FE00FE4A3CB93D00FE00FEC539B23B00FE00FE00FE00FE473C00FEE03E00FE00FE693D00FE00FE613900FE00FE333EB83E00FE2A4000FEC93C764000FE00FE0C4000FE7A3F00FE00FE00FE00FE00FE00FE00FE9A3E00FE00FE2F4000FE00FE00FE00FE00FE00FE00FE00FE5D4098405D3C00FE6F4100FE10393F4000FE00FEFB4000FE00FE00FE00FE65408C3E00FE00FE00FE963E00FE00FE00FE00FE00FE00FE323D00FE00FE00FE00FE224200FE00FE00FE9E3F00FE3D3F453500FE00FE00FE7D3C00FE4F3D00FE00FE00FE283DA640BC3E00FE6C40053F00FE00FE00FE00FE00FE8E3A00FE00FE00FE00FE00FE00FE143E00FE00FE874000FE00FE00FE00FE00FE00FE00FEB438383CA03F02401E4000FE00FE00FE00FE00FEB34000FE773E00FE663F1140C63F623F373D00FE00FE00FE7A3D783F00FE00FE00FE343B00FE154100FEAD3D00FE00FE00FE00FE00FE694000FE00FE00FE00FE00FE973E00FE00FE2C3D00FEBA3300FE7F409C3D00FE00FEE9363B3CBF4000FE7B3E00FE00FE00FE00FE8F3C00FE853E00FE443C00FE00FE00FE00FE00FE00FE00FE653B00FE7D3D00FE753F00FE823F00FE00FE00FE00FE00FE5C41A53EF23F00FE00FE00FE00FE00FE00FE00FE00FEDE4000FE00FECF3E00FE513B00FE00FE1D3F00FE423FE23D00FE5A3F8A3E00FE00FE543D944000FE00FE00FE00FE00FE00FE8D4100FE00FE00FE00FE00FE00FE00FE00FE343B00FE00FED93C00FE00FE00FE133C00FE00FE00FE00FEF93D00FED23E00FE353F0B36953C123E00FE00FEF93D00FE00FE843700FE00FE00FE00FE4E3D00FE00FE00FE00FE7F3F00FE9E4000FE00FE4C3F00FE00FE00FE8B3F00FEDA39B13D00FE00FE00FEC43E00FEE33D993F00FECF4000FE00FE00FE"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
