// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.log %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x82C079401440F23F9240A8BF00402240E43E8B40B23F90400240A7BF29C0D9BEA0BF85C07140FC3FACBFAABF0BC0E8C0B4C03340CF40BC4015C073BF87BEA4C099C02140883FF3BF7F3FCE3FDF409EBF5340BAC0B5BE9540843F47C002C005C0D03FAF3F79C0A740E0BF61401D4091BF124057C03F4070BF4340D6C023C028C0753F43C064C09CC08D3E6040C63F37BF2BC0D4BF493E92C024408ABFB0BE78C03CC08640B5BF6FC0E240B83D72C091C0863DB0BF2C3FC4BF0C4071C02DC04CC03740C340723F71C02540A2C02BBF93BFB9C070C0AFC0D43FE2BE293F21C0B1BE21C0A13FD83F6FBEB8409F40FC3F6A407E40993FB9BF47C0D03EB44041C0C04095C007C0863F674091BF0F408A400B3E573F47BF37403C409DBFBCBEED3EE8C09DBF50C0AF3D19405CC052C0E1BE9FBF80C081409940DF3F7640963F58409BC08A3FA9BFADBF943F01C02140EC3FD5BF09BF9FBF293F3CC07CC017C0A3BD6D4092BF40406B400A4061BF79C0DDBE3640774024C0A9BF39C0D5BF29C0B93E6FC091BE2940FC3E2F3FE83F213F913F733F6A40163FCAC0E0BE013F01C07DBF973FB5BE99C03DC0884001BE35C03740983ED9BFC23D4BC05CBDE13F3E3FB5BF194017C0FFBF22C058BF384005407C3F74408CBFC9BE2DC0544003C0EF3C964006BF35C0BF3F1440B7C0FF3F4040D2BE99403AC0233DD63F4AC0A53DACBF9CC093BF4EC098C0B43FA3C00B40F1BF2640BD3F9DC025404FC003C0053FA6BF7AC0BABF9240A43F87BF3DC0B03F8C4075BEA93F193F13408B4095403DC0243FC33F34BE213E65409D3F2E4014407D3F5EBF5F40BBBEA04046C05DBF963F97402640F2BF37400440D9C0C6C06840A4C00D4073C0B5BFB9BF683F2D408B40B03E7C3FDF4094407EBEDD3F21BFC4BF363F82405B3F804009C0AFC08EC04D40A04031407CC0104008C0D53F5BBE104006C0893F10408BC028C0B7C0AF40CBBF80BF33C017408A40AABFF1BF323E38BF253F043FD7BEB1BF2CC00E402EC068C095C049C08F401E40D2C09540254065C005415AC0923ED73FCF3D953E11405BC06840003D4D40BC3FDE4025C0983F883FBDBD444008C104C0113F9740A6C087C047C072BF2340"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFFFFAE3F573F233FC23FFFFF313F6E3F4FBFBC3FA93EC13F353FFFFFFFFFFFFFFFFFFFFFAA3F2D3FFFFFFFFFFFFFFFFFFFFF843FEF3FE33FFFFFFFFFFFFFFFFFFFFF6C3F783DFFFF80BBF43EF93FFFFF993FFFFFFFFFC53FFC3CFFFFFFFFFFFFF93EA03EFFFFD33FFFFFA13F663FFFFF533FFFFF8C3FFFFF8F3FFFFFFFFFFFFF34BDFFFFFFFFFFFFA5BFA03FDF3EFFFFFFFFFFFFD0BFFFFF713FFFFFFFFFFFFFFFFFB73FFFFFFFFFFA3F1AC0FFFFFFFF2FC0FFFFCCBEFFFF483FFFFFFFFFFFFF863FE73F66BDFFFF723FFFFFFFFFFFFFFFFFFFFFFFFF013FFFFFD5BEFFFFFFFFFFFF6B3E063FFFFFE03FCD3F2D3FA63FB03F373EFFFFFFFF67BFDD3FFFFFE53FFFFFFFFF3C3DA43FFFFF4E3FBB3F00C033BEFFFF863F8A3FFFFFFFFF45BFFFFFFFFFFFFF1DC05F3FFFFFFFFFFFFFFFFFFFFFB23FC83F0E3FAC3F223E9C3FFFFF9A3DFFFFFFFF153EFFFF6C3F1D3FFFFFFFFFFFFFD5BEFFFFFFFFFFFFFFFFA83FFFFF8D3FA63F453FFFFFFFFFFFFF863FAD3FFFFFFFFFFFFFFFFFFFFF82BFFFFFFFFF793F35BFC3BE183FEDBEFF3D55BDA63F09BFFFFFFFFF2FBFFFFFFFFF293EFFFFFFFFFFFFB93FFFFFFFFF863F9BBFFFFF17C0FFFFFFFF103F99BEFFFF5F3FFFFFFFFFFFFFFFFF873F3B3F81BCAB3FFFFFFFFFFFFF993FFFFF62C0C63FFFFFFFFFCD3E573FFFFF303F8D3FFFFFC83FFFFF4EC0043FFFFF21C0FFFFFFFFFFFFFFFFFFFFAF3EFFFF473FFFFF743FC83EFFFF723FFFFFFFFF28BFFFFFFFFFFFFFC23F7E3EFFFFFFFFA33EBD3FFFFF8E3E04BF553FBC3FC53FFFFFE4BED83EFFFFEDBFA33F513E803F573F41BCFFFFA03FFFFFCE3FFFFFFFFF223EC73F743FFFFF863F393FFFFFFFFFA53FFFFF4A3FFFFFFFFFFFFFCABD7F3FBC3F89BF81BCF93FC43FFFFF0C3FFFFFFFFFAFBEB33F20BEB13FFFFFFFFFFFFF953FCE3F823FFFFF503FFFFF023FFFFF503FFFFF8B3D503FFFFFFFFFFFFFD93FFFFFFFFFFFFF5C3FBB3FFFFFFFFFE0BFFFFFE1BE2ABFFFFFFFFFFFFF4C3FFFFFFFFFFFFFFFFFC03F673FFFFFC53F723FFFFF0840FFFFA1BF053F13C09EBF513FFFFFA53F5EC0953FC53EF83FFFFF303E783DFFFF8F3FFFFFFFFF12BFC73FFFFFFFFFFFFFFFFF6F3F"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
