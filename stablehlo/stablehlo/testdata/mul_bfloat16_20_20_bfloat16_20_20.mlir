// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xbf16>, tensor<20x20xbf16>)
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.multiply %0#0, %0#1 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}, tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x914017C09CBF144008C0F5C0AFC07640F13F5C40BCBEF93C1FC04440A23E6C40D7BF03BFA440683EDCC013400DC031BB33BF31BF30C0C23E26BF8DC04E3F39BF8440E2BEDB3F2B40CABF2AC068407DBF163E923F70BEBFBF74BE514020BF9540E63F5640624000C0B7BF2A40E8BF38C0F2C09FBD973FB73E11C00740C5C0663FAA3F324094C0763F3540ABBE4840D7C073C003C0FC3F8B3F993FAE3F06BD074097BFC43FAA3F3440063EDABF84BF8FC0FE3F1AC002BF2440C0BF9EBF7A3E2A3FC33F95BF05C06F4012C0983F32C0D83FA4BD97409EBF713F9BC04C3F9FBF8CBF613D10406BBF95408ABFB13F463FD13E7CBF5740FEBED0BFBF4017BF11C0C33F584083BFBDBF14C044C045C0EB3DDDC0983F6A40F4BF5940853F48C063407B409CBFE0BD5D3FA33E6C4030BF593F4B40A0C0C1BF01407F3E9A3C6C40F4BFD13E8CBE2DC0534032BFF33F6BC0E73FD9407BC040C0443F0EC05C404240343F194088BFA43FC6BF94BF50C044C00BC0A43E76C06340873E4E3FA23FCF40A5BF30C012C083C08C3E7440D43F9FBF4CBF2F400A406F4050BE333F36BF4A403BC0BF3F2AC06BBFF7BF0FBF8DBF64C03C407EBFD0BF8BBFFE3E2940D8BF54C08B409ABE8EBF53C0C53F29C0914040402AC063BE7CC083BF13BFA9401CBF10408EC00BBF153E6FC0C0BF9CC08ABFA7BF223F5EC01BC0D63FB33E8D407A3F8F3F563E913F4BC03F40ADC0D6C03FC08D3F1F404C3F903F4CC088C01A4000414B401BC014BE8840863F5F40B440953E544070BD21408140D0BF15C0174163C02740C7408FC0CCBEBB3CD73FBB3F4C40B63F41BF994069C0124124C044C0A9C03040134015408AC097C03AC0084037C0E7BD16C128C017C0E9BF6840F2BF1CC1DE3F2A4008C08BC0F8BFBDC0A740223FF6BFE73F98C026C09CC0123FDE3FD63FB740F23FFB3EACC0893E84BF6FC08DBF804073C0D8BF873FDDBFA23DC2BFAEC0B74087408EC0EEC0C93E23BFB73E04C0E63FC040EABFBDBF3F40ACBF8BC06B3F23402DBF27BE55BEF33E10C056C03B4096BFB83F1FC1B13FB5C01AC016C0C9BE7FBF61400640DEBF043F6840E5C09C40F5BFF7BF12C082BFBF3E5E3EEDBF42C052400A403440"> : tensor<20x20xbf16>
    %cst_0 = stablehlo.constant dense<"0x1CC022C085400CC075C09F40CD3F294023C08FBFDFBF3DC014BF6DC0944055BF09C00640AF3E4AC01B4051BF50C02D3F953F8140E0BE724011C07040C9C043BF3640084115C069400EC0B13F67C050408A4008C00C404940294048C0AE3E0CC06E3FEB3F0C407540E9BFD3BF8E4049C000C06E3FD9BF8ABF16BF733FFA3D3A3F5EBEE7C034BF95BF933E394071C00AC0883D99409140B43E55C0783F40BFAABF573ECEBFA13EAAC07340A1C01E40323F4840ACBF4C407A4014C0823D10BF61408EC04FC08E40964002BF453FF1408F40FA3F12400FC081C0943F8240874013BFC53EF2BF53BEA240D4BF4A4025C08AC01B4087BF87409640923F61BE134007400EC0D8BFBD3F833D4C407240293F26C0983F89BF93405C4040BFBB3F963F25BFCE3F36C00A4093BEE33C85C0F4BFE5BFFC3E563F2AC0933F1EC0494076402D3F44C06F3FB3BF2E3F8B4086407040883F39BF794037BF8CC0F73FE9BFDB4054C05D40D93F32C0773FB440CC405940CC3E74402FBF16C00440C44081C0A3C0CABDB240D240F9C083BF1AC07DBE0EC04AC0853F69BFABC05140F33E973D9DC005C0DD3F813F97BF5ABFEEBF57C0D4BFA9BFC8BFE2BF55C011C0D33EA64007408240AA407840C23FB1BF54C0C5BF7440703FA5401A40CEBF88C059BF833F86BEF33F0BC08540113F75402C405D3FCCBF05404DBE0E3F3A3D24C0A1C00A4083BED3BEDCBF57C002402C3EB23FBD3FA53EAEBF643F6CC0F9BF50C026BF78BE904020C063C02D40083E0ABFC63FBCC0E03F85C09ABE86C09940BCC01C406C40B6C08DC0D43FDFC099C033C036C032BF68C091C0C9BF8AC082403E40A5BF43BF3DC09BBF78C0593F1DC08EC00FC1A64067C03B403A40604036402FC0293F543F3A405E3F3E406840AC3E67406440CCBEEA3E8740473E20BE7BBFE93FD8BEA9405A4046C0B83C59C0AD409BC02A40E93FBFBF8DBFFD40ECBE94BFF44041C00A4084BFD33FE53F57BFEF3F3E40A4C01440FDBE2E40393FAFBE0AC08DBF3640B1C098403A403240933FD73F394038BEA33F514027BF943FEDBEB5BF52C01BBE69BF634015BF5740934097C0B7400141D13FAE4052C0DDBEDF3E6940A33F03BF4A3F0DC022C0"> : tensor<20x20xbf16>
    return %cst, %cst_0 : tensor<20x20xbf16>, tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x31C1BF40A2C0A2C0024118C20CC1224199C076C0243FB8BDB83F35C1BB3F44C0664089BFE03F37BF85C1F0BFE540EFBA50BF32C09A3FB73FBC3F84C1A2C00D3F3C4170C07FC01C4160406BC051C14EC0223F1BC003BF96C021BF23C15ABE23C1D63FC440F740F5C027408CC001C11041724194BD00C0C5BEAA3F004040BF273F93BEA1C150408FBF503F77BF3CC1684181BE1DC10F41C33E7FC0A93FC93C33C07EBE1EC0D63E6FC1FE3E094123C047C0C6404F40CFBF20415E40A0BD0DBE1540D8C0714014C18C41943F6A3FA8C1F14020BE2C41314073C0B3C04F40A8C0213FAD3C88C0423EBD41E53F8C40FFBFE1BF19C063C006C0F4C0DA40053EA7C04E40F0C0DD3F0CC017BE1CC13AC19B3D8F41B43F7AC00CC13A4148BF92C0854022C0FBBF9F3EEE3FBBBDD13D3740CFBFB6C01EC0A1BFABC0923E3EBD3941EAC08D3E563F22C094C0F2BE044176C1D940E74035403BC10CBF1B41D440B1C09A40FDC06BC00B408A408FBF92C19CC1ECC0033E6AC11BC01EBFD43FF840D1C1D2408B3E4BC1D7C108C07AC07FC09D3EE23F0AC10F405AC08B3F1240ADBE6E3E654146C093C06DBF1240F43E03403F419CC0A83F2240F53FD3BFBFC032BF89C113419CBFBDC04CC115406A4070C194C022C155BEA2C11EC06D3FB4C1043F1340953F84BFA2BE78C15ABF95C139C090BF81BFE7C0F83E6D3F823C35C19DC01A405BBDEFBEAE4020C130C190BF85C0D03F4D3F8BBF803F3C410441FAC0A6C045BF2EC1B93E71C13540ED3E42C0E63E9CC1D2BD27C19BBFDA4032C15EC20AC11A410DC29E4129BF23BE00C183C011C17DBF2F40ADC1B7401DC227C111C1DA4006C0D9C034C0864180C0E44017C1CC4116BF0742F5C0DBC0CCC02541A540CEC0B83FF740ECBF4EC1E1C0FEBF97411040443F533FA0C101BF433F0FBF4A4035BFF241CE40C2BFF7BD68BFB2C091413BC0E940B540EE3F05414C3FBBBD39C1834145418BC0EAC055C1A9BE98BF883F294185403EC09FC089BF83BF39409940274061C14DC0F3BE14BF0C3F72C01BC106BFBFBF9640CF40CD3F28405A40F640733D683F48419CBFBAC0184089C124C21D4248C028C1F040E03E263E4A3F17C0C73F264098C0E4C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
