// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFFFFFEFFFDFF01000400FDFF03000100FBFF0300FEFF0300F9FFFEFF0000FFFF0200FEFF0500020001000000FBFF0000000002000300FCFFFFFF0300040000000100FDFFFFFF0400FCFF0000010001000000040005000000FFFF01000500FDFF00000100FFFFFEFFFFFFFFFFFCFF000004000200FEFF0000FEFFFFFF0600FDFF02000000000000000100FCFF020002000200FBFF00000200030001000200FEFF0300FEFF00000000030008000200FCFFFEFF000006000000FFFF0400FFFFFDFF0000030009000600FEFF0400070000000000FDFFFAFFFEFF0000FDFFFCFF00000400FCFF0800000007000000010000000500FFFF0000FDFF0000020000000000FCFF00000100FDFF0000FEFF0000040001000000FFFF0000FFFF0A000100010002000000FFFF0000010001000000FDFF0000FEFFFFFFFCFFFEFF0100FEFF00000000FFFFFCFF04000000FFFF000003000000FCFF0100FFFF0300FFFFFDFF0400000003000300000000000100FDFF0000FBFFFEFFFEFF0100000001000300FFFF0100FDFFFFFF00000000FBFFFDFF020004000800000000000200FFFFFFFF00000000FBFF0200FEFF01000200000003000000010001000000020003000000FDFF0300FEFF0000020003000000FFFFFFFF0000040000000300FFFF00000000FFFF0100FEFF02000100000001000000FDFFFEFF0000FDFF00000000FFFFFCFFFCFFFEFF0000FFFF01000100FCFF010001000200FFFFFEFFFCFF000000000000FFFFFDFF030003000100FFFF030003000000FEFF040003000100FCFF03000000F9FF0000FFFF0000FDFF0400000001000100000002000000FBFF01000100000000000000FBFFFBFFFFFFFEFF00000500030001000000000002000200FFFF0500FFFFFFFF03000000000004000000FFFFFDFF0000FFFF030000000000FCFF0000FEFF0000FEFF020001000000FFFFFFFFFEFF02000000FDFF02000000FFFF000004000400FEFF020000000100FBFF0300FFFF0000FEFF030000000200FFFF000004000400FEFFFFFFFFFF0000FDFFFDFFFCFFFEFF02000000070002000400FEFF070001000000FEFF000001000100FEFFFDFF01000400FEFFFCFFFEFF000002000000"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x0200FDFF010002000300FDFF00000200FDFF0100FEFFFDFFFEFFFFFF020000000000FAFFFFFF0000FCFFFDFFFFFF01000000FFFF03000000FFFFFCFF0700020003000100000001000200FDFF030000000100FFFF0300000000000200000000000200020000000100FBFF0200FCFF0000FFFF01000000000000000000FBFF0100FEFF00000000FCFF0000000002000000FBFFFEFFFBFF00000300FDFF0100FEFF010000000300FFFF0000FDFF050000000100000001000200FFFFFCFFFFFF03000000000002000300FFFF0000FEFFFAFF0000FCFF0000FFFF00000100040000000100FAFF050000000000FEFF0000FFFF000004000000000000000000FEFF0000FFFFFFFF0100FDFF04000000FFFFFDFFFFFF060000000400FEFF0000FAFFFEFF01000000000001000000FBFF0000010002000200FDFF00000400FFFF0200FFFFFFFF030001000100F8FF00000700FDFF020001000300FBFFFFFF0000FFFF0100FEFFFCFF0000FDFFFDFF0000FCFF0400FCFF02000200FFFF00000300FFFFFEFF030000000300FDFF03000300FDFFFEFFFEFF0100F9FF00000000FEFF04000000FEFF0000FFFF02000100040000000300FEFF0000FBFF0100FAFF0300000001000000FCFFFCFF00000400000001000100000005000300FDFFFDFF000002000000FEFFFFFF060003000500FEFF0000FFFF010001000000FFFF0100FDFF0500FEFF00000100FEFFFEFFFEFF03000000FFFFFFFFFBFFFFFF0500FFFF050002000400FBFF0300FEFF010001000300FDFF0000FFFFFDFF01000000FEFFFBFF0200FDFF0500FEFFFFFF000005000100000002000300FFFF0100FEFF000000000000FDFF0000FDFFFAFFFDFF00000100FFFF0400FDFFFCFFFEFF01000000FFFF0000FCFF0000030000000300FEFF0000020000000500000004000300FEFFFCFFFEFF0000FFFF0000020003000100FFFF07000100050000000000FBFF01000000000000000000FEFF050001000000000003000200FFFFFFFFF6FF00000000FDFFFBFF040000000000FFFFFFFF06000100FFFFFCFF0200FCFF000006000200FEFF020001000000030003000300F7FF0400FFFFFAFFFCFF020004000B00FFFF00000200FEFF"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFDFF0100FCFFFFFF010000000300FFFFFEFF020000000600FBFFFFFFFEFFFFFF020004000600020005000300FCFFFFFF000003000000FCFF00000700FDFFFEFFFEFFFCFFFFFF0300FAFF0300FEFF0100FFFF050002000000FFFFFFFF0500FDFFFEFFFFFFFFFFFDFF0400FDFF0000000005000100FEFF0000FEFFFFFF0B00FCFF04000000000004000100FCFF000002000700FDFF0500020000000400010000000200FEFFFDFF010003000B00FDFFFCFFFDFF00000500FEFF000008000000FAFF0000030007000300FFFF04000900060000000100FAFFFFFF0000FCFFF8FF0000030002000300000007000200010001000500FBFF0000FDFF0000020002000000FDFF010000000000FCFFFEFF010007000200FAFFFFFFFCFF01000A000700030001000000FFFFFFFF010006000000FCFFFEFFFCFF0200FCFFFAFF0200FCFF01000100FCFFFBFF03000800FFFFF9FF0600FEFFFBFFFEFF04000400FFFFFEFF03000200070003000300030001000100FCFFFFFFFCFFFCFF02000000FEFF04000100FEFFFDFFFCFF0300FDFFF8FF00000400060007000700000002000100FBFF00000200FBFF0300FCFF0000FEFF00000000020001000600FFFF080000000000FCFF0300020004000200FFFF0000FEFFFEFF0000FFFFFDFF060002000000FEFFFFFF0300FFFFFCFFFEFFFBFF03000000FEFFFDFFFFFFFDFF0100FFFF0200F7FFFEFFFEFFFFFF010003000300F9FF0100020003000400FFFFF7FF0100FBFFFEFFFBFF0200000005000000FEFF000006000000FFFF070002000100FEFF0800FEFFFCFFFBFF01000100FDFFFFFFFFFF0100FFFFFDFF0300FFFFFDFF01000100000003000000FEFF01000200FEFFFFFF0600FFFF04000400020001000200000005000300FFFF00000000FDFF06000000FDFFFDFFFBFFFFFFFFFFFDFF020000000200FEFF0100FEFF0000FEFFFFFF0000F8FFFDFFFDFF0000FDFF0700FFFFFFFF0000040004000000FDFFFFFF0100FBFF0000FDFF0100FFFF0D00000002000200050000000400FEFF00000000FAFFFCFFFEFF0000FCFF06000000010000000600FCFF06000100FDFFFBFFFDFF0A00FDFFFFFF030005000200FAFFF1FFFFFF000000000200"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
