// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.tanh %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDCAAA4C0CA692340C018F1BF59C23BBDE8112FC0301268BFBDA70BBE8607C2BF383C8D3FA600F1BF4636EC40CA7F3F40A9DE29C0440A9340C79DAE3FAE752ABFF16AD83E45FF9FC00CBCCA405252CABF56B31EBFBED8EA3F81F0DAC0DC7E41C02423B5C06D6DED3F73A084C0217D9E406B4D1740A80415C0E660F43EA07C15405334AB3F7E73E33FDE807EC0281870C049209DC07FA7C73F46A622C08B76E340ED929840891BC0BE83ABF23FDA13C5C08C6AF73EB8328F40A1ED80C0CCF9F1BDDDBCF43F7E95A53FE1D70C41354C7E3FB0247840F1DF60C00F0CBF3FE677D43F31E79DC08DA6423FD2C895C0CB3A894018CE31BFF2B570C0C095AC4036367F3FA3C41A3FAEDC97401F5552C0A55CD13D29A7DF3D352291C08B038BC0743840C06188F7BF86DB0941262841BF589A4AC0AE283AC01120A9BF86AF71C05BB94AC022C3EA3FF9E5F3BFE9CBF33F9962993F1F6BFA3FD9FC71C059F7B4BF6C0B42407262D940C275243E6FAF7F405E0503401B8200C0989BC33F0170A0C01223BE3F9804A5BF2541283FE441713F22D398C05EE346C0FF3886BFF38E99C0658CB83EE17B35BD7AD087408F3C7CC024737640C9AC93BF63CE873F51BCA1BF4F2C7F3FDCB667C0E6841B401379724099394EBF774491C0330111BF53E0CDBFB74B87C0179EC5BED832293FFE13F9BFEDCD853FAABE3B3CABC78140ADD089C0400E23BF43B214C03248633FFBC703BF6E31963F2048B4BF4B523040DC916E3E78B432407F687840C5B60CC06BF12B40A57459C00CF962C089740AC0F21693400E7F5E3ACAF896BFB7E822BE2CBF30BE033615C04929F43FFCC505C0737B0040B6923140734A9B3F18BB2740243C6D40B5731B409C8A3ABFAD93233D91CB02BE8604413F09BD83BF6A0347BEE063ED3F1ABB88C064C3B5C097C647C041AF4D3F13B59EC0248E8240C44029BFEF78ABBF5F202C4085A6823F17F5A73FE80D3CC0D9AFBCBF181595C0D45A5E3F629860C03F5408C0365C0D4046CDCD3D499192C07B4AC4BE816E3FC0405122C097B14AC07F2C65C026D4EFBF5026B93E5F4B1840E1407DBE377E0A4003B2B4BFF0139C40E54F1B3F4C8FCDBFB6794A40A496A4C0C78DB2C08B789A3E267B92BF66085B3C46D5BEC04A41D23F265A42C089EEBB3EF2CCA2C030C6FC3FF2E6384022F41F403589A9BFB7CD8C3F7461C9BF7FFE36BFEF52BEC0BE4381C0EAA5FD3F4F95C64053DFE9BF5F85CCBF1A54CBBF6AD0CA3F57BB13C024374FBFE2D6B3C0BD71863D67B5A5BEEC5618BEB25583C0119AFB3ED43D6540C28F453ECBD68540685062BFB0AD9A401067F33FFAE100C04146F53EE1EDEBC011E767BFF3C9033F0E68D8BF65A1B9BF46C44F3F6CB85A3ECC206CBFCD6DADC09B3B9F404B8986C04AFD63C0A67891BF3B44584039EAE7BF6D2F8D4011AA89C0071134BFAADB46BE1E10413FFB4B8FC031AB473F3FC6A5C00D1B9CC06A34F83FB508FC3DB651273E7E3A953D21214DC03AA974BC798CC8BF69211B3DDDA3AFBF01B14A4059A5E540F72F763F583315C0B3D016C0011062409A79023F42969EC0719981C0CC36A340BC37BF3F0EB249406407A640CD07EDBFD34AA9C078CE32C01458893F12B33AC0698CBEBF6B0230BF1ED8774056F3A4C0A3056240DDADA33E22CD45C09C8D783E47CEACBFB813CDBFBB4B7D3FE16A11C00D76323F2BE849C049917FC0ED383CC0AA7B3440A44B0A3F786E5AC0BF0B89C096AA0840BA1DF43E8CDE54C0E6B9693E8593B3BF2B0E66BFD07EBA3F080E39405102F4BD51B0B8BDF62A16C17464C4C043C814C0716722407B133E3F66322EC0FBB811C0F869BFBF9B5C9EBF840602BFC8DDB6C0D4C955406267A23FE55110BFD94E493F0C173EC06264C0BD094D85BF90CF9D3F8D228F3F1DD612C0F1822E405C9636C050D79C3EA6EF1EC0AA1B67C037AEA63FC9262040B08EA43F2CCA8C402E7CE43EC2BABF3F39BFCBBFEA0CA9C0553F1EC02863573EFBA205BEF6E0DBBFD125E03EE93DE1BFFE8C8A40EA7D4B408B6EFABD61683A400FE35BBF9E6C80C0D2FD13C066F98740FB0A15BF9A45ABBF688CD43F1DA438BFEDCF10C0F56481BF9763DB3F6D6CE4BF97C30D40A2EF01C04B30DDBD0C0802C1FF7FAB40F6C2B9C0341E57C0788231C0CDBD22C0F4A03BC0C173EBBF34EA904089989C3EF0F281BFB93510C03492B1C02C544A40B2177E403F058CBE760ECC40CD514BBF25A1B4BF1184B7BFA1D8CE40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x8EFB7FBFF9EA7C3F526E74BFB5A03BBDDBDA7DBFA12E38BFB6CB0ABEE37068BF553D4D3F0F6A74BFF4FF7F3FD1B67E3F6F7A7DBFA0F27F3FC09A603F410E15BF4863CC3E0BFA7FBF95FF7F3F03306BBF41130DBF0E46733FD9FF7FBFAACA7EBF6AFE7FBFBBC3733F14DF7FBF77F97F3F2C837B3FF92E7BBF785EE33EBB407B3F04FF5E3F11C2713FF1D17FBFC2B77FBFE2F87FBFDD566A3F09D87CBFE9FF7F3F88F67F3F9F92B7BEA6B4743F6CFF7FBF1BCDE53E00EF7F3F86D67FBF24DBF0BD9C0E753FBD2D5C3F0000803FE33F423FD2C77F3FCE8B7FBF095F673FE8216E3F39F97FBF482B243FBCF47FBF4EE77F3F6FD419BF25B97FBF4BFD7F3FE5A2423F59500A3F1BF67F3F0D497FBFB7A2D03DA1C4DE3DEEF07FBFE9E97FBF24BE7EBFDE8375BF0000803F4C4923BF26177FBF347B7EBF92FA5DBF42BB7FBF08187FBFDB41733F6EEA74BF01E6743FCB48553FE3F7753FEABB7FBF826763BFEECF7E3FD5FF7F3F750F233E9BD37F3F679B773FFFEE76BF34FD683F36FA7FBF2409673F06E25BBF3C97133F04803C3FAFF67FBF8CFA7EBF200148BF17F77FBF64F3B03E805D35BD07E57F3F91CE7FBFC6C47F3FA6A851BFFB39493F751F5ABFB79E423F26A27FBFEA0F7C3FF0BC7F3F82C92ABF0FF17FBF2F4203BFC6446CBF23E47FBF115BBCBE4238143FA0C275BF79AD473F8EBC3B3CAAD87F3F31E87FBF4F1410BFA0227BBF3CD7353FB882F2BE634A533F3B1D63BFD5EF7D3F52586A3E99157E3F49C87F3F12C679BFBFA27D3F866D7FBF2C937FBF045379BFABF27F3F087F5E3ADCC853BF648C21BE1E032FBE4F367BBFD0F5743FD24978BF25ED763F02047E3F8E6F563F0B4E7D3F03B17F3FD00D7C3F244C1FBF6D7D233DA71602BE2834233FFD0946BF818B44BEF3C1733F86E67FBF79FE7FBFB1017FBFA07C2A3F8CF97FBF88DA7F3F824114BF0F205FBF30A67D3FD528453F06655D3F7F917EBFFA7D66BF3AF47FBFB65D333FC98A7FBF40DF78BF91E5793FA41CCD3D3AF27FBF2535BBBE20B67EBFA9CF7CBFD0177FBF669A7FBF6D3474BFDF7AB13EF1A57B3F933678BE0255793F334A63BF64F87F3FD7B20A3FB52C6CBF3A167F3F87FB7FBF21FE7FBFD9F2953ED4DD50BF0E055B3C23FF7FBFC4866D3FD4D27EBF54ECB33E01FB7FBFF252763FAE6B7E3F7D917C3F9B2E5EBF2AEE4C3F5BE46ABFDA1A1DBF1DFF7FBF62D77FBFE973763F77FF7F3F561573BFEBDC6BBFDA7F6BBF35576B3FE3FC7ABFD6552BBF49FE7FBF6140863DBC27A0BEBC3917BE4FDC7FBFA021E93E9C9A7F3F7125433E7BE17F3F245C35BFB3F77F3FD8D4743F880977BF7316E43EF4FF7FBFD11938BFC785F23EE8296FBF364F65BFA4A32B3F2B74573EEF1D3ABF70FD7FBFC2F97F3FC8E27FBF93967FBFDD2F50BFFC677F3F50B172BFB5EC7F3FF9E77FBF5D441BBF376544BE093B233F18EF7FBF2216273FDBFB7FBF6AF87FBF569F753FF4C4FA3D87D8253E06F7943DCD287FBF91A474BC9CA06ABF6E0E1B3D981261BFCC177F3FECFF7F3FABB93E3FE9357BBFB4717BBF08907F3FC07AF03E81F97FBF3AD87FBF23FB7F3F036F673F78107F3FECFB7F3FB7B073BFACFC7FBF26177EBF0A644A3FB1817EBF1C3067BF7FAD18BF4AC77F3FA2FB7FBFE68F7F3F74529E3E8AF17EBFC1C8733EA8C25FBFC8076CBFC1D2413FA99D7ABF943F1A3F0A127FBF72D37FBF68937EBF03307E3F697EFC3EEA717FBF05E77FBF1EF2783F8728E33EFB567FBF09C0653EF0CF62BF4C3437BF35A6653F9A6D7E3F66DCF2BD8F30B8BD000080BF63FF7FBFEE257BBFD9D17C3FE471213FBBCB7DBF99AA7ABF598167BF573B58BF34C7EFBE93FE7FBFC25B7F3FCC7C5A3FC9C002BF0206283F08A87EBF02D4BFBD364847BF35EA573FB6944E3FD7D87ABF3AD17D3F734D7EBFD21C983E4E757CBF5AA07FBFCBBE5C3FE1967C3FFCA35B3F3BEC7F3F8D6FD63EB99E673FB2A06BBF9EFC7FBFB8617CBF1F44543E13E204BE690670BFB8D8D23EB14571BF43E97F3F861D7F3FE430F9BD347E7E3FE81932BF31D57FBF28077BBF4AE57F3F053606BF5A075FBF6F276E3FA5201EBFA0837ABF302144BFFDE76F3F89F771BFEBF8793F925277BF2655DCBD000080BF1BFD7F3FD0FE7FBF6E627FBF01037EBF57DA7CBF9B8C7EBFF86373BFBAF07F3F94E3973E169644BF3B697ABF03FE7FBF27157F3F59D17F3F92A188BE9EFF7F3F9F2929BF0D4363BF077664BFAEFF7F3F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
