// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.asinh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x500835C0B3B691BF961032BF4D0A7040B946C23FDF6B8FBF37C45EBF5DA8253EE7106C3F6CAE1640D7555DC0664D2BC0EFC2FFBF549D983F1C68ADC0A9292FBFED9962BF7D1C284067A21CC0E4372540BA0836C06C0DD2BF40F1F13FB7DE7240C9D4483F3ED73D4089C8863F875440C01955FCBFF9D290BFE1750940C6563640732CF5BEFB6666C0BCF9A7BFBB77DD3D5A34254077E64E3FFCC9643FC6DE0541EA9C303F77C2A44094C910BE80EAA1407290D2BFB09AA1BF5A7FB94023722240B22C8D4021731640FC8B1F4004738E40D7B1BC3E20C6523F412F603F16602E400655AE3F7EAB95BEED50C0C0F4801F4037E0223E14EFB6405F3DBC3F9A725440C72D054086088BBF93C64ABF0838293FF262E9402530D93FA2EF81C09B5757C022FB37C02156D5C0B6FDC9C00481DC40569637C07BA8C8BFC749C4C009928ABF483F41406D4F8E3F085F29BEC86E8EC0C01ECB3FBBDEE43E27306D3FFE0912BFB31ECA40EA91D63F70B895C00664DDBF04E58F3F6EC02F3F107A04BE992738C0CA8B63C0DE88FCBFA77881C037077640BF846F3EEA5F1EBF624960C0D0474A4075073A3EFA2982BFB78DE740FE64383EC7CE9C40A8C9883FF7F430BF4794F73FDB7509C04D64CA40AFC6A940E4B2AC4062698040DB1063BF230750C0F893083FA8DD41BF926B203F38C01D400B0191BF103F7A3F8D3D0B408703ACC0A5DCD6BF65783FBFBA3583C08A45C2BF9742B53E0B3E3B3F4C9C2F3EE0CE823EE82DE9BF9B530140AE2754C04230C2BF22581EC0E14D8F3FBB67283E3A90133F388C9C404CB585BE516DACC08E044940611EC23FCD64A040125E97C041257EC02D6CBC4027F50BC038C57840BB5EEEBE3B9586C00C2D9B3EF0914FC02BFCFFBE53CF3140B78D263EE11AB73FB1E40BBFE7AA3CC0F8E03140EBD21440F9A60DBFE92C36C0ABC64E3FCBCDA13F221498BF94AD0BBF0B8B1F40878D284067031DC0F80167403C7B5540FACE0040562CD5400E097E40C4058FC002E4B54005DC833E01765A3F5FD0B0BFC7FE91BF508BCDBF325E76BFD2D5B13FE3BBDAC0399722C064774B40F00447BF94CB73400E3D76C042EA00C0CC955EC064D9AF40F94B71C0771F19BF235C13C020D774C05752B1BF1245C73F49B8C040C39EAEBFCB1618C0D0C382BF8EF98540D7F1F8BF8456FEC04FCD51BF756293C0A9DC5CC06B370C3F51F8F8BE34EA61C046A0F0BFB77F0BC056F7E440E0A30CC0A51D1EBEBD6F94C0A9E2564045461AC0667B2BC09B00634069CC3440FD0E2BC04FD78ABFA6D2843E02358CBFFD9E56C078E70EBF2CC3203FB4D9024002D557BE39D9DABF5FD107C08F5A23C0BED1A5C0CF6C5C405C7B0D40CE9B09C06EB49340C8F6C4BFB7CC1540E461383E2B6C1EBF7302724035240440F532943F495D96C032C04A3FA00D04418E369C3FB3B6253F6D674AC0EAC838C0783612C0FB732FBF9F38B4C08FA82BC0D1793CC0B8319AC0728682C003EA88C0562DCDBD5E948140DA1C6B4088F5C33FA1E6913FBB27A8BF30BEC4BF3EF985C0861C4640E73C274015C32540D66DA3C0B58CFFBF2A0FFFBF8296E740C8831C3FF6677E40A41B35BE5BF73540462F8EC0DE78A0C07D5630C0AB088EBFF311713FCB1D35C0442F6CC0C52A2C40A4D1B7BF520DCBC06E23DCBF5BE6A240B24B06C0EC927F4050E81040E895D13E61A462BF2727953F0743F1BF082FC8C0B3D4084070215DC0DB3C1C401990E63F7C74AF3D7DF230BFB269EBBF191A7D40E6525ABF298E78C02749173E1A00DEBE4A8E0141D85C89C015A72CBF1FE31B3FE5520BC09D81F03F254B2541BE8FDBBE155E58C0B6E00EC0AB52F2BF8EE02D40CE3D46C02F6F703EA47DACBE9F47A7BFBF9F09BF75E09EBFF6C6AA40CCCD24C0E016B84000000B40D869D6BD27E8C13FA709563F34256BBE5780A43F0D866640EFDD43BFF40B0BC0B7AE5BBF1EEAD140AF98B1401F968F400BB7EEBF06BB7BC0C7F2813E21D74FBF5DE84D405884C9BF072193C0418014BF03EE893D026604C0FB11BFBED92E1340B0EC34C0B39CA33E21FF1C40484CB13FEC979C406094AB3F14B5673F62F216C04C054FBF5ED89CBFCFA404C0489495BF7B278EBFBD41CABF469203C0B6DAA440DC32403F3F011C405A7CB9C0578681C0B7D31B3FE75500C0C2699A3FD34A9140BF520BC028BC89BFE41B24C003FC93BFE9BFDE3E17225B404CD01BBFAC4401C01F6BAEBFBD51D43F784367BF9D126BC0FEE7973DF7E8C33F8FC60B3E9BFD80BE55401A400D6908C0F3C9B14038408FBF840B23402C113640D25DBBBE01ABB940DAB8F0BE2CE0694065D63BC016FC24C0C678B3C055B5FE3E008ACFBFA2B658C0D848F5BD0AEB4BC040403EBF9F0855401486164015F943403DE5C9BFC6C56140DF5F853E2D0706403BF0813F391F62402A0BA33F87BD0B405E5F0DC014F91E402B2784C0F8DC2CC09F9AC73FBC0D0D4022EAFF3FD8DCFA40CB379640A821253FF0ECBA3FB495DEC0C629A63F7A2BEB3F5EC1083FC42A54400EE1293E1352883F30278BC06669D6401F050C3F83E0FF3FCF83333FB46C0BBF45727FBED0ACEE3F7DF2A6BFCA6977C04611ABC0B08B28C0BEC21140698E833FAE57F03F061F9240EF380DC0EAAAAFBF2387CA401EDA0040546ACB40E8B61040DB63BC3F935CBFBE94134F4018D933BF94BC9CBF676E3D3E473E02C0C5D3653EB0CF6F3F316372C0C36FE93D26403D407773F23FBD872FBF277EAE40F356FC3F2FD104409AAA99BFC436AF400F6F334046FE23BFCC62A4C09F66D5C0E9B00040EDE827C05EC53DC08B1CBB3E35061140F3FD9FBF407F9E40933B09C0F2B63FC0197E3EC0E01811BFE00FB83F2153A1C0EE18CFBDB85B7CC0D272F7BE9EFE46BE53984940E5344D40D4AF2DC0F08D7A3FCF3FF1BF21D680C05CB6B640391287C0F1A105C057E4CBBFB943ACBF98B72240E3293EC0187556BFBB4D374025514FC0260EB6400034694029BC7ABF67EC253F0118113EFE4F14BC8BE17FBFFF5EC7C024EF3A3FAEE31B4074263440520F9340B8F10140FB850740FB9D183FD47A2240999AEFBF197180C00B67FEBF59BE823D1EF94840BBB8A1BE103C7FBFA8BA34C0655725BF9742FBBF4AD64C40B63CFDBF0C8D2240D148873FD7C977BE9E52FABF5A3044BF54BF27C042EE1DBF0A1460BF65086040141C2F3F351E72C0B736923E2D947EC00FE299405159B2C08EE5143F5D4E4B3FB1E5624062CB16C12204C8BE65543940DAD9FB3F2689B240123F5ABF6886CE3F8A47993F24CA08402D61903F58EB14408DCFDB3F225A39C0589362C07B313C3F51D45340C6C7CDBF20140BC0AF953E40E9DF9EBFCB96AA4070F5B23F5C657540715CF8C0581238C0983CF53D34768840A99CC8BF62937DBFBE2DA13F103560C033A01FC0D5A7F2BFB44A15C0CC3977BF96B933402BE5B0400072B9BE52BFD4BFDC278E40D5C6803F5DA91840D1367EC0B710833FF99E363F214E3A3EEC29E4C0B7D638402B3D85BF002E924049DF8740CDA66CC05F3A5D3E81DE73BFF35C803FDED88AC06C273640615D2F4028A86DBE317807C0DCAE9F3FCFA2A83F904BFA3EA51438C07948D4C00A5F1441655BED3FD2320040A85422C0DA3B23C0809A76405D1FAA40A2AF78BF42EF9940EEDC1C40D7F339C040E406C09DD42FC084A64F40386B28406684F73F56186BBF0C0CF43E0E4036BF3BE6A7BE0371D53E4C62B34010891B407DD5F23FDBFE2640AAB45D3F7F57DC3EE2F7CABE42DCBA3FEE6C1AC09FB621BF3CE6633FB0CD8DBF98D343C0B171E8BF62A221400978E9BC55E102404A139D3F4648AFBF16E4243F83DD2FC001B148400690E440BD66063FA21457C0650CC6C0E0BD7E4082B8AF3F55BF3E3F014A0C405B0242405524D03F13A910C14B13E53F92D76440D7DAA0C0B4E968C00B72973F19566F40A68A9C40D18E95C0E5F3CB3F687D12C016DF19408B2D1EC0038309406196AABF602C47BF71A49D3F5FB3BF3E6DA1383E1EE9EE3F445C0E40F342923F36A784C0927848C06BC34CC0DEA3D3C04184474070586840D2859DBF1B5B224092680140F4B1B13E4D6905C0EB257FC0AB5DC2BE9FC659C0C7F00B40776144C0E0E06FC05BEAFABF1BC80CC0EFF10040B7E96B4057C28F3F5A6ECD404AB19EC087E1A1C0E44CACBF6CF5883E76FBB7C0A29F70400B946BC011E21F403A1E633F60C4A0BFE9AF78405EB45C401D46D8C0589AC8BE30D79AC088218D40AA5674C086725240ABF43F3DDA34373F6787BCC0A522113F99DE4A3FA56A1AC000E3824036B252C063EE80404B26EBBFB21EE33EB890C03F55D34340B53C25BE6A80F6BF046F4C408F8E324043634EC00F45E63E7AFF46C0CE792DC0BE6C523FEC2B79C0005DFBBF5C21F3C0693FC2BF30D229C0F47633BD1D9812BF9C9A9FBF1D70CE3FC67687409B0225C04DDBBFBFF08E45C0B57E5F3FFB229D3F11E7BFBFE16BED3EEC595FC07B81BCBF6FC28A4035F0B1C0"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x44E5E9BFD0E4BABEA3FF00C016C3B03F5048AD3F92D012BFED9B4ABFEDBFF93D7CC8CB3F4691953F27040BC0AE6825BFC1CFC7BFBA01003FFA8819C00511FDBDCADBD7BF2ABA9C3F1018FBBFFED34A3FBE71F2BF910101BF944608401E748C3F6233E53F6B29A63F087DEA3F39D59BBF371FC5BFB4ECF6BE1DE9FA3FE1D8673F1067FBBFDC76B7BFD8378BBF1C25863D0B9ADB3F0E28923EDF7434404658BB3F543B15400CB1B73FFF8413C0066AC53FCA7FB8BFBCF119BF8EB62240EDFDD03E57B61340107CF63E6C5714407CA7863FE64E033FD1E74F3F8A15DC3F59CC9E3FFF58903F655030BEF97B24C04928C73E0E781B401D72C53F8125FC3FF9CF913FAE5DC93F74AFE4BEFAA250BFB4E4023FF0772D40B213683E12E316C0D1E42EBFD9062BC08E8194BF07603BC0A58A533FB0FDF1BF325FF6BE4DD021C0E8A930BEA8A4F03F250AAD3E79250BC0E42EC4BF9B06A23F8E61713E02B2633FE14CD3BEC1D22440C75B833E8EB313C04506B2BE30B3853FBA85E33EEB1BDCBF14EEC2BF94A706C00FF8FCBEFD6E1AC09A77403F59DA923E3CD622BF8FC00FC0FC04393F2945E73E82F195BF4C582B402FE7C93C7722144069BF573E1EEAAEBFE893973F639D25C040B79E3FC4E32D400F214A3F6EA90740739D58BE8706F4BFF4811F3EA77D47BFD368FD3E3750DB3F6636D0BEA654C43FE16A8E3FB0631BC003B898BE01D706C02C4AB1BFD4339CBF0C12463E41142F3FC9B70D3E03A19C3FA1E7B3BFCAB302405F0F81BFE87DDFBFD2447EBFBCC9773F3411E03D91C21140BDBBB93F67AC17C00AC1C2BF7148FA3F4961DE3EFEEC2740EF4E40BF99B529C0CB0B793FEBA30BC08F10863F54CB07C0D88ABABF7ED0EC3FD188BCBFD1A4D9BF35BCB03FCE196A3F601AB53F0ED4E1BF7337B0BF4E05FE3F5F9C2D3F3857DDBF88EEAEBF61B9883FABD2633F041C87BF47EEB0BE358DFD3FA4384B3FCB5D0AC0ED21763F73E603403456073F32942F400AA2083FE2E72AC01159663F9820D03E4A16683F092FA6BF0A411EBFCAB1ADBFAC72F7BE365E28406B22AFBF8CFE05C0C2B9613F754502C0746CAE3F1DD60AC03F7CF1BEBF0724C01F26803FAB1D03C029ED1BBECAC10BC0224582BF807CB6BFB431493F36402140D94361BE24A9D5BFDE01C3BE32BE0E406F2BDABE7A9C31C0BECFD0BD1D821CC03CC622BF2829123F24F6DBBEA7A305C0C814F4BE98E72CC0E7E3A23FF5E6C3BF2AD982BDDC331CC0C18D1E3F09A4FCBF15A651BFFD4B0D40222C293F0011E3BF4E53BBBE57F11C3F03B394BFDBE6F7BF2E2522BEAE0EB43F10629E3F3B7492BF7CDDB5BFE7DBF1BFF9C85ABFBC8521C0B2A8143F1719E93FECCF3EBF752812405197A1BEFB58CB3F1DB2903D0A4701C07191B33F5123CA3F4083F33E83F110C05867273E1E5A34408346153EFDD2EB3F65EDADBF221400C0C0D426BFFDF61AC04851B9BFFEBE04C032FA50BF2F5C22C0254032BF0C440AC03EC1BABCD2241940F97D3A3F30A0AE3FD422143F9C56B2BF2D5C4DBF672316C03BBF203FD98DFF3F0E35433FE7A919C0A4F6BBBE13202DC07A60A63F50780440EEE7B43FBC9EDABF4292C03F7C0E26C0ED1757BFFEACE6BF8E8EBABE7AADE13F5CA29DBFA3CF0DC03A5D1E3FFFDE23C0F93DACBFF78717C038AC9E3FE7560CC0C5CF893F63BEC83F0E31283ECE0888BF1C864D3F1E2C24C0B82EA3BF0DAB0540B45D80BF86EAE73FBE421C3F7CBAF03D7CB041BF11150AC00506903F90C403C0C981ACBF01A6263E1366E2BE66403A400453F8BE498435BF84E4003FCFA7E0BFD8C02E3F840342405E2329BD444C06C07FE211BF0A0EF1BFA4B9703FDAF7ECBFF283933D97415CBF5BAF9BBF6DD769BFD4F583BF05851E40BD5BE3BE14EC2040709FB63EB32F7BBF255BBD3F9847453F702A34BEB25B014081C09B3FDEC1BEBFD37B99BF1CEE24C08038B83FFD342A407BD42C3F71F709C0830C8FBFC220C23E7CC25BBFC694FD3FC066E1BECA360FC00B4DFBBD54A3AD3F0F4EC4BF4A0ABFBF7352B23F3840E2BFC390D93D0874DF3FB109FA3E75D51440806B863EF39ACB3FAD7D96BF8E6186BF4BA35EBF59BDCABF82D2F4BE4ED6AABF113964BF24A119C091BB973F9868CC3FE7C29F3F90A529C095DB1ABF3227B13F90A09EBFCBBD0E405E14A73F26A5CDBF5814DBBEF2C9DFBF6D7ACDBEAE9CF43F3E2BB83F7F10B2BF19FC9EBF7CB5B9BF1C24543F7E7F00C0EC1AA9BF72F07D3F41E4C03F90DD0F3E651781BE26C9EE3F204C33BF2CD71B401D8648BE2E06024084C6523F3D8A1CC0B6E0C03F734FFDBF900DB83F48BA03C0D15F34BF22751BC01E68B23DC85200C078128EBF4CE2E9BF5EFFC3BFA237F3BFDCB3AB3FBB9102406E40663F082A02C07A97913FF4C1B03F741CB73F2653FD3F4CEEA33F7823CD3F20DB803FEA3BF2BF0A42523F03CB12C0BEE511BFC494D63FAAF16B3F0DF33140C3DCA83F4A9A10402FDA083E30952940A050AEBF06CBBE3FB735683F56FFF03FE7A8B33F0F53FD3E26199F3F293F31C0DBD47D3F754AAF3F096BA23FA0E3363F85A5E3BE3EF19FBF7409B53F8B9405C033349EBFDFDF1EC0DC89E7BE8A59D13F3AD4CA3E4B1712407E2E963F6731D5BF675C06BF84D4254026099C3E98D026408E39AD3EFC3C993FA56955BEC18FF43F7ED251BE20B884BFAE33EF3DD456BBBF9E3FCA3DF38A02401000A9BF1FC9DF3F97D2C33FB541B83F162EA0BEEF351D40BB39AF3E0293CB3F9F75FABED9E020405A95EF3EF80015C075E1B8BF14DB28C06C80943E055404C0C19D54BF8AEEBC3F3262B23F473114C0E3D2A83FC3ECFEBF428A6EBFE2C1E9BFD02837BEE9E5154012DEA4BFBF2203C055ABC5BFB42BF2BE448E33BE578C0C40B32A483F3A43E3BF740AA83E98530BC0E4BE8FBF56E8294037C221BFC0BDD5BF9E2A1EBFF6DFDDBF3862873F29D0EBBF542086BEE4FA09401C5E55BF37C72640B890103F228071BF6A43E83E4E9E103EF8D812BC9EDF21C0C471B4BFE2F1CB3FA8C4A03F99EA174085B9813F4D7DE23F5B01473FD709CF3F0D37A93FC6140BC098EC8FBFBF1DB8BF4902EB3CD0E0EE3FCAC5C3BDF350E2BF5E399BBF3A73AFBF7D359BBF2BB10140BFC909BFBC39DD3FF7B1BE3E06C2A6BF7ED2B6BFAC9BD5BF6C20A2BFFE3142BF6AC83CBFA5C5FD3F0F6C3E3E31C502C08639953DB07A21C04D955F3F4A271BC001AAD13D299EFB3FAEC3AB3FFA2A3CC054BD28BD0A21FA3FA50A143F0D981B4005EC18BEC4DDB43F7831153F71DCCC3FE6CDE73EF8E8E13FCFA71B3FCF860DC0D4935FBF1C6DF23F84D5AB3FDAECD6BFE17666BFBFCFF03F25E3C1BE130D1A403F4C813EA25D36408FFC8DBFAEBEE3BF4E01213DDCD20D406C6BB0BE93E993BF7E504E3FE8030AC0B4291BBFC302E5BFCF625CBFEF25E1BF3D469C3F1B701A40ACDE83BDAC730FC012479A3F7A2BCF3F8F45923F278407C0AB447B3ED4842B3F18A8173E50222FC04D8EC33EF9890EC098BBAB3F400A1B40226D35BFCEF7DA3E8C8087BF9A380B407841ABBFE75A04405C1D403FD1FCB1BFF840B9BF418BA53FC6C13C3FAF17DE3F3E28B2BF471548C028B0723F8224D93F9E544A3F6DA2FCBF8CD444BF61B02440B026703F348D11C08D06AF3FC2A9014029555ABFAA16F7BF575D65BF27120840D4E52A3FA29FBE3F9075CFBEF2F5113F1EF727BF54E6B2BEDD9ACE3E137D2040B9F9CE3E9ECAED3FE6366B3F5A9B513F0090A53E72AE80BFF1569D3F5009D2BF31F373BEAF3B853F2DF644BF916EFCBFD8CE04BF8E0FD43F86E52BBCEDCBCA3F7E0C013F8BBB96BF19E0BD3E50A307C05E3F563F45AB2A4089D3943DEE1C29C0A4D788BF491209408BBDA53EFC5BBF3F57099B3F6263F83F8C63F33E19AE3AC0AAF7463E9FAC20401C3E72BF1E2003C0E3009C3E0B9620404066693FE51413C0BC18A53EE441F2BFAB8A493FB314F1BF405B313F708997BF19B2E6BEBC60873FA7D16F3E5B369F3FC884BA3F8219D13F8A74E33E09FE15C0516423BFFACF2BC0AEEB8EBFF67510409AB5593F8CF8DABFB6E58B3FAF63BB3F75AC1C3ED4280CC057118ABF2C84F3BFE432BABFE7E900405A4B6FBFCC2C09C094FCF0BEBC13E5BF94BD363F4C940340CDCF923E13663240457127BF21CE16C0BCE282BE0AE31B40E804C3BF54A616405D0A44BF18FED83FF81CA43EFA9F05C02DE19F3F27E52D4088378CBFD7CB10C09C7EBEBF664D1D406BCD34BF11F6F33F2D645F3CC6E31D40095EB9BFC5A32E3FEE2A313FE5BA0FC01E95833F8ECD15C0876A603F0BA6B1BFBD09573ED012F43F984D8C3FBDA8A3BFE392BCBFC7F70840A249343FC2A4F2BF49B5073E5F3307C0BDD833BF0DCF03403993ADBF5FFC2FC0AF6EA8BF4D15E6BF087E83BF72A75ABD23D51BBF629DB2BF16375A3FA81C13405BC309BF04E4F4BFDCFA8CBF9EC18A3FF83F573F3B5F9CBFC62A823EFD5F02C0DD49C6BEC44A29409F5167BF"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
