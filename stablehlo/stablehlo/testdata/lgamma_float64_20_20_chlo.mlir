// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.lgamma %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xA9449313095911C094B9C5E8FC2C15C02834C61C266CF6BFAE57A1EE3812E1BF2349368C20E21540049AC128EDFEEB3F0EA593C72460EDBF2AA8D1F76ADFE6BF3C0A5608A0B1F9BFB875C351A0DDF6BFAEB05B452945F2BF3A745A7F4AB5E83F0D30D470D91316C07E6B2187B82E11401C9FB3977E2B01C0AC5BCA3075CAD03FF3393B942BD3E5BF5A3998358037FEBF3AA577BC57D3E4BFC01E22DD5B417E3F29A15D15E6D50140046FED5A62C4D53FE8290447A6F3DEBF1F12CFDBE5EFF2BF64FEDB2126DFE5BF00C7B75B3F2F0D40544EBAAB78ED0EC0D49E88B517E81040C0D18793D44109406248BCBB2B7804402CBA56CAD404FA3F0A2DA4E34F9700402EFE5641BA97D93FF12F734F7567E0BFA4941D3443E517400E45B3F8FF42D83F3EBB19EF5077DDBF2C10E9A99AEAD2BFE7F95D95590BFE3F60DA3C61D562F9BFF64F7314073006C06A128FDF35721A400012BC2A034301C02F2D06C684CB0340B094B600A3F4104035CE17E38B04F0BF98654F70ECDCF7BF53DE9B6BF494CC3F260443914300BF3FC7F3A718D9D8F03FC663BD678F050240595131654083D6BF6E125C6A58E813C0FD10FAD5A136F73F5E6153FBAC92B4BFA2BE3851B4D0FDBF581ABB793495F2BF846E6E9449AD1740EDEA28F09950F83F80216273F3180140CAF68B867369E1BF98BD646A85C5FE3F966B1B4BB47C1140C5C9470BF9BE06409B188C5BD7E415C043F6CE3C399713C0E22BC833E1EAF13FFDA644E8D41016C08C088BC364E7F03FAECAD9AD384B1240B455184A846ED43F1964F46648EC02C076CC109F3DD401C0CE6868760AB715C04550A8D76376B03F92A002C96E67FBBFE8B9776B2733CF3FA0EB3CF2F3A2A93F077C3BA9509DA33F541FA48EE8DB1D4082D4F67090651840548B4E78AFC212C02637DBE81BC3F93F9B7C501A18140740AC176E942AACDE3F7C36CC4871EC0040E599EB32BCB2204016F36F28A91C0840C6499AF973ACF83F471F60F520F707C0FABA380EB041FC3F3AFA7919372CF53FE045DA848671F73FAE28B6E6EC7308C046B77337D4930BC005416222900C14C01CDD04BF8EBE1540252FF373D2FA09C0475D98E60BB4F43F265E8443C691EA3FFF02B0860526FA3F5678DB440CF810406503F8A234271740ADA2F11A28FA0D407FD77C37B7C1D83F23A580B98D280040FE87E053BD54FBBF923D5F29C3ED0140B210E343094FF43F13C658C727F20CC0B86FFA68D9860DC063621F7DFF2E07401295BF88563908C078D35E385725C5BF1CD563A0C722FDBF44C59C545F6C10C0D7DD6E8D602708C0A36211ACD088024013420D5A68FDEC3F4CD162C94C990BC0F4EAABDB83C0A13FC2440649C022843F0ADC91DA0D6000C0C8611EF04717F0BF62D73006B2D10340CABD6A3F169E06C0E69C8B61118422C0B0701FD3CA34FF3F9F4388C09EF313C02864FCE29AE0E23F1872C7038C89C1BFB097D98AEEC4E6BF8202BA9E4BC7F33F71E3AA0BC0CA13C0B4E096CF9A62E43FE22BDE3FCC9911C06DA0C20522EAED3F64DBA2B6E52D15C09F741456F74EFDBF033F5B99B9651140D22ECE3C9F9FEEBFAE3506C62D0502C0AC2C8DF61F0B00C0E445E49B664C00C0B871EC328F8D03403FEF920CF8EA02C01A54976351490AC0545A0A32F592D6BF3FC5B4C338141340E4E0291BD180FCBFD194BB1136FD1440F738749255E1ECBFDB243843F3CE094059B5590E758B02C0C9EC99F49D94154060A7DB169462F33FEF10DB19693904407E49249A156B0C40715C5DE1F711E6BFB498BFD9EC7305401CF78B8FF454FE3F04B017922746F4BFC300066C25551140E10140CD343220408CFD37C427CA1CC08892B632E45DEF3F7E5F97FC04830840F6018C94FD3FD5BF22B94AC43DCC11C0AA51050AEA0CEEBFB27338DB9F40ECBF7A4D0863F3110A40460174A88D4907C0E153463DAE3603C08C6DC050B4D601C04B3173056BCCF03F85D8DEB6E32C134096F76A014A82FABF809F7F34D44AEF3F84A830F22110F0BF37BB7CCDA0F1F03F7A89820FE530F63F74E6B54FAB8CD43F5AA1E0B30DF8D6BFC90F87F1E72608C046277D9486CC0AC08417DF5BD20F08407D69CACA8172EA3FACC4BCA2EA9902C0DAABBF759F400540EC28BC025047E3BF713A35D8F0B316406CFA7513FF10E6BF0919D7779BDF04404A3A80780930EF3F27FD89C3C0B907409FDB41ECD259F2BF4B66408B618310403CCF2B25731EE83F8E0354E127DA0740DBB5D4C9C75F03C074D43F1DC9CC1A404B479A560B1FF73FE2F320222BF403C0292A7ACE63200540B9C6A18D216812409AF144406371FF3F5C965528D88E0FC0603BA543711DED3FB8FBE530A04CF1BFAA81EA74D3D8DE3F4894BEF8DCE6FD3F8E10885EF0E7DDBF882C3246C202FCBF38BF24D50EDAEA3FFCD3C6511094F9BFF9E935521CBCF6BF5642E1B8AAC51040C18336331EF2ECBF46127E85E36606400849CA080A5B1140B9FAD28247A906409E989F1FCD8BD9BFE20A9F424BBFF4BFA42DF9DD4A49024062C1645A31E210C05C4D3602AE041FC087AB274FA2DD11C073A834964B6314C003072E24279814C025B3EA880DC5E0BFA4C52C4A66E4D8BF3075D8AE32B5F6BFFC2AD99D2629044094E6E36F5B4F064077AC518463A1F3BFE0DC4A9A79EF0440F54001DF40F111C00507DA0E1C3AFB3F16081DB653C0B43F8BA956463B3F04C0CBCB4D04C21A0640695FF13ACF72D6BF14B6ABB31BE70AC040708A8B9315F63F4036C9C6209812C08E0CBFA716779EBFBAC21AE0B23BF93F5F7E6F92EA9DF63FC2F5960067EB12C0E6F01F120C48164022AB977241270A40CEE7B0AD37D4F7BFFA054162F631FEBFE42953E631FB01C003A84DE15E3DF6BFDE0117E0BD9CFFBF5CA4CEF85F26E13FE4820FBA996410C0A20BD316EE5609C09D85E9D35988E03FB6E04163485DF8BFE17C681D109201C0C8222967E37400C0C0E95EEAF712FD3FB686116AE059014062EDD0C7D756E7BF00EAF017C5BF09C0F4CD47A4E332EA3FBA8A584B994D12C024156540A676F83F22220C0815960240B9FBEFF4FEC60B4006037A40B730F9BFB27B43F8409302409472557735B7FA3FC2FF296523B9F5BF847C0B399910DA3F925ECEA3CB0E1140D0493D2D41BBF5BF388CD59FDA96CBBF39B226D433390640F099D191E6F8FBBFAC60EB4E7DD1E63F468AE08F37CD0540E96C568DDCDFFE3FF05F04ACA632034070055ADA9EBF06C0E194F65D5E6D0340760A2BDF1C5FF8BF555A73B0A0EE00C0423C693BA2141940FE2037A35BBAFE3F62C8766A9AF6F9BFDC5E661C2B9DF43F406A76E532B00DC062E312651A520F40F215D3334810D5BF52A4D078ED76FABF070D410D942EF4BFEC15E3E151A70C4024F8F195187E1540BAB300867E671C404CBFB90518B10A40937225EFBF320640E82A3F03EAA5F7BFB64AA0B0A3A8FF3F2A3D80EFEB0E0540F8C61FF8180007C09E2607A71B3814C05C457D85A001D13FEE17B2E897C6CA3F6F42F6D43D4703408DB676D0837B06C0362F06D038F91FC0B40F5F526D1903C044535EF42F67F6BF5E4214D56B5C0EC0E4A6B0342DD8FC3F82FF9D496E6D17C081699967A88705C0141055119B580DC0E9ECEE6AB274FBBF42CB3F9408CE1A40575AF672AA891240B6BEBC7482EC00409174BD837801064064CBFDB09C8812C09488FE8F52F2F73F7240EFDDB870F7BF6E9ED653CCF5F8BF5B660305326D0040CE6DC26B8E6814C03B163C4DF3D3EE3F8E4693E71B44F83FCD581A8A471AFC3F902ED3BE263BCF3F3F4CF4EE91A3E23F5C420A5467F0CE3F81BC97094B97DA3F6410F5FA32E62640CBA2C1D36334F0BF20ABB3C4ABDADABFE491D695EE7210C063919426684109C0C71C834AD77CE3BFB149534D664D024094BFFA5EA9AA8E3FB2B9A275F108D7BFD852D74CF1CDE13F408062A1426303C0BA000907C50FF0BF1B7E9C5C3DE2E33F9EC36D8388980540268258CD725D05C06E6461845C06F8BFAAA396F2241E11C0EEF6BE2A13BEF5BF80CD8EFC8A3EF93FC407EF918D200240118BA91F8840FD3FF642A1E9088605C0EC2A16DF24CBEABF4A07DD41E45C004082493C73B4D811C0C6167AB26AE403C0FA5135D2A2B8F7BF3448EEF0FCA7F8BFB85A10CBA531D83F4C894B7E006CF2BF7795358BA16000C0E67BD1B4565F04C072164AE06989FF3F7EF5CBF2CCFBF3BFF09D97B0EEAF14C0C0618D5F2FE414C0A69B7D2C5C10E3BF6242D9117BD7E03F7BBA07649E5DC13FFACBBDE33C1EEABF2AA27D57A68A1040E4A1323C13C6EFBFD5A288294155F83F8468B247AE5BF6BFEFE35C5FE14B1940A6AB89DD391A09C0698943406BDFEA3FE40EF5248EAD02C0F18F4C53639C0640D4CB49DEF6B21A40EB2BF9BA402A05C0C062F38F84D0FBBF7F58310E20A71340F9AF8540385FF13FFE56A5BCAC8C06C002AEC59C051BE7BF17DA402F2145074028B11F4ACB18EA3FD274B1C9361A15C020A9A0D17B7D0840"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0519F7185C5303C03506F31635680FC056EB4D970B39EF3F64E5C7F3194FF43FCE5E8D6985490F40C0E1DB2DBE01B63FD25A0450FB5A0440E69124BE5DC1F73F1404668C3CDBEA3F0ACA823885E0ED3F6226221B6CB7FE3FA0FF3F84C505C73FA52A8AF9FA3312C0838C7B51C0660140760D1862EC02F23F183F9AC2FCCAF33F1AE7A803D8ADF63F0E0AAFE750F3F93F7EB7D0B83BDDF53F1C205191919D134080575C71FBFBBC3F523C0FFA88DCEE3FB1DBFEF8E446F43FA67E5DC23A9CFA3F7FA2272CD9B8F63FDD7F6AA9D8E2F53FB0ADE453410BEEBF533E477637AB0040A0B1C2EF55F9EA3F8082DE05F0E9D43FC0E7078469E7BBBF80EEE6E077E1A03FE40AB778C880E93FCAF48C119240F43F1ED7A96FD6F8124060F2E1439942EB3F0B3A7F892F62F43FF4F5A96CE796F73F00B166E922EDA7BF8681F52CD5B6EA3F40F37CE318B4AC3FB4CCA30D497417401A0F2E6806B7F03F4055E60AAC13D13F7C52F7F555CC0040C2B13FED39361B40949DF9ABA6B9EB3F3C15C6D81585F63F521C2733D96B0040008B520683FD9CBF006DD289CC2EC03F06097A8EE1F6F53F0893689CBB56EFBF40597FCE0416BFBFE332A347BF950440AE80FBB98537F73FC0330B1821A6FC3FC8AF7801E2991240401086C9BBB0BEBF40AC1288C85BB03FDE63939DBD5CF43F00DD480EC0429FBF9E43966EC738024010D189B8E3B5E13F447D287311DE11C03939F6AF1D8902C08091D1425FB2ADBFB8B5E44C182F12C00014081342C69EBF2ED78C7290730440F18E0DF7397DF03FD8F8A8E7923AC73FE49EFF7295C4E43F6C2ABCE5037611C0F9DCE1B0A4AE054008730421E824EE3FBA3AE7C16209F53F9B49656A45BD0740F0C25C10D4ED094042F837AF04DD1D405D5F4C7694D41340732BE4EC707607C0800B622A387CBCBFFC466F174BDDE23FE8D69DBF5AA7E33F80C14CCBF123AB3F9A5177453D7922402056FE685E98E63F4070C1C04351BEBF7AA50B4D7D3E0D400058529CCD90B4BF0065102DA29FBCBF00EF9B945119BFBF8CF5B52CD937F03F88C68386FF8DF3BFD0C81A5B1414DABFA961E09A92D70E405C75783CDB93E3BF409AEF92F96CBBBFC00B4B2A4DB5BF3F40BEC7E5DC96BBBF2608B7305BD5004010B156EBBAB81140B99A64882EBCF73FD207EDA32498EA3F00E600BE3F67813FE0D10BD87BE7ED3FC0697205E7AABE3FC05A08967839BABF1F05DEE60C78F6BF1ABAA2E99730F6BF881A53C3E13BE33F41278C199EFFFB3FECEAC61112BAFE3FA01B461496D3F33F888BF3864930F1BF0CF8CF00B016014050FDE9CE6309C53F80CA99555DB5AF3F5FABE4AEA9A2F3BFF0BD261006BE0A405D8562AC527712405E4E08069C9C0240A940165DCBAB144098FF947FD435D13FD08A32938EF3CC3F06DFD51C9DD627C0003FC5C92FA894BF10FF5EB4B07AD6BF703029F2367EDA3F2B1B0B59B9AA0040BFD993E253A3F73F4037971E6C52B8BF30C07B5334CFFBBF007F357156FDD53F82B2375B8FD304C080811AC88D1BA53FB6BB836EB66F0FC0AECAA1F7C892F43FBFDB3E1892FA01404C60F054AF5509400EBD6F0F0771E13FE28ACC57BC111240AEEFC12E2B810440F090B79A4982CF3F088309CD9C6EC73F60D1B36374AFE8BF1C73E18024F1F53FA8859593A8B20640D23B9D282097F13F496A34A1FF740C40CB66E6FBCF0D03409439DA90672BED3FE4D5E4D1F8F5D33FB2667C04DB510E40006F812DA7B0B6BF181EA7E7557ED33F204F72F04925F43F8157CD3DD5E8F63F40F0F9A331E5DA3F0065A2D5C2BBA4BF31512D5776E3F43F3A287ACEDACD01406D3E6820687221405A6D61BFFCF31CC00010B76D170F883F704869527018E83F6C4E6785A276F63FFA97086A03C105C0F9F8ED6F5EA1064026088681BBB20140C4F856B6393BEE3F3C520B791902E83F402E3213195BB93F6846C3405997E43F0002744F33739BBFD6900D9185FA06405C974F531BDBEB3F001EA061FFF98A3F742DF6422024164000D5B1A54F02A0BF804667EAA464BEBFB6C65AC29364F03FE88C91B736CDF53F6F26E040E72F0140066C721C539BEFBF907B221EC268E63F6098289B654BC03F80286DD35899D23F50003A5AE5A3D93F90B7F4ECA7F4F43FC4680F84D1F91040729B8136E5E7F63F289A43FB2851D73F00444092EB1B8F3F4826EECDE12CE53FFA8C658AB227FE3FB0257A3D9F48FF3F4071055D6D81C93FB0C29A8F20A3E53FA092EEF3637DAE3F247DFE73FE18184040F2583EFE10BFBFC082B442C873A9BF98EFF0916BDCD83F925C5D1A1DC50440003A22D834578DBF400DDC26B0DEC8BF80A989BC243AAE3F68ACC7E9ADE10340FE37FAFE4C79E33F0010FD756177A9BFA21BEEDA0858F43FA727E2645348F03F401F034CEDB3BD3F0EB787DCE3C9EA3F3AE07217B13FEE3F9886FD57BF5000404A6B45ED7636034008DE4400798AE03F7AFCB2B8BBDD0140D83328778D6BE13FC5E1D9DC9D0BF53F3B6B4F0C9964F33F60960540D4A6C23F9C0C0A4844CAFEBF11F88D66632721C0D6A238F3490706C00EFBFE13D0D604C0915688356ACC08C0C33B648E8C46F43F4368E8E93F36F53F4EC7E6260054EE3F2883F43C5821D33FD0F8E2D1933BE03F2407F5DE6252F73FF81F90B745B1D73F1A462128A04F06C000A8BE3DB96FB8BF6C0DD97592C4034030E79F14A3F3B5BF98EBA904D319DF3FACE1AF15EFFCF53F2EE5D2508666F0BF00C6169F6742BEBF2644F9AD2E8807C0003903F72B430C4040F2F22E5081BDBF0094B7F554CFBEBF8440707C1D3607C0227A9C0B614910409C363DFA5192EE3FCA22488C77C7EB3F4253AE5CD7C8F93F7A8736800917E23F8647CB0DD9D9EF3FDB76AD7F9D66084058F8A97BE427E03F44D2782FF1B4EFBF20374BD6FB0FC6BF5073D161954AE13F9CACB0834416EB3FD01B58B49FEFE93FA5D3F25D7EFA0040000E562E89EBB0BFC0D2F5B1EF8DB43F08C670FB2B51F83F141210CD4A42DEBF6092257B0634C13F5B30555ACE4107C000A32BB8D38CBEBF70D799CC0E8BC53FFC75C9DDF1B9F23F58D5D330CBAFEA3FA0C2E4315A6FC53F80B4B948940CBABFEAC5BB467CEFF03F1C12D1208AE7E83F2FD0FCBAA9110140AF3F531AF8EAF03FF4C80F42263BFB3F7855A39572E3DF3F3044FF4B8731F03F60F7113B5961CF3F805BE073701FDD3F00DE050DE8CB9CBF80DECAFC4FBCCB3FE4AE8A00A100D33FF0A68CFF7928CE3F68221C367C14EB3F7EC65615C3E6F53F9ED61664070515408056A210F225A0BF36B41B766815EB3FC021E42F5B2BBBBF2EF8FBE773E9F5BF862263CC66FAFA3F1AF856BE178BF63F441E28FDD5C6EB3F058C4EC3DD34F53F604A6DF7D2ACF43F041EF75C570A0E402255A948C6131B40E2950B56B466F03F70402F2395B8DF3F782E051DCA16EC3F00C2DC55632A82BF804C70471871D83F042065A067FDDD3FE4196502C38DFFBFA13C1412D893F33F2213C9E1FA9FF73F80BD51273794CC3F7834F5304BF0C43F386DDED9534A16C080D056551F9BC03F0A5B6D2E9249EF3FBE75872A4880F3BF80606FA87DFEB1BFFC049BB0E85611C0D05859AD75A3B4BF72BD62D00764F6BF50CE4D7C1952EE3F196A31B5451B18401BE6C0A834240540800E77701126AB3F40688AE08D73DE3F3DE14B10958307C0C07C55713AF3BEBF6ECC0B92177EEC3F501208EF1EB7EA3F00E51D45F002983F9D09781B384F05C000A1492EB9CC963FC06E344D64BBBEBF00D414503A32B5BF443DCA450D05F53FE0B98D3F8740DB3FB87B5C44BB2DF53F140071C07740E83F3222E5E7D72B30406B6B8A585A6A1140EC982A54F5C2F43F3CE1E58FA73FF2BF50577982E67DB9BFECF3384D270EF53F00D7E3B3C9CDC23F0EC40C659DC51040E9CE123C61C7F53FA04052067E04DE3F40CDBFBBF2DFAC3FC518CE1C773B164060C4085BAA6ED73F107A8E1D4DCDDB3F50739AFBBD1AB9BFD60BECD5A67CEB3F440A911F9E9A01C0C8443067F8E4F03FC0F216AA777CBDBFC02F6E774E28C13FC0755A39AE0FB0BF00D3860D82D6B4BFF2C2AC6C22B7FE3F005B771E3E4F943FE82DE86FF6F305C0A06057131DBFA4BFC8B3321088F5EB3F98A9198E17DAEA3FD61855283E5AEB3F5282BA8B81ADFD3F4780FD61E48F024090E3D28A83E3B8BF00887DB9E48288BFD1B13A098BECF53FD26B778DD02E0AC0B9252190B4B30CC07B0157C051DCF43F8872EE194CB7E03FEEB139CA62EFFE3F4A9046E32110FD3FB5BF1240366EFF3FBE180FEABCD1134080F328C89EACBEBF30D042BB6070EF3FDE3234682F661540C07ED0337C76A73F001F9FCF498EBD3F2825139013D1D03FF06B3BCE8F3FE13FE287130CE8E917408033503D1CA0BCBF885CAD8A98B1EF3F5E23BD21A9620840008F13B4085EA6BF8861E0ED20C3C83F149720F16407F83F18AEC1D7208AE33F00CA8B06B694C13F2EAB792691C70EC00C7A9AD97603E83F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
