// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.asinh %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x283CEDC37CC2E3437337713860B5DAB56E3FD0C3B7BDD03173C17F3C0E3522C2A446A0A83F358FBF23409B4015C099439141713F7EC0AD44073A9FC3E2C26E47F0390B4065462BC19138123B2C3D93C2AAA130405241A94452B463C11F40E5392DB7883F4DC248C2E2382A324C4676447E3D78B931BCA040A6C446C23FC5963D83C5C1ADD6C49EC31C45D0BC8D409FB2BD3A013EF934DB47F24438C280BD8C2E0ABDC1B0CA3C9FB6A4BB0639E4BE7B441B3632B2E7BFC03E8AB99A409A458F3E21BB463F63C4FE3D44353AC02643F54092C4173A683F17BC3D433BC315C0D43DBCC3ABC414C090C4A83E7FAE993C64BD2137603F8B43EFC623404BC07F422BC5E5C3C0C05B434FB1A1B0C23AE63D79B5543AA634143C03BF4F43343B3EC30C42F0BEBA4263457FC2ED380DB803427EC1664203BF70B95EBD51C5113ECE2635BB0C45B33805BAD4C252C16EC2A0BD2C46ADC1043C213D5D43B341B4BE79BDF33837C03C441F3A68C047B77F3E0F4206C42DC67440EAB4E2388AABEB39DF46A79FCF3FEBB3F0C323C2143D62459B40E6C057B454B515C7F53BCC41F43C45BE19C67D42D63C0FC0523FEB3CA6BC0E4367449ABF2CB94DB9A5BEA3BC79BC734086C061381AC394398833FF409CC40C40B2BEAF40F93D1341E44157BED5422B34D8457541ED41343F21C24936883B1DC15940FAAB3938BE4010C44E411FC090C1E8419BB9C9449C44AEC49F3F1F3AF24559C76547E2317AC406BC9CC37DB207BD55BD0AC90041233811C338C0BA4018C1A03A18B718B2E1C02D427BC44E4497B134408AC4AABE35C1BC3F4CB755B6C2C18E48603DD5C211C5E7C0DD44D1C0B83621BE4ABF8FB469BC05C289C1E63F54BD75C308C660BD1E3CC7BE59C03546864385C1283633B72BBF2BBD85C647C0E5386FC2E1C036BF794076C4784478BA24C15E40083E15348B439AB56240A0BFBB3CB9C576C0D5BCEEC5504506C379438D40ED3640C072C3A8AF3CBE844338BF0B3C0EBF62C3D740C83FA13C823F1DBD403CE7C24F345AC048BC54443F3F4AC87244E12C073ADF449A3CB84067C1A9C2DFC45FBEBEB4C9412938423D753C203CAA39DB395B405F409237BB4172B5BF3874435F36"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x453B2CC092BF2A4033373E3847B5BBB5833D25C09EBCC831E9BEBC3BFA345BBF2F419FA8283593BDE53D493ED9BD1740FE3E853D31BE7E40923918C0CCBF68417F39D03D1C41B6BE5A38603A4C3C9FBFAAA1F03DD23E7D4045B4DEBEE23D7539F6B6903D75BF73BF9E382032144167407D3C1DB951BB4D3E7CC072BFB8C08B3CD1C0BFAD8FC018C0AB4012BC3E3E93B21E3AC83CE53484419A4069BF7EBC8A2E37BCBDB00F3C72B6CBBABE3840BD6940F83528B2BABD2D3D2BB9483ED940143D6BBA703D5FC0C63C2D35F9BDF13F8F3E73C09D39803D2EBBFE3FFDBFD9BDAF3C20C07EC0D8BD72C0213D7CAEDD3B6EBCEB367C3D134045C1E53D08BE943FB1C02AC066BE074049B19DB0243AB93C5FB5CE399634293B4FBD0440793AFEBF4E3F46BDB63FC54094BFA838CAB7483FF0BE853F4FBD16B96ABCBFC0D13CCE2679BAA440773890B9C5BFD2BE8ABF91BC0A4110BF143B453C0840143F27BD7ABCAE38F7BD4D40A33920BE0DB70C3D4F3F34C00AC12A3ED7B49E3889AB7A394041A79FB03DD7B32DC05CBF3D3CC540493E83BE4AB43CB550C1063B243F293CEDBC04C1933F163CD4BD753D243CEFBBE53F604097BDDDB8F9B820BDEABBB2BB293E38BE3038EBBF34397733963E77C0D13D26BD593EC43CA53E343FF7BCC53F2034EF40EA3E3B3F673D5BBF2136B73AACBE133EF9AB0C38653E38C0CF3EE2BDFCBE373F3AB98A4077407FC0993DA339F74062C16641D93169C015BB18C072B235BC65BC03C2973EF137E6BFF8BD623EA8BE0A3AE1B60EB27FBE623F69C0554090B1F43D70C022BDBDBEA73D0FB72CB61FBFD0416C3CC5BFA7C084BE924073BE8736D9BC72BD80B49DBB49BFF8BEBA3D64BC0DC0FEC06CBC383B31BD13BE0D411240F5BE0336FBB663BD4BBC26C104BEA2388ABF7FBE68BD2E3E67C06840E9B9B1BE183ECC3C0A3413407EB51B3E9ABD053CE4C02BBE15BCF6C0BE40E0BF0F403E3EBA36FEBD0DC0A3AFE8BC124069BD1D3B55BD09C0783EAD3DE93B8D3D43BC663BCFBF423414BE71BB58406D3DB1C16540DF2C92399340E03B603EE1BEACBF93C0FBBCADB4233FFD37593CAE3B3B3B46396D39153E183E5237193F59B581380D403736"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
