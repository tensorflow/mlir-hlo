// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.ceil %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x133E0744A1C4E444A73DA8313DA95BC29B44DB469D3E16455DC0783F34C1D3411C3A7D3BBAB8CCBDD7C47AC36CC61C44B03A974039B92740B9B84AC49F40153F2C3F873968413CC07F43204041C0DCC001C848C6AABDFB33934589B8633F74B6C5B5483F8343EDBF98B3EDC315C7073D9439B93AED3D9E421FBE0BC08B41FBB67434C8C57243DC4225BD6DAE573F0634F2C76140BD3BEC42603EF2312B3BD33EE74500413B352C3E6EB9633D5DC34E38E1C540C0D241AB3A413DF8A33C394AC125C38240BF3E65C5EB3CDE3C7FBF383C9B36DA3F83BD43C1CA3882C0D24411C30DC2ECC01DB609409F437C4525BE143BA238C742E0C4134313BD79C5C6B9C3BC7FBD11BD1D41334178BEE9AD583D5D3D6FB67337E3C32E3EFBC319C079B082BD573E043E69C6A54120BFACC067BE26C38940CF39183FBD38FFBD9DB5D7443A4562C2EFBE97353742FD4474BC15C20E3FEBBF063F03C354B7123C57401A41103D76C044B23FC4AE3DAEB7F3449C3B5437E0BE34C2374589468FC138C0104872324841C6420F4016C00343E03F5B3EABC51DC28B36E6BF65BDFBBD57BDD13EEAC769B0864470B79240DB45713DF73CA7C4CEC6B73EA735D0C034C014BE59C2C53B363B6743773D3C421F4149B9984332C46546113F4F42BBC3F13630BFB43C37BAC83F5ABB7541483DCBBEB63D2444C13F95C07BBC2544E0419F4092392034F63EA142B045143C12BC95440FB4B4426BBE8B3A0FC05BBA86B7C1B2C4A93C448740AA3E554200B9DAC078AF1DBECB3F034643BAB23E653D4DBC0DC479408B3E542A88B93C3D3FC16B3E0ABF9541033A70403147A6BF2139D83C893A0E33E7400E3C7E3BA8BD14BE6A3B94C0DE436C34823D9FC72AC7BBBFD3C2CD429DC3D4B1B438F94454399645AEBC833EC8BD1AC469417BC093381A4567414E4358C2C7C0D5C35D4181C08CB9ADC21C3CDDBC45C4C9440FBEBF3D4E3FDBBC7EBCE63902BF26C0C5C385BAE246E5442C3624C2DD3C0D3FD93D1DC55CBE333DB0BA0743E4BE1639CBC998C4E1408AC254C0BA3FD2BF22C67B41B3B117BACC4391C4B545113DB3429BBD30C44B3F8FC4484030C05ABD28C4E043DFBC59353EC1C145592FA5361CB5"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0040004500C400450040003C008000C2004500470040004600C0004000C00042003C003C008000BC00C400C200C60045003C004200800042008000C4004200400040003C004200C00044004200C000C000C800C600BC003C004600800040008000800040004400BC008000C200C70040003C003C0040004400BC00C000420080003C00C50044004400BC00800040003C00C70042003C00440040003C003C004000460042003C00400080004000C2003C00C500C00042003C00400080003C00C000C20042004000C50040004000BC0040003C004000BC00C0003C00C0004500C200C200C0008000420044004600BC003C003C004400C4004400BC00C5008000BC00BC00BC0042004200BC0080004000400080003C00C2004000C200C0008000BC0040004000C6004200BC00C000BC00C20042003C0040003C00BC00800045004600C200BC003C0044004500BC00C2004000BC004000C20080004000420042004000C0008000C4004000800045003C003C00BC00C20046004700C000C08048003C00420044004200C000440040004000C500C2003C00BC00BC00BC00BC004000C7008000450080004200460040004000C400C60040003C00C000C000BC00C2003C003C00440040004400420080004400C400470040004400C2003C00BC00400080004000800042004000BC00400045004000C000BC004500420042003C003C004000440046004000BC00450080004400BC003C00C000800080008000800045004200400044008000C0008000BC0040004700800040004000BC00C400420040003C0080004000C0004000BC0042003C0042004800BC003C0040003C003C00420040003C00BC00BC003C00C00044003C004000C700C700BC00C2004400C20080003C0045003C004600BC004000BC00C4004200C0003C00460042004400C200C000C2004200C0008000C2004000BC00C4004500BC0040004000BC00BC003C00BC00C000C2008000470045003C00C200400040004000C500BC00400080004400BC003C80C900C4004200C200C0004000BC00C6004200800080004400C400460040004400BC00C4004000C4004200C000BC00C4004400BC003C00C00046003C003C0080"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
