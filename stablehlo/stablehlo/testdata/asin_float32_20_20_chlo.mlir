// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.asin %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB34B683EAD3D3C40EFE28FC0D488233F8CA542C02CF614BF5B708F4086B59FBF73B165C0AF4F6D4023C004C0C3A3C13F74C4C6C09601993E8AA23540866FC8C062F3E63FC8A558C0B8D66240275555C00F69723ED6F81040CBBD96403296314092F41FC0EF431CC07942AE3E79683EC022E79E3FB1B4813F6D95B0BFA3B5BC3FD35DAF3FA6E04D40E21FB3BFA78E0740307E76408D110BC037C62940E84780BE1D77ED3FBCCB8DBFFC77C0BE88E3BFBFA49E04BF719083C07597A7C01E3E814064D9FCBF9351A63FC1B77CC000C1E43B19C1E9BF2DDB54BF76E4A6BF69B16640671EE43F0EEF6B40C97A1E3FF19102C06DED2BC0F20925C0B59E01BF5B024EC0AAF57CC07FEE09C08782EB3C8847C0BF985C4C402E117FC01C5E87C0A1874440B04E933FEAF8D3BF61FA39C00EFE7FC0BAF46DBF05D81340786B30407BC7AD3F51D0F23F69C01D4049C952C0378CC8BF5B3C5140FBE712C020B4AF3ECCEFFC3FC679B4C0EE873CBF5BF44C40D28B5840CD3DAAC07762F8BE771398BF02750A3FF994DE3F8696A2BF8A24EB3F7183713E588A1940CD4247407BDDAF3F6CAA99BF2CED3940E386C5BF03AAABBED75318404E71B0BFDE1A6CC0D692BDC055C59FC068A948C05541A43E11FCF63E849E0BBFE4547AC0B046A2BD13680241E4ED57BFA8ED8AC06103163EE3B4DB3FC0C9CCC0A4A16CC0C30582409B5880BFB6BE01C1B55D7D3E3273FD3F41E4E43F84B145BF38B8BC3F04375B4042FCCB3F54B2244013E178BF8C1CE4C05AF1224082F81540BBC92FC093EFC3BF74A904BFA3FB1DC078A9903FF86EBE3E054B05C05E0712C0D4A65B3F866889406536CABFBEDAA1C009A099BF85BC75BF4C39E1BFC5960041B2E33F4095DF0DC063A45EBFC4EAFFBF4464D23FE4246440B33660C0C9C849BFA38A3C3E602DD2BF137BA3BDF2ABF5BF69480ABF0FB61C3FE16EDFBF367CA6C07B0F69C0CF589BC0BF6779BF4F7E1E3FA6D82B3E5DCE42C08AC54ABE3487573E79E23FBF8C8FCEBF2D8BECBF47434A3F5F01A43F33791ABFC6444940A6454EC09B1C2F3F2229713E7F3BA540FCA55E3F69DB1A3F3527A3BD0D4CB8BFFCEB46401AAA9D3F61C002C0137875C0BDA0794059061FBFDB8D1E409AD04140421F79BFE97D114082F308C0B6D4B4C0D01AE53FEC78933E0D051C40E764A64029EC554081BCBC3EA01EDCBEFDEE98BF478E5B40FCB334C0E344B1405D12B43FE70AF0BDC37D6D40A6B64EBE5C8F3CBF21844D3FE79841401CCCFCBF55FE0BC0CA4C273F5F91C33F1CE0204012B10C40C79EB240F6DF084016E799C0881131C077810BBF6EB8C03F0AF00941B712BF402DB253C03A5E403F4399573EBA92534050BF36C0C2638A3B432F22403A945E3F9EC68AC0C6716CC0CE129BC0FF6972BE0781A43FC3650BC0E3E5CA3FD8038D405E6584C0C26BC5BFA304ADC0B6D9BC3DCA67A1409A47C4BE40594ABE78BF953FC31984C0A64224C08B3C88402D023DC0D418D3C0285DD5BE3F742DC09AE057BF1BB89D3F1A5ED9BF7A767ABFDB7F98BFDD8D7EC0125C00C0546309C0844967C015931E3F9D4BA33F10CB4ABE6DF345C0231410C0A9AFFBBF31F45C3ED146ADBFC20AA240E92E94C06A3814410F5FC93F12ECDC3F23E22BC0B65253C051131AC04AB510C0FFDA29404F1712C0868FC9BE0B069A3FAC660F40FE2241BFCB269B40E03BB74001CA85C0F8AD943F78FC97BFB8EA52C0D9A52EBE154181C007333CBD5B417ABEDD3720C0E1C6183D9BD602BF4CBA2E3E2F1A54BE8601A1BFCFAE5140793E5FBECAEBC13EFE000AC0801F20C0D0EF2AC0939F753F6E0386C0743106407F2CEB40B52889BF8A47313F722FEABE7C512BC031D7473F1ADBF4BE52E7393F9C78A340AF888040F56BB93DB5CD28408FCCAC3F0CD3C53E8AAA5AC0852F7C40F2B62E4093159840B1CF1040A0D800C0073E38BF8FF4703F508C05C0C025B4BDB07A1FBEFF86EA40DB6913C0264C81BF4D2FCABFCB01CCC0AAA5F8BE577C1EC02EC281BEE116AC3FE9452440135AB43FF857D23F9C9E2FC090709C3F18F5A53D3CC66EBF00B218C07235294099DDFEBFD1BF9F3FB311F0BE24635740163EAE4034857A40043FFC40837CCBBF1798D43F485E6F3F63EEB2C058FF5EC0F1361F400C6548C0B7C285C092CFA640EFF5F7BC392C71BF1F2D3FC05B08903F07E672C0014B963F28F2A4C0F88B35404AB2A73F9EA3DBBE028F68C0AFF22D4046C7D9BE55232940"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xF0556A3E0000C0FF0000C0FFEA64313F0000C0FF7BFC1EBF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF5A619B3E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFCEBB743E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF00D0B13E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF94A981BE0000C0FF0000C0FF1C51C5BE0000C0FF95680BBF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF79C1E43B0000C0FFCA537BBF0000C0FF0000C0FF0000C0FF0000C0FF54E42A3F0000C0FF0000C0FF0000C0FF74EA07BF0000C0FF0000C0FF0000C0FFD58AEB3C0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF65B798BF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF5659B33E0000C0FF0000C0FF1DEB53BF0000C0FF0000C0FF0000C0FF7AAA01BF0000C0FF354A123F0000C0FF0000C0FF0000C0FF7ECF733E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0A0EAFBE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF3936A73EB9DD003F88AC13BF0000C0FF4872A2BD0000C0FFCF7980BF0000C0FF178E163E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF3903803E0000C0FF0000C0FF4BE261BF0000C0FF0000C0FF0000C0FF0000C0FF12CDAABF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF39750BBF0000C0FF0000C0FF571FC33E0000C0FF0000C0FFA004843F0000C0FF0000C0FF0000C0FF0000C0FFB5B1A4BF0000C0FF0000C0FF0000C0FF0000C0FFABFC86BF0000C0FF0000C0FF0000C0FF0000C0FFDD6C68BF9A9F3D3E0000C0FFA5A7A3BD0000C0FF341512BFD7A5283F0000C0FF0000C0FF0000C0FF0000C0FF01F2ABBFD1E82A3FCEA92C3E0000C0FFEA1E4CBEED26593EF9ED58BF0000C0FF0000C0FF4D34693F0000C0FF70D425BF0000C0FF0000C0FF87D6403F9072733E0000C0FF49FE863FB04F263F8353A3BD0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF3B962BBF0000C0FF0000C0FFF452ABBF0000C0FF0000C0FF0000C0FF0000C0FF7197953E0000C0FF0000C0FF0000C0FFA14BC13E1D89E3BE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF7B98F0BD0000C0FFD22450BE19F653BFB9956E3F0000C0FF0000C0FF0000C0FF0654363F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFE08913BF0000C0FF0000C0FF0000C0FF0000C0FF3AA9593F6639593E0000C0FF0000C0FFDE638A3B0000C0FF4EEC863F0000C0FF0000C0FF0000C0FFC4BC74BE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF7D1EBD3D0000C0FFAE6FC9BE71B04BBE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF2114DCBE0000C0FF726D80BF0000C0FF0000C0FF2164AEBF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF47032B3F0000C0FF8C244CBE0000C0FF0000C0FF0000C0FF94B45E3E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFDF2ACFBE0000C0FF0000C0FF3AD45ABF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF7F812FBE0000C0FFFF433CBDDED07CBE0000C0FFF4CF183DBA5409BF40962F3E23A655BE0000C0FF0000C0FF280D61BE99E2C63E0000C0FF0000C0FF0000C0FF387EA43F0000C0FF0000C0FF0000C0FF0000C0FF7CD3433F463BF3BE0000C0FF8F4A653F1E4EFFBEE510503F0000C0FF0000C0FF0CADB93D0000C0FF0000C0FF211CCB3E0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF54A94DBF0BF69C3F0000C0FF6E61B4BD902120BE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFE9D001BF0000C0FF773083BE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFBA23A63DA0D699BF0000C0FF0000C0FF0000C0FF0000C0FFCFDEF9BE0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF39AB9A3F0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFA2FFF7BCBC489DBF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FF0000C0FFE800E3BE0000C0FF0000C0FF12F2E0BE0000C0FF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
