// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<2x6x6x3xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>)
    %1 = call @expected() : () -> tensor<2x6x6x3xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, f, 0, 1]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>) -> tensor<2x6x6x3xf32>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<2x6x6x3xf32>, tensor<2x6x6x3xf32>) -> ()
    return %2 : tensor<2x6x6x3xf32>
  }
  func.func private @inputs() -> (tensor<2x3x9x10xf32> {mhlo.layout_mode = "default"}, tensor<4x5x3x3xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x682E12C0CC6B913FA7C6ABC0375790C06AEB0A40623E7FC0F08D50404FF43DC079C67540C7EB13C018662D3FCA8507C0538281C02F062CC020C6D13F8543123FEB3876C06AE26DBF273204C0AE9E013F434F233F66506A40F8C605409B851DC0C38142407EA5A83E38C23CC0327559C082698AC027C997BFC0FA363FD61A754087EE8140D60F244070CBB54095CE01C0F4D4FFBF2C171C40B9A79B40D41D1CC0855C23C14C2DBD405070BF3F82792241AA1B00C0B0857FC05969FABFFDF1854017B421C0B6BD50C06C0FAEC044DBB9C0D56352C05AE3C23EF9BB1B40ACA2DA40265326C0253273C0BCA684C04A659D40F819FC40F1EADFBF93FB8A3FA8C2BD407C5D0C40ADCD67C0BDFCF0BFAD0E4740E28401C019851C4026F7033F4DF629408CC9BC3FD62645C02C40BE3F1B6BD140A95288BEE6D6C03EA6CA1A409053F3C0DAEA893FF38DC2C0E08786BF04E98AC0F215034091A8C4C0D2C6ACBF40C6DABECB6A8040DA65E63F8A3E92BF430A973E253B243FD7E18EBF9AA737C06229F4BFA4F982BDB34FF03E1039103FCA7635BFC80AC8BEDF79ADBF4B002EBFB75B3540633E7F3FD7D46D3F474467409B02F43F52CF7AC051832D4086F9ACC0199B3E40D51544BEB70ABA40490BF23FD86EFF40556E5AC0641F6740E79001C0E9CA8E3D9F0D753E8D4C1EC04BF950401D7CE13E3F9C243F44D012408B2A8D40293DF6BF8ABF5040FC8A08C098109ABF20E2F6BEA5EB1440D892C43DEC1694C057D89A3ED63F77403D58FCBF3F8291BFB48FCE3F03E8F3C0E452B2BFF9524AC07BB317BF55706EC039CBE1BED45F4840CC5CD0BDF8121140ECB1FC3F2AAFCF3EC412C63EA4021EC0A7E17BC01E81F6BF720B2AC018726FC01A9295BF69A5F93F61376940809C01C0B8BA98400DD7E0BFA8CE16C068CD3E3FA2EE443F53AEC040AB2FB5C0214EEAC0983213C045A8A63EDF2C10C0555038C01CACC6BEE2F58C3E9A49593FFE8A413F1F9F553F090C6B3F64799D401657BCBF6D1B36C0C0CCA8BF48FB4D3E5411B03F45EF5440C4BD96BFA3F91E40D3286BC08F9DB0BF909B19C086F079BE867B32C0BB41DDBF5CABF63FC83C8A404260EDBEF2751BC08B3A3B406534B73E6AF28ABFB354F33F0568713F1A40C8BC0161AEC04E14D53F85FF1DC0B31D70BF2DEF65C068613DBF6C493F3F1425AB3F031AABC03FDED73F0FD585C06DD701BFD57AA0C083635B406CF89FBE7DA39EBF7DD7C5BF68C1543FBC5AB83F4A5437BFE2550A40BF730CBE15799AC0431F12C04B834A3E62E2D840382E72BE46E1CCBF3C2D1FC061588ABF4843E73E3C3931BFE254BEC04A70AF3E098F49C059465FC076BC3D3F673678C0EDBE753DD57E6C4074C9243E0990893F354E36C0C45D83C098168A4008A862BE19CCA640348BC3BFCB6DEE3F22ADCB4094C2C3BE15CCF83E194A1B40D01D19C0900657C0739D0B3FC80798BF23ECF5C06006CBBE4F95164035C4A9C010815BC0AE6A5A3F872B71C0582C38C011BE91401844B6C0892A36BFC6B7B13F145FF13FAC357C4029A0A2BF2729BF3E198DDF40E8593D4017ABE03F6DC07EC03122B7BEA74FB03F490DD7BE79AEB63F799387BE54430E40FB8E4ABF72F1EB3F2596F63F690A2840F311523F5CC1C240A4171FC0F4A457C062B917C0967EBE3F98AA02C0FA04693F605332407EF9DC3E3EB36A40867D394090F5D0BE903F04C0F517993F83C8673F144F214013960DBF8D1AABC0F4EDBB4012B3443FE909693FE6D6124024BCCDBFC8F3B5BF0DE5363F063D1A40CE28D9BFD1D38A40CEBE4CC0AC778A409BD899BF9BE93C408A825440AC825C400BA982C08B72E9C0AA336D40853299BFE69F5CC0F011D53D4F22FE3FE04E24C0B8C499BFEFE0D83DBCAF963F97387DBEE7CB4C40DD4E4CBF16971DBE26F601C086176540EC7C6AC0118DFC3ECC8999403479B33F14CC3240CDEB2940946F28401D4B5840684644C0B59F343F9C6575BFBF64E93FFFF29040894A823F43FF813F8B4ED63E5CFA92C0CA651F4060B612C0AFCFDC3F0584F83F9EBE0EC0E5AC07C01BD48DBD4C488DBF9F631EC0B0D841408B27D7BF39E98B40A92943406046C1C0C97E913FF17CEABFEAFAC13EE2AD35BF154AB7C08EC590BF722BD03F9A9530BFFB0507C02BE583404E4F6240B7BD44C02C65AEBEF79C5A40131977BFC5EAB8C0BD767EBF96F625C0FEE92CC07E8555BFEE76743D403BD1BE524397BFA497A3407726C3C07483DBBFA916E93E50FB0A3F9B819EBFBC14324043B0A0C04B2C28C018EFA53FE02990BF6AAF44C0CFE2F6BF2E2495402EE12C40AD656EC09BB63CC06A0E21BF2AA3FF3FB06EB240E21000C084421FC0FCFDE6BFFAD439C0C79661BE021217C0C547C5BE5585A93F9175CCBEC53B42BF4FFFBABE23E0004048B644C014AAF9BE0D140CC1186003C05E6D04406A63393F562A93409B73B83FBF1FFDBFE46B94401462DCBF3EB4664041677E40E7DBD63F6B3592C0FBFB9D3ED0A90840D730D53FAFC310C01BB553404EAB74C0B75891BFED4CE13E0B50273F9094A4C091D9A5C0E4558EBF63182340996DD33FEE808C40DAEB94C0102E20BF80D29FBE06B3EBBFD32936C06CE8D8BF7A1F2DC0682DF5404ED2A53F002E4BBEE9B3A2C06354C53FBCB50C405299FEBF7CB7D7BF65CD58C002B2ED3EE347A1BFA3F0B5BF260BFFBF7AAA7EBF1910AFBEBFA8BF3F0AC68240273D8F40DB5F963E719C443DB33141C0236E64BE653E0EBF1E7F9EBFFA39F53F2B387E408FE8ABBF9A009640434FBF402C205F3F6130A9BF51F008BFA91D214012378D3DA4CF2DBF8445CB3FCC4C5BC052629940911E1FC08415F1BE800A6A402CC903402ACF9A3FDE268FBE56DFE33B0ED01B3F8DDE8C40B3738CBF830B97BEE12C09C04CF2CA3FDDC5F93F2CE61EC0ED9098BF6DC865BF7B15AC3F74E1F5BFDD4D83400DD4E6BFAE7012BF39F88ABED4748F3D660D7DC0D05790404FCA31C043616FBFFB0FB0BE501F29BF81B147404142A53FE8183BC01B3F833E61B5653F364BE5BE"> : tensor<2x3x9x10xf32>
    %cst_0 = stablehlo.constant dense<"0xCBFB51C0C1B5FDBE04DA8ABFA0D4A1407DD29D3E3A5F49C0443653C01F7C09400A5195C095E736401FB53FC0062CD8BF53B0273D5E95CE3E64808FBFA3AB523E73913AC0339B3A3F725EEBBF95C9D7C03FA50A3F6F70893EFAA5ACC0C6F803C0A8F60CBF9E7901C04A034DBF38253EC0783C19BEA524BC3F2D7A1FBF71C4B4C0267E6EC0F65583C0A4E894400C94E8BF86BD623F99494FC058B47DC03C9CCFC0DA2761C0F4853BC0A6E93A40331088C04E88C5401E2E96400578FBBFB04BA340C5353EBF397919C09F3FC54099725B401A99A5BFD3149D3F7AC6B6BD176C154012739AC04F747BC0F234F73FD49DCC3D384E0EBFBD8BFA3FA13987C081312DBF7EDD9D3FEC9D9240390C5ABFD7B556C039AC203F6EAD553EC2E565C031980B401475DDBFF592AE40AE6D76C00AD124BF69C05F3E14C32BBFCA9BA7BFC7F63B40B1A4E1BF018D98BF8798C0405AEBD9C07E5DC33F1E5C54C07E61984068DF40C0E0151E409A0C9DC0CFB1D6BEA9DCD8BF786321C0E72B4040C3802C40F5A87540AD92C4BF064090C06E369CBF57814B408AF0DEC0F6FD223E89AE0F40392145BF331886C0E7ECD6BDC11292BF651C63409A5E1A3EFB9D10402DA253C0176193BF296AB73FEBD9AAC0732E9B3FADEDBF3F37FC013F800AB83F906573C0C2F86ABD4ABABDBFB406B7C036D47BC0EFAE183F280ECE3F96A46BBD97C971C05D0E76C0F29CA040CB88B8BF3255653F8F2B7BC0C6200140C8AB6C40D63A67BF024630BFC79AFABF58712BC09B62D8BF86943940E69975BF4651E33F8E0F9C3FF06961406D7E02BF8110A13F86D7304096E79F40218609C0A62D50C08E289340930811C0B661473F556A3940D31D963F41A17540E530E740E8AD303F59EBD53F983882C0D757553F11BD393FDADE813FFACF74BD6C21E7BF54A1C8C0B6C9673E46BE8C3F7F8015C010C40140F2278140F3A5C6BF4FD9584021F2BE3F1C71A7BFD3A51EC053858BBF1E689EC0BC9143C00B3F61C0"> : tensor<4x5x3x3xf32>
    return %cst, %cst_0 : tensor<2x3x9x10xf32>, tensor<4x5x3x3xf32>
  }
  func.func private @expected() -> (tensor<2x6x6x3xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x3D7DA84226A5FDC09A73394196D64CC1FED5FD4107C130C285E1AA3F109E01C2F86B16C28A5482C0AF2DEB41D651F6407A18874189B51CC2E0D8F6C2FD1D80C19ED8804213513A42A1BDC64126F40AC2BD6892419731DF426F36F5C2EDEDE740B253BDC23A0A0A427A7EDB415E108DC10B505EC3CED3BC4002DFBB4200844FC2AB614D41C12DC54069E391C21E1C3B41CAFAE940044F48C2EB0DBBC23A2B3D412B3E51C1F2794BC2C61324424D94EFC2B3F5AB42435D0CC1A589C9C2C9F587C193866C42E3036842491BBAC162769A419F19EB42992A98C2665222C3F3E96E424F1436C36534A3C2B974F3C115D8264310F65442FA76E5C2AD8D5842F6D00C43C93DBAC2FA140FC2974D8DC2A14CBFC22B102FC3196DF6C27E0F3940319D55423C624742DF15D841DB6256411C4BDDC258CBD242EF5521C210D9E7418668A5C1978CD2C196A33E411840A6C2D5C8194327ADD14200724F420533A4420254B0424A07D6C2DB8DE8415F98C9C116BD0043D2F079429EB986C14F678CC1A7058942744D02C18BA79BC186DE20C2AF3498428F6210C3014DAEC063494E41EB0963C15E7F2DC2A3FA2B42EFED194241BFE9C2634DC7C1AA4B29C2A80631C2DD7539C182DA45C287C122428DF41D42754B7A4111EF5FC07C2946426313CC42B807A6C219750BC290F54A416E2C0143791DDDC0BB368EC113C53AC23075304283FD5FC2DE57EB428C4A8442C3F1CB4028A13242E54AB341AD9B09C35C7F9F420753ECC2CD5569418F39CF429FD2734296509CC2C6FD6D42B04FBD41FAE809433600A9C2A3BD3641FB40F1C156BFDBC1EE772342276DF241202F3CC275F80A42D7FD7CC153E73E41FA80B8C15C9437C19DBB0D4345C81D41FF54C1417B688BC26C88894298069DC2FF89C74170F648C104C942418BC26942235AEBC0123460C2DD496142D94350C1570288415622BCC2D4764941196642C204C018C33733DD41F0867F428C1982C13C431E417B449F42116F354170A2B5C2E790F64222F6F3418EE224C1A248AEC1B90CE1422BB3EDC19D2A833FDDB9A2C285DB9D425B12AD4151F69042D5628A4111F204C13CCEBD41473358C22BA306C14C0309C2DEFA7A414BCE4C42453C2AC26F86E2C2248394C2C782A0C2081592C21EC8C2C272D23D42A3FFD3C12AB064C176041CC2A41FDB42290F71C26B1DA9C1442EBEC14A7E8342EE8EB1C1"> : tensor<2x6x6x3xf32>
    return %cst : tensor<2x6x6x3xf32>
  }
}
