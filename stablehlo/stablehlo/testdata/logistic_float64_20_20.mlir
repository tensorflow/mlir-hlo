// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.negate %0 : tensor<20x20xf64>
    %3 = stablehlo.exponential %2 : tensor<20x20xf64>
    %cst = stablehlo.constant dense<1.000000e+00> : tensor<f64>
    %4 = stablehlo.broadcast_in_dim %cst, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %5 = stablehlo.add %4, %3 : tensor<20x20xf64>
    %cst_0 = stablehlo.constant dense<1.000000e+00> : tensor<f64>
    %6 = stablehlo.broadcast_in_dim %cst_0, dims = [] : (tensor<f64>) -> tensor<20x20xf64>
    %7 = stablehlo.divide %6, %5 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%7, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %7 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x32295C643AC7F2BF0D9B8D453430C4BF5AE0501519710BC07DF1DD0F640CF23F76AE77DA3659DBBF0888089A85300BC0AFAA80D7D9B1F0BFD4F2345B2C88EABF497A54E89607D4BF084E38465C41D43F6A5BD51C1C55E13F64847BBD15B9DA3F5E7EC012B737D4BFC6A1AD1D1665F2BFCDE153F8F35B18C00E961D379CFCFFBFED8F0D3B742DE63F5F3AEB2A43BDF93F0A7AE1D88AACFEBF6397957F0A3606C0E062F515EA89DD3F1762CFB8F3E2803F794406E6CF37E3BF63C83A4CD0BD09400C2A7EFBBFD411C0FA13D5A956BC1340DECC2D1701C1F0BF0A59DAFF8B6E05C0AE6DDB42C8EEC43FB42D50263098DBBFFD53CE22ED0F1540E60E8956619C1140108313541153E0BF64C2C8F746040F40FC1BD25CE12509C07ED09BC0445B14C0BE3A229BE968E43FECED7142E60C1040CC609B6532100EC0F0BA227962381640F9318F3A77CD15C015451968D1C6E2BF17DC3F0101DF0B406C0E5F04D43B05400E9733BF8F6F0C40B048D4BD50F61140C79F39B007E20640F55A8397BA300F407A3066F2F960FFBF838AEF0BB5A510C043421A5D0B560D40F83DB0CC5A2FBC3F7AC0950ECD54F1BF6B5CD07FF523D3BFE482CC95391112C0FEA96BE27E8CF9BFF665A283F3CA11C0EEEE7A6A2D21E03F6788F716EC6C11C0DE76E058DE11FB3F44958F183436D23F48614ABC77F3F83F62A360F2241EF53F5781E3561D48F63F849F4BEEBA54B23FBA754D9738D8F5BFE7E1F84689B1F43F704112179B65F73F92EE1116805F0BC0FA618F8B7F42F13F3A90BFB1C4450DC0D2C54EF126370B401EADAA281658FDBFE241E1B943ECE9BF99B3DE02E866F6BFB2F9F2CABB350AC07A19E6A69D8500C084B9971E2B0A1540794A831FD6C9034081605F425186FA3F86DF142E28B007403E06C11C642CFC3F076ABFC688CF09C08073145559930C408195D9010EE41140B64F9BC22DB7B63F0B317CA6F87A1840ECD5B01EA14902C07014F92F4BD01040242677291B9CF8BF0911C8C7E1910B4004ACF5605A4414C07A91B93D38B911409E9FE46753289A3FCC618BB328F803C070A77146259B0340DB47E068AB5713407F5D7773259EFDBF5D0981440D5801409E2C30E3657AF6BFB3A10A73924F04C05AF52EE9C38CFDBF7455221900EF0AC05A241BB9187F19C0C05EFB7484FE0FC048D0D219BE6E07C0D4C8A8D40997F43FDD49187D5F6EDBBFAC3411E4BAD2E83FC1C50B873B410740F7345A9A250EF53F205993C2C35FC33FFEB4A8E10F991A40C3B1F6AA5337F03F325BC5A16D7E14C0FE391D43E7B10EC05DC8B3AB7C5605C0615EB4774E910C40FA205BFC029212409863F1F08107134095B4F5EC7DC7FE3F63EBD668C687F73F0E8A8710CB210B4009EF5A9082C0114001CD93807C4F1240744AA0D54108F0BF4883F6D0AF53ECBF20D1080E5C8CF9BF324D94EAF4F6F0BFB607DBE9607300C02893ADBC3E9BF4BFCD83FAB8BD6611401194321B6887D03FFA0FFB6F5E52C4BFB693E25059101B4038540D89891AEA3F789C72B48A8A08402732AEF40C2612C0ABB298ABB686EABF16203173918101C00B58D36BA5AC07C0231899B58E0DE03F108363F93B1DF53F62B7EDBB9CAFB3BFCD60C891A7C716C0145BF0C6F86312401FD7E99AC8220040852584B75221104090454BC75B8111C0481EC0E3D78EDFBF26EFBB3A7FDCF53FE204CA3893A4024010FBF3F354DCE8BFCA3FABC25DF6C2BF5027E10646FB0240DC83239367B6144034C99C7B7258FDBF0010BB8E9E16F03F6BE3D5FF01E6F7BFB014F3B0F6D418C089EFE8879347C23FA3E9E0D3AB22E63FB03C2FCB2C3DFBBFF6882DA4836718C01E5B60B843E4DEBFB22C4FC8A459F83FF07CE36CD4260D403D776D1875CD0940F150F7D5DE2AFD3F6F138F26B8F7014036BB0575496A0CC099026E370C420740B4F102D4FEF81FC0E4361A1AC55F06C068D66C372F79F1BF2A74AC5637BEF9BFC31F310EA462F73FA45DCF8DFC4A1CC07A97A18D0DA2FFBF8A3C67D0DE7100C0025CC00B4E3765BF8AF626AB570F1DC08251F0E1C05B1AC090A9DD26F8221040AD27051C56E61140F0DBCF6D6B970D40FE5E9E43A8AC1740807F58E8032303C03A5CE42F9CE90240EA9D8F594C47E93FE60A3F5AFE77EC3F3251087701BE0B40250354C310FE0DC0EBF1F776673CF23F9EFDA5569F41E7BF70DB5B0F8C9F13C0C3B5401F1EF416C05EB24AB709EAF63FDB6B2104CCBC03C03BCD4BF0910FF7BFCF262F0578CA054077B6400D3379F33F1F77CF2625B211C030F16129C7A110C08F82D91870A4DDBF4A7193211A66F23FA62B1ACFB1EF15401492E34CF54703C0157724ADF44BF33F22ACF98B816EFCBF4FEF4C26C21C0540AF9ECA68BCE00AC01432F3FD06EDE73F2C188899A3D410409A4C3B9007D115C06E1B06BC6A22C83F90263F70D6B50CC02609E2B3DFFC20409E2AD913F15614402A6BB61893BD10C0F2C206F2E01DFBBF66A61EA92864F33F8EA87784420118C0A346E41E425EFE3F4FDF4A436D266FBFAA47AFF023C5B43F9A561FF8B04C01C0FD6A488EC46913C0AB8831A1BF15F1BFAF54A567FEB10740FEEE445E32881840BE31323DCE1EFE3F6F306ADE0023F23F38653CBCB1CB0B404EBD951BCAD3F53FC2D40A5F5470074040C5A5AA0FB7B9BF88E0ED7E20690D402CF960FBDCDBF03F888DB0CE1B970F403A209AB7A7DE14C06E0E49D7DFA1FD3FCECCA641258296BF23B86C9D000F07C0CE78A05E85400B403DEF9C77DD15FDBF57F3EC88F6EA1140FE4A5D4E3EF519400C5E1D56CCE91640C74186CF026302C097AAF8D9415C01C0A149C8D8162C10409874E932AD190140C17C66AF86F80040EF88FA2C3DD40BC07A38B00F607E05C0AAB2E72E18560640BBABDF726323FA3FCA4313532326084077B735E2C3CC06C0FF908C03CCAF0B4098D8264B6576E6BFCCD035FA0335953F9A87C90310A1F9BF9C66A797568CFD3F8AADB58388041A40E8C9319D10E202C044998BCF3FFC01407D391AF96FDC0240B0978B06FB880D407C8F323D9D3800C0F326E930847FD03F18232A917F1BE53F343C30ECCFC3D7BF3C2187B916D20640A2176C902BC100C0A4E0928ECBC8EBBF7098F05BFDB9E6BFBC9E2E96D3D9593F7E0CD439A3C30B40620A3F720C28BCBFBD09E2FAA93B0C407CC64E6906190240BA395304C3A1D43F86193502F71DFE3FF3C9291547270DC0D142F1A31C9A0840160E80736B210B40E44501301C8509C0B4A1BF841CA904C05ACE49B3D8BA01C06CC59D50841204C02038FE177D44F4BFB60CEED4558808C0E2309F3BF4A20A4080C28AAA202AE73FCFDBEF4DBF660E400E9A5DE2077A124044571E332F4C0BC070349C08D217D33FED75B0EEB60011C0B34E97BDC7EEF4BF5B7F9D4961F1EEBFE666AE40153AF9BFBCC80D1F74CB0F4064146D47A257F8BFB0E182E41638E9BF6872FD971237FABF13893A5D4161F13F13527A636F200E405A08C47B9946C6BFC0DEDA0DC71A09406EE86F9FE65AFE3F53A9B45849DDF53F58B10FA6600D0B40D82621914AA413C06B1E379DD556C33FB69AA2E166F314C0E0E8378890A1E9BF1255C2217088FE3F21C75000B04EE13F52D6F09CC129F2BF0606408FD3B91440996B91280B93FE3FAEA365A7FCBFFEBF4A8CDFC64BE6F3BF5E1004484BDDEC3F0552FD8CED9405C0C83FE02E4554F1BFAECA85DFD6AEF13F2BBB0DCA5A19EC3F583CB662FDC2EABFAEC499CFF6ECFB3F70831619BF790CC0A68409A5BD4EE8BF3C9DC576EDBA08C016252C0264B70A409E345EC9090BE13F503ED59074B90FC012DA8FD3D56DFB3FBE0350DE901A19408A7822C8FF98FFBFF07E45990EDE0DC06750C78281D3F4BF39F788F4BB74F5BFC2BE48EA5ED2114001F67494AB62C1BF69233DB04C610140ECD8B0869E2CEFBF1D3BAD0D81D3F73FA296A7CFEE360DC0FA5A175C491FF5BFAA4833755A13E33F9DA1BD7EE6D8DFBF5CA79548F554DCBF516EF0D81DF0F03FC48660C5FE6DFA3F8AE2545D7210D8BF04EE87788A89FF3F6674FF9DCBEBDC3FB38B6F8E26AF0D40C035CE1DE1D300C01EA90DA6290E19C03F37F3334306FC3F2E5DCE7499A300C0508808FA796901C039E474E95671FCBFEC78D3F9CC6C194062475172937A0F4090C93131730F03C031E417B8E8DC17401C1C88EE799416402E0B0A596AB802C01C67121FCB83FC3F60A3A78F529A0DC01C4C847CAE5F0440E96B932532CE06C0BD97E2E4A431BCBF6207B27284A109C090BFA73B1016C7BFA882F6E5B53CE13FED313A6070070040CEE26948695AFC3F62B422678512FD3FBEDF50BF99D9EA3F16B2780708B9F33F143727D73F7BDE3FDADC21772F9EF6BF2D4F6BFFC5CEFD3FCB0A56E3C65712C080F872FF836CF63F1EB33CE3973FE8BF0A71F2A07A620340D4192D5F4D1511C0AA4C5F88886E18406C258842883E0BC0C46B1595212704C07047646325070F40ACCA9B6FAE0700C0203322F9D5930C40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x45DBF823BA3BCE3F4F34D5734F7BDD3F5437CED3F50EA03F99513959D82CE83FCA19AE62DA43D93F6FCF371E648EA03F0055626CE0ABD03FA6806AE6F571D33F393491D67608DB3FBF10BB37D082E23FCF88CA46EE3AE43FC40773A5EC4AE33F90A566B0B9FCDA3FD11C7F1344CACE3F3DBA12E11F85623F35C5576BC789BE3FDA7B7D622755E53FD5E8509DD5A9EA3F239618324968C03F4D6F17899902AE3FFEE48F3BCFA0E33F76BA73EDE210E03F92244FF774ABD63F0520ADB38FC4EE3F40E31D52FB75873F7F70B32A74C5EF3FE05416F435A0D03FB7854C4A1171B03FDC97B3EF2D4EE13FB4A20427D034D93F7339C1AEE4D5EF3FBB5C67F5E89CEF3F8272CAF4A102D83FC2609F1EC759EF3F37E58F109B2BA53F751E9DDD2F17793F203F096AADEFE43F28C1EBF9776EEF3FF15AEE420359973FB2AE5BD66FE0EF3F48D8F5B6D382713F3F0B6B1941DFD63FB64BF319170CEF3FF7623D948AE5ED3F8C5A3838401CEF3F133BA23026A5EF3FA005A9896B44EE3F931E4BA0465DEF3F9B898A453393BF3F280E3983A66A8F3F9685AE61E333EF3FBC47D59940E1E03F77F8E8AF842FD03F9054B8520F40DB3F5242B66E4621863FA44788D8168FC53FEEF338B00FAF873FB6A1CED2FAF2E33FABB3501DC8EE893F0CD76BB5E305EB3F85E044E4DF42E23FE1762925D470EA3FB7873EF4C840E93F327FD175DBA1E93F49291CCF9592E03FBC8BA7256D08CA3F94D000A75D1CE93F0FDAB588F6FAE93F32EC8A775031A03F1F65F21F51E1E73FEAF6BF4462B6993F6DF286DDEDF7EE3F95EDB1B02DA2C13F7E99E61A29B4D33FE6F949486551C93FC93316CF6CA2A23F71955CF431CEBC3FF135FB36A8D5EF3FDAA738CA3583ED3F6C408DD8CCE0EA3FE600A844CD6CEE3F9831894B5A4EEB3FEFDF0387328DA33FF23286951620EF3F6945A07188A3EF3F073825EE9AB5E03F921ED10608EEEF3F271D63B385A0B73F6116E7956087EF3F7B541A27B5A1C63F1FA548EA0403EF3F18EC2A49A3A7793FB9976521A19FEF3F3A8364EC4F34E03F16C8BF660F7DB33F54EFA5FDB075ED3F200F3F0F74BFEF3FE71C91B70360C13FE24923DBFEB6EC3FEE3EC851B038C93FECE9E013DABBB23F3AD8C3365A70C13FB5364B199613A13F0F3CFFDCA1E35B3FAC21A67F546E923FC3DA59A1EDF9A93F499C20756513E93FCDC31763CC3ED93F5172C52689E9E53F83358E338657EE3F03BB5396743BE93FDC8CF7136535E13F505CDE5268F5EF3FE497360A857AE73F34948069AB3F783F0CE40278CE9C953F1FAB4CCE939FB03FBE495EF4DE1FEF3F3039C574D7B1EF3F5FB5D1FD3DBAEF3FEC0BB6E6EFEBEB3F5BB20E805F05EA3F9C15873840F5EE3F5D80FA1A4EA0EF3F1F38FD16A6ACEF3F257A026FD82FD13F40AB9E5BBCB1D23FDA7655DF3D8FC53FD0C94BE9D776D03F58AD6A98AC08BD3F301EF3C8B5ACCB3F555E9E24A697EF3F3EF6ED5D010EE23FD5AB53FF1077DD3F1D59662992F6EF3F467EE9E2C42FE63FEBFFD31DC593EE3F99E1D6C76DB0853F980FE6FC9372D33F93CC899AA1CEB93F975DA386B13DA93FD8A7A44B5FEEE33F5B80F16B7B40E93F065055EA2DC5DE3F970B3BB9B5746B3F6175138148AEEF3FB2247BF0003EEC3F5B5191DE4A71EF3F3240D1403B6D893FF08FABAF3D44D83F8BB1294E477FE93F66E2DD26DD29ED3FFCCEC2B5C828D43F49C535C14FA2DD3FB593A42F6545ED3FBAB91A6B11D2EF3FC3CEE1F5D5A1C13F4BF3CB09B76DE73F69CF1594CB78C73FCEEFD9D8BE75603FE88FBE3AFA23E13F5C0BA3CEC152E53F44FADEB01ABBC33F853B671D0450623F0FA44DFB716CD83FCB883AE31F44EA3F2D8444CF3F2FEF3FA6A8BBB1DEC6EE3F82C799A6AB8CEB3F54A4E11009F0EC3F980F052F3E8A9C3F086EDB34AF57EE3F4244E9A3D820363F12176A958E70AD3F4D28FBD01414D03FCD3634219A57C53F07F467A10EFAE93F037DA45042BF4B3FC2B3D0A24923BF3FDF9D4446870DBD3FD8995D5964F5DF3F0BD380A8ADE8463F70AC5E03847D563FA7CCAC888471EF3F139B3C89BCA3EF3F06FEB05F253AEF3F90622C0508EAEF3FDEB0A1F36D72B53FD6C53E33DD3FED3F8579A8DDA102E63FB7B179F1A1AEE63FB033858D3F08EF3FF238D1E8F08C973FA8E3AEFD873EE83F6D1D16DCA4DBD43F15872E340A1A7E3F92E10284014B6A3FE1EF89EBDCD4E93F39A807425004B43F9E024A1EF57DC83F11F67F888907EE3F65C14EB18BB0E83F97BD2940F841883F33432D2D18898F3FF02A129D17B8D83FD5AFF1F9CD4DE83FD42F6DDD1FDEEF3F8D244FB45D18B53F322E196E8CA0E83F557AEBFEC284C23F6D76FCE3DBDDED3F85DBB66C1D31A13FEA78F135B2B7E53F371A8A6DE187EF3F2405FEA85173713F1CE65FD70281E13FB6C1A8E1BD889B3FD7823BC552FEEF3FC4606E909BCDEF3F865B895723B48E3FEACA66DBD5DBC33F0E4FAE3B1EA9E83F2CE11A471B3B643F71E4739B4ED4EB3FB73499CA6CF0DF3FA24607CE11A6E03F8D3B017A9969BA3F83F801E859B67F3F7FC16A2E5A5FD03F5E3E5540256DEE3FA2CC7DED42EEEF3FCC440117D7C5EB3FA05ADA183035E83F674F455DD909EF3FFB366FFB747CE93F1AFAE062AF60EE3F40A3247FE764DE3F1286D106BC35EF3F0C5C2D3C35BAE73F70E456780F65EF3F975FB3B7E515763F81A891EDDEA8EB3FE25D8858F8A5DF3F138546774D27AB3FBC7E158318F9EE3FAC2A6BD579E1C13F444ACCD125A4EF3F16C92F9992F3EF3FE4F7280A71E5EF3FCE0DB976D25CB73F687CCB10A63BBA3F38F2225FC272EF3F2C215D2FBB9FEC3FF92C2F252393EC3F5D032DFC03A59E3FE296F182BA52B03FD5B54409DD26EE3F4685ED36FBC5EA3FA24AD63C5282EE3F13A6B4094EFFAB3F2C847D6F9306EF3F77707E2B5235D53F85A99BA4692AE03F873DDD271578C53FE4E768B7CFA3EB3F38D69DADC1F3EF3FFAB097001614B63FBEA437239AF1EC3FA28AD49BB63BED3FDA912FB9C738EF3F58915825DDC7BD3FC93EA508090DE23F077014F6EF17E53FC2368F144920DA3FE383C0962441EE3F8D0E59660512BC3FC603147060EBD23F0EF5F0D76817D53F9B86673A3B03E03F20BB2079E808EF3FD92E9357F33DDE3F48ABA1869216EF3F5B5E0A317DFBEC3FDBACA8AF8F8EE23FC979EEBBA5C5EB3F243E90AD99169A3F49D485246896EE3FCF2CFA2B34F5EE3F52E8BD371B3FA43F4D3C9EED1BFDB13FC0890455542AB93F3905BEBA0F42B33F44C7E2490823CC3F13AFD9CBAEC9A63F642E350FCCE4EE3F8484368A038DE53FCAAB6642C74CEF3F5D1ABCFA01B0EF3F85C45EB35757A03FCFD82F717C5EE23FAD92CED051C88C3F49A73E021E3CCB3FFA1FBE248FA1D13F8F40036B0CECC53F10B339F3E568EF3F145D13EBDDF1C63F063CC1E14401D43F6A556A0F97D2C43FAEC03D8FF1ECE73F6C9B34FBA846EF3F7F2C3DFCF738DD3F33F87F8682ABEE3F56B4A1B48BD3EB3F634911C1887FE93F92DB7493AAF2EE3FC3F4B25CAEF67D3F6428F601D734E13FBC73FB3719A5753FC405EF230DD4D33F41905924D5DDEB3FAC59B1F06F39E43F0186660D4D21CF3F765C1F6D38D2EF3F76E6F45B37E0EB3F6FD89DD0EE56C03FFAE3ED9018A5CC3F5B061B867CC3E63FA5B52F49DA27B03FB8EF2061EB2FD03F25EAEB65140AE83F4DE1D5730D9BE63FBDB7D03B1D59D33FA2382635633EEB3F55BB3D9CD1549C3F407F71BC1466D43F86E875548641A63F7304294783E7EE3F3F5288D1AF29E43F0029CA88240D933F872D6D71DC1DEB3FFF0842A19EF0EF3F5634ECF5C632BF3FB669D1CCB0E9973F23A66519BC60CB3F0B160B0B4E8ACA3FBB041ED5F0A1EF3F02FA731985D4DD3F26AB27A965BAEC3FEA2E6638F389D13F68515861401CEA3FE7AE9A6407E5993FF1EDF9FB56FBCA3F8274FC23EDA1E43F75386D4BD132D83FF9EDAE9FCD07D93FC22CDE9AF6C1E73F2262DE493FDAEA3F654D77C4C70DDA3F831AADEC5616EC3FB7D048610A8EE33F3A74C9F55E3CEF3F7328F7D2C7D7BB3FFCEB6B4785225F3FD2E8F8B9C644EB3F83673E80EC6EBC3FC08391C1D714BA3FD8C69916F581C23F930EA3F0CDF1EF3F1DA6E9AAED62EF3F0D1762C4ADA2B53FA63DCE370AEBEF3F17E99F5824E3EF3FD714343B017EB63F4A6DE27A1164EB3F2C6E90AA93B2983F457440D2DFACED3F74D9A5B592FAAB3F37C130475A3DDE3F3335CFBD7EFAA33F4D4DC0FC3C1FDD3FDB1F3D4E4135E43FAEBC7E099C32EC3F9F03B5DFD359EB3FBA6201B8D386EB3F488679993558E63FF3EC53D3F3C6E83F1945A98060BDE33F8221B5E2820BC93F7405404D5BB3EB3F2EB4E592E5AB843FD2E50F326EADE93F21D7E157A96CD43FACEC68A7EE64ED3F6F0C43B5AD378C3F0394F9EFCFEDEF3FB4E396636C72A03F4740AEC45D14B33FE516927A015AEF3FFD48A2C74F6ABE3F2ADF5BD62320EF3F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
