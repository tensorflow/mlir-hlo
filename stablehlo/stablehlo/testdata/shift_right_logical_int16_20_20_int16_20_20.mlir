// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.shift_right_logical %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFEFF000000000100020000000400FFFF000005000000000002000000FFFFFFFF0000000001000000030002000000FFFFFDFFFDFF0200FFFFFFFFFFFFFAFF0600FFFF0200FAFFFEFFFEFFFEFFFCFF0000FFFF00000500000000000200FFFF0400040000000500FCFF0300FBFF000000000300FFFF0100FAFF0000FFFF0700030002000000FFFF000000000200FEFF01000000FEFF0000FCFF00000000000004000000FDFFFCFF0200000000000300FCFF0300FDFF0200FFFFFEFF0300FFFF02000200010003000000020002000200FFFF0000020000000400FEFF05000500FDFF01000400FDFF0100FFFF0000FDFF030002000000FBFF00000000000000000000FCFF0000FEFFFFFF0200FDFFFDFF020000000200FFFF030000000100FFFF0000FDFFFFFF01000200000003000500FDFF0600FFFFFFFFFEFFFFFF00000000020000000000FBFFFFFFFFFFFBFFFEFF01000200010002000000FDFFFBFF0600FDFF0000030000000200FDFF0000FFFF00000000000000000000FEFF0000FAFFFCFFFEFF01000000FDFFFEFF01000300FBFFFDFF0300FFFF030001000200FDFF02000100010000000100000004000200000001000300FFFF04000300030000000000000004000300020000000300FFFF0000FEFF0300FFFF00000400F8FFFDFFFEFF00000000040000000100000005000100FFFF0300FDFFFFFF00000000020000000100FDFFFFFFFCFFFFFF05000100FFFF010001000100FEFFFEFF0300FFFFFCFF0000FEFF00000000FEFFFFFF0400FDFF000001000700FFFFFAFF0000FEFFFDFF0000FEFF00000000FFFF02000500FFFF0100FDFF0000FFFF0100030002000100FFFFFDFF03000000FFFF040000000100010003000000FBFF000000000300FDFF01000200FEFFFDFF0400000000000300FDFF0500FCFFFAFF0400FCFFFCFF02000200FFFF0300000000000200FFFF03000500000002000100FFFFFEFFFEFF0000FDFF02000000FEFF000003000000FEFF00000100FBFFFDFFFFFFFCFF0200FFFF0100FCFFFEFF010000000000000002000000FDFF0300FCFF030003000000FEFF000001000000010000000100000001000300FCFF010000000300010000000200"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x030002000100000000000200FFFF00000100FEFF030000000000000002000100FEFF02000000FBFF0500FEFF0100FDFF020003000400FDFFFAFF00000100FCFFFFFFFBFFFFFF0000FEFFFFFF00000200FCFFFDFF0000FEFF010001000400FFFF0000FFFF0100000003000300010002000500FDFFFFFF0100030000000000FEFFFFFFFFFFFFFF030002000400FFFF0000FCFF020003000200FDFF0000FFFF07000000FFFF080002000000FFFFFCFF0100FFFF00000100FEFF0400FCFF00000200FFFFFCFF02000200FEFF01000000020000000000FFFF01000400FFFF010004000100060004000000FEFFFCFF0300FFFF000003000100FEFFFFFF0000000005000300000001000000FDFFFDFF0100FEFF04000600FFFF040001000000F9FF0100FCFFFDFF0400FCFF000001000300FCFFFFFFFDFF030004000000FEFF0200FEFF0000000000000000010000000000FFFF010003000000FFFF000000000700FEFFFDFF0400000001000000FFFF00000100FEFF0000FFFF000000000300FFFFFFFF0300FFFF0000FFFF0200FDFF00000400FFFFFFFF0000010005000100FEFF0400FFFFFEFF03000300FDFFFFFF0300FFFF040004000000FFFF00000200000000000400FFFF07000000FFFFFCFF0100FFFFFDFF0000FEFF0300FFFF0100FEFFFFFFFEFF020004000100FCFFFFFFFEFFFAFFFDFF0300FDFF0000030000000300FEFF0600030000000100F9FF0400040003000000FEFF0000FFFFFFFF00000100FEFF0000FFFFFFFF0400FFFFFDFFFCFF0000FFFFFAFF0300FEFFFFFFFFFFFDFF00000100FFFF02000400FEFF000000000200FCFF0000FEFF020000000200000000000100FFFF02000000FBFF0300010001000300050000000000FDFF0000FFFF0200010000000000FFFFFFFF02000000FEFFFFFF000000000000FCFF02000000FBFFFCFF00000000000000000600FEFF0100000002000600FEFF0000FEFF0000FFFF0100F9FFFDFF0200030001000200FDFF03000300FCFFFDFFFFFFFFFFFCFFFFFF00000000030000000000FFFFFFFF0000FEFFFDFFFDFFFFFFFEFF00000100FEFFFEFF0100FFFFFFFF00000000000003000000FEFFFEFF0000FEFFFDFFFCFFFEFF"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFF1F000000000100020000000000FFFF000000000000000002000000FF3FFF7F00000000010000000000000000000000FF3FFF1F000000000000FFFFFD7F0000000000000000FEFF00000000FCFF0000000000000500000000000100FF0F0000040000000200FCFF0000FF1F00000000000000000000FD7F0000FFFF07000000000000000000000000000000000001000000FF3F0000FF3F000000000000000000000000FF000000000000000000FE7F0000FDFF01000000FF0F0000FFFF00000000000000000000000001000200FF3F0000020000000200FF0F00000200FF0F00000000FF0F010000000000FF1F000002000000FD7F00000000000000000000FF1F0000FF7FFFFF00000000FE7F0000000000000000000000000100000000000000000000000000000001000000000000000000FF1FFF0FFFFF00000000000000000000FBFFFFFFFF7FFBFFFEFF00000100000002000000FDFFFBFF000000000000000000000100FDFF0000FFFF00000000000000000000FEFF000000000000FF1F000000000000FF3F00000300FF0F00000000FFFF010000000100000000000000000000000000000000000000000000000000FFFF00000300000000000000000000000000020000000000FF7F000000000300000000000000FC7F0000000000000000000000000000000000000000000000000000FFFF00000000000000000000FF1FFFFFFE7F000000000000FF1F010000000100000000000300FF7F00000000000000000000000000000000FDFF0000000000000000000000000000FDFF0000000000000000000002000500FF3F0000FDFF0000FF3F0100000002000100FF7F0000000000000000000000000000000000000000FBFF000000000000FF3F00000200FEFF0000000000000000000000000500FCFFFAFF0000FF3FFCFF00000000FFFF0300000000000000000001000500000000000000FFFF0000FEFF0000FE7F00000000FF3F0000010000000000000000000000000000000000000000000100FCFFFF1F01000000000000000200000000000000000000000300000000000000000000000000000001000000000003000000000000000000000000000000"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
