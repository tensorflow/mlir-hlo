// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<2x6x6x3xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>)
    %1 = call @expected() : () -> tensor<2x6x6x3xf32>
    %2 = stablehlo.convolution(%0#0, %0#1) dim_numbers = [b, 0, 1, f]x[0, 1, i, o]->[b, 0, 1, f], window = {} {batch_group_count = 1 : i64, feature_group_count = 1 : i64} : (tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>) -> tensor<2x6x6x3xf32>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<2x6x6x3xf32>, tensor<2x6x6x3xf32>) -> ()
    return %2 : tensor<2x6x6x3xf32>
  }
  func.func private @inputs() -> (tensor<2x9x10x3xf32> {mhlo.layout_mode = "default"}, tensor<4x5x3x3xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x001A4FC0E5F0373F9D7CA0C01F2761BF64627440BFF37FBFA18EF73E86DC253FD797B0BFD765C2BF31B58840442A2AC0809F81C055E38C4099FA1E3F091D9B3F25C05D3F287C74C07514C0BF55BBCA3FC232ABBF7CD961C0DBD6F63F9C1F94C09371E9BFE720EFBFE0ACA840665D8BBEBED95DBFE3F38A3F60DB1C40ECA58B3FFB203740D2E2EBBE4369F2BF98931D40751EB2BFA219603FC93CD33F40212DBEDCE283C0081A81C0735114BE49B391BD18D1AC3FDF254640B6CB20C06F28BB40993B804075A1D0BF95F0A2BEF2309FC01D71BC3F5AA2AABFA752C8BFD16BBB3FB9A86440EAC623C054BB6E3E3E1CB6BFC9FF8BBF16E0FEBECD2C92BF81F7FCBE07D92DC09AC09C40D086AF4023B8F03F44903840D6016FBF4D158DC04F3A0F40EB720F3FB59B8D4049F82EC0E558944088ECDBBF19A1463E12188940E0313240CE2AC0BF1A0738C0868F8540735104BCDCF7663DD793CA3F425A0AC0D929C3407C6950C0287789BD93DC19407CCDAFC0A78C673D42C70BC169633BC00F3329C0E3E47EC07F3C383F1DF5C43F8AE2DB3F190CB5BF2CDE3BBE3352EDBFA436373F08B2BFBF23850F3F6062A23F77479A40973986C0B6146A401C1323403FB388C08F640C40F53F5B3E27AE1BC07B6F52C09CC15B40E9C8FFBFAE9DED3F63C5C1C0AD728AC00B97D43F0C5591401FC0A83FA56044405205913EB3D73E409A3605C02DC9DDBF86CE2EC0879571C0EA0564400A69B73E96FF41BFF23A2C40E2B7F4BF198DD73F3F41D93F71B35F3FDC2FF4BD24D6ACC0C93E4CC08934B7405C9EAF3EBB0BCBBFB316C33FFB5409C083B6494050D55740EF63713DE0FBC53E134109BF2D7B2D4027D98B3D8989B140296841C0618BAEBE0173B93E8B13F5BEAAB205C12411D33F13CE85C0765FB6BEF91976C0560317BE71FFFC3F53C1B4BF641CF93FD3378D3F6B670F3F154CA9C0E724ECBF53BAF93E8F64F8BFE159AC406E19D9BF77B79B3F45A069C0AD8E27C0F09A26C0EEDB14C0858F813FB5E0843F4ADC8BBFEF7D8B3F4164E540748093C095D68DC064AE8BBF5A2CC2C0B8891B3F2BFFF53FAADF71C01373B0BF8F7B8540E30F21BF1BFF05BF65FB86BF8B9EB43E021B0FC136A5143EAE8B2ABF862A4B401D5E98C09E853840DE1D393F9BD8B53F7EE99B3F2C24D9C0CE99A7C0AC1BBEBF0D55A6C01C1F99BD16FC7BC0922131BF7DB34440CEEB68BD2131ECBFF11EA2BFC6B7A0BF96F60FC06ED3623F8A22A03F6DA89BBFEEE6B4BF06B9D5BFF0C506403A242D3FA9836640BEF7654089E413BF695254402403693F6559D13FEBA5E9BF7F122A40D993A2BFFFA2DFBFDD0B50C03599574093A36BBE8537D7BFE64D1C3FA8E939C0BC4ED93FC97F813EEAB91EBE6D2C5E40E533EF40A48D943F3ACF2540F7B904BFDC3407C057CDF13EE53787409F1F1BC0CFD1C2BFF6569CBEFF572A4059263DC02C7C42BFB4E10FBFA5209DC0D7CC75BEC2E9BEBE39903B3E6D82ECBFA69952C084683C3F772E49C03EA5BFC0F607A540FB11D63FB9D866C0F6C214C0512E3B3DFF3B84C0EEB3AA3F85663CBFCDF2C0C08807D1BF045A5FBF84191440C54CC3BFFCDE7440A97B2DC022AA45BE8DC0D83F345067BCE14055C096200C40FCA12340E9D60DC0ED90B4C00E3571C0424A08C0F03623C057E14CC0F0A29740F6B1DCBFFA1985401D9C3AC0163D13BF7305A6C0C0628B4062A43EBF46D27F3EACC72ABFB64D51C0E4132040DE96C93D27699AC04843B5BDA22EF63FE46B8BBF182C1440C863E9BFB7A788BFB2E680BF8219A0BE270D8C3EC5CC56BF95AA9CBF9A697D3FD5899BBFB754813F2881CAC09CDC1240708D91BFDAF9B9BFF412A9BF87E16B3FADD7363FFD37DFBF4A4756405410BABF26DFAF3FF8CFC2C09E438A40C24417C0089B8A40740C8CC028894D3F2E2E27C0951B0AC0D96C93BE10D986C0E19B413F69D6CF3FCF0E8840F8A8C3BE4C5D2EC0C9A6833F9E487DC0165276408D13853E9920BDC0F846DFBF4B398CC0569A733FE61A594038F2FABF0F857F3E19EC0140E601CABEEB3793C0060340BF30381A400E4903C045DA933E5B6C31BF8D2CD1BFA01C01C03E557B4054FD023F9F86CCC08AF5433FEB0FD1BF0F0912C0024D3840D75320BFA4C9B0C027A3A63FFBEBF6BF70FAA740F911BFBF22B34FC085E18D408E488B3F545653C057583F409F16164060662F4036A4263F1FE16C3EF896E5BF0D5AA53FF58781BF4A373C4003E7F63FCFB62A407811883E25A42440FD6D76C0024B94C0CA632E3F505A5440C5885F4023D97B4061149FBFA3A0A8BFC29CAA3E2DC27DBCD11990C086CC15BF3F7089C07D904AC0C65473BF48536C3F177A3440F3A30040AD0A6BBFAAB41D3F6F8C674089D5AC3F1CBE81BF676EF3BF4B0F55C0DD0EA840810CAF40170DC0BDD9D654C04DC182C0F46943BF17A72C40824202BE074A9BC015E41ABFF9B196BD98A485BEBE4C0BBFBF454B3FC0A40B40DA3485405BACF13FE4399740AD9C9C3FF9C273BF3E96473FAD5801C04B1A6D405EFDE43FAD4A563E935B2840385BB23ED04EB43E12FFB93E50415DC0CE290540BA334E3FAE1C7440E4BC923FE695EF3FEA3A18C0ED0D1540C655D2BEF93EE5BE2D49B13EE73A56C0E725783F88F47ABF27D5E4403C62A4C0779A3A3E4E7DAE3E46E825C0B74000C0686C8D3FB725E7BFF234C6BF14F0B23F737A233FF317A0C08E29A440F4DB7C3EE0350AC0C2C93E3F65FB2D40B20FD040ADC7863E73E86AC0E82F78C038E838BD62FEDFBE031E97C0ED870EBFEB132B407E7D6FBEAEC2934006696F40D85799C082F09C3E42EEF33F7B4D753F91059240111068C0E4D21440E235D63CFC2400C041DBF93E80E4373F340CBA3F0DF0373FE458933E2AD53140A5C522C0B0995B40826EAF3F6D3241C03641F33F50DF1FC02E433BC02D4AAFBF1950843EC90141BE04F070C00227AABFC40D3FC0B7EE2BBF066FE43F1F695CBF685246406F6BB33D9C4C07408A73113F74F78CC0C61F4F3E080D27C0EE7E3740EDA17FBF"> : tensor<2x9x10x3xf32>
    %cst_0 = stablehlo.constant dense<"0x197B73BF2693AE3F762C75C010D69E3EBC91E9BF36C5BEBE51588A3FFE73B6BF891F0440651BD04001860040061BB4C0A56011C07B087840B6098E400CA7D440F1E7A0C02482ECBD571C0140DE0915C08BE6C4BE964B82BEF0F2AF40D45288C0F8903040DDF15A3FCF4363BF033949401AFD903F0F21ACBFAD31C140E6EC1CC0760041C06C3BEE3F01DA6B40396F543F0BB4A73F5058714086E817C0419763C01E473E3FCF7274BF94174BBF82145E3FB62EF13F622E5DC0F4318F40FDAB6A4051B01D404D610DC0A9D7BF400699ABBF88BADEBFDCE663C0D3F4BE407CFFF7BDE28C39BF2BC0A5BECD32093F24BEBA3F5D329A409BDD0BC02C2D09BFF89D7B3F7AE3C54063B955402A98DD3F3B927C3FDAA79EC093A605C0B5E44640B120B03E8452B6405EAF61409CE8E3BF798607C10E1FBCBFB0A4803DD6D9E23FD3333640FDA50ABE09EEF5C0A8369EC05939F8C03F2BC83F9B72C8BFF9567CBF12D83840CE149F3FB930E9BE189A2AC019E4C6BF36C8183F769BCCBF1F6C9340F011054069E7D03F61A55ABE5AD9DEBF2F079B4086D3A73ECBB40FC0CD32F53F81EB5D40D8CE6A3FBE8127C1E7F0AFBE767E1D404051CC3E14A898C0EB128E3E229D2BC0EB654540E7D020C00F8CD4BD64848A40356F97C06B52A1400A7317C0C3DA8E3FA5D937C0E77F504097F4A2BD8B4881BF37F44D405248FD3F24DC08400D2FFABE11EDACBE444C6EBD650494BF849256BF6591A4BFDA4DB6C07BA221BF5DC13EC0BB6627BE649B6FC0D5FE5FC05FBF05401176893F6F7EC2BD7619813E50885DBFF66106C0336C36C0CDCBE53F35AD443F579FF73F921EA1BFDE6D003EDCC4A83D13167A3FA91EF7BEA0B3E5C09F66133FACCFA440AD1773402B24DD3EFC3CACC02C9C9E4045D9A0BFD68B14C0EE3F393EC390AA3E489ABF3FB45ADE3FA1DE923FAB2E95408050AF3FB0119A3FD758A9C0E2CEC0BF3197993FA239D6405B6D383FC1471DBFB41C52C05BE684C013ACB0BF"> : tensor<4x5x3x3xf32>
    return %cst, %cst_0 : tensor<2x9x10x3xf32>, tensor<4x5x3x3xf32>
  }
  func.func private @expected() -> (tensor<2x6x6x3xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x7E6875C174E48A410B82EDC10D381842C9AF21C2B3D281C2557F5140B9530B42287CA2C146EB024303C27342E0F63142A214A1C1FF7374427A79434236B85C4250E518439B5D58C2E0711E4219FA46C22A3046C08C53D8C22179A7C2533C1EC17C0DC9416425A842637467C20B82E341BF49BB42440ECEC1C1F01542C79799C1FFB1A641C14779C209EAFD42284F99C23F5302C21884943F69133DC2C638D6421B3CAD3FC81355C2A2AEEC410DA28F42DA5990C2A7D48FC2CA662041D7C254421FFF8D40B357BBC2660BE2C1390BA542E2D7CA428E89F4C2BA6D7CC1CC072B42C5CC2D410BD2084225DCA742D04DFF42953687C230418F42A39936423851C44207962AC1792C12C2DEA2ADC2B2D10CC3CE87C041D1ACDFC07E5131C208B5A941BB613EC35D61EEC1655CE1423740A441E4009CC1DD76CBC1462E2CC20230C6C17F8165C03E750C41A01547C2D372414265519A421DD8F1C205E876C28CC02EC25C7BA64233D2903F378657C265CC04C2D2838642DA3F2CC101609EC044A5BDC1AB3859C391FBDB40B4BEE841DCBDA942FA7CBBC22C513DC2E82C8CC2D016B5C20630DDC188D70AC10D31C541382E3AC28139F8C10274AF41DBDEC841016B4CC29E89BDC1DEFA9E427C0D11431D020DC182005342791C0D43734B1743582B6942940C8DC19B6323C1CD422142410948C2E9F494C220EE1542D90B41C3AE89A7C1136D4842CBC21A4239EA6FC23D2CBAC053F4CDC2EABF64426E618BC2B6CDC4C21474AD4246ABB342EF5906C3EF4992BEB0E299C289EE5442D90B38C29AA910C2B59AAFC17D4CC0411C51B83C465698BFAB90D3C23C7C2F428B14D1C26E67254135C9CD42866E2E4207A39AC2FC894CC2E5ABA9C2BD4CF5C23F2F4DC2F04689420BDAACC278E073C245A60EC3D261B1415D5659C2DC0F40C24658C8C1ECEBFD410A17A0417466B6BF2BC4BFC2377D38C35AB32DC20F849642997191C280CE3F42EF9B1542F6B3A6C06D63C7C1C9BE43C0A4564342F554A64216BD8E40502E4EC21EAA80C17F530D40ADE0DF424E30D0C187A43FC231C505C2AB3E804279DDE4C1B5698742F42901C3F04B1EC257E78DC2123DA8C141252BC1E7C32D42A5CD75412ACF03C299EBDE41F878ABC217A4FD4132503542EBD2A342A6D3824176E12BC23658FBC2429F2EC2E0637642088D99402145A3C17A421C4386B186425016E23F"> : tensor<2x6x6x3xf32>
    return %cst : tensor<2x6x6x3xf32>
  }
}
