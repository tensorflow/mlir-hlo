// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.sine %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x63EFE6BFA781164037DAB5BFD497014035267E3E50A9103FD2B3FC3FE863BE3D6AA81CC0F824BCBE9B1926C09CA429C033E210C069856C40A4E52EBF774923C026579A40C53D0EC08CB8044038765DBE7875C1BEB4119BC05FD253C0E2253D3F8ABEDCBEC895AB3EEE8384BF1E46A2405681A7BFECAB05BE37F554C09284553B47747FC085AA1DBF972A55C0E88A6FC0E314B33E1B070DBF93AF473F68AFB8409C321A3F150F853E247FDFBE5F08ABBF43A1293F5ABF0F4045FA15BCABFC41BF17803D404F6126403452BA408D75CBC0AC419DC0E48C3DC059830A4027A4D6BF289AAFBF2793D2C0E4649E409CFA103FE123FEC0C47DC5BFAAC10EC0C786E83AD7390FC0847001C0BD7F84C0F5252840DCFCE9BE34C79B40251C1EBFE5F68C3F278CAEC0C4CABA40D573CBBFB879BE40149B82BFC5D0B33F84A569C0F8B2E0BF89441240780BB9401A7FE43F9D158A40117E4640A09AF7BF4389173EB338EBBF0B3929C059BEA9C042DD7B3F0C7CF7BF50BFBBBFDA13C0C00CF98C3E59A9583F860C3D4009B982C0D7820DC0668AA5BF3F6F74C0869869C0BFF8A53E93EF91408B60443E75B4413DFFA9593E505D8F4074FFA44094251BC076F537C05EBC6CBF57CA7A40472D6740F7F169C0FE0ED93F327ABE3E8AFF68C092DA9C3ED0A936C05A3B3BC08DD40D400A0256C08EEC49C01FB203C0A78B224059D50240EC385E4075927BBFDAB58540CEFEBD3F44252F40A95AD2407FBD22C029C6E8BD66295140F90050C02A76AF3E64479BC054F7D0BFE817A43F55AF2340B586B2BF86104A3F6E31963EF248A93FF99C7FC05E6EDF3FAEC3613FA66659BFF061C2C0662DB23D232665C007B0D84037E86DBF024D843F2F9224C0732A9AC0EF50D1C0C84ACF3FB4D74CC06C3EE13C6C9C8DBF11CA54C00EED6B3F056590BF53A14C4082EFA4BE84697F3F5DC5A93F428476BEA7C56BBFA27B86C02B2CCDBD7BDEDA3EE733A6C02F27E93EE77A0E40E18C96C0AA3806C1C00F3FC03A394F3F24EA52BF36D86E3FD35A57C0D44C974024A787C0DFB68DC02D1A8A3F1C4A1640C3AD603E49322A40559689C06D4C333F3913A43D4859014080A888402B9F8CC06DBBAC40C3C8D53FFFC50440770814BD61E48D4015A5C840CC17BB40FF819F3F730737C0FFD48C3F9EFEE0BFCCA9FA3F90C3344089193BC0761C95BF01642C40454ED73F196A79BFDDF3813E3C3D1A408D7811C081F02F4025EB3F3FCE6F0B400A58CB40FBC7CB3FE5D061402A8F3E406E6A4540796FF0C0D0FEAE3F926C70C0F7768CC04CCF4540C62112BFA0E428BFDBDDD5BF9B4F22C06A6DEEBF56ACD73FD979ACBF209DBD4048070CBF8B9EC5C0097CDC3FA9AF81C070AD0140CF644A4069BB123FD73585C0F1D83D3F533BA7BF5AC942BFD214E7BF0E818B3E1DDC51C0D45456C0865025C1181B973E5E1A5F40D0B48EC02E6F8ABDC2D3A7BDB0E802418EDBE8BF2F2B1D400ACF0CC06AFAF43E8EF1B93FAA204440E8FE493FD97351C0CE2BDCBF8A6DC8BFDD7FD8BEC324E1BF2171D5BED3B736BFDCF4D6BFAD72D1BE6D4FA23FD81F4AC0E20B3F3D89D924C045305640D9F6D740CDBB413E081A63BEFA39B0BFAA8626C0E103A63EF87472407617D540063779404EDA79BE8FAD07BEDF6D4640DAA860BE7E5561C0FC3D99BE094B0340D1B7E2BFCF89F93E14AD37C0F347883F969671C05D68C93FCB0F38C05FAF80BFFDCF06BF222C3A40AFC7F5BC961F803E35A6F63E9A097540C9A1C03F9C131840C4838BC078BE10C0E6E644C09105A5400309CB3EB571963ED3A9D33F00F1ACBFB7B7353FFC7F1B4072061B406315CF3D8680A44046D5B03F535F81C0C7019EC0111149BF54DCC240AE45FC3F0F479C3E7650FBBFF529B33FCEE43B4048A7B83F66B2AAC0BD8A6640E3DD5BC00CE49BBE1D151BC0E40A0F40C8B427C090631BBE1A4F47C08388E3BEE687853FA4CFDA3F8EF581BFEB16A640AE4F2EBF90780740FC9766407B529E3E35FAF23FA165FDBFA3532C3FF1B14840802D553E38B91C3F838DD2C006680C40791F4540706E9440EF6FB03F5E4897BE77198DC0C5755B3F93E77A404CB80B408158AA3EFCC0F2BF2F16B03EBBAA04406D9298BF145A25404A279DC01ED814C02E084C3FB89E1DC0A28A81BF40D22F3F455A514049B896C0C71229BFDFCFD6BF0867993F03DBDABFB5A01840DF1D9EC026C69DC057D0E2BF7E6570406C5680C0EB3528BF236EAA409FF6293F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x460F79BF73D6353F5F1F7DBF760E663F4B8C7B3EA215093F78726B3FBB1DBE3D8CB423BF48F0B7BEBEFE04BF5460F1BE98F244BFD4B006BF029B21BF677A0EBF806E7EBFB4874BBFC24B603F4ABD5BBE65E3BCBEADB87D3FF3582B3EE6662C3F04F8D5BE2B64A83E2D295CBF94B56FBFC34077BFD14A05BEAF3D3D3E7984553BB24E403FD0E213BFB784403E8FD0103FD373AF3E860006BF2F0B343F22BDFABE980A113FF390833E5877D8BEBFFC78BF937C1D3FD9D1473FBCF915BCB7F22FBF13FB373E5909043F9599E3BEDD4799BD15CD7A3F953137BEA939543F8D8F7EBFDFF37ABF64F995BE7BD178BF445A093FFF027FBF81E67FBF03464ABFBF86E83AFB1D49BF455366BF3847573FEBDAFB3E6CEDE1BE73E77CBF813F14BF4E4C643F14AA3C3F68D3DCBE92F47FBF824FA6BE03305ABF407B7C3F5A8FF93EBEA57BBF655D413FD5B4F5BE72247A3F97106CBF1A67243D31436FBFD3FB163E11F076BFE455F4BEF56B543F6E27553FEB586FBFC39D7EBF78DE8D3EC8328B3E05B53F3FDC143F3EE1424F3FD6494DBFA03476BF2083203F9434F93E8314A33E6F0D7DBFF62C433EFAA1413D5407583E732079BF773367BF604E28BFB83387BE85684CBF7A7E33BF7E20E8BEADA4FB3EE2007E3F251DBA3EB104F53E67699A3E772B91BE2F905BBEE9854C3F13BA4D3EA8B15C3C5C3E62BFBCEE103F51D6633F4637A6BEF8FD54BFF15D5CBF370B7F3FFAB5C93E4298923E374A10BFF145E8BD374001BE5AB4DD3D190CAC3E1A7E7D3F16837FBF9A65753F2C270D3FE70A7CBF16BA353F5B0C943ECC26783FFDB9403FC8197C3F0F9E453F453240BFDF30543EE1F3B13D848DD93E7631F03E7D1C4DBF0CF15B3FB92E0ABF0D957E3F9A9B82BE63B27F3F53D2713D2837E13C58E164BF09973A3E73EB4B3FD85167BFCF3F64BD0119A2BE3119573F7B63783F722474BE9ED34BBFAD725F3F5AD4CCBD8643D43E41E6623F982DE13E05F34A3F10FE7F3F7F3F5CBF2E5B1FBECA52393FB8D93BBFBFAB4D3F19CA623EE2F77FBF77DD633F29C2753FB6A6613F9272363F5EE15E3E7B76ED3E5E7F6A3FBEFE243F4EE6A33DC67B663FE66A67BF082B733FFF2B46BF8EBC7E3FCF31603F370014BD232776BFB88955BCF478D8BEBCA0723F835C8EBE992D643FCA897BBFAE046D3FEAAC9F3E8BA05DBEEE336BBF55C6DD3EA56A7E3F9AC953BFD28F803E4E062B3F447043BFA2DBC33E9E702E3F1323523F29EC913D36F17F3FB621C1BE374A273ED93A693D305071BFC2B57A3F5FB5133FBCC5723FBB0C503DFD520ABFB0E71CBF5AB87EBF79B411BF6B2B75BF7C557E3F78A479BFC849B3BE492605BF2BE7DB3DF90E7D3F24494A3F7EE8653F0977AABC2CD40A3FE24D5A3F1AEB2C3F541C77BF2C8730BFEBFD78BFCEC8893EC2520C3E03CB523E67B3493FFBEB943E12DDACBEB7DC773F33548ABDB0A3A7BDD65D723F712478BF1121223F59F44EBFB9BCEB3E67377E3F0BBE9D3DADAD353F88DD053E09277DBF32FF7FBFE91AD2BE907B7BBF2A50CFBE479827BF437E7EBFACA7CBBE7C5B743F16FD873C27FA3E3D213E09BF788E50BE5FE9E53E7594403E9B3E61BE44327BBF3F8903BF111FA33E2A461ABF4EF9BB3E64F22EBF886177BE054807BEBE72283D93DC5EBE078EBD3EE4F696BE29FE623FEEDF7ABF9CC6EF3EE46189BE81E85F3FAF7C173FC3FF7F3F7F6886BE5C2758BFD2AA00BFDD166C3E3FBEF5BCAB947D3E2738ED3E476222BFEC717F3FD05C313F2141703FC84D45BF960685BD731E67BF6AC1C53EE249943E591F7F3FD3D879BF5AD6263F3C3D273F21AC283F19BBCE3D57E068BF6E6D7B3FC5BC483F4F87793FCF0535BF763345BE9CC86B3FBCDC993EF0856CBF4A437C3F0935513E43E67D3F5812503F9796E3BE8048943E4A7E99BEFA7F28BFF691493FAAEDFEBE12CB1ABE2359E0BC161EDCBEB8305D3FF18A7D3F258259BF445163BF982621BFC1C95A3F7FF5E3BEA6CF9B3E7B65723FF9E56ABF9C9A1F3F01D3BB3B28A4533E981D133F17A395BED8E54F3FACEF7B3D174D7FBFFC467B3F4B1795BEF455743FE08C413FC8D133BFEF7C513F6A38A73E328A72BFC8A2AC3E6166603F6BD96DBF048B073F12F77A3FBF743ABF731B373F64BA20BF131159BF3E52223FC04704BED0FF7F3F250C1DBF3C867EBF65756E3FCC877DBF26C42F3FB854793F32F0793F26D67ABF3E9E13BFF47E433F805D1CBFA14E51BFD6BF1D3F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
