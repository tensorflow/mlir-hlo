// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.atanh %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD142973C0FBDC44112422CA4934346BCE5414DC1E9C4E43DCB2F764479C5D9C1BCC73F3F1E412E386F41E447B944C7BDCAC5FBC156C3CFBB924416437AC3C6389D406AC4CDB103C774BA3A34584512471C3EB34055382AC2F13B9EBF67BCF4B43FBF5A4383C03FC09240BD4397BE4CC1D5BC10C4F8B921BF61B0BCBFFABE13C005BAD34099C1E8C45A45FEBF33BEE2C4E7433431D93B18C55135C3C712C026476BBD7146C4B97539844444BCA246B43D1F3DF1C23E398BC182C4E4BE52C2D341D03C98C8D840D5C108395AC112BE773BE7C1E7B5283D5AC494B8F43FE1424DB702C512444BC68DB60AC5ECBCBAB65B3E0E3D04C22D3CAEC825BD0637E0C133C1043FC1C1B1C020467DBED4BFE846E6C445BE73C030C0F83BDABC9F27EAC104C58BC312BD1442753C1B383AC3EEBDABBE43C3EAB60029293B24C2A7406B3E6DC83DBA063A0EC45240A43C28352A3DC2B766C1A5BFF54200C5E03E34423A3C09BF33BE61C423C01C3B3DBE45B7ABB7294245C1F4B9714835C4F2BC8C3A5F3650C3B8C0F643A7343040BCC357BBB5C17F48333B953931BDF643EA3E00C099BBBDC274BEAEC32EC0843C78398D38B3C07CC50BC3A3BBF930EBC220BD5C3BC341863E94C065BE4E39FCC4804439440BB32ABA41C26CC3BCBC0D447CB7733F3BC08DBEFC362FC60A400049C6AC9FB360B97145264235B763C787403931FE2FC63D36C1803F5B4409C12D430C38793D5EBC20380AC056411BBD4B2FE6BAB4BCDA3B8B3B0235F2B656B24E3CF73C1A3F77BC6B45ABC51344BDB74A41BBBD95C2F6C29A4142C4BD4260C2D9C0D0452AC37CBEE2C3F84025C470C012C210C6C3419342B2B8CEC05DBC56C5F93D9344FE4233431C3E6E40EE35F64012BEAD3C55C326AE52BCA44239C2EAC1BD33593AD43F30C2AE43D73EF6BDC93EC9C3CA335DC4243CCBC601C79136C24407302F443F43B323333D84BE064243C01B303243EB42C9C130BD6AC2083CFFC2FA3248C10047E53A93C07D3CBA436141CF3FAFB75FBBC3452745C3BD1339023A0D4121B4E2C48647B6C4A1C564B9784593C2683542C11DB7793DCF453C3E6C456ABCCCB115C05338B0403BC0CEBCD9BD9BBE71446E3577C48842"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x007E007E007E007E007E2CA4007E007E007E007E007E007ED62F007E007E007E007E007E007EA438007E007E007E007E007E007E007E6AC0007E007E007E8139007E007EDEB1007E78BC5434007E007E007E007ED938007E9C41007E007E1FB5007E007E007E007E007E007E007E007E007E007EB7BB007E68B0007E007E007ED4BB007E007E007E007E007E007E007E007E4031A540007E8635007E007E007E007E007E46BBAA3A007E007E007E007E007E007E473A007E007E007E007E007E007E007E007E007EEA39007E007EBA3E007E32B6007E007E35B9007E007EE0B7007E007E007EF5B6007E007E2BB7007E007E007E007E007E007E8A37007E007E007E007E007E007E007E007E007E007E007E007E007E3D42007EA027007E007E007E007E007E007E8A38007E007E007E007E66B70129C93D007E007E007E007E2EBCD73B007E007E007E5935007E3CB8007E007E007E007E007E007E007E007E007E007E007EAA3D007ED6B72EB8007E007EAEBB007E007E007E9C3CBE36007E007E007ECA34007E007E4ABE007E007EE33DE63A007E007E007E007E51BF007E007E007E007E007EB03A2A39007E007E007E86BF0431007E007E5B3E007E007E007E007E633A007E007E007E29B316BC007E007E007E007E0FB8007E007E007E7D37007E007E007EC8ACC5B384BA007E007EC2B7007E007E45310430007E007E007E007E007E007E7538007E007E9038007E007E007E532F35BD007EAC400E3F2E3570B76CB2007E007E007E007E007E007E007E38B8007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E62B9007E007E007E007E007E007E007E007E007E3A36007E007E007E007E2BAE007E007E007E007EE533523C007E007E007E007E007E007E007EF233007E007E007E007EFA36007E0C30007E007EB323007E007E007E007E2130007E007E007E007E007E007E007E1833007E007E343D007E007E007E007E007E30B864BE007E007E007EFD39CE3B007E39B4007E007E007E007E8ABA007E007EA035007EA4B7007E007E007E007E007EDCB1007ED738007E007E007E007E007E007EA835007E007E"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
