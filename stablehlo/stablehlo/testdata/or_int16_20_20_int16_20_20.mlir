// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.or %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0200FCFF0300FEFF010004000200FFFFFEFF0200FDFF0500FCFFFDFF0100000002000400000001000100040002000300FEFF01000200FEFF0000F9FFFBFF0100FFFFF9FF06000500FBFF0200FCFFFEFF00000000010001000500FCFFFDFF0200FFFF0100FFFF00000000000005000300FEFF00000000010000000100FFFF000000000000FDFF050003000200FFFF0000030000000100FFFF00000100FCFF0300FFFFFFFF01000000FFFF0200030001000100FFFF000000000000FDFFFEFF060000000200FCFF050001000200FDFFFFFF000003000000FEFFFCFF0200FEFF0200010004000500FFFFFEFF0400010000000000FDFF00000100000000000300FCFF0100FEFFFFFFFFFF040000000000FEFFFBFFFCFFFEFF020001000000FEFFFFFFFFFFFEFFFDFF0000000002000100FFFFFFFF04000000FDFF0100000001000400040002000000FEFF0000000002000300FDFFFEFF0300FDFFFFFFFAFF01000000FCFFFFFF010000000200FAFF0100010000000000F8FF0000FCFF01000000FCFF0400F8FF0000FCFFFCFF0100020004000100FFFF00000200FDFF05000200FDFFFDFF05000200FFFFFCFF0100000000000100FFFFFCFF02000000050000000000000003000400FFFF0100020005000500FFFF00000000FFFF0000FCFFFDFF01000000FAFF0000FBFF0000FFFF0300FEFF010000000100FBFFFFFFFEFF01000200010000000500FFFF04000300FDFFFCFFFEFF0200FCFF0400FBFF030000000500030002000400FEFFFEFF0000050004000700FFFF0100FFFFFCFF0000FEFFFFFF000000000000FEFF0100000000000200F9FF0400000003000000FFFF00000400FDFF0000FAFFFAFF0100010006000100040003000000FFFFFDFFFEFF0200FDFF030001000100FEFFFBFF0000050000000000000003000100FDFF05000000FCFF00000000FDFF030003000300FEFF050000000000FFFF00000000FFFFFFFF010004000300030002000100FFFFFCFF01000000FDFFFEFF0000FEFF0100FDFFFBFF0000FCFF04000000FAFFFEFFFFFF00000200FDFF0200FEFF00000100FDFFFEFF0400FCFF00000000000002000100020003000000FEFFFEFF0000FCFF00000000"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x02000000FFFF090000000000020003000000010001000300000000000000FEFF01000000030000000100FEFF0400FDFF000002000300FEFF040007000200FFFFFDFFFFFF0600FFFF0500030000000700FDFFFFFFFCFF03000500FDFF0000FDFF02000200000003000400FAFF0000FEFFFFFFFEFFFFFFFFFF0400FDFF00000500FDFF0000030002000200FBFF050001000000030005000100FFFF0000000002000000FCFF0100000000000200FEFF0100FFFF06000300000004000000FFFFFCFFFDFF0300FEFF0500000003000100FFFF0300030000000100FAFF0200FBFF0400FCFFFDFFFCFFFBFFFDFFFFFFFEFF0000010001000000030002000000010000000000FEFF0000FCFF0000000000000400040001000000FFFF0100FFFFFFFF020004000000FDFFFEFF0300FEFF0000F8FF0000000001000100020000000300020000000000FFFFFEFF0400FCFF0100FFFF000000000100F9FFFEFFFFFF03000000FFFFFBFFFBFF0000000000000500FEFFFEFF0000F9FF0000030000000000FDFFFEFFFFFF010001000100FCFF0000020003000000FAFFFFFF0000FBFFFFFF050001000800000002000200FDFF0000FCFFFDFF000001000400FFFF0200FDFFFEFF020001000000FDFFFFFFFEFF0400FCFFFFFF0100FDFF0100020001000600FEFF02000100030004000400000001000000FEFF00000000FDFF020002000400FCFF000006000300FEFFFCFFFEFF0000000003000200010002000200FEFF00000200FDFF0100000000000100FEFFFDFFFAFFFDFFFCFFFFFFF6FF0100030000000000010000000000FFFF0500FCFF0000FEFF010001000000FFFFFDFF0200FFFF0200040000000100FFFFFEFFFBFF00000400FDFF0400FDFF0300FBFF0500FDFF000003000000FFFFFDFF04000000FCFF00000300FEFF0100FFFFFDFFFFFFFDFF0100040000000000FCFF00000600FCFF0100000002000200FFFF00000000FAFF0000FEFFFCFFFDFFFFFF020000000100FDFF0300000001000000FEFF0000FFFFFBFF040002000000000000000000000000000600FEFF0100FDFF0800010005000200010001000100FFFF06000000FDFF0000FDFF0400020000000100010000000600"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0200FCFFFFFFFFFF010004000200FFFFFEFF0300FDFF0700FCFFFDFF0100FEFF03000400030001000100FEFF0600FFFFFEFF03000300FEFF0400FFFFFBFFFFFFFFFFFFFF0600FFFFFFFF0300FCFFFFFFFDFFFFFFFDFF03000500FDFFFDFFFFFFFFFF0300FFFF03000400FAFF0500FFFFFFFFFEFFFFFFFFFF0400FDFFFFFF0500FDFF0000FFFF07000300FBFFFFFF0100030003000500FFFFFFFF0100FCFF0300FFFFFFFF01000000FFFF0200FFFF0100FFFFFFFF030000000400FDFFFFFFFEFFFDFF0300FEFF050001000300FDFFFFFF030003000000FFFFFEFF0200FFFF0600FDFFFDFFFDFFFFFFFFFFFFFFFFFF00000100FDFF00000300020000000300FCFF0100FEFFFFFFFFFF040000000000FEFFFFFFFDFFFEFFFFFF0100FFFFFFFFFFFFFFFFFEFFFDFFFEFF0300FEFF0100FFFFFFFF04000100FDFF030000000300060004000200FFFFFEFF0400FCFF0300FFFFFDFFFEFF0300FDFFFFFFFFFF03000000FFFFFFFFFBFF00000200FAFF0500FFFFFEFF0000F9FF0000FFFF01000000FDFFFEFFFFFF0100FDFFFDFFFDFF020006000300FFFFFAFFFFFFFDFFFFFFFFFFFDFFFDFF0D000200FFFFFEFFFDFF0000FCFFFDFFFFFFFDFF0600FFFF0700FDFFFEFF020003000400FFFFFFFFFEFF0500FDFFFFFF0100FDFFFFFF0200FDFFFFFFFFFF0200FBFF0300FFFF0400FFFF0300FEFFFFFF00000100FFFFFFFFFEFF0500FEFF010006000700FFFFFCFFFFFFFDFFFCFFFFFF0200FDFF0600FBFFFFFF00000700FFFF03000400FEFFFFFFFEFFFDFFFEFFFFFFFFFFFFFFFFFFFDFF0300FEFFFFFF010000000000FFFF0500FCFF0000FEFFF9FF05000000FFFFFDFFFFFFFFFF0600FDFF0000FBFFFFFFFFFFFBFF06000500FDFF0700FDFFFFFFFFFFFFFFFFFFFDFF03000100FFFFFFFFFFFF0000FDFF00000300FEFF0300FFFFFDFFFFFFFDFFFDFF04000000FDFFFFFF03000700FEFF050000000200FFFFFFFF0000FFFFFFFF0100FEFFFFFFFFFFFFFF0300FFFFFDFFFDFF0300FDFFFFFF0000FEFF0100FFFFFBFF0400FEFF04000000FAFFFEFFFFFF00000600FFFF0300FFFF08000100FDFFFEFF0500FDFF0100FFFF06000200FDFF0200FFFF0400FEFFFEFF0100FDFF00000600"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
