// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.exponential_minus_one %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x3634F1B6A0BCA53928BC1E4272C1ECB56ABEB0438840683966396BC19BC1CBBCF33D2FBC694307445B44FEBD0A438BC15DB46D40BB43102C86445A443F32BD3E133DD3C59BBD3F45E73D233FEDC33C3D3440133B9A4176C5523F0DC2323BA84398435A3B0EBDBAA8E0B99FC550B62EB9C1BEE1C73142524467C1D8C34940AF4362BA1A44ACBCF742F4400A34D0BFE03910C221B8CCC33B402BC2AE419D3FB3C4DABC51C2414193BDDB2F76B308405BBF50C158C56DB342C201BAE5C5214046C6BD400D3D4BC022C17CBBB93A1732FB45B1BEBBBD663FFC48EDBE26C3C4B23DC4774196BE12B6B1401EB90A3B193B2245C63D89C09F3BCE43C8BFAB402F38313444C2D64344BF584155C2983ED8C3CEC33D3E6CBB6B4110BD6B45083F63403442D9C06942603EE7BEF83F8F427D41C9C457382241123B873E063A11C074BEE2C1423845C23144983C164444415041E43E09C4EBC36BC4963DB4404B4075C01DBF36C186C07C3D1C37E9BB7540B22F22417B40E8C537C65FB5D1C00CC00BB25D395EBBED44F9C406412AC27D459745FDC7953CD03D0442FE3C692E14C2C8C2D1C48DC443C4064101449339CA43FA4438C4C6C018C0374506467242E140883D61BA623898BA45C2A934E24402BD39402546853CDF3F87C8C43FD5B75C4506412EC0BD4787C320B8163709C351449BBC1CC41826B32BC8BE5CB823C75DBEC6BC98B8F443FFB94A4144358038F83ADB3BEDC02B44F2BD7B3FA93DCAC2E2B7DDC48640EFBC534406C07AC6DDC3CE40F347E9C0F144A92F81C0E2C1BA444EB648B8FBBF6A3F22B6744640C44A3AEF4173BDFCC34043BEC0733BC840A9BF7DC2B1BF4C3982C00CB80F4618C489B897BB614012455FC4FBBD8740A83275353A409940AC36BA37C4C043B229C22D3BF0C4C7BC7A4244B9E8381B42553DC0C02D3D2540FA3E75C4CE3CA0281530F3ACD23CA6472E4419318CB3552EF9C17EC07632193A2D3FB7B652C4C0406C37B3B60C442C387044613C43BCDB3E57BE40BE1EBDBFC2C9BD07BF013CCE3E61BF1CBC663F42C4E4C1B6A8A4B9663838B401BA51C49B44BDC118B95CB3223C96C1903638C050BAF1431247A0AC0538473C273D73B8C4B3E6BD"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD134A2B57CB91A3C2CB9134D7ABBF3B464BAB6515248BA3BB63B78BB84BB96B9DA4230B9F550E452CE5436BA195080BBA4B31248D751332CB255CA54E53264441D41FABB08BAE759C042F444D9BB67412E47B03DBA4BF7BB3C459DBBD63D9F517251063EBDB9A4A82AB8F9BB37B5A0B786BAFFBB474DA35476BBD7BB8647B35166B86E5383B9E24F73499934DEBA563C9DBB74B6D6BB4A47A2BB074CB545EDBB9FB9A9BB6A4A04BA2E30A7B28146BABA70BBF6BBA1B2A6BB39B8FABBE246FCBBD848124111BB63BBDCB8443DB6322B5E80BA17BA5B45367596BAC7BB1AB2E2BB2F4B75BA0DB5B84890B7A43DB63D445978422CBB5E3E1152DBBAA9487E39CB34A7BB2A52B3BABC4AAABB3344D7BBD7BB8443D6B8024BBEB9035BCD44F8474F4D4BBBEA4DD84393BA5546644E474BEFBBC439024AAE3D1D447E3CF4BA68BA94BBA039A7BB12544E405053754A9F4A9944DCBBD9BBE7BB1442C0488E4724BBA6BA69BB2BBBE1417A3806B925481730024A3348FABBFCBB90B448BBF1BA81B1A43BD0B84658F2BBAA49A2BB875B2B5CFFBB4A408E42D04CF840BE2E9EBBBBBBEFBBEABBE3BBAA49BA52083C04528058E2BB44BBF8BAB859705E064E3C49F94166B8D6397EB8A7BB69351858B6B94247455F3140284600BCF84532B69D5AAA4903BB7A68D0BB72B67638C3BB9F5478B9DEBB2A26F02B88BAB8B6FEBB5FBA93B9FEB68B5238B88A4A3D360A3A8E3DAE3E52BBF25331BA7D453C42BBBB3AB6F0BB4D48ACB9A854EEBAFDBBD8BB0649886950BB5858123029BB94BBFF5635B5A2B6EABA624518B5F360E3BBC83C9B4CF4B9DABB915041BB263EF648D2BAB0BBD4BA823B29BB5AB6AB5EDEBBECB6E7B8EE47F258E6BB35BA4F486633813646477B482438F73843BBB0B1A2BBD03DF1BB94B91F4EB8B7C63A0B4D964142BB4B41F146B944E8BBA640B6285B30C3ACAD40186806548631B9B2A82E99BB27BB2733923C03457CB5E5BBE048B93879B507537A393955F43F3EB98D445CBA53BAC6B9BABB1EBA9EBAE23E7B44BCBA23B95B45E3BB94BBA0A80CB8DE396AB339B8E5BB30568CBB8AB794B23E3F83BB0F3808BB5EB88152986475AC3839A83F4041D4B6E6B22BBA"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
