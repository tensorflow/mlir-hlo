// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.asinh %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1C1EC41EDB47F3BF0BAFB2A9C38D13C06A24A477E07705405AFED8ADE762FC3F8A6E8BD6672E0340ECDBCE057E621440562EB1736FC010408FB5E0C4417806C0305789AB0E6B04403A7CC10695600940D3E973DD0B2A12C09E53FCA4D8BD13C070467BE53C37F63F03E0E35B592AD33F5633CE43269D07C0522D1980CAADF9BF08FD32581DF607C0E8AABE724AC7FF3F78045AA49951EB3F4571920C21EE01C060CB02A3E2EAD73F2294FF387505034031C4D3910CB911C072366FDC8153CCBFAEFF09E1D72DFBBF63DCB6D12641F7BF92B13D93F245F1BFE2E8DFB79EF7EA3FC6AC2F2902E4D5BF863C18EDEC0F09404ED0F4C85DEB09C02D51BE22FF45E9BF397ABFA1194507405DDF3189B7EF104036F06D384C52E0BF9895B5F19AD41E4065209A6CCD5319C0E0BCA926401C1440D6D2C17A0D7AEE3FB8C0BC9ABFA81BC05A1146C2BBF2F5BFF40AA6A71583DC3FF028B1085F051340E38DF66CF2AFFCBFA4B03A0F6E96F1BF04D91DF3F8D00EC0E33ED024120718C019CE6ECF9B24C73FA4F1A089B62E16C000692115805200C052D9B07B01C806C03630EB62EB45E33F7D07668BD6C9F9BF18843D735C961AC02D845F8DD991FA3F6355E3D3435DFFBFA682754695E9FBBF328ABEE1E9910A405261F3AE50BE0040E2426EE0D7CE03C0F4A16908EEAB1240EF9D519496EA11C0348A559CBF76CE3F22D02A6666D4DDBF9AE64CD730F9E13FBC77DA4BF87F174002CC25368FDE0EC0A24BA34E4830D93F300A5E2BE0B7FBBFA92AF0B0F20DEB3F7D10D6DC04660040F0C8F3AFCFEC12C01177D4720387F6BFBE8090E02303CA3FDB71C46C5914F53FF85F343A435DF03FDE56189FC114DA3F2CAC2DD5B3B820408925B831CF880B404EB1969BB10105C0328BAA37FF48D6BFE9B4923DDDF201C0BE5DA64DC26FF13F0107C0E079DB12C0E6A39AAFDCB8E5BFA8BAA3066289F63F8344041E61B114407A737189DD35E2BF5AF7C46204C40EC0A92EB06FDBE30E40ECFF5F7A44400AC0C27B24E93E22EFBF3433347952A118405F425777A0C5C4BF4604125E4D42C3BFDDC139DF92A00240426B262A82C3F43FA0EBB5FDC81514C09CE546FB028CD93F27F0E72E01B212C00560ABD5E1E500C080D7A52220CD1140FF22D70049EDF1BF3450617AE2DBD8BF38FB42242BF0F5BF04B6EFEE545EFCBF1F2136CFEB18E4BF6A3B8D89CAA019C019648C8DEAD2FDBF497E59B81F77F23F28D7E4331C05E9BFBB0921894AD3FE3F565608B7C0BD144025827544BB460E40F52B01DB27DC943FBE84038AA4F305C0543E5AA219FBF7BF1B53620C44A20640C2E7492B8D1BF23F8C4E6E07009EF9BF782E5D7D97FCF23FCDEE1F3FF08306C0DC9CAC89AD1804C08626272B3AC504402B6E15DC0C4401C00516F8915EAEEA3F64F055C30E6A044066E8EA634893FF3FBEAB4764BC8F1040BB5262414C1E11C062679E09864F0F400E5AAE1E0A190FC0EACA7881A6A8F4BFE47D1C8B5D380A4066456BCABBDD1A407A9C534D31C4D4BF88C7A81433A6F8BFF839B11B2B10CCBFC42F835928E7CB3FA2357B2949BCFBBFCB663C5C395E05401D8E7C5DFD92CDBFB028EE5232CA01C0E4520037CEC80BC0908FDD0D3D0920408A8908C256F2FABFCF8FD30082D403C0435A4E7CBA180040A2CC6863145D0AC03E577F6A7C1709402A862B8C3B45EFBF4CC7F8789B66AABF7676754BB0E8F33F4780D006471A05C035DC39877A41FD3FFB4371986041054041F65A6669400E40DE1405BC975DDEBF20A7FA2F676B03409953D59D9081174042E15965BE1F11404ED8081F09B106C0FA95960B354BA23F4909E2E2B55A1240B06A2A2FF83C10C0AA6CA6A13C311740CD4F4179B2C3F6BF227C78812FC109C05AEE32BAAEA415C0E48388EB5703DD3F5E2569E8AD5816C010874B37AF5CDA3F5D8F57ABA4CAE43FB8607974EE10D23FFFE9CC4C6548D6BFF59006C6575514C0612D8E322567E33FE466C0B6D15EDE3F71BC8D892BC1ECBFFA5489E3D381EC3F72368B5257890EC0281EBA8E4A4BF6BFDD7F9E7A2B2D05C0A2494F7EDDE6F3BF41D251ADF8D91240A2490F7C0089FBBF813F9D0FABBB1FC0A36F80EDDA81064090113BC1609304402A17BD3F6C8A054020DF4419432F0E40EA909100CAEEE73F4AEFE02885CFE6BF03B4B004DE0AF5BF4C0DCF4B60330140C9533CD2BBCBFCBFB86404599BF5F1BF553E1AF5FDAF00409A913EBBD454F83F306B91DC7849E13F58D93E19BE560E403E7F2462C5911140D88D95EFD3301140F17BD9CF5D34F8BF34746F4CDDADF23FA7530184E03C0440FD8A3075ADC5CF3FA33D315F9C0C0C4024132791DAC4ED3FBA592B5B0C141440E2698F8564DCCF3F54EF21631CECC73FCE89F2C6D6AE02C0D6E17D715C93FCBF5CDB837E4766FE3F17AD7648A4D90CC0FC49198202CAFABF1C1C62D1D9A4FCBF5BE601CD6AB309C0AA9720106D2B0A40101DF46D2B4814C04B7448AE7D6A1440E86609023F4909C0EC88B10145B8D33FACC8F6A1BF27F3BFD40CA17D0C4F0440A0649B86321507C0F6C8EDF32254DEBF8F90F3F866361240560A214C66C60BC0DC0D250BA475FE3FDCEDEC451AEFDF3FACA9E5D2FC680440664A48695FE7F63F0BAA82C3101500C090B3A8AA358A90BF1D14425C33700D40E8C76EB292960FC0FE76FA4D3C2E13C0A2D964B912F4FABF5749CAE4A71117C0EAEC0A78822213C004A42ADE73A7FCBF4FCEB4416F7BE6BF084A654E9E34F2BF1E4FAAAE7B23124082A49804C56F1340190B660BFA0CF2BFA007EC69AED7D0BF73C9F3390C8E0940E1B2555DB0E4C43FEEE68ED3A32EFE3FA3C969527BAAF13FD3312F382CFC034044CA3E634D2DF2BF66CE7DA5EFF722C0E2A796993E320FC05E744769F17FFDBF444C30F28091CB3F45F417220CC303C090A8E34A67DCC3BF3579E8E65179ED3FDED82404834016400951275FC84BFD3FD6D83060450B18C0D22510698C1F0A4098BCE257B2E30440F91838BE87D410405917C144FC9EF33F46DD53CF696D0F40F6B82508B638E9BF0D1FCB7D3271F3BFEFFCB152788814C0B9812A71059EEFBF9FAC1540E6E20FC09C99FE1D5941B5BFA98DAADC733009C0B04FD1D34449D53FE6B52D13676808C0841479E691AC1240B235E7601C92104092F122FA108B1BC07087774BD99A06C0E17A1414F01DE33F680D2116D700ECBFC91F6CA141FEFABFEA153A6BBFDC0C4025C3D21C4B390340581160B2340015C02B66BA5EA4821940137E5343231DB0BF45C1110EEFF1ECBFA85293BF8A0AECBF2FE3EE3394C8A03F0FE266DD9C7F05C010F3019DFF5E034012C4B559B530E4BF92D01C37B9A6E23F4AF597F415761AC0A9417D93683475BF90571D58F78116407F0175E7AA6E05406FF0358628E2E2BF60A64D121A7AFF3F4682C029028FFE3F7C4EB3B1DC5103C0A71AA0AADF59074082E8A2372C290240BFBCD2FCD5DB10C0D6140210E53AADBF005C4CD4F6D4D3BF243145F6B1DE0240B94E996A05FE12C0FEAA3390BD4414C0CD0C9222559813C034125F8D2E9FE8BFEF2A8DD00776D73F7268904DD2A01040F3A055EE0AB0084016688A2643739FBF7A0789017A99EB3F18A66E8BE183F7BF56B0FA6FCAE100C0AABEB160F493DDBF878D6146F93B03C0767A66B39243B73FD93FAE7D3F1913C0D1E12B40583E06C03B2534269C8C09C0DAD466D9EA7F0840B8C0F5C4F589E8BF62CD08DE7FE2DCBFF7B82CD5E9140CC080939E01926F1240068C5897D0020FC04664F4F927D40E4001C2CAE4C7361240B5746523FBD210C000031CABFFEF04C088A8B9B251910440E0404D1BC1D4F2BFA74D31B74B461040B28C6319C22CDABF425853EC355106402A37BDFDD37C0CC0DE3B088364DEF0BFFB85BC0DA37AF1BFBE9D1D6D23B301C0265BB652888EE93FA02D674E95B20C40714CE8C8CE9F07408F8B65D7772106C0B10BC18CC61A03C006401A82FCCE863FC807F1401BD7154001AF242716BCCC3FA03D2794A4C10C400E1510EF6D44F8BF963DB393D700184096390027C4491EC0280A42B86FB6FDBF75C3DA1CFC22D5BFCC14F092DE1001C0BF862210AB200140E16C02EF56A3FDBF89F07CAD10A5E5BF9672BAEA5C53F7BF716C7A92C5731240BCE2FCFE4279F1BFF2FD64C83C3D12409FE29E441710F53FF6B190FEF12B0F40EFC8F5C500B0CA3F8AAB3392B4AC18C0AA8356542E8E1540D0595C34E7700E40AAE31FE5ECBD054000BFD06AE287FA3F04869957F473D6BFD24C1E12337FF93FED99A8DE8947F5BF9F56B369DB12EABFD4737FEE96D5FA3FCEEBE3868DDA07C082D4A07CC32906C0A2B30D098CD1F9BFEFA67653955EF63F557E8333811D1140034233530F92E2BFFAC31BFFE95410C093F7ECD4E1150740C373BFA7D93200407DD265928057E13FC9FCD78D5400E2BF78FE76361C04EB3FB412BFB4A85F0B406ABE282E82D1F3BF4A1A3C47A3FC0AC0E40F12BBBBBEF63F6958951C900C1540"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xA5838218A24EF0BF654D7E4E945202C0505ED38EBF69FB3FE46914B3B167F53FDE638C7391BCF93FA123680D27A602409FD72E404F1D0140D2167E8B3819FCBFCEC6D5BDDEA9FA3FE69D9691C5F1FD3F59808852E8BE01C0CE9BB87AC36502C07F0CA5EBAF19F23F17FAE333D4E3D23F393BE89E61D9FCBFF10F366C8606F4BF3FF0A3A01912FDBFB4549607B3FFF63F615471721EC5E83FC21A0A46E8BEF8BFAC372434A464D73F718F2168EE9CF93F3CB1CBB7BB8D01C03B6AE23A9619CCBF0D04059871CDF4BFAD4B1046BCB2F2BF0F34535720F8EDBFE7DE5FCA7F80E83FB8B9EE6E1E7CD5BF2D209DF5FEC0FD3F1962FE786C44FEBFC0CB658D9230E7BF3ECDC11A81A0FC3FF3317887283301406632E0BC185FDFBFE981D75693EA0540972F9FDCFC5B04C0DA9A6ADBEC8A0240F9EF8ED12B1DEB3F87C3371E550E05C03DB93A207EF1F1BF9E8C5E67F5A4DB3F870D7D8F2E1B0240E2AE8C3C5F8DF5BF0E09A9F3F964EEBFF6771CE02A7700C08286301D7DF103C01F5E787CCB04C73F8265FD41415003C03751E11C5562F7BF7430C232644EFCBFDBC8D477DB43E23FAEB5F9985515F4BF7BCB6F1342BE04C0084CA64BA47DF43FEF91F216C5CFF6BF5B20EA02BE2BF5BF10675EFE8CA5FE3F20EB67EE41C0F73F4A543EEA6436FABF50F202A20AF601409B236C096FA301C0B6AFB982F02ECE3F83DAAD77E4D7DCBF129FBB864924E13FF9BFECF6A2C403405344C82A947A00C0694B281D7294D83F0D65BB0FF512F5BF9FDB79BA8F91E83FF1DFE3177B73F73F0D8B45820C1102C070F0D6531848F2BFA0764DCE22D6C93F21ECF9C9C66CF13FAC8A84965BB7EC3FEF5591A88968D93FA6728177E08F064067CC56239831FF3F14B87D8B6C16FBBFB6EC35F694DBD5BFA9169EAEC3C2F8BF66279BDCCE30EE3F6E578CF4DD0902C00A6687F8C453E4BFD9967E857749F23F25FED83D50C40240DD04C8CF1A59E1BF60A43DDEE87300C05E54874BE87B00408AE6D42B3676FEBF6DDE4AB45796EBBF222DEA898A230440895A841F8FAEC4BF67288804E32FC3BF7F6B2723034EF93F851B9AD2AA3BF13F3204A4AF668802C04B948E6CB8E9D83F8F4B69C595F801C0190CDEF33EE2F7BFA7D62A048E9601408178C4E141D9EEBFA8E41DC0D745D8BF332FD544FBEFF1BFB20F02B37265F5BFBDDC0C6193F7E2BF904135B2DE7304C045937548FF18F6BFBFD08AAC4C8FEF3F486020D48DFDE6BF585FE30FA490F63FC11DD23E01C90240A844D79924540040D47E3752C9DB943FFF7832BA56BFFBBFD0E7D50B081BF3BF5C36A4714F35FC3F7102AC26B316EF3FADB9DCCD2AFEF3BFA0C260075A1EF03FD27E90CF0C21FCBFFE0222DF596DFABFF6558EEE2BEBFA3F3EA432232032F8BF0EB99BD65C48E83F66BE710324A9FA3F0D01855A40E8F63F716A91EA90060140D3D562B6764801C06CAF7CD4BA96004054EE93F0328900C0CEEFD3653F2BF1BF3FDA5E1C9A71FE3F1EDA36F662D30440BBB62C9F116BD4BF8D29F30C1679F3BF70EDB80ED3D7CBBF74629189C2AFCB3F5C2FCD572915F5BF93C3E2D8CB57FB3F100DA2903251CDBFC95CD28687A1F8BF031B380C2855FFBFEBCB8C31CB3A064072DC4A0D29AFF4BF803B0B81A23AFABF524A0F09322FF73FE6259B1CFA86FEBF3C21297497C5FD3F006F9A7264AFEBBF9B8B73A99D63AABFE8E4AAB65BB4F03F0EE2623FE327FBBF8631B8A7BAD3F53FADD5FE4C8543FB3F3F7659228752004014F043B30A54DDBF10A5740D48EBF93FC09DB3FA2BC5034054E4D2201F490140EE8BC9AB243FFCBF24953319364AA23F6F7EC432BCD301409552C92C57DF00C0FA8C58560BAA0340401A519E1C6BF2BF7EE9BCA4782BFEBF3F53B3E6AD1E03C0909BD032F219DC3FDBD0F8B8185F03C09954669618ABD93F17E97055578DE33F3BA5A0D99CD5D13F88EA7F9A03DBD5BF7EB7EF1C15A102C043BD69404B60E23F9B8AA25D2655DD3F8B74102697D9E9BF3F95A16F62AAE93F9A256367176500C0963B33A36425F2BF0F3E3AE24235FBBFD10F1D4337B3F0BF5E6C41123E090240F94D843377FBF4BF2EE5BBB7312506C030E8E6A2A71FFC3FB2EF61C530C7FA3F9A902960AE76FB3F6139AE8B234E0040ED609C6B7C20E63F27EB3DB18038E5BFC674DC5F0A67F1BFF0720F7B1524F83F105B112CE39AF5BF81AD7E8755E4EEBFC572A90CE4B3F73F92C36905954CF33F57B71BBC618AE03F29B265B33A58004001AD58E45D7C014031B5C221E1500140BDF9995EB63AF3BFDA3F71D5C1D6EF3F39B566FA0B88FA3F39E9BF5B6374CF3FBCF70EAC837AFF3FAC34DA773B99EA3FF851E7F7B887024044D96DB26E8ACF3F0CD2042402C9C73F018ECCC14159F9BFCDFCE35A6D7FF5BF44DFAB23255EF63F948F461586E9FFBF65D00799869AF4BFC6D623C8F687F5BF29B85F7F4B23FEBF610A040F0B6AFE3F535294A7FD9B02C0E6DD89093BA90240563CEC6CB7E3FDBFAF61350E9F6BD33F508DAE02173AF0BFA275181D6395FA3F179EF2773E81FCBF47DFE45C7F4BDDBF47530F1E37C40140E4585F28D353FFBF106A6F514B65F63FC7D14ED60EBDDE3F3174EE175CA8FA3FC415DC8F957FF23FD65F310CEF2BF7BF58EA008A068A90BF8CBA5AE49D1C00409AC312D43EA800C0E65AFC0EEF2B02C0663288B20BB0F4BFB9A30107489F03C0062944FE232702C0C337598B3B89F5BF2D84B1C7DDF3E4BF52235E78D837EFBF7B48B72715BC01400DCAF09B85460240CBB29DA96103EFBF87E4354567A7D0BF1C92DA32060DFE3FF8B1ADBF37CDC43F8AADA77D2844F63F3B491437EE7FEE3F5B979B0C3758FA3F12A5CA962E2EEFBF558F48367B9007C0001B6A22788F00C07BED69039BF1F5BFAC95DD760C5CCB3F575F36EF8C2DFABFB774C13638C8C3BFE0665A29CD61EA3FD1CE63FF8F560340917061B3ABD8F53F5D1AAA22DEF203C05795FEC91763FE3F356D48210501FB3F904D5A849F2601403E2B3109FC85F03FC284FCBA1D9E004006C6BD722426E7BFB3C04AE7F768F0BF41150F1DBAB402C0CC595632B9EEEBBFFD6D99CBE6BA00C0AD0BB5961D3BB5BFA5443E9BBBD4FDBF78D132237FE9D43FFC92D7F9E259FDBF79E8F5474FF6014003BED051AE0701409760CF7AD10505C00FF01F355D30FCBFAA7B112A9221E23F5807ABC9B149E9BFE61E88AD3DB5F4BF98A67DF02EEBFF3F63F29344F1C4F93F4E3C4C9205E202C00DFFA3E08C6A04407EDAF7296B1AB0BFA3DF9FE5CEFDE9BFC162584AFE50E9BF8CF7AA4FCFC7A03F841B69C2256FFBBFB580324FD2E1F93FE4D717DDB40BE3BF612949B8E6BAE13FE34CF3E1A1B404C009116D5E623475BFF5982969986D0340D77144E34F63FB3F540A885E2BEEE1BF227D41F6DADCF63FE9AE54741371F63F0480950BC8D7F9BF5D93B0AAFDADFC3FAA2E3235C4EEF83F03ADF9B9FF2901C09EAC1000D636ADBFA6653F750987D3BFA743C807C67EF93F3D7CA48D271802C094F023D3A99A02C0C46F2CA3CF5602C09A0A428503ADE6BF12A09D970DF7D63F1402A5C6920E014064A6B3804886FD3F6305143FFF719FBFD4A3B675AAFBE83F7DCDDE966AD8F2BF38D94B3FBEDEF7BF0AB6DFAE6F9DDCBF8441DC6700C7F9BFBD00B201683BB73FE8994ED0582302C03A1AD99C32F2FBBF87653F3F2A0CFEBF0EAC45768268FD3F2D2794162F9CE6BFE95A4E6605FCDBBF4BBF7CF8107FFFBF4887A79499DC01400F701796A78300C09B9EAFA1F7770040A586BDB260C401401044FC12E82501C0EDCC3084CF09FBBF552A2EB7B2C5FA3F7D8C4A699E04F0BF77AC8815CCE30040E6464B56C27ED9BFEF3CE7DBF2FEFB3F21433F60A1B7FFBF2638D64C7E6AEDBFE6A9D3ED813FEEBFCC898C5A938EF8BFAEA2458D5F69E73F6A5F7F3B99D4FF3FBCFD714016DBFC3F726191B09BDEFBBFCC6D63076EADF9BF5AE5179CDDCE863FCAFC6B4AED300340D57D1343A97FCC3F7CAFA9C7ADDCFF3F027151EC8F43F3BFB274E42671EF0340CDFFB93389C605C07C23798F830BF6BF31D9F30F28C5D4BF79F941BAE206F8BF0396AA024714F83F4D3B2A6E7302F6BFFFEE79706143E4BF54B7BD260CBDF2BF16C3CA8061DE0140779FCD76A63DEEBF72C4A35125C7014047527A85336AF13FB2D2E168E78D0040BC8D45C7727FCA3F67A5B7FD2F2704C088BD0B067C160340023F4599E35E00409732E57A659AFB3F678DF7857F78F43FE7F2AE402204D6BFAD4D7FBBD2EDF33F62E416E3A18BF1BF6D81F3DD5CD0E7BF3F817BB375A0F43FBD54189C9B00FDBFC16726A83EE4FBBF7C5433986519F4BFFDE85109A130F23F585AA54C1A4801407417D5F509A9E1BFB18FE289C3EA00C0788DEB46B181FC3FB2ECFC5E6346F73F914BD1ADB896E03F8FB211C9822AE1BF62771AEC0B8AE83F6B1DE7DA911AFF3F03CD8B3FD1A5F0BFF36C7397A6E2FEBFCB4202B34168F23FFB95130BA4E60240"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
