// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.add %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x00000100FCFF0100FEFF04000300FCFFFDFF0300030000000000FEFF0100010001000400FEFF01000000FDFF03000200FBFF02000200040001000000FEFF0100FEFF00000200000004000100FEFFFDFFFFFF0100FDFFFFFFFFFF00000400FEFF0400FFFF0000FFFF0200FFFF0300FBFF03000100000001000000FEFF0000FDFFFEFF0000FEFF0000010001000000FBFFFEFF0000FDFF0000FDFF0000FCFF000006000200FFFF0100FDFF0000FFFFFDFFFEFFFAFF04000000FCFFFDFF00000000FFFFFDFFFEFF0100FCFF01000000FFFFFEFFFFFF0000030000000100010001000000FFFF0000FCFF00000000000001000100000000000000FCFF0100FDFF00000000F8FFFDFFFAFF0000FEFF0000FDFF00000000FDFFFEFF0200FEFF030002000300FAFFFCFF0300020001000200040002000000FFFF03000000FBFFFEFFFDFF03000000FFFFFDFF0200FEFF000000000100000001000500060004000000030000000000040002000000FCFFFFFF0000000001000100FEFFFEFFFEFFFEFFFEFF03000200FEFFFFFF010005000100FFFF05000000FCFF00000100FEFFFAFFFEFF030000000000FEFFFDFF090000000300FEFF00000400050000000200010003000000040000000100FFFF0000FEFFFFFFFFFFFFFFFDFF0100FCFF000003000000FDFF0200030005000200FEFF0000FAFF0000FFFFFDFFFDFF0300FEFFFFFF000001000000FDFF0100FCFF000000000100FDFFFEFFFEFF01000400FFFF0100020000000000FFFFFEFF0200F7FFFFFFFFFF05000000FCFF0200FFFFFDFF0000FDFFFFFF0100FDFFFBFF020002000200FFFF0100FFFFFFFF0000FEFF0400F7FF0200FEFF0200FFFF0400FFFFFDFF0000000002000100FFFFFDFF0000FDFFFDFF000005000000FDFFFFFF0400FDFF01000300000001000100010001000300FEFF04000200FEFFFCFF0000FEFFFFFFFEFF00000200FAFFFFFF0000FFFFFFFF0600000002000000FDFFFFFFFEFFFDFF000000000300FDFFFEFFFDFF01000100FFFF00000000000000000400FFFF020003000000FFFF01000000010002000000FBFF0200FEFF030001000000000002000000FDFF0000FFFF020004000400030000000000"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x0400FCFF0400010000000100FEFF0200FEFFFEFFFDFF00000100FBFFFFFFFFFFFFFFFEFFFDFFFEFF0000000000000000010001000100FEFF01000000010000000100FDFF0700000002000000030002000400000000000100FEFFFDFFF8FF0000FDFF010000000000FFFF0000FDFF00000100FFFFF9FF0000FDFFFFFFFFFF010005000500000002000000FFFF0000010000000000FBFF02000100FFFF000000000400FEFF030002000000FDFFFEFF0100FAFF0000FDFFFFFFFCFF0000000002000300FEFF0300010004000200FFFF000001000100FFFF0200FFFF040000000400FFFFFFFF050000000000000002000700FBFF0000FBFFFCFF03000000FEFF0600FFFFFFFFFEFFFFFF0100010005000100FFFF01000000FFFF0000FFFF000001000300FFFFFFFF000001000200FDFFFFFF000000000100FEFF000005000000FFFF000000000000070000000300000000000300FFFF0100FEFF020000000100FFFF000001000000000000000000FFFFFFFF020000000200FDFF030001000400FFFF0500FEFFFFFF04000200000000000100FFFFFEFF0000FEFFFEFF02000300FDFFFEFF000004000200FDFFFEFF00000300FCFFFFFF0600FCFF0000FDFFFBFFFEFF050000000200000005000400FCFFFEFFFFFF0000FEFF0100FEFF00000000FDFF0200FEFF00000200FEFF010000000000FEFF0100FDFFFCFFFFFF0000FDFF00000300FFFFF7FFFCFF0000FBFF0400FFFFF9FF0000FEFF0100040000000000FEFF010003000600FEFF0000FEFF000002000300FFFF010007000000FFFF000004000000FEFF0100FFFF0000FFFF0000050002000000020000000000FCFFFEFFFFFF000000000300000000000500FAFF00000200FFFF00000200FCFF0000010001000000FDFF00000100010002000100040000000400FEFF0500FDFFFDFFFDFF000000000400FFFF030004000200FFFF00000100FEFF010000000200FFFFFEFFFCFF0100FDFF0000FEFF00000000FFFF03000100FFFFFDFFFFFFFFFFFBFF01000600FFFFFDFF0000FFFF01000000FEFFFBFF010001000000FFFF01000000FCFF0100FFFF040002000200010001000400FEFF0000FEFF030004000000FDFFFFFF0000"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0400FDFF00000200FEFF05000100FEFFFBFF0100000000000100F9FF0000000000000200FBFFFFFF0000FDFF03000200FCFF03000300020002000000FFFF0100FFFFFDFF09000000060001000100FFFF03000100FDFF0000FDFFFDFFFCFFFEFF010000000000FFFF0100FFFF0000FBFF04000000F9FF0100FDFFFDFFFFFFFEFF03000500FEFF0200010000000000FCFFFEFF0000F8FF0200FEFFFFFFFCFF00000A00000002000300FDFFFDFFFDFFFEFFF8FFFAFF0100FFFFF8FFFDFF000002000200FBFF0100020000000300FFFFFFFFFFFF0000FFFF0500FFFF050001000500FFFFFEFF0500FCFF0000000002000800FCFF0000FBFFFCFFFFFF0100FBFF0600FFFFF7FFFBFFF9FF0100FFFF0500FEFFFFFF0100FDFFFDFF0200FDFF030003000600F9FFFBFF030003000300FFFF0300020000000000010000000000FEFFFCFF03000000FFFF040002000100000000000400FFFF02000300080004000100020000000100040002000000FCFFFEFFFFFF020001000300FBFF0100FFFF0200FDFF08000000FDFF030003000500010000000400FEFFFCFFFEFFFFFF0000FDFFFBFF0100000004000000FAFF070000000600FAFFFFFF0A0001000000FFFFFCFF0100050004000200010004000400FAFFFDFFFEFFFFFFFBFF0200FAFF00000300FDFFFFFF0000030007000000FFFF0000FAFFFEFF0000FAFFF9FF0200FEFFFCFF00000400FFFFF4FFFDFFFCFFFBFF04000000F6FFFEFFFCFF02000800FFFF01000000010003000500FCFF0200F5FFFFFF01000800FFFFFDFF0900FFFFFCFF00000100FFFFFFFFFEFFFAFF02000100020004000300FFFF01000000FEFF0000F5FF0100FEFF020002000400FFFF0200FAFF000004000000FFFFFFFFFCFFFDFFFEFF01000500FDFFFDFF00000500FFFF0200070000000500FFFF0600FEFF0000FBFF040002000200FBFF030002000100FDFF00000300F8FF000000000100FEFF0400FCFF0300FDFFFDFFFDFFFEFFFDFFFFFF03000400FCFFFBFFFCFF0000FCFF00000600FFFFFDFF00000300000002000100FBFF000002000000000003000000F7FF0300FDFF070003000200010003000400FBFF0000FDFF0500080004000000FFFF0000"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
