// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf32>, tensor<20x20xf32>)
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.atan2 %0#0, %0#1 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}, tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x6C55474048D9123FABEE5D40E378A43F3FD4C63E4ACF8E3FF83EA640F12AF8BD6F3173BFFA2340404D7F83C040D259C0503CA1404D43B0405929A23E2D4AB8BF53D9AC404A24AD3F274F29C04F35AAC0B89B153F15140440F289E2BF78A81040DE721B3FF02C494046C7804048448BC019DD23C0443C6E4035EA1040A270FEBF5782F33F9CE421C09E32C6C0FD2B0940A484B5BF8C992FC0377FD43FDDC043C028A4933FC510D6BEE84BD2BF626939C08D3826C08FEA37BFAEC17DBFF64125C0A1B7764082A7DEBF6BE6B2BF937978BFECE44440413897BF32438940853DE53F117C944072E24DC05B72CEC0A551AC4033B763BF5806D33C139777404BC8573F60AA03C0114C90C05F12C0BF799EE63F10D727BF55B20FBF567912C0193702C072488D408D32A7C029ADE33EEB1329C0F6BC86C0BB50293F5CBAE13EF329C13DA93418404B7F8B409AD41440C66709C066FC89BFF5C22E4033455D40022E8D40AF65113F46C650C0A70C8CBF7EA003C0EE7D65C0159B2AC04C9460C0DC6280C07734143E7817A3C06F82343E3A333040F878CC3D05DA6FBC2B63933FFA60123D8FE0C23F1B9B31C033FB8A3F99454E3F6D289AC05DAB8540502166C0CE03334019828FBDDC4113C1AA945F4015239D404CA31D40D8FB1CC0231ADCBFC3985040A4406340BC451040F65E4D40DC67D8BE385E06C025DE6D40AA2621C02A7E5D404F159140834E10C0F4F30E405621AABFE9CB41BFB598B4BF875172C067BFB13F6A8D0CBFA1658A40E7C56EC039A3E53E37FA96C0DCCB274068918FC09D0D273F926CB43E666E8940508645BE53B636C04C87A13F40CB6340E136A63F56481840DAB29E3F763D8FC0B6B47D400B1239C033FC5F4053C8C43FA1FDE8BF6724ADBFEC9E74BF8FBB3F3FEBC7E9BFDDFD6C3E1D4EB1BFF3638B40BBF649401D6E6EBE11471040A4EA773E18D0C3BE0BACBCBF1944223EBEDC3FC07151763FAF95D83EF644EDBF761EAB3E87A6363F849D87C005E907C05D632DBF4BF4D6BF4C4903BCCEE3CCBFE15CCC40887C433EF5FB2DBEFD6911C0125B79C03A4BBAC065937BBE84BC8CBEDD5B444008BD17408DBEB440DC630240896AAB3FEC13C3C033383E3FAE7E323FE554CFBF7F47563E55E5B13F8CCEBB3D5DC94540963D0440A05721403744F3BFEC0375C0CB35AA3E1BE4BBBFA896A440527C8BC09341BF3F241D15BEFAE78340F75EEDBFE6B996C0E88744C0523CF1BE8840FCBFD97E24C0229E4E3FFA7712BFD57623BF6F98F33F53A7A3409293504048751FC0A2B275C023AD61C04BE8623F33FB82BFDE1E3AC008F3B83E4EE5AFC0CE7EE0BF4FFA7DC08687ED3F1735FC3FA67674BFF5F09BBF92A1323FCE8EEA3EA47D0E402915B63F30F6413F499F29C0508097404FACFABF66EB97BF61B777409D00993FC98C2ABF2A5330C02EF5C23E61026E3E052D20BFF43FEEBF17ABE8BF30174C40BD09893F29B28DBFFD14A1406A0A9740C701DEC0274DF33E754563BD8FB2DDBF5DA57F40DFAB38407BE30E40FBB10EC0A543DF3FBBB2AFC059B02740B4B925C0FA34FF3FFB2AF83E0113F2402A7358C098D462C0D6EA9BC0AB31B9C0B06F6240BCA9DEBF3532333F06634CBF543441C0FA2E843EEDD9453E87239A409A447C40541A7540FB893DC03D2FAC3E8E465440CF5C8BC09B39A73F9A1BFD401234773FE0B6DCBFD2F0AF3F5BC7B1BFD73E25BFCEF300402A5A8540768E27C0026BA0BF1BAF19C065807B3F74C39B3F170F26405A529440C1B8CC3FAFC3A2400F33B8BFF07D74C06E835F406F385E3F37C05240BC38F3BF52D8B0C0B7B05040F9A78FC0044BF83EADDA833F49020DC0B460B0BE5723E43FC89708C0B08C28C0B1281C406F19393F3AAF99BF48A4453F475951C054E630BE391192BFE666924038F2ECBFCA987E3ED5458A3FEC0581BF66D22CBF9E718BC0E68A1DBE0FAAC93F57E916BFE89749C0A38B0DC08CE04540997AAE409BC7A64054D879C0E7EF823E0CFDA1C0B10B65C013EDF93FF70596BFA672F93FBAF385BF8FD1D23FC5272840DED98940A6CBC93F02EED23FD8FFAC3EECCE6040439A8CBF4ACF3EC067C442C0E6D46C3CC5315F40A72CB3BEF3F4C3BE344F81C0C0C93BC01E1D863F0FDFC5BE2B6E85C0BAE71CBF32FA7B3F8C1D95BFCDC6B1409C67A840EF576FC0C2EF44C06EA4E53FE521BDBD5D00F2BD016B40BDE1C166C0C35A6E40D225974047EB0B3F35A43B3F5384F5BFCD6E81C0"> : tensor<20x20xf32>
    %cst_0 = stablehlo.constant dense<"0x14E91CC0284906C0CB7C4CC0EA644D406EB2B0C047C57EC022B839C04C01903FEA35BEC0CF3FCE3FD60123C0DB685940F39FB9C0D46168C0897AEEBEEECA8DBFA4717D40B7F801BFCFBB8B40D28D05C0AB18F3BFBF19993FD79ED1C0CFE981C08FC775BF74AB7ABF47B3A6BE5B1ADEBEDA8A9DC08B48ACBFD5219DC0881361C0EB918E40B0E3BCBFFE8E1740433066BF4DC7DEBE21CEDDBF04FB1440F3A469407DCB50C0C57A773F98B175C0B3993040052F8BC0B1442A3FA2C1CEC0A4DB163E2FD5783F71E43CC0D134F13E4808CDBFDBAF8E3EECF49640BDB88D400AAEB5BFAC37F63F7F2C90C0581ACF40FB6CE8409062CB3DD65E0340ACD92ABFA305D73F17DED1BF182087C0456C9ABF871CA64003D070BF330D00413557AEBF76A426BFC1DA71C0F83082C0E2FE89BFF8D296BFBC5C74C0C9C33D3E6C50A73F6EE8FA3F9E0D59BFFD057CBF648C1640F1C4B740AF9F553FEFBD6B400C8CBDC0EF6B0AC01DE21E40726B68C07BAA48BF49CDD03F9EB33CC0765BBEBEC4576A404BD342C070F57BC0D26EE03F54ABED3F07ED45401A5D4AC0C68A94C0237CCB3E31FF00C0E21FA5BF68144640D68735C085952D405A179FBE25C100C1773A0DC0F3B2C5BDEB48003E4A749BBF27EA64BECD0EE9C0A31C3C404F2EBBBFEA3CF340F2362040E149BFBFE07EF13F3C31C6C0FCCB9BC0AB521E3D662CDB3EF838B8C05D779FBF6FB982C0291F124081963F3F630901C01C8358408ECB70409DBB2B40C716373EFFDAD63EB37C90C02C27F73F7780B8BE8B646B40625FDDBE445DBA40AA23ED3D517BABBF9B02CDBFEBF8C23EA8428CC02C3BB9BFEB9CA5BD4212AC4044B86C401357BAC0DD98C13FA3E2A84036217040156D5840CC47B83FB69C98BFC8B103C0508698BEC163D940B70434BF06C1B83F372D063EE0140F40B1440F403F0360BF9773C63FB0D554BFA126C73F8D379EC07E766F3B2843673FFE4CA8C0F9A315C0B1F1EBBFC9156340E8A9B5BFCA22B640993328C0E08214404FC175BFD4264440D64413C0EEFFEABF514D07C0DC56A1BF87754D40ECDE16BC8125893D7E2927C0FB302D40E0D3EDC01D428BC071C460C040A80D407FC170BF1CACF4400F41FE3F520B3741417C8C405BCADBBE6FB1094053CE65C08EA9D4BFDDD7094082D3353ECD4C63C0CD7375C0C16CBCC01EBF9E3E87A2463FDAC6514032EC3FC0440633C0D58D3BC0C2CB7540342139408CC4AC40B571F33FD52A17404F729F3FAC8E03C0FFB90FC07055BF3FC6E10EC0CF1F903E78394C3E029EEF40E10C8F3F3A5243C070800240D15207C0C2673440BF8B4340F00E85C0176B88C02B960540CF20883D8F64024050E634BFBF62FF3FC19088BF8B2784BFD53DDFBFE1EF3D3F0E6D1AC001F2F43FAA5F92BF82DCC13E226EB9BF87EB0CC012D032BF27197B3E0C4BA5BF691CA73F0E3855BE9A4136BFEC310BBF5D6AE63FAB24A0BF9187A2BF01487B4046443BC0D9AECA40E37A67C09D139440541A0040B1D1DABF4B013A4015BCB43FB2EAA2BFF7D6674084A6283F12FAC1BF45FE16BFE5E8F93F2A949AC087DDE53E8CAB2140E6398C40F41F3EC00149D2BE8B1E1E40477AACC0EE3A92407AFFF7BFD1B1424061D35BBFC10CA74070FBDE3FF0C10E3F9C5547BE8DE8C6BEF4763DC00845A1BFCECEF43FD8BB934023F72CBDF32F18C0801C2EC0C64BFCBF6EE582BE9ACCADBE8573BF3FC31A5CC04755B43FDB9FA6BF20C814C0E1721ABE5C153AC025B2604084902C40134E08C12BD38D40DADA98C0F24F2140461A24C011B74CC0773422C03A6130BF24D85A3F975C05C0AE661840E47932C03F91ED3E0817D6BFFE04844065A3E43E0B62A03E8D12124005D49CBE88125DBF38527CBF05F40C3FE0BDF53FB4E23E3FF0224840D6EB78BED989DFC0AB93A840A7395E407A950B402B2C5040DB6DAFBEA61C273F43FC594093A28440C180873F32926BC0F98C753FFB15D0BF26D486C0BCBD8F3FA845F5BE65A44EBF450C16C01B0F9BC08D7E373FA214F63FE980B33F0E3B23C083DC60C06D7329413D110EC0982FFEBF53F2CBBF6D9DB13D8B2814BF8F2067BF9D1DD43F2588C03F5A8461BC1643F4C0E0AC88C03600004125D0293F31CFAEBF51E1D4BEAE06F040EA1D2640D2E4D43FF047C0BEDEEF3E405DCDD4BE9014C63FEF68EF40D586903E4D61C1C00140B33FF36DB9BF90C3DF3F69AF6DC03629F33F436F05C0276F413E0F9140405471B9C01E419A3F"> : tensor<20x20xf32>
    return %cst, %cst_0 : tensor<20x20xf32>, tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xF4350F4080FB3740FF2D1440DFFCC23E7D914440C2923740E421054019BDDBBD59EB3EC0CB028A3FC00A08C0D94D49BF064A1B40AFD40940E6D7224098800EC03F2C703F9C05F73F12710BBFEBEAF8BFECF43540C7D3853F7E2C38C0A08C284006F824401CB7EF3F2D65D33F42C7D5BF9C5E2AC0E478F53FE2682D40EC2228C0CA9FCE3E705406C040519ABF1EE8FB3F272BEFBF229508C03C981E3FC28732BFEF4F33406BFFD0BE822E2FC0AB4A4FBF449C26C0EDEB52BFBF513FC055C4C1BF5172A93F4EFA26C0B4729FBF3E3226C09C7FBD3F25477BBE72F8443FFC6B0F4078C2963FA06021C0DDA748BF0452233F96D4BABF94994D3CABEDDE3F7D1CEE3E97980FC04CB214C0A0DE0FC0EF0BAB3E0A1B22C067678FBD4EE306C050B2F0BF86D611408ADF0EC0440630404FC3FEBFC1AB13C00018A63FB38DA63EA2EE443DC0E5F43FD37DE53FCB97473FEC2CB7BEEE7C69BF254F233FA03F2740CCB30140A04E663E21391AC022510CC0367666BFD99210C0C4CCDABFCA9D43BF64120EC0CCB5464054A69EBFC6D9C13D66363A3FB10A47402FDC48C065859E3F64ED4740E4841140DA1F3BBFF3A9314026DA933E784ED1BF326B2A4014C207C0487ACD3F238E02BF04DBD9BFDB3DD13F69182340798E323F0EF006C0D2D063BE4E746A3F9E0DFC3FF8B95F3FCD772A400D8543C0A5B4C6BF5262BA3F8DAC2EC0754AF53FB07713404B7647BF02AE9F3FA4C223C0836D61BED4B0B7BEC24974BFDBABB83F800E6BBF902C184046EE8BBF45D90F40C19C68BF7AFBDD3F380A28BF4D95B23FB79938409CC0F63FC10FF0BE301D24C0132A1B4034F8CB3F08A4723ED957123FC6A23B408F5A9FBF65EB243F8C1828BF94744D3F3775513FE0A409C000D823C09CBEEFBFBFE0E03DD11AF8BF1ECE223E61FDBCBFCE5D8C3F942C743FF76A38C070E5773F1AED3640D2D076BEDD8436C0681CC63F2999A3BF457B3D405E9B3D40029E16C01657C03DE43F2B40B1D823BF17911DC0E36691BE4AC405C0D0572BBBDA2922C09AE4EC3F5D4C4340937C40C03FAC1DBF4C5DC9BFF296C7BF460F43C0F250CFBD68013040B52229400E22084028773E3FD6B60B40E24F2CBF4E46B73E3754793DDFF8B4BE9A082C4018D4123F856D4740C919044090C0433FA60FC03F989D29C07EDA16C0D3734540CE6AAEBF90E5B53FDB106DBF3A7A2B40B5BB45C0B6150C40DD51E6BE289182BF5B6304BFD1AB78BE910132BFD34B8FBFE11D3140A81839C0BFB2CEBE48E21B401106C23F153DC13FE875A4BE4BCDA4BF993012C036F1D13E17372CC0AF0D4DBF3C02F13D98FA0DC01F1530C02A158BBFA57AC43F11C8443F8C4D0DC0D9550CBF63FE234098552E403C0F0F408B868B3FF29635401D0872BFDA65E73FAE9DB0BF14221DC010A205404660064027EB9BBF339500C08C4C913EAA481340E4EA1AC0E770EDBFAD4E4ABF28EBF83FBA3A1C404EB48CBEBF3A0640F8F2233F944903C04B94D13DDD07E3BCD66016C06219713FA6CF8E3FFEB00540503E0DBF60D69A3F6588EBBF4B67E53F4BBC6CBF69023040D2DB523F3CCF9F3FD84428BF462D11C078D3D3BF9C6A95BFC6E223405D3BBABEA2DF3240956883BEC688ECBF3D674A3D2839E23D1B4FBA3FCE60CF3F8D00D63FAEC816C0445E3840571C863F7B9941BFA332CD3F7771EE3FA23B334030101BC0AD99E03F80BEE7BF9398D0BEEC2427400B559F3FD60F02C0F26A29C05817D1BF3935344055D4AA3EF224443FEC2B2940A651B13EA7C91440A5CE04BF0F5D0AC022FD134082F133405676E33FDEF292BF2337F7BF73A6703F141B08C05EB64E3FA0BB25405F24FBBE013628BF08CBB23FD77A40BFF6E1D7BF5D9AF43F348E2040BB0692BF93C2C33ED25FACBF270C62BD46EDE3BFE0F323401C03ADBE5D65923DD575EB3E65DC99BEE69602C05E07B6BF0EE438BD24FBB93E571202BFC0C21BC0C4AE94BFF082034004A30E40CBE5AD3FE1B0D8BFF96C35402A4A00C02E5920C047079C3F06280CBFD970723F772430C0D1012D40E503793E8CFB0240211E1E4025B8154004E7A83FAAF6DD3F828F10C05F2088BFD44D8EBF053B154063A22D406FD443C068CE43BD693CB4BF286900C0936AF93F75DA52BDFECA81BFEDC4B4BEA6B7F73FE59ABEBECB9ED23F7174A43FAD54EDBE4B5ABDBF9297364092DC86BD66DA43C0D715DCBC2EBE17C0CFAF8C3FF544FE3FC9779E3FBEAF743EE89A34C046FFA3BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
