// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.multiply %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x91409CB93F3ECB35EF462E411CC102AFC93C22C58F4580AE2C4094B9A83FB8C5183D444551BA90C1803E2245D5B685BE853EE33E18BA384344C6D841463D5EBD8F411443F83A7EC22F43A0BCE84120B469C010443BBF31BE4DC572C3F34008BFCDBFE4BFEAC59638EEC414B482B6C4C037C8C944AEC3324202B859C2B7C2AD3F73488FA7E4BC684383C437C12EBD44C6E43DB6C1704233C15CB9923C013DBDB6D33101B6704177AF92C017B76CC2EC3A5835253D8B3EDD44E6C08E4208C0B4B8A8BAF734A7BFAE400FBFE8376F450347B9C797C4D93BA4C3CD35EF3DB9436945BC3EF3BA4C3F753111BDF0BE3B417FC3A0447B41F1427BC265BB61BCB1BF784526C70FBB52BB8C4453C02A44893412C5EDC213B9A1C4923EBB45A4BB3740B9C333C1F8B9D44471C0A0B498BC0D3544C66A385B39CF411DC0573C36370E3ECC2DC4C57AC4F0C20240D73D8A408B4028C229C4B1BEC12E7A4209C4443FFABD82471844EA40C1B9AD3FFC37D4C23336C13D343EEB40E8401B429841783D4A3882B3D935C6B8033B2642E5BA8640A8423934713867B603C33441A042D32DF53A35BEDBBD584654B752BF10300F3AF4BB37B133449E4383C69AC8FDC09DC3F6B40ABF3135AA2956325644BB44533B463A8CBFD2C1CEBB4D3B594688C1B641FDB9B2C77546C241A6B9062C9CBC8B34CDC037440645DD3E30BC704462C12DC194405E422ABB33C7883402C1F1C310C0483FF9446BC0D43BD93B9043B736973B15C5753D5633FFB6D4C1AFC35B449348D43D883DD3BFCA3B90BECE4491B4C33F5B3E2B24113F9CC0EDA47B43E2BF14B8A440BD35BD42853687BDDDBA0D43363F05BBF82FD7BE2DB457417DBA283F17C16738E541DE377D3BB043AEC337BEFCC23EBC66C0743DB3C04339B8BE3CB2483EB8BE1EC459C2A1470CC5064444C26ABD6F3C4B3FB741A23C08BC2743E5C0AB2319C562C4184170C4C6B2DFC275C073C19E364E338C2D57C046C41A3EE9419D3DBF2AF343A4C47948BCC15140D2BF28C440C36F46164404BE37C759B0D0BD213F0FC423BB60B59542EF9C0BA6C63DF7BA6AC418BE2F3CCB3D59C176BC1B38EA39F5C4F1BC583DC9C2B8BE374126BEA8C051C40444"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0xFDC1923622432CC6A4390E4033C6B1BAADA7993FB741534201C2A942F2C10542BBBD80C271C115A82F418E44FA428DC09FB829BF5C3DF03B0739A84080C132BC50C805BE6F451B412D3C364122C236422036B8C1E32F282DE9431DB92CC294B66DB78542A1302EC0B9461CC090419EBCEA4255B6873E7445B8B7A63E27C1C64579BB59C2E2C01C4483429FBF85414CBD583E56BDAFB86BC479C15C42ECC02C405941F1C5B3C43098E1BF38C6D74186C7C9B8A140AB3D16BBBDB91C34B7C1F2C037410EC0F030DEC1C83BD3BCD0455DC2BC37E542ADBA11B48BBE4E43A8C3ACC0CDC0B3C1F742454109C08A3C083CEA3FDD3B8BB8514162AD64428A411D3C7DC2FF34083D7BBD07388A46B3BF5D44DDC0BA39123D47C860BC3F3DB9C15344C4BCC4B715B8843C3AB4F0B8243C8FB830C144C08CC29CC071C53B341242204204422EBA503C30B41CBEDFC1AB4271441241333D5AC6D5BBA142D9B6203C7F3D37BC1FB511C1B033CD40F2BA90C11BC27DBF2DBE4348883923C67E35C54231B732BA184233C5FBBDEBC1033F3ABFD4BC893AE1B8A93CB73FAB38AA417DB7DF39B843E2B218C1C6C00A346AC56649D8C1BC3F03B9CA434B45F13EEA3F442D0CC0DEB6C4BF81416B406ABFC53D4B418BC0E6BD2BBF5BC76D44B4BE4B401F476C423840D7C22DC359C3B03C883E08AE65410CB35C4224C53A4182453FC583BEFFBC723CC8BA79BDDCB788C0DCB12EBF7B40443C67C183444AC179442BC1403DCFBE494075C2B4417C408C3D60387EB816C1FEB8F3C4C34083BA013C5EC0663E393A13BFD643AFC2933BDE42E5C351C08F39C6B6F13D7DBB89BC20C2304530C4EE3FFAC07139C6BE69BBDD395CB5BB45272D2C41102A59B6E2B840BC57B66443ED411D3296C643C29C40F640AC45FB43A0B575B4EBBFEE420D3EFD30C33D59C6C8C31441903DE6AEA7B84EC15C42F7BDBD3D6240083AE940E7410944A8C4EEBDFE43613DB1C4D94469391345B6BCB43A68B7B83D93C184C556BE5CC22CBC57484339D7BEF9C55AC352C5A83417B99AC2E7302BC18DC5D3439940634446413CB4D945AAC07DC4173D64C4F23F793AC54289B6D53C91C204BC65443C3446C125C5112E9C43"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xD6C69BB4924578C0E4444045EB4BDD2D97A8E0C8F14B23B543C6A5C0B1C54ECC4CBF47CC4C40AD2D3644D84DF5BD6B4388BB2AC215BC2A43E0C3CD4640C3A13DFECD53C5BC4425C8804306C287C868BAC1BACFC921B3FBAF3ECDC240A3C7C8393E3B6EC6D8BACBBC24D0313886BC804149CF93BF44C6394CBC3346C553488A4928C8FF2DF8419C4B58CBF84426C32648AC409E438ABFBE49553F444328C207BBC937754063CAD10B80448341B0C882C665B2F441A3404FC4073FBC3AC245D13D57C008B9B9B4DDC6DEBEC5B8E54F94CD77C3E9CB8CBAC43BBFB86B4564CB52CA0BC4F3405A4630371C41DFBF45416AC78C4439BE9D485C34E8C110C2E9BF6FCC77C070BC043D944012CB02C8F23C2A4AF5C06FBAF35030BF844777418E489A440C3D17367345B138B631C1BCC2B1104CB5BC62C0B2C698499734793DA3445C347444D4C4433B1FC249C491470B49CEC768C550499DAE5E49E83E7E3F1BC0E9C73EBD39C687B19B44EFB6BF48BBBC63C1CAC03D4DC93EAFCCAE3BA144B6B3D031743C34423EBD8CC80BBE16C404C4E6326BB575B7C3C6123EB14874A91B39FDC50A350ACC5F3C64B780B91748CF410BB543C16B4B4FD0FCCBEFC403B505390B3A0AB9CB2FFF3605C8D346D94020BF904137452D470A4452C9F0C5154DCFC00FCC85CD2AC93041B72C87BFDAA679C66DBBFD4B69C879C11C4E0F4B3744B8C11343133AED4874B0AC45D1394B4314444E45F8456A4430C13A4C56BCFB3C5348D941ECB9FDBC89C654C5C44023C569C3E7BAD748A340573DCF44FC383542F23C5FA7EC46B447AAA46C4AC747673C733EDCB001451AB6443E4141924C8DC7F5BEF5B4A7BC1237F2C0C1B8CBB84BCBAC299F47F625F1B5B1C01444ED3874CA49C2B9B67DC85B47103E2BC46CBC4446B938963C48469C4EA2C7043983C44C4850C4A144F243FDAFB038BEC8C8C7B8A550C7CDC8AE3F72C9FFB8EECA30490A449C3EE93481B642C9C8C1BD47F6C2B43C3FA6AF45784A2BD28B44DDC6144082D0C5C080C91ACE8745CC5010A9653BE2C5F9B89C40753F704AACA1A1AE9D435F3374CE1B43B2C45F3FDF496EC0A53601410D40F8BD63C4D04262C785390E44FD498CB6A44B"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
