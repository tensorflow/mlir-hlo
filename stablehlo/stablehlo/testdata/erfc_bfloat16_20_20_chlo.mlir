// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.erfc %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x6C4091401AC035BD724094C0FFBF1540103E67C0A93E51C0EB3EEFBE453FA6401BBE8FC0683F83407EC0CF3F1B400040703EEEBF98BE5EBF79C0E53F813F793F74C045C0C3BEA8C011C0ADC042C09A3F5C3F8D3FF83FAB407BBFC9BE61C02A3F89C045BD303EE4BE5CC0BC409FC093BFE6BF06C008C0BBC02840994021C03CBF313F27BFB440A0BF3740E93E4B4094C0D4BE5ABE084044C0F1BF9CBDE13F7140A33FDD3F194005BF4CC03840FE3F88C00340D63FBB405CBEBC4011C090400F3FD93E9C3F383F953E7AC08BBE9D409FBF58BF9B3F1DC08D3F1A3FE9BE873FA83FB6401AC08FC000BF8FC0EA3F4740324026BF3CC08F3FE5BFA1C0823D90C01C409B403C404740B9C07C3F403F6340D6408740824099BFEEBFAC40614032BE41BFBB3E7DBEC740813E0240D2BE3E400BC0E1BE653FEFBF49C001C0A3C02240D3BF4AC071C0BD3F15BF9ABFA540A8BF80C080BF0B404CC0B2C0393F3CC0FCBF9E4051BF09C0544011C0C33DE73E8840A4C05F4009BF4B3F1EC02D3E21C019C0FC3F30C04E3FA2BF54BF4A3FF8BFC33F154096409BC0CF40793F69C0C43FC83F62C01F400C407840FE3EA140D93F83BF57BEE6BD214040BFB4BF20C00F3F344077C00FC1BC3D4FBF08400A401CC00F402AC0414039BD89402A40E4C019406B3FE9BF2B3E424085404440BCC08540A040B64037C084BFE54097C006C0ED3E804094C007BF953F81C0A73F4F400CC081C048C06F3E07C059C0A4BE2B40DD40E0C0ED3F77C01340E5C0014044C0E93FCFC0BABFCF3F2240F5BF78C030C017C0A5C0903F8EBF023FBBC021C03840D6BEBC3F2F3F6B3F9140833F45C03ABD93C069BF9ABFDCBFC83FA73FCC3F03C03B3E343F92C0B6408CBF6C3F7C3F1840B5BFC5402940C8BEF5C055BF5B40E5BF25C091BFC9BF043FD040D7BF68C04DC086401CBFC93FE8BF88C064C060BFCFBE44C09BBFE03F093F5E409ABF0BC0D640FEBF5DC047C08FBE8AC002C07D3CB3409D4014C042BFA2BF894022BFEAC04D40F03F3C4065C04D3F064055C027C0A5BF38C0A4C0E43FEEBFCA3FB2C08DC0BAC0B4BF604091C0D83F884043BE4C3F27C0F0BF024090BEC3C001C0923F14C03CC09B3FD23F44C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4534222F0040863FC0330040FF3F823A583F0040243F0040043FBF3F8E3E772A963F00404D3EF3310040B63C213A993B3E3FFF3FAA3FE43F00403B3C1E3E2D3E00400040B43F0040004000400040B63D663EF43DC93B3929EB3FB63F0040B23E0040873F4F3FBC3F0040DF240040F33FFF3F0040004000405739702D0040DA3FA83ED23F0127F63F5D38053FF4360040B93F9E3F2E3B0040FF3F8B3F543CD833933D6F3C3D3AC53F00404938A43B0040793B943C22259F3FDF240040582FDC3E0D3FAE3D9E3E2E3F0040A63F8B2CF63FE23FB23D0040F43DCA3EBD3F0B3E823D7C2600400040C33F00401F3C3837B038D23F0040EA3DFF3F00406E3F0040153A022D093838370040283E943E0E356E1D27311E32F43FFF3F04293235993FDB3F1B3FA33FD421393F853BB83FE1370040BC3F533EFF3F0040FF3F0040B439FD3F00400040173DCB3FF53FAC2AF83F0040EC3F0C3B004000409D3E0040FF3F4C2CE03F00403C360040653F063FFE3000405F35C73F863E0040503F00400040B03B0040833EF73FE13F873EFF3F003D823A152E0040891F2D3E0040F93CDE3C0040E839023B3733F73E9D2B873CED3F9E3F903FC439DB3FFA3F0040DC3E923800400040663FE03F2E3B163B0040CF3A0040A837873FC130353900403D3A473EFF3F503F98378F31793700408F31D82B7C260040ED3FAD1800400040033F84320040C63FCC3D0040853DA0360040004000403E3F00400040AD3F25393D1B0040113C0040983A00408F3B0040253C0040FB3FB63CB439FF3F0040004000400040E53DF13FF23E004000404938B93F1B3DAB3E473E222F173E0040873F0040E73FF53FFE3FDE3C853DC63C00404C3FA43E00407C26F03F453E283E4D3AFA3F68224539B63F0040E13FAF35FF3F0040F23FFD3FEF3E351FFE3F004000405B31CE3FD83CFF3F00400040E43FB73F0040F53F5A3CE63E7A35F53F00406E1DFF3F00400040A73F0040FF3F7C3F38278B2C0040DC3FF73FC130D13F0040C636033C09380040843E493B00400040F73F00400040413CFF3FD23C004000400040FA3F473500408B3CFE309B3F853E0040FF3F853BA83F0040FF3FDB3D00400040B23DA73C0040"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
