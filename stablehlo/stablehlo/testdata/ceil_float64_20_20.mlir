// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.ceil %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC2EC6224FF8C01C0B24BCA8267AE03C0F882ACDFF14EDABF8B5FA6FABB3316C04ABEA0DC2B530DC0142528094BBE0340D7BEAE66C6FFF4BFDCD42906628221C066748AE3E66B0640A65EBCFEE1670B40541D9563F7F600C0B0F1EE6B9F49FBBF820F5A9F6A2A15C0E2D734DF249A154075CD079A7307F4BFFA815445DE86F6BFA4C91F91FCCF1040299205AF5BEB114025E5F0CA060412C0FCAA4C51759FFFBF26B7DE709BEADFBF5E511E6A083EFD3F99A0A29A035F1DC08A7443C4E78711404C74C9AC9D22DC3F6F10E26C0F7F1540216771C62809BABFCE7484686208E3BFE59BD65B3F8719C0003A2D114E2AE3BFD0AC7D5E2D01E03FDF93DE70309B124002BEEA6DDCB8F3BF3E7DBE8F435107C0516FE333ED0B074085112E0C805300408CE645F2E843F73F64F9D20FABE5F4BF7C2C32BB6EE50A4084CFE04B177411403C45E0B528C910C06C9843911A2FCDBFD018B1C11487FABF0AAC520419E503404492E0F935C7ACBF09A3AA0A4486C1BFF6C9B94728230EC0D8D5AAC740B813C004D658D5EF8EFB3FD4E076677A10044003E3039C6FD90E40E06B621493A111C013D15FD648501CC00449A3E69B8B014016DEDDD3B850EBBFB231E00FCE71FBBF6BC494C67BA6F9BFB6D03B5D1D09E53F35A566F4D42AF03FECB97E1286B41140801F13F95FB4F33F9719A177524002C0C883EE0D4AB4E1BFA248522BAE23C5BFD51152F0BBC703C0740A241F1BE511C0C0398A07A28FE83F1F388A1E6E86FABFF8B0C59D6EB3E6BFDEA187B2AE4D034041837466224416404B6334A67EDB10C0AEC9D8830827ADBFD25179F69DE9D43F7E5D89D8F340F1BFBA6F6126FFEDC33FF7D0077F2C561940A6C9EEF39512DFBF949946F26833EEBF9B7D80D8A764E73FF7F2101567531240E630CA3D0060084096A3A33600D71C4082441A3D67FE0340847329E476B00140496D3FB25289E3BFD1DFB92C8748E2BF2311CDDC5E00FD3F3F03EF264478FBBF7315FF8F1C241340482CC99EF2FC9A3FFD4D93E98F5509402797AE17443311C003EB4AD0A4BE104002E8D638CDBC1140A3B1ECB38E57F5BF5F165C8E326717C0B2689190A678FC3F234E35BEFE71084094D1BDD499E902C0BB176476B568EFBF4A762E5180E60740CB32163D69C6E83F671A36B4A34A044029350320DF3C1DC0880540C40E82FA3F454CCDFCAC02F5BF88D2CF5A72FB00C04006ED0073240D40765636D58C68FC3FCC16ED43E80617C0699BEF2E0A21EE3F6997A85F61AA03C04B6F96FE49050740CC85B8965855D03F2A85A4496317E53F9B7CBACB19A8034040FE5AF1A5110340C0ADBA75AB5FEBBFFE2C09D6600E0CC0FDBD5927BB3FFD3F14E36A55D1B20FC05E5B24BEAD0318C07EE31FB5A700194064A34D7BEB43DE3F919A367B188D15C0DA57864017ECDF3F53FC8668730F16C0E031F2D4F8BB00402CE944DF6639FD3F5EE6CF8A06AC0240167BD4809312FB3F5283044D042410C0C0BCAEBF08ED05C075B16DDF660CF5BF9B31F3FFA785F63F37018A07042E1040FA35F7034DF1F0BFF8C7AF8E9C8402407D4F78AE62C909407153463E5E21FFBF8E32F8E671701240183D62792BE9FFBF7068C15B4971E5BF0515C4D2CFB6F5BF621378ECCE86E7BF9B752820CE161140206D62DCDC80D93FD0E829384B45F33FE9472CEA2494FDBF50F941F87D44FDBF78D9F5C95EF00640C49BDC6490AF0140888F332FA3BD10C0A2B0D8F3ED7400C028A83695D1C2DF3F408F601D16816DBF4E23EB224A1FF6BFC8D1AE9DE69CCE3F8980217FCC5E1E40DBA8DF4023900D40E0D94A86394C21C0053DD1C949FFFEBF98E682B96259F3BF38B32C7CF3B201C0C61D5FC7886E12C0D60827E9050907C02B9A6D395BEA0DC0198832C93D6D05405581F896D6CDE1BFFF8CB05908D60240F42A8B82FA4207C0373AD0A5316F12C0B05704A8642214C0E890845416CA18C0F619E4232D5C0940B351FEBA64D70D40BBD58632AFD2D3BF0A5C30012D3CE33F621BF044FAB8C23F8456B83BEE29FF3F901B9BA495350FC0BA16CA984AA20640D0B8DE0FA624EEBF1FA4FACF7CB606C080FEB8C94B5EFE3F4EC05B8F92C60BC021614D85CEAF02C0A65F9FC3A6E3C2BFD09DE1F3857B07C053E81A93E5FF024044130474959EC1BF9410B8E7D7C9F03F98801127A2C81A40CA2A64A5F464BC3F8A56BF1A2CE6D43F839E14D82759F53F231969CD0FC410C0BE11E1707918E3BFD8D7D41EFEEE10C06A36A19B64790AC0979F5BB8EEC80840F491AE270A7B00403E8B477494F1DCBFA5FC2A81F35DFEBF34858D158ABAFA3FF6B5D881F6550C40C9A23C7DEAA80540E2B85008602EDA3FF0A7BEBBA7410E402A9C5C012DD805C0F830FF8BD86C17C04E8D277E24F201C0F039F2AD6BCF1340AD2029AD9D3DE23FD0A351B4DDA4D33FDE7A8DB28303F0BF3E1D26DF3823B13F6FC5B3BE7DB1054087DF2393F5860040054D403B36C208C0FD0D536ABD3715C0664BDBC8F5F3EBBF089DC17C8533F1BFA87AE489D14205C080E843065B430EC01AAB0EF30FE3BCBF4FA1E29DB967F9BF9E5DCDC010B6E63FD2A96EB89742DF3F9FAAE4B0CC0F0D40088EAB9381F508406CEC5B3FFCDD01401A5B2E181D121040539161E0972512C03A4E7BF9236CFB3F4D0ACE88DBB9FC3FFA4E6DF7AF3506C06FE4D6215B8B0840E05F9EA7DE13F93FBCE8E2F7CA9602C0A8D759FE52D0FFBF5C5B5C75533515C0E41EB8B75BC00840E2E22ADFF1CAEBBFD29AB49DB7AC0C40127E792374F41240E276EA26D04A01C03CCD71CE46BA0040E42D19E31F34FFBF9289706305D90C40506EDD0C62AECCBF0A9476D89CD90BC070202AC91820E03FFCCD51CB985110C0CE9C075EFCBAFE3F06BF907F672B02C0D5BB527535451340047A4083EA020440744EAFE8764D15407A1FB04D8C37024011A1CBA2B867AC3F9C53FC94B473F5BFE4A44A53A6A314C027C45372E8AEBA3F8C9F6D625F750340D1944EADBE0D0240252C855D0E14E6BF9BD3ED2F0494FD3F94B75CAFA732F53FE6AE9295D8B5E53F9C418E8B4F74DB3F9E1E55EC5621FD3F0CC993A7529C03C084B632624D2016C0019DBD93DD510AC04ED6F199A43902C044564F1F837C07C0DDBF4FEDBDC8C23F19EE2EE30B35D5BF30E37F17467BE23F027E68897462F83FB43B99308BC1184058D90211E641BEBF3F1168EC472EF83F1DB4E0BBF6EEEBBF74F566D783460E40D2ECF0A3A3E40EC0A6DF2866C4630540F138897478FE0E408458CE860406064057919C134BF2F4BF82E72C89C3A0154087F68475198410C0C6605CC029C30B409D768D2103A3F23F105CD48D173A0740EF28945BCE1E06C04615478AB43DE0BFDB9E3861672514C0AC9DD802A9420DC0F26F1A89467FFBBFDAC0CEA7F9F3E93F9657AAB536DEF6BFC44CFF6019B225C0DAF937E730EDF6BF30861EFC5ABFE6BFF869545FDB5F10C002B9A35CE22008407539696B63DD16C0E62B784DF50302C06A8374E172F7074026381E04CC2BE0BFBCFFA4C00CFB0CC032F9BCABD43601405859B409C6F1F1BF4027A676D3F609C0320CAA03EF2410C01C1599CEA329E43F4EB6401845BAFBBF467CA492870617C002458F20110C15401E9D8D39FD30C13FFFFE0343E78A0E4074F31F4785F105C0315391AF1FC003C0D51210E8B8190AC089A036B478410740CE99AE96621D07C03B9C0DFFBA74F9BFE3B73315A93F14C039C81E06C370F43F8937001D584D10400FC275D2959B12406BB26B338CF313C0E876D9312822C1BF44B8BDF573E004409B7028D2DEB7E33FF5C75ADB875A1740B0880D68575502C0A7737552A324FCBFB0AB7D577CD81140BF33C1A8C2C9F43F526F0A232F60F23F2A249CE025ED1CC0E6446F86D50505C001DB21937BB5FC3FBA3FCAC079D40D4099E2B23217A2F83FE629A279974302402B0BC45AFEA7D7BF148C4D9350B0D3BF04F8E0834B1903C07AD78787A29B04C0B6DD6A5779F3D23FE9F293FFD40604C05223522FA999EBBF5C10E68EB521FE3FABEC43D8DE5904C06CB2201B6486F83F330AE90E8CC9CABF55E4250AE9141DC0F7785CF9B12A1440F4FFAD5EB64DFABF7ABC505DAAB6FF3FC96174FBFDB2FA3FF6722E9F69B60AC0734E42210436ECBF863D174B6F2A17C04597886FB25AEB3F1DC7D4517CBCF2BF4460D188831F05C0B24DC51F66220840786A074E856A0440EFE9C3FBA79410C0C4297FC508180CC05E268F23D873E5BFF21A439B1C190EC09A02A6522C6103C01CB3097D5FC30C405646EADADF6C0CC0C2C0C7440C15B83FC1573B02C29D19C046EBB8F8E76D174010CC6BA648BEAA3FA012D4BE8604EF3F9AB79269CB8B01C0A65B0F5D9D4CF63FDCD0B04808E50DC08B391F58032100C0762A617832E209C01E7F3A5DD13806C0FA5307B9F287D7BF3D9ADEA5158BF23F4A83B0CDD0450540654213B094ED0440114E61BC521016408CAFCB9A39B9E93F588515A31935F2BF29BEE65EE6D616C0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x00000000000000C000000000000000C0000000000000008000000000000014C000000000000008C00000000000000840000000000000F0BF00000000000020C00000000000000840000000000000104000000000000000C0000000000000F0BF00000000000014C00000000000001840000000000000F0BF000000000000F0BF0000000000001440000000000000144000000000000010C0000000000000F0BF000000000000008000000000000000400000000000001CC00000000000001440000000000000F03F00000000000018400000000000000080000000000000008000000000000018C00000000000000080000000000000F03F0000000000001440000000000000F0BF00000000000000C0000000000000084000000000000008400000000000000040000000000000F0BF0000000000001040000000000000144000000000000010C00000000000000080000000000000F0BF00000000000008400000000000000080000000000000008000000000000008C000000000000010C000000000000000400000000000000840000000000000104000000000000010C00000000000001CC000000000000008400000000000000080000000000000F0BF000000000000F0BF000000000000F03F00000000000000400000000000001440000000000000004000000000000000C00000000000000080000000000000008000000000000000C000000000000010C0000000000000F03F000000000000F0BF00000000000000800000000000000840000000000000184000000000000010C00000000000000080000000000000F03F000000000000F0BF000000000000F03F0000000000001C4000000000000000800000000000000080000000000000F03F00000000000014400000000000001040000000000000204000000000000008400000000000000840000000000000008000000000000000800000000000000040000000000000F0BF0000000000001440000000000000F03F000000000000104000000000000010C000000000000014400000000000001440000000000000F0BF00000000000014C00000000000000040000000000000104000000000000000C000000000000000800000000000000840000000000000F03F00000000000008400000000000001CC00000000000000040000000000000F0BF00000000000000C00000000000001040000000000000004000000000000014C0000000000000F03F00000000000000C00000000000000840000000000000F03F000000000000F03F00000000000008400000000000000840000000000000008000000000000008C0000000000000004000000000000008C000000000000018C00000000000001C40000000000000F03F00000000000014C0000000000000F03F00000000000014C0000000000000084000000000000000400000000000000840000000000000004000000000000010C000000000000000C0000000000000F0BF00000000000000400000000000001440000000000000F0BF00000000000008400000000000001040000000000000F0BF0000000000001440000000000000F0BF0000000000000080000000000000F0BF00000000000000800000000000001440000000000000F03F0000000000000040000000000000F0BF000000000000F0BF0000000000000840000000000000084000000000000010C000000000000000C0000000000000F03F0000000000000080000000000000F0BF000000000000F03F0000000000002040000000000000104000000000000020C0000000000000F0BF000000000000F0BF00000000000000C000000000000010C000000000000000C000000000000008C000000000000008400000000000000080000000000000084000000000000000C000000000000010C000000000000014C000000000000018C0000000000000104000000000000010400000000000000080000000000000F03F000000000000F03F000000000000004000000000000008C00000000000000840000000000000008000000000000000C0000000000000004000000000000008C000000000000000C0000000000000008000000000000000C00000000000000840000000000000008000000000000000400000000000001C40000000000000F03F000000000000F03F000000000000004000000000000010C0000000000000008000000000000010C000000000000008C0000000000000104000000000000008400000000000000080000000000000F0BF000000000000004000000000000010400000000000000840000000000000F03F000000000000104000000000000000C000000000000014C000000000000000C00000000000001440000000000000F03F000000000000F03F000000000000F0BF000000000000F03F0000000000000840000000000000084000000000000008C000000000000014C00000000000000080000000000000F0BF00000000000000C000000000000008C00000000000000080000000000000F0BF000000000000F03F000000000000F03F000000000000104000000000000010400000000000000840000000000000144000000000000010C00000000000000040000000000000004000000000000000C00000000000001040000000000000004000000000000000C0000000000000F0BF00000000000014C0000000000000104000000000000000800000000000001040000000000000144000000000000000C00000000000000840000000000000F0BF0000000000001040000000000000008000000000000008C0000000000000F03F00000000000010C0000000000000004000000000000000C00000000000001440000000000000084000000000000018400000000000000840000000000000F03F000000000000F0BF00000000000014C0000000000000F03F00000000000008400000000000000840000000000000008000000000000000400000000000000040000000000000F03F000000000000F03F000000000000004000000000000000C000000000000014C000000000000008C000000000000000C000000000000000C0000000000000F03F0000000000000080000000000000F03F00000000000000400000000000001C40000000000000008000000000000000400000000000000080000000000000104000000000000008C0000000000000084000000000000010400000000000000840000000000000F0BF000000000000184000000000000010C000000000000010400000000000000040000000000000084000000000000000C0000000000000008000000000000014C000000000000008C0000000000000F0BF000000000000F03F000000000000F0BF00000000000024C0000000000000F0BF000000000000008000000000000010C0000000000000104000000000000014C000000000000000C00000000000000840000000000000008000000000000008C00000000000000840000000000000F0BF00000000000008C000000000000010C0000000000000F03F000000000000F0BF00000000000014C00000000000001840000000000000F03F000000000000104000000000000000C000000000000000C000000000000008C0000000000000084000000000000000C0000000000000F0BF00000000000014C000000000000000400000000000001440000000000000144000000000000010C000000000000000800000000000000840000000000000F03F000000000000184000000000000000C0000000000000F0BF0000000000001440000000000000004000000000000000400000000000001CC000000000000000C000000000000000400000000000001040000000000000004000000000000008400000000000000080000000000000008000000000000000C000000000000000C0000000000000F03F00000000000000C00000000000000080000000000000004000000000000000C0000000000000004000000000000000800000000000001CC00000000000001840000000000000F0BF0000000000000040000000000000004000000000000008C0000000000000008000000000000014C0000000000000F03F000000000000F0BF00000000000000C00000000000001040000000000000084000000000000010C000000000000008C0000000000000008000000000000008C000000000000000C0000000000000104000000000000008C0000000000000F03F00000000000018C00000000000001840000000000000F03F000000000000F03F00000000000000C0000000000000004000000000000008C000000000000000C000000000000008C000000000000000C000000000000000800000000000000040000000000000084000000000000008400000000000001840000000000000F03F000000000000F0BF00000000000014C0"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
