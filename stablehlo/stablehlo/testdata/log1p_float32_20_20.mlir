// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.log_plus_one %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xB4FF4540742B87BFB8D61240429C6C40DAE285BFE403C83FFCDD384043484EC07823BC3FB950AEC04A1EAA3F010DBCBF958ADC4030D324C0E90D0040B4D5D3BF46C7FCBF15C7D9BFA987444056DE583FCA11863E7FC012C08ABE87BF09B61440F36CBA402C87A53FF8C7E63EF5F791C0977C313F9B891840FCA19E400CF38A40C33B9B4062BC2EC07F89413FB15F86BF729F00C0F14F99BF0EF28C40A1280DC046AE2EC068ECE53F14DF893D64583CC043B2F5BFA1BD94C09C044240D000CA3F2E7C873FE4CE59C0AA871DBFD67874403BA30840AD035BC0041032C0FEA638BC4DC964BFEAA27D400B8C2240737B21C097EDF738BD95074005006440D4D966404A3096C01D3EC1C0DD22D6C016A88740969D4C3F4DF31FC0ABDF68C08D38E63FA6C6623FF3648940FD320DBE919D94BF90D1FCBD1F744FC0D66A2740333581BF8AD6683F4C91A5BFCFD43D3FE2162DBC978FC8BFD8E84540982AB0BFCF0FF0BEE45563BFFA51454066A2124076C3BEBF8B02D0C0D7C399BDBFC276400161C440E3A7CC3FAD041D408A1E41C06943084057F0933F457A48C018B2FD3E725182BE47559CBF87AF05400AF773C041120240F10BA33F5DE0623F5DF03FC070B4E5BFC09C8D3F9A7499BF25B685C0CC9331C03A711940F7F18D400D42BAC0C5561AC02FFC1CBFF6E523C0A7BC88C031DD04BF601C86C043290041D2A242C08AAF0540AFABA73FDF22693F5522393E758CF2406988583F9B770DBE247D653FF642CB40C1A83EBF45149DBFD2E9AAC080344D40ED980AC0971B233E99E61240E089A03F9863963DBC33EC3F6B52A440718D84BF9D148D3F0C2CBB3E84D5D2BE7081A44018C6103F111C13C0B48916C02A88B3409959983F28932AC0F557DFC0982A0BBF8993E33F8F42C0C083FF9ABEDDD2AF40428B49C0A9CAF9BED2553AC0CC6B4A40D18635401D893140FED67A3FDBF28440A20AF03F0A93F3BDCAEF64C0313F8C3F4D79E53F2479FABE0747A9BF18D72D3F0B3330405458B33F5CC4BB3F4344ECBEED0F6B3FACDA67BE9B989ABF5EA1E23F8594DFBF526685409498F43F3206413FFC526DC09FAC6B4030DC94C0FF79CF3E3195F13E3F8D6BC0558A4DC0F50DC13F36412EC097D424BF07A9693FCDEC59C07B5E4CC01FB3FD3D7A486AC0065817402B719F4052DF773FEE57C6C0A995C7BE3FA2B6BF54E8963F794BABC0E828B4BE5B8117C0105EB6BE7D5199BFBD50513EF3EE003D69CEA73EEAE7B43FB3188ABF2117124062A0A3C02CA94A401D833CBF242676C0536DB8BF2F1421408722A3BF347D0EBF6B15C6BFBF33DA3D578179C0518EE1BEBF3C95C0ACDC6440D2E985BEF267CD3EDF76B63F5B8154C0AF6E3F40ABE43CC0083AA1BF5D4D4B3EA4A431C093F64DC0EA71933F75476F40EE511640FB4241BF9A07A0BFA1B3783FC3D904406B64DDBFD04C1E4075CAB13F4A91853ED57586BFF457773F7060EEBFD28982BE208DFE40BE10B93F431D14C034B05AC05A392440FD6907C006566FC076D839401AEFC83FE8118BBF68A072401DD7AC3FAE8CFFBFB32325C07C394CC0CB1E9E40DE508BBFA4921FC0C883FEBFECCB26BF23B0774093363F403C7C90BEB696443FCA7E38C07AD3674093F11A3F550472408411303FBB1537BF3BA968C0F374F1BD1B071ABFC88D28BFDD886EC0D527943F87904DC0E8ADFDBD2D779DC03F0DDF3F5AD618BF869F70C0E717D4BE4DDF44BEFFEEB93F22B73E408E83433DB0809240400215C089A7153F4A32B1BE13C046BF5B74A040C8DC994013F891C02699C0BFBF036E408D8A0DC0ED9736BFCFA9793E436496C0D4BA09C0E0DC993E4343AA408F6B0BC17E12A24096CAC8BF4DE8C1BF04F5B6C089A5ED40F22481406663F13FB2066B40E007C8BD08CB7F3ECA62B1401D1A003F79809BBFC01E78C02F3FA43F86B818C0B055A8C0A57063C095A37ABFF6175A40504E76BEAA69D7BFD6466DC097DA4CC0C3735F40910579C02A1DEF3E69F392C084688EC0DAF8D1C0DDCAB3BF2B3FC7BE6BD213C0629E6DC0F37E94408B1B8DBFBFB28640AE2F9A3F827B433FA29595C0502F25BF29B642C040FCA23EBCEBB940E6FE3FC037F2C1C0294F794081E0973F6AC8323FA3107740D3A4C640B397B9C0FD9DCA3FC35AA2C02FE65FBF03342B3F1B265D3F2B3DE23F073F09C0FBF85BBF97D7E33FDBEB653E3B2E0EC09E2CD8C0B1E202C0666386C07FA694C0E3AA8A3E2D527D40E888C740496944BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1669B43FFFFFFFFF5B9A983FDE01C63FFFFFFFFF52E7703F20D4AD3FFFFFFFFF6576673FFFFFFFFF1470583FFFFFFFFFB5360440FFFFFFFF9AA88C3FFFFFFFFFFFFFFFFFFFFFFFFFDAB0B33F81171D3F172A6E3EFFFFFFFFFFFFFFFF10BC993FCFD9F53F2277543FD980BE3EFFFFFFFFBED4063F49049C3F326EE43F1A7BD63F9D20E23FFFFFFFFF7423103FFFFFFFFFFFFFFFFFFFFFFFFF81F7D73FFFFFFFFFFFFFFFFFF89E833FCF6D853DFFFFFFFFFFFFFFFFFFFFFFFF6373B23F5073723FCBD2383FFFFFFFFFBA9674BFCF4FC93F4941923FFFFFFFFFFFFFFFFF64B339BC0D740FC0210FCD3F08CDA13FFFFFFFFFD7E9F738E894913F9849C23FF687C33FFFFFFFFFFFFFFFFFFFFFFFFFC4FDD33FF45E163FFFFFFFFFFFFFFFFF30BA833F6B66223FA84FD53FE1EE17BEFFFFFFFF79EB06BEFFFFFFFF0286A43FFFFFFFFF3698253FFFFFFFFFF6040E3F9B022EBCFFFFFFFFEB5DB43FFFFFFFFFE2FB21BF12210CC01A14B43F937A983FFFFFFFFFFFFFFFFFF8D79FBD0942CA3FFA8DFB3F0080743F6CA39E3FFFFFFFFF1904923F6AA5443FFFFFFFFF430FCE3EB96496BEFFFFFFFF975B903FFFFFFFFFF0FE8D3FC24A523F0D74223FFFFFFFFFFFFFFFFF5BB53E3FFFFFFFFFFFFFFFFFFFFFFFFFEA8C9C3F5DB4D83FFFFFFFFFFFFFFFFF1C2D73BFFFFFFFFFFFFFFFFF075D3BBFFFFFFFFFA8B10C40FFFFFFFF995B903FC853563F2DC0253F2E2D2A3EA68F0940F8E81C3F7C3E18BEA7D5233FEA5AFF3FB2CAAEBFFFFFFFFFFFFFFFFF32E2B73FFFFFFFFFC559173EFEA3983F9013503FA41F913DCCD8853FCF31E83FFFFFFFFFF6333E3F65869F3E8AD907BF7350E83F0F7DE53EFFFFFFFFFFFFFFFFF4BEF13FC8B4483FFFFFFFFFFFFFFFFF2ED048BF61C7823FFFFFFFFF669EB8BE6D7BEF3FFFFFFFFFB74F2BBFFFFFFFFF8F8DB63F4F19AC3F4A00AA3F3DDA2E3F30E8D13F6F30873F09A901BEFFFFFFFF99683D3FC875833F4AFA2BBFFFFFFFFF1FAB043F824AA93FA73D603F5529673F9A6F1EBFB7C1263FA27183BEFFFFFFFF1770823FFFFFFFFFAB41D23F72C3883FA2D80F3FFFFFFFFFAC9BC53FFFFFFFFF9A2EAE3E31E5C53EFFFFFFFFFFFFFFFFA3696B3FFFFFFFFF872784BF5A06263FFFFFFFFFFFFFFFFF862CEF3DFFFFFFFF264F9B3F04F9E43F68592D3FFFFFFFFF62ECFCBEFFFFFFFFB762473FFFFFFFFF220ADEBEFFFFFFFF0875E1BEFFFFFFFF05743E3E36E4FD3CB824913EA489613FFFFFFFFFD525983FFFFFFFFF08ABB63F48A7AABFFFFFFFFFFFFFFFFFFAF7A03FFFFFFFFF033350BFFFFFFFFFC957CF3DFFFFFFFF14AE14BFFFFFFFFF2EAAC23F323D9BBEDCB4AC3E71D3623FFFFFFFFF5B29B13FFFFFFFFFFFFFFFFFC772393EFFFFFFFFFFFFFFFF0330443F7D23C73FFDB29A3F82FEB3BFFFFFFFFF2FC52D3FE2D08F3FFFFFFFFFE9609F3F68F15E3F585E6D3EFFFFFFFF99142D3FFFFFFFFF5EB096BEB44C0C4036F6643FFFFFFFFFFFFFFFFFB3BEA23FFFFFFFFFFFFFFFFFB354AE3FA29E713FFFFFFFFF308BC83FBCC35A3FFFFFFFFFFFFFFFFFFFFFFFFFFD15E43FFFFFFFFFFFFFFFFFFFFFFFFFEDF186BFABA3CA3F3A0DB13F67C2A9BED4DE113FFFFFFFFF29F4C33F9651F23EF749C83FF8FD053FB9C0A0BFFFFFFFFF957500BE5EA46BBFE17D89BFFFFFFFFFDED8443FFFFFFFFF316907BEFFFFFFFFBF23813FB8AB68BFFFFFFFFF28EC08BF11A35ABEB4AB653F3FCDB03FB4FD3E3DDC03DC3FFFFFFFFF9CAFEB3EDA7CD9BE6EB6BFBFDAA5E53FCA2FE13FFFFFFFFFFFFFFFFF959AC63FFFFFFFFF9FE49FBFC46A5F3EFFFFFFFFFFFFFFFF5988863EAD02EC3FFFFFFFFF24B8E63FFFFFFFFFFFFFFFFFFFFFFFFF7868084095EBCE3F1EA8873FB854C53F6C7CD2BD5D55643ED270F03FEEBBCF3EFFFFFFFFFFFFFFFF7558533FFFFFFFFFFFFFFFFFFFFFFFFFF66C77C09BDEBD3FF6DE8CBEFFFFFFFFFFFFFFFFFFFFFFFF3947C03FFFFFFFFF1337C43EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB65EFCBEFFFFFFFFFFFFFFFFBA6FDD3FFFFFFFFFEC41D33FA3604A3F723E113FFFFFFFFF26A784BFFFFFFFFFE47F8D3E008EF53FFFFFFFFFFFFFFFFFA94DCB3F1C46483F6898073F1A62CA3F59D1FC3FFFFFFFFF20ED723FFFFFFFFF05E204C0D317033F10661F3FE84B823FFFFFFFFFADFEFABFDFDF823FAB6B4F3EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF266D753E93EECC3FAF4FFD3F4696BABF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
