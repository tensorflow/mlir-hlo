// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.sqrt %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1AF8E9B41B24DD3F56B012AFFF7114402685E814054DE7BFEA8D48D520E5EE3FB20792BBAF0CF1BF85173BA3667D10C07E521AC501CADCBF4C6B0E7EF27A06C056BCF238E500064087B475EE161AF23F00C0D31CA2C500C01C65DD45D3DC014029578907EC4713C016920FBAE6BDE3BFA3902C57B0830AC0E4583F0D2AD6DF3FD6F0C5959BAA17C0A22194F45846124085BED746FCC8D0BFFD9AB3768B3CFE3F5C7ABEE17FCE1CC0100A40F6FA3A0940E541712CFCE507C0FDFABF8EBD18B53FF19FF0AE6047E43F704DC4DB394AC7BF60C7A733E4A4C23F409512DE7C27D53F9456B7E73EAC00C0667754E39493F5BF994996EB18FC15C072FC0E4B1E7AD5BFF42B10333001FF3FC0BB79CFDF18E1BFAC36F704D4260E40484E93719C0FFE3F76886777FEB0BDBF89B9A8DF6398FABF58B13701E4AE03C09D1A27E4FFA813C0F60C5F6543B811C0AC94ADB95513EFBF42E32830F02B004032272D0918D7F8BF630470B805BED83F8A4FB2BFB36E094075B3D8DDD441E9BFFC973E0455A9F13F77B05B0C19B010C02583AF5E2ECADDBF0E7F2C94C6E80E40D685F7EDF5BAF23F3A76F4619E38DFBF3680CBEC67DBEA3F96F12E1B2398D53F2A3A92E7DE8510C0A0FF36AA2682CBBFFC2C840E2D7516C0D25DBCADB528E83FDF09A2F23F2B06406D56028C10B807400615A5F1094003409CE5B697CA0A07401A8461B2D911F03FD5AC814EE7A91040D97083438637C0BFCCB3CA58AEB70B40826394275326D63FAE8CCE13E192ED3F38D2C96352430DC02B0DAB7D7B7CEC3F8A18E9849A4A0BC0825E01738D14FE3FBFB05FD7E83CF53FF85B227344D1D3BF3ABD344907BFF13F6CC4FC2462C9FBBF5E4BD4653147F83F98E4ED4F7759F63FC41D2EF5880512C0BCCE02C278CA0F40935571805DEFE23F5DB0AD8378920F40377BF802D9EF07C0D3DED9648CBFE73F675D6D974418F33FDE8A40416FBD16405D22FF12636E0240DF4348F8072700C03DE90518578DF93F7D920D210BBFF2BF68A4F63FCC83F1BFA6289CAE1CDCEEBF8C90831F4FF90A40F67E6077BECEC8BFABAC08612138F73FC8566F3607D4F3BF72AB78F6FFEDF73F5E994256E20C06402C3E1B9C4ECAD93FB2824A8E7241F5BFE5F9C446AD64F03FA8FA19BAAA13F73FBAD3029E6089C93F72CB840CDB6EC4BF43585AAE92F8E83F3003452005C5D0BF40EFAA105093E43FD5F51260248AC4BF5F7AA4E045F0FC3F45E70EA66F8DE13FEE36A0DB4B831040C1086B9E275B134098696A5E59DBB83FF8764E7D90A512C08FFAD82299D7F2BFFB7F6E7C7AAE10C0367C2E01E595F73FFABE44794C41FC3FCE49BADC2AAAE73FE2233B288F0DE43FD2FFFAEEA8171340E51B29275409E3BF637A16BF4B460EC078D0B7943113FEBF329AEBA80A06FBBF063464F8872112C0B60FA350EF1DE03F32DA489828C616C016717223A3BDC83F96CA7A9F690DF43F3D144FECA041FB3FCDE10E4EED8D08C024477ABAE7AED8BF68F42DCF69FEF1BFB46AC98CF22503404F4805039836F03FDE23AF4741BBFDBF0AB2EBE776FE10C002DB46187F9AFBBFD6248AF1AD250A40991EC8D9DA3CDCBF3AA123857E7CE13FA255FF0C3D5E06C060F85722C989EEBF64DCAC525498C4BF0F994C6C5DF40F402101C4A793A5F4BFEACB82A30EF3F63FD729E94C9E920540982C8D60240D11400CCE3AA66A7902409FAD3F4CEF73F23F97D3FF7A92D4E9BF03BF7F4CB68B154066272E93A77006C0D22BBB2EE1611EC09C6ACAB8EF08D93F6A582F0D9D2403C08FE9EDE05FAC0840048F8886EBBCEDBF009798A056B9054029F00C93AC6000C005EE4BF1512E0040809AC1245CC60AC0826D519E0EED0040CC074608EA92144090A14213243CFB3F720DF44288150740FA662B49763FCE3F3577DB5AD76E02C0154C0CDA149DF2BF92DF85B2DC5FFA3F84F33AD6889CF2BF5C531E41DD2704C013BDC1D8BD79EE3F8AA44449780D0E407F5CB90EA5210240F72BC7A2C23615C0B7ECC506EA8DCABF08C2D259B06FFD3F7E29A3E264EBF33FDF3274016F3C06C0E4EE93BE7A27FC3F685450B1EEF6EBBFA1722A9EB4762140D42CD14A57ABC13F2A0737B1C673EDBFC6C45138B4FB04C09828DFAE90060BC0896DAD55EDB4EEBF91F67A4A433903C03DE3FD791B37134073279CF758921740B616C27E840E02C00C7EDA7C40A008404C8B7AE7D45FDB3F22FEB4A73558054050E7112EB83303C05A215C2E1C41F63F616FD942F2F218C07DF2E425FC73F23F8CFEE061AA40C83FE0DE423C83D40BC091173824A5F0FFBFB6AFF60DEC31E83F041C51D4C6AB0C40A0582C9C33310540C6360966B4A513404AC712239694E13F0A6E6A2B0F50D0BF4064AAEEDF98F13FE825483372CD04C08068CD7FA4E4E3BF7DEB0EACB6F42340E8755B4365B70D40CBCB5EB894EBF9BFF6F733CC649004C004118BBB2CA3FEBFE12D26DCC09E1CC0C2F8DA0DB22402C07C001513CD7AD3BF065237C7150E00C0A8014BB5EA67F93F2F47ED94A17A114093E9C8BDCCF0F3BF6A925A3D725801C033248AF85A66E03FB681C068CD9E0B40B4EE95B1D7ABF6BF2DE5FEB0F52FE7BFB80C354C5DB010C004CD26FB6C40E23FEB25D1871BCC02C04664D57E71C9F6BF88B8BADF24C80940D2D8777804A413C0AA629AE428C00FC082011FAFB153104016F87ECCB13016C061ABDCC361570640B0773FFAE85302C0533D7843CBBD12401E756BEE12E015C042226E230B010D4026B78BCDA53B0640D58A6D489C3910401CA22F093FF307C02A8986113B001EC010EBA89751E4E8BF82432F722D3A04C03CEDA7ED33CA05C0A4292C3D6CAB02C002396B50C118DB3F92C05A186A0709C0E12F7C5F121C0640B3EAC0029456E03F06F5849D8EDE0840A5ED8B742314F03FA2CBC0576BD8F73FBEFA4D80320218C0F2D22994E7E4E3BFF87C6DA989BA00C0B2BC41889CF7F03F9224127CDDB2E0BF2244D0866D34EB3F03C043C2E6E6154022BBD0B6D589B33FE146DEF8AD0AD83FC0BFE92776E8FBBFBF412CDAA856C1BFA407356645B2114003C3E29651B100405CE1E9B957DE01400FC8518FF6EBFC3F44C37325E1DCF63FAB5E888520C9FFBF5873AAB1AED30AC0C279AA660355DF3FCEDD65AFB09D0AC0AFA9B1C322F601C0D3EC39B319C903C012AD1FF6A13502C0D945BC3C7B12D5BF8C982D807CCE10C0FA1212042EA2DD3F3E26746B4624FDBFB0D65FF43DBDEB3F4EA17CD7CB8008C0C28BF3F9D82EFB3F59883A1B0414F03F457DF289B52410C06E0D47ABCAFAEEBF63A6A97E6EA51240EB6010F623891240C6534EF6E60BFE3F6A749BD02871E33FC0120054608FDF3FDE0AEFF688300840338B4B40FB4A05C079756C51FED3F03F366B331F860911C09FA9CC5058FDE0BFC090B087797C1640B1187AB11DE703C0B66CB71395BB0940C674421EA7ECE33F85A46812688EF33FB39FBFE27B3A0640D66B85ADCF6FE63F6EA51FE0FA21D53FA227B53AADC0C93F19E0D97D984005408454355A2A2BCF3FDADE56176EFEF7BF35812A76F9F10640D60615B13C84ECBF16B3B787E65109404A269A82C36BCDBF288E078FB7E51040EBF50395980E03C08DE912D1803CE6BF8A4CC6B1FA13D63FB286B4F6D90B08404AAEDB88252AF03F98A66152C9F2FDBFE4CDC505ECCDFD3FF43CD66A635C01C0A20A59AC9D7D0540E04654C2E0470AC0FF67D63C9432EF3F460DD95C226E0CC0F324CDFBD0B8D93FE0A6CE31BC360A40A804EFD81072FB3F54A054E098E203409D90517C4C3BEFBFC5156E02F9C3F03F22412CB83CE8D0BF60A38ADAED1F0F401A26509FFEB9034060FE95E753ACE93F1E2B32D767FAFF3F82D9BB8D9C9B12C0F282EEF0DF620340D8DF51BEAB8A16C0CC34C34AB68601404E7455888AFD13C0D1A707873C45F7BF1C189077CA5F0DC0D6CDD9C14482F8BFD0899429807F06C062350958AB92034009C2984616D8F43FE9D13EECFCDB1340FBB40F75F60E11C001DFECC58B0C064064BDA22D1BA9FF3F2C8F2F79ED2CC43FE61FD42C1D2DD33F70FCB832C6DEE1BFB842F539E584ECBF701E23A4804B0E40EEDFFD0B80D216C08FA2C8194ADA0BC05A560EE673A897BF806658CEB7FD004078082D4B70F4F03F28F4DFCD8DEE0B40C79A596098B3F4BF58D2E6F701C9F9BF2EB1794CA0191A403A957CD17ADF1DC008DEDBBB2CF0F1BF64372538035303401893E67D9A5E04C00F5BDB95E56AF9BF5F9F8ADE6DB0E33F6094C464A8E9ECBFEAA9FBE9F48FF93FD1BA3EF307F3E9BFEA3C046468760040EA4E4D810568F13FC4BBF7FFECE0E33F5AA2B0962C3B18C0FC74D32C149D0840C38C83ACBF4EFDBF90712EF8B83A0440BC7D0F5C499013C01B25BFE98E3301C0467E7CB354A202402364759AE8C1F83FF7EFA9C15C6EE6BF4A37075069F9ED3F7E61199AA8A0FF3F92A06B31D1751440B8425DC74239F6BF4986D7CF01001B4078D0B0BF71FD04C06AD4DE41D299B83F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x25976781CD97E53F4120EF182B160240000000000000F8FFBB6B2B565271EF3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF48DD86CCFC88FA3FE3DEB7D5BE04F13F000000000000F8FF13EE3A5981E8F73F000000000000F8FF000000000000F8FF000000000000F8FF521BDE03CF91E63F000000000000F8FFBFCEB22580190140000000000000F8FF58D28550BEFEF53F000000000000F8FFF1F2C8AC0F6AFC3F000000000000F8FFDAABC0BD575FD23F62D8E3E35479E93F000000000000F8FF16604A1FF66CD83F00ADC585C265E23F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFEC1EE949D145F63F000000000000F8FF569CA039E50FFF3FFC260E6060EEF53F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFED9FA9DA9ABFF63F000000000000F8FFB9B8B9628AE5E33F300AE5A62087FC3F000000000000F8FFB1B7F51B6ACFF03F000000000000F8FF000000000000F8FF6C4B236E2D73FF3F91B681CDB84FF13F000000000000F8FF108F1804E350ED3F99FB650C7E96E23F000000000000F8FF000000000000F8FF000000000000F8FFA6F3B6EEF1CDEB3FB151E0717AA2FA3FAFC2B16FD38CFB3F1A8B9027C7D1F83FE7AD4BA77727FB3F9BA54D5DEA08F03FC35514B016540040000000000000F8FF7C2D580429C8FD3F5B3817BF4CD3E23FBFD85F8D51C3EE3F000000000000F8FF8614A9A32A31EE3F000000000000F8FF15C444BF2DF0F53F607B5AD4106FF23F000000000000F8FFB94DA33ABAD9F03F000000000000F8FF4117C12289B5F33FAA1E07E0FBE8F23F000000000000F8FF76FF532631E5FF3F5D32CB7F8E9DE83FD2134F140DC9FF3F000000000000F8FF176FC1BD2B91EB3F1ED5C030A27AF13FFFEB01C71713034061D835E32749F83F000000000000F8FFDA8C1E333A38F43F000000000000F8FF000000000000F8FF000000000000F8FFC40102853061FD3F000000000000F8FFEDA4B7B04846F33F000000000000F8FFFCCB9D793391F33F0AFFF3693690FA3F31F29D114B50E43F000000000000F8FF7CDC17690832F03FE7F7B3552037F33F9134FCBE1296DC3F000000000000F8FFC205CD239244EC3F000000000000F8FF7A5BFD4BDAA8E93F000000000000F8FFE37D0B969084F53F872D5BB424B3E73F89F21E5E21410040D10FED9E24990140A1FB158F51F1D33F000000000000F8FF000000000000F8FF000000000000F8FFA3F866890C6DF33F775484921F43F53FF5B06317C084EB3FE7678121EA54E93F20FFE7F15A7A0140000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF82115F51BFB5E63F000000000000F8FF1D27339B2223DC3FA9C6932A76E9F13F2B94D4940FE2F43F000000000000F8FF000000000000F8FF000000000000F8FF7C099E87EFC0F83FE85EF1DF341BF03F000000000000F8FF000000000000F8FF000000000000F8FF77D5A3520AEDFC3F000000000000F8FF8D4989E4B1A7E73F000000000000F8FF000000000000F8FF000000000000F8FFDFB9AD2E2EFAFF3F000000000000F8FFDCAA76EE8729F33F10F03D202A46FA3F1E7331226E840040D52E1A096B50F83F73191DD8C62EF13F000000000000F8FFDD66B24B24910240000000000000F8FF000000000000F8FFE248FFC49203E43F000000000000F8FF0B1004EB4F19FC3F000000000000F8FF4D8B2FD8B35DFA3F000000000000F8FF9DF0ECA847C1F63F000000000000F8FF7D1400C7E245F73F4C0E855EB4240240C03D5A4CF5DFF43F85214E19CB2DFB3F9DE27CFA921CDF3F000000000000F8FF000000000000F8FFC7F9379DDC8AF43F000000000000F8FF000000000000F8FF995A41637D3AEF3FDD399099D202FF3F123E61986316F83F000000000000F8FF000000000000F8FFC38F4CEFBBB3F53F607E5A203EDAF13F000000000000F8FFD27C84686639F53F000000000000F8FFAB53383AC7A3074039D1898C4CC7D73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFE9DD8AEDB98801409EA2B588966B0340000000000000F8FFDB1B7CF16712FC3FF2A828659EEDE43F2AC20F488022FA3F000000000000F8FF0019F942ABDEF23F000000000000F8FF2B45B7D3CC2EF13F29674B91B7DBDB3F000000000000F8FF000000000000F8FFD1C13A8C3ED3EB3F6D660F71304AFE3F11582CC3930AFA3F737B1C03E8BA014088A05EFFF7B7E73F000000000000F8FF2E01054593C7F03F000000000000F8FF000000000000F8FF852EAED933450940742126C049D6FE3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC841503C6629F43F0F5442BC21B90040000000000000F8FF000000000000F8FFB5F8165F8CE8E63F7C9C1C5EC8BAFD3F000000000000F8FF000000000000F8FF000000000000F8FF7CA0A727CD2AE83F000000000000F8FF000000000000F8FFC24417D41EB9FC3F000000000000F8FF000000000000F8FF2A247DABA2290040000000000000F8FFA4E60122F0BCFA3F000000000000F8FF4DA559F207510140000000000000F8FFCE3631871977FE3F18C71C5D52ACFA3FA9E08D64B41C0040000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF184EE33B61D2E43F000000000000F8FF1238CDBC5A99FA3F65B3E4C484DDE63FBB05489BD435FC3F5D9E24910E0AF03F32C426C15E88F33F000000000000F8FF000000000000F8FF000000000000F8FF1FBF4B39FD79F03F000000000000F8FFC73EDE115181ED3F24BDC78E45B8024043C0944C50AED13F4585ADBBE99CE33F000000000000F8FF000000000000F8FF7B088F9DAAD3004036D01B73AC1CF73FDD983B4A85E9F73FC7BA6F54F682F53F8ECBE1674320F33F000000000000F8FF000000000000F8FF31B631D7D863E63F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFF5E57FBE50C6E53F000000000000F8FF4D227CAF25CBED3F000000000000F8FFA692F47BDCDAF43FD74D48EEFE09F03F000000000000F8FF000000000000F8FF246136FAC2450140FFEC4483A3380140E73DD2FB05EDF53F91BF9D845DF1E83F10E03E96A978E63F3A14585A72D2FB3F000000000000F8FF1572A7DBA868F03F000000000000F8FF000000000000F8FF3C927499C5F70240000000000000F8FF25BDD8A31EB2FC3F1A369FC91840E93F44037AB961B0F13FFC69C9A59FABFA3F2A60017A8ACBEA3F2F0D463E5D63E23F26BDF3A8F5B4DC3F4EBF795B0714FA3FC12160E4E194DF3F000000000000F8FF1411B743D418FB3F000000000000F8FFD182E5C1F476FC3F000000000000F8FFE8E95EAF4A710040000000000000F8FF000000000000F8FF5E41CB547FCBE23F4C3434B951BDFB3FC14EEAF50415F03F000000000000F8FF4CFAA3F85CD6F53F000000000000F8FF06F40ED45C39FA3F000000000000F8FFD355242FA398EF3F000000000000F8FF9937C2806649E43F1C5796EB77F6FC3F700EDB9995F4F43F97FBF2CDB839F93F000000000000F8FF95FCF26ED760F03F000000000000F8FF27EAE312308FFF3FA17C92BEEA1FF93F538E51F59BA9EC3F4E9116F8A39EF63F000000000000F8FFC839BF1132E8F83F000000000000F8FF38C44A299AAEF73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFCAE3E820D306F93F4BD5E3081B43F23F16C3926F55D30140000000000000F8FF76DAD3450290FA3FA06986B3D081F63F347C2D83B268D93F3F1F4D192A84E13F000000000000F8FF000000000000F8FF6FC1598CC322FF3F000000000000F8FF000000000000F8FF000000000000F8FF34E1493F5451F73F303D25C77278F03F393CE15495E5FD3F000000000000F8FF000000000000F8FF10E86D0F706F0440000000000000F8FF000000000000F8FF2D0CD26AFFDDF83F000000000000F8FF000000000000F8FF59BC8A94D219E93F000000000000F8FFF5C0DB304339F43F000000000000F8FFE5E5AECABFF3F63FDD97A05438B0F03F711A9663A938E93F000000000000F8FFF8D92FE59810FC3F000000000000F8FF6E29EECE6071F93F000000000000F8FF000000000000F8FF4ACBDDAD486BF83F111D3F581AE7F33F000000000000F8FF19230D8177F8EE3F63BBBCD3CF7EF63F59B61463DB170240000000000000F8FFE89DCAE0DCC80440000000000000F8FF537DE3CDF6D6D33F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
