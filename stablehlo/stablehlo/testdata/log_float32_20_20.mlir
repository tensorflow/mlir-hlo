// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.log %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC2B333BF72E849BF639A4FC0EEDE3EBD2C008F3F567D8FBE1FA8A7BF9528E0BF4D0436BFAB4FA7BF7E83A2400DD9D2C0F69B973FD0880640BF48D03E63A98240EF1407C0893F0B403E4E2CC0E627C93F84DA9AC0F303A1BFBFD4FEBF94D517BF9EA5203F9F5B9C3E2CA9E73F0AFED2BD5AB87E40B05744BF8884173ECA9F6B4088AE553FA31C4CC07CD846BF9D572DBE21811CC0DE5B274075ADA03EBA41C93F8652863F329D1C40CB1FF43F84133AC0F7EFFCBFB8A45440EAAAF5BF40EBCEC0AAA200C05039283F0FA09CC0C8A4D3BF3910523FA7E5C03FBB10BE3F997FDEC090FAC1406680C8BE717BBFBF9818F6BF78AE5EC092327D40D124824076677EBF23BD55BE867D87C08DB289406D035B405CF3804029165E4081F62440C2A2B3406233733F4671A5408B27073ED24BBEBD7C29AC3FC34AA4BF2CD16CC00CC9E53F29836340B087B1BD3E15993F3A807F3F79FF53403F205D4069B98640C6F99EBF69E91340A0BDDD3F79A16240F243C13F1C9B30C0B3B4B4C0A1151740DA4BE63EC65D923FE1164D406BC835BFA1C5BE4007EEA5BFBC27FD3E810FA93D73246AC0A53D4DBFCFCAA53D109CB93F961CB9BF152217C0282DF33FD82DEE3F2D9A24BFADCB2240FDFE62C069191A3ED44406BF09BE4D3E913322C0C5C18C3F44EB13C0A1FBC54053B01B3E794981C09D145D3FF312E13FCCEEAB40249AC640272FA93FEFF2B0BEE7FC773F8EFEE94086FAA23F5CF9C4BF620A3CC06A57A4BF328D9C3FBF9A20403536AB3EABF14A3EA3CDDFBF1E77ABC0FB206440555139BDCD3C534096FE55C017E8EFC08F3C39BF85AFCD3FD8D85A403203C43F7FA3F6BE65F00C3D60153AC070CC4140609F13C08B9161C06694A6BF9686B33FE2B4ABBFD3B2EDBFC2BBDCBFD4E41340392AB3C06358B3C0BCFA42C0D64A803E7B4C4E3F48823140EDB1BFBF1746E73E9806D9BFC4559ABF8B4DC7BDC9A6BD3F9339683F9CD2B1C0868515BEB4DBA140512696C0AD8C9A3F9E5280BF326D16BF853A08C05A844DC0CDE9893F6DE8FEBFE146834063B542BE263BDABF9617CD3F9F3006C01CA993C0EA4D9DBF099A9FC027F656C05525404079B438C0FC56E4BFA4B78240AE00DBBF2E89EE3E9D9D123F9540E03F87FC1E40F7C51BC0484080C06235B3BEBE432EC08A1E04408C2405C0AD32A540D67C6BBF617D16C085CD15C0686E584069C62CC0810794C0D073F4BFDF4CA4C06C352C3F85F2434028A45F4054FAC7BFD4609240F4CED1C0A7425440A198B6BF72AA954011D35EC0C74F9C404C40064063948E3FF6E48640D79D20C0EAAEA43F282E3440064AA5C06C4ACC3FE931F03DAEB0FA3E1E0D653F6265C9BF6AA05340762D1940EB33FCBF87A081407DD934BF9756AC3F54DE24BF5E00B0406A2D7D4025401840A834FF3F954ED8BE6A8D09C0A4E031C064D688C0DEA39B40B76A2140628ADB3FE8AF8FC0A9F7EEBFBA19773F21FB073F27CA823E72F99BC050DA6940F668543E1FFD9FBF8B88A8C0FDDA07406699303EAA9892BEB28090BFF8B9074001110240C88228BE2F4F4B4046CB5940885593BF556DDBC0E3F0303F90232B40720C54409A0901C13907AA3F8D198140023902406CA9B43F429DD33E2E372240D679D83F66D2753EF23D923EAA2FF13D33B5BCC0D5721BC015C50FC00270B3403C879FBF5703EBBF9BE8783F7F66694028C2B03F237FC9400B5B82C09187BE400EB243C0CCF97CC0CAD2313F21668BC064A55BBD80FB08C0C11D023F392D463FE26EEDBF368214C0215B4BC005465440A36287C0FB342240C4203E3FF3489DC09C816740DB44653F70564F404B05E83F27FED4C081765B3F6F40674056EC24BED308763E24158E3FE73D2240C73FB1C0D316593FBD0C3C3F7D4EA540B3A9FABF46947E3F8F6B7C40792273C0D4159340BAFA5E3F6212FBBD0689A2BF050C52C077ADBEBF94B8853E28FD2AC0E22FABC0AAC30B40358984BFDC4517C0CC35F5C087DB92C018159C40D979564030FBADBFAB65FF3D09D94640C85571C0FD0BB1BF45B6C23EA85299C06B5F25BEC2DCC9C0684E9C3DF5A977BFAB9C7EBF16B72DC0581488BF000F4CC0711F51C091E90C4005E135C06D614ABE888CE93F1B20BA40A8DD48406429A4BF7CC604C0F87E833FC37CCD3F5757813F08D81B40F5FC85C00FE1913F9BEA9940EE22DBBE58CE1ABF8CAA9FBFEC86F9BE56F21D3FD1858040379B813FF84CCDBF47670EC19FEC04C09CC3A340"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF1BF5E23DFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDA00D03FFFFFFFFFB3562D3E1F313E3F7A4066BF7E14B43FFFFFFFFF0802473FFFFFFFFF1073E73EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6893EEBEA6D497BFD8DE173FFFFFFFFFDCCDB03FFFFFFFFF1794F4BF56D4A63FB40639BEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF514763FA75794BFC9B4E73E427A453D4218653F1C49253FFFFFFFFFFFFFFFFFA4B1993FFFFFFFFFFFFFFFFFFFFFFFFFBDFAD6BEFFFFFFFFFFFFFFFFBF834ABE1BFCD13EB469CA3EFFFFFFFF5BA8E63FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6709B03F5D92B33FFFFFFFFFFFFFFFFFFFFFFFFF19CBBA3FD3789D3F8E64B23F6D419F3FF263723F34D3DC3FD71552BD244AD23F7A9A01C0FFFFFFFF84C2973EFFFFFFFFFFFFFFFF1ECA153F5B58A23FFFFFFFFFA13E373EDBCBFFBA054E993F63B39E3FD0FFB73FFFFFFFFFA875563FA0AA0C3F23D9A13F24F6D23EFFFFFFFFFFFFFFFF8CE45B3F81884CBFD34C093E6410953FFFFFFFFF1F86E43FFFFFFFFF704E34BFA0A31FC0FFFFFFFFFFFFFFFF78E320C05F44BE3EFFFFFFFFFFFFFFFF2D4A243F5EF91E3FFFFFFFFF39016F3FFFFFFFFF7E6AF2BFFFFFFFFFA36BCDBFFFFFFFFF8491C23DFFFFFFFFE045E93F3A1AF1BFFFFFFFFF892B16BE757C103F1037D73F32ACE93F8CD38E3EFFFFFFFF163E02BDF0A9FE3F0663773EFFFFFFFFFFFFFFFFFFFFFFFF05304E3E28896B3FD7368CBF5F2CCFBFFFFFFFFFFFFFFFFF07B1A23FFFFFFFFF45D8983FFFFFFFFFFFFFFFFFFFFFFFFFE4D9F23EEE5F9D3F1430DA3EFFFFFFFFE2A457C0FFFFFFFFDCD08D3FFFFFFFFFFFFFFFFFFFFFFFFF1E34AD3EFFFFFFFFFFFFFFFFFFFFFFFFBA6D563FFFFFFFFFFFFFFFFFFFFFFFFF5827B1BF54085DBEDF93823FFFFFFFFFED724BBFFFFFFFFFFFFFFFFFFFFFFFFFFF4BC93EF59EC7BDFFFFFFFFFFFFFFFF6E7CCF3FFFFFFFFF0402413EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2FC5983DFFFFFFFF6AAEB43FFFFFFFFFFFFFFFFF265FF13EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF35B88C3FFFFFFFFFFFFFFFFF7422B43FFFFFFFFFB98843BF53AF0EBFBF8C0F3F8EF1683FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF28D393FFFFFFFFFAD19D23FFFFFFFFFFFFFFFFFFFFFFFFF34F49B3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2DFECABE2D3A8F3F0326A03FFFFFFFFF5E9EC23FFFFFFFFF8E76993FFFFFFFFF2D76C53FFFFFFFFFD705CB3FFDA63D3F2CEBDC3D2A29B83FFFFFFFFF5205813E567D843FFFFFFFFFF65DEF3EAA2909C0B6CF36BF74CDE3BDFFFFFFFF9314993F3D6A5F3FFFFFFFFFFF0FB33FFFFFFFFF9648983EFFFFFFFF7435DA3FCB06B03F6ADC5D3F6FA6303FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC478CA3FD2D36C3F1D1D0A3FFFFFFFFFFFFFFFFF10ED10BD2BF621BF9DAFAEBFFFFFFFFF0FDDA53F8A56C9BFFFFFFFFFFFFFFFFF7CB1403FADF8E0BFFFFFFFFFFFFFFFFF3C73403FA78B353FFFFFFFFFBEF2933FE1C19C3FFFFFFFFFFFFFFFFFED1CBDBEB8CC7B3FDA55993FFFFFFFFFD05F913E718AB23F57DA353FF56EB03EF33062BF4A176E3FD483063F80A3B6BF5664A0BF31E608C0FFFFFFFFFFFFFFFFFFFFFFFF06AFDC3FFFFFFFFFFFFFFFFF6820E6BC9B9DA53FF93FA53E5386EB3FFFFFFFFF745CE43FFFFFFFFFFFFFFFFFE090BABEFFFFFFFFFFFFFFFFFFFFFFFF723F2DBFE01483BEFFFFFFFFFFFFFFFFFFFFFFFF9678993FFFFFFFFFD2136E3F4B4F98BEFFFFFFFF9A92A43F52DBE1BDA875963F9144183FFFFFFFFFA9B01DBE8C6EA43FFFFFFFFF2C87B6BF3AC4D53DE6216E3FFFFFFFFF81D328BEE4EF9DBE382FD23FFFFFFFFFAD5EB6BBA4A4AF3FFFFFFFFF433CC33F93690DBEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4DD9ABBFFFFFFFFFFFFFFFFF7FF4473FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC0D5CA3FD2CA9A3FFFFFFFFF333C05C0A91B913FFFFFFFFFFFFFFFFF698077BFFFFFFFFFFFFFFFFFFFFFFFFFC8A824C0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA00C4A3FFFFFFFFFFFFFFFFFD2F2193F1F5EE13F8966923FFFFFFFFFFFFFFFFFC3BDDC3C7C5BF23EDCC62A3C2ED5633FFFFFFFFFD9E2053ED80BC93FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5441F7BEA3F7B13FF8534C3CFFFFFFFFFFFFFFFFFFFFFFFF05FCD03F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
