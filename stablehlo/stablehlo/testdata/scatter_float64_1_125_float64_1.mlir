// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<1x125xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<0> : tensor<1xi64>
    %0:2 = call @inputs() : () -> (tensor<1x125xf64>, tensor<1xf64>)
    %1 = call @expected() : () -> tensor<1x125xf64>
    %2 = "stablehlo.scatter"(%0#0, %c, %0#1) <{scatter_dimension_numbers = #stablehlo.scatter<update_window_dims = [0], inserted_window_dims = [1], scatter_dims_to_operand_dims = [1]>, unique_indices = true}> ({
    ^bb0(%arg0: tensor<f64>, %arg1: tensor<f64>):
      stablehlo.return %arg1 : tensor<f64>
    }) : (tensor<1x125xf64>, tensor<1xi64>, tensor<1xf64>) -> tensor<1x125xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<1x125xf64>, tensor<1x125xf64>) -> ()
    return %2 : tensor<1x125xf64>
  }
  func.func private @inputs() -> (tensor<1x125xf64> {mhlo.layout_mode = "default"}, tensor<1xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFC1D7E469BE10840880011D89D0807C0ECDDFF369093104068EE7390D95AAD3FDA6BCCE52D77D0BF6CEF23FFA271D7BFD65E89F473840640689E93524454E53F9C684A073748CA3F4A84C53D0BA9034033086C50FEF8F3BF0296049AF4B0EA3F185A6888DDAFF0BF591960869769E7BFDE5F376A2187FFBF3EA1D67CF9C8FC3F25011E48DF96F83FF5F4BC5E6EEAFC3FB6F102213DFC0DC036F7B61FA7B20CC0BA1C62EFBB9FEFBF936D89D7162D1440105FA34BFD6614403CFAE358CB9E1FC0BF20E7AC4419D6BF3EC92B2D4F310AC07C954EEAE0F5A83F2268180D1155A83F1A4A0836CF9D13C07B7CD8608BBAE2BF4FEB523A0AC2E63F2326AC2F64AC0BC07E25CDD580F414C0A293C2F656E9F83FE3CC63C2EBA614C068D3FADCAD2AF83F5D5475C9B322E73F6052BC71209CD2BF061D89543FD3F5BFD21907D8D554DABFEED7BD1CE9DF06C02845C7837DE40940552084353D541040DE885F03CD9301408B71D327243FEABF0BAAC09C114000C00EC02E3AA0DBEB3FA6FC33C180A51B406A4F33AE13C80640D6EB458F902C17C091F18CA62C0E18C0CF5E345258470240A2976456AC2A1740B03B887917FB1A4046AA9D1C98FC1640D631388CE0A317404402CFE86769174052890235F0BC10404075E866FCF1F4BF27D8352B336DD43FF8878E1EC68C0C40F2EF707402BAFDBFE3FE18C97FB3E43F895CCEDD81CC09C0FEB81C3E9EFFF7BF1BF81EEDD8FFE93FECEFA9577A52014078695612F9B51440A9224E35C7B206C0381FFFDA1096E1BF873141B012E20B4049863A5EAC64F03F475EB875572CCBBFF8D60E10B8B800C03DF957F4E58C0340102BAF88AE7011C0636FB1DD9B220240FE9D8E5D46F615C04601E1AE9C6714408CBF2FFFFE9F0240A6802FB4192DF2BFB1F431A283B2F93F38C703B911670FC0817DA61486DA0E40422482BC6E4301C062C8C16228F107C0001742BD73C5F9BF84783C19EA8615C0EE6BA1EB28C2FC3F961D8D514E28D4BF208DAA85D9DDF33F7BE6B076CEF410404064E234FB68AD3FF8E571B9AF58F33F681EF5E4F33509402A9ECA92C9C0FABF19217D2CFA50E1BFE44ACC6FE0450040E584005C1DDC0E40D5E208F0C91A05C01D3C712F1457F7BF54ACF6D13075C43FA2F5182EBF3911C020622E02EF66CEBF48BED4C258B307C0D7AA46C13C4A02C0957B4317E8C509C0A9EE2CD5448704C07042AD8C0AE6DF3F29563CF1647EDBBFAA707AB8B855ED3F3AE69164A6CCF03F8CB721CFAD360340D04003A0312703400A8A884918C3B13F770C3F0F56A1F83FAC54686D868AF83F88184F2C832912C04879C84BE012EDBFA6EC5B0450FDF1BFA86A5F39F1D0F53F51138354AC8BE43FD988B93997E4F43F72B0625CE4300A40F366EBA0ACE01440"> : tensor<1x125xf64>
    %cst_0 = stablehlo.constant dense<9.173880460330448> : tensor<1xf64>
    return %cst, %cst_0 : tensor<1x125xf64>, tensor<1xf64>
  }
  func.func private @expected() -> (tensor<1x125xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xBE1015DC06592240880011D89D0807C0ECDDFF369093104068EE7390D95AAD3FDA6BCCE52D77D0BF6CEF23FFA271D7BFD65E89F473840640689E93524454E53F9C684A073748CA3F4A84C53D0BA9034033086C50FEF8F3BF0296049AF4B0EA3F185A6888DDAFF0BF591960869769E7BFDE5F376A2187FFBF3EA1D67CF9C8FC3F25011E48DF96F83FF5F4BC5E6EEAFC3FB6F102213DFC0DC036F7B61FA7B20CC0BA1C62EFBB9FEFBF936D89D7162D1440105FA34BFD6614403CFAE358CB9E1FC0BF20E7AC4419D6BF3EC92B2D4F310AC07C954EEAE0F5A83F2268180D1155A83F1A4A0836CF9D13C07B7CD8608BBAE2BF4FEB523A0AC2E63F2326AC2F64AC0BC07E25CDD580F414C0A293C2F656E9F83FE3CC63C2EBA614C068D3FADCAD2AF83F5D5475C9B322E73F6052BC71209CD2BF061D89543FD3F5BFD21907D8D554DABFEED7BD1CE9DF06C02845C7837DE40940552084353D541040DE885F03CD9301408B71D327243FEABF0BAAC09C114000C00EC02E3AA0DBEB3FA6FC33C180A51B406A4F33AE13C80640D6EB458F902C17C091F18CA62C0E18C0CF5E345258470240A2976456AC2A1740B03B887917FB1A4046AA9D1C98FC1640D631388CE0A317404402CFE86769174052890235F0BC10404075E866FCF1F4BF27D8352B336DD43FF8878E1EC68C0C40F2EF707402BAFDBFE3FE18C97FB3E43F895CCEDD81CC09C0FEB81C3E9EFFF7BF1BF81EEDD8FFE93FECEFA9577A52014078695612F9B51440A9224E35C7B206C0381FFFDA1096E1BF873141B012E20B4049863A5EAC64F03F475EB875572CCBBFF8D60E10B8B800C03DF957F4E58C0340102BAF88AE7011C0636FB1DD9B220240FE9D8E5D46F615C04601E1AE9C6714408CBF2FFFFE9F0240A6802FB4192DF2BFB1F431A283B2F93F38C703B911670FC0817DA61486DA0E40422482BC6E4301C062C8C16228F107C0001742BD73C5F9BF84783C19EA8615C0EE6BA1EB28C2FC3F961D8D514E28D4BF208DAA85D9DDF33F7BE6B076CEF410404064E234FB68AD3FF8E571B9AF58F33F681EF5E4F33509402A9ECA92C9C0FABF19217D2CFA50E1BFE44ACC6FE0450040E584005C1DDC0E40D5E208F0C91A05C01D3C712F1457F7BF54ACF6D13075C43FA2F5182EBF3911C020622E02EF66CEBF48BED4C258B307C0D7AA46C13C4A02C0957B4317E8C509C0A9EE2CD5448704C07042AD8C0AE6DF3F29563CF1647EDBBFAA707AB8B855ED3F3AE69164A6CCF03F8CB721CFAD360340D04003A0312703400A8A884918C3B13F770C3F0F56A1F83FAC54686D868AF83F88184F2C832912C04879C84BE012EDBFA6EC5B0450FDF1BFA86A5F39F1D0F53F51138354AC8BE43FD988B93997E4F43F72B0625CE4300A40F366EBA0ACE01440"> : tensor<1x125xf64>
    return %cst : tensor<1x125xf64>
  }
}
