// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.tan %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x91B618664F25ECBF22600685A951E13FB50627FBC2F309C02C7C5C06D732CEBFAF46333C8C580F4034CBFD99E594BFBFC4B4226ED4DEFBBF6D89A4040081FB3F2EC102A3C2C9BCBFA25DD9283384C9BF03197DF53DB712403A55C859BCEC05C00C1035FC0DCB0640E5F628D14748FBBF6CE1898DB4C4D0BF684FE2EFEE3A17C07BC93B0D966511401B49C1DD37DACDBF5A35DD55BE1B08C0944967424E75FCBF3C3E77C838AC0DC00952B0B7E2540A4061DC1A7B39E4E4BF7C75434D990506C01E1702865D68C4BF233290D509AE0240191976264C90E63F23CCF8EA4DC60B40E7D709FC3D6404C00C2E61265F4E0BC00B771B21587000404424577BB5171740243E1C4BE18011C0FD64AC4FD8DD18C0E5A31E92FB1506C0C8765326963801C0226FA09F5A860E40740F5CE1619417405E9BAB7C68EFFC3FB8CAEA8115BA0140C6D7DD1EED020940BA66B0D25007E5BF9A7969B55528EB3FDA3F35420E2FF33F106B92C119471AC0A5BD3BC78FF2D13FDEFC4CBA94B600C0F327CC540DF703401230978823A6FFBF30C8B85C4EEBF8BF9D65FC8376341640709A90AC4F32E4BF64D6BA6D80760640ACA3472DC51103C066CCB2919E880CC002AC2088A4E5E13F04A2B9211965E3BF18ED63FFA1240240EDCFF68D9F1113401BC79D6BE052F5BFF627CE976DFAF4BF3924A5D841CEF6BFC348AE539C08F7BF8DC5F27863210240CDD370E7CF11ECBF815A3330EC8215408DDE71554B8F02C09238AE013CA3E43F53D588D895F01640D25FB0746DA9044097C8B392913C0CC0F6EC3E9C1A0CC33FFEE1899511DA0AC08DEA11FDCC03F13F245D849CED2312C032B141B62369F0BFFCE427157894E23F470AB79C1425E1BF1A90706445AD24C06C03608876160940B2A7CC45B531D73F6805B724520C12C0FA4ADD38D31812C04851D8B95058EEBFB7495D78D8FDF9BF42D06BF8B866E13FC87D5A39DD13F4BFC93FECE38D10FCBF7E07558734D8E13F2228A45625AA0BC03403DDC0CCAFE4BFAC10FE48EC75114068A565B86C7D1940D6FF9FFF564804C0D8B7E480D452FEBF3C9D5B943035F53FBC4D45760AEA11405BB1C6417C3AFCBFFE8B8846084B14C06A4896EF2E170EC01ECE0A15F06704C09A68F2DF67711140D20C1CF5B03500C08C381935891B10C0D6B3A1BF1501D2BF02CE919F4007E1BFA6F80B55ADFF03C032DA86BFA31BD83F0298503DF4D412C04FF15D61361911401A69908C004D16C0BE0858F8AC2B074023EABE458AEECD3FD5E447D6A42513C0131D2848FD86FABFA3452D63C4D0E5BF9BA7892FD81008C029F6ABC82DE8104046460C228C2B01C0D44485BA0B680A40E4D2BDDDCF6B00C0686952603B9911405F5F4F6CA3BC0CC0E3E2628B931203C02A078E93CB2218401C9396BEDF80EFBF0F3FBC7C830512C067AC682AC412FF3F5842BB9B9755F4BF66451F2A9F6DFDBF291940E96DC317409F9C7BA3CCB70340B7B7C8068D1E1940482B645A04B501C0B0D5D16F8DA7FF3F9A53829F0B950D409283DBBB7844E73FA23387199CF711402224A72ED638FDBFA0EA7FA80A5E084082A0F7FE9DDCFB3FF5CB54ABEAA30440F4F6F82964D00C40B2D63EF7B5E71940A102EC800A9112C02438F922074302C0F2938C9B6B04F7BFFC350D4106F6CA3FB1A4158774BE07C0AA8025B700E7F8BF855B593346410D40E71DF9ACEEC8E8BF1A049FC1B50EEA3F6EDA1579A7D318402C79BF47CFE2F53F1C7963F5138B0F4012E22427DB731840CEA592014543F8BF0547C12CC9B8EFBF248F6800626313C05C422844B9A5F43F2892DDAD6FEC0A4065A5CC428DEB11C0C134821CE8E4E9BF2E657E97631FE53F627191A02D20EE3FD093FAAE4A47104009CB5B27531AD0BFDF1A3EF7BC08EDBF3A25C0BA0B2011C0629A0DFC2B5B00C0F4D30DD6AB9BF83FF54C38B286080DC0BCD92826DD690AC0039764DF55DABEBFE76194135F61F4BFE055106146A7EBBFDCF7EF68E33220404C89B4A4C42B03C0A864532272BAE4BF24BC8894B8D1F33FC9FC8DF3740602C087308E30E46410C076AE207AFF32B03FE0CDB231695C14C0DEA76B487EF115C0970956925DD1E7BF355FB848D03E03C0D75B2B5FE250C13F8F0E258E9725FFBFF690CF406292DEBF0C44A945C0DB12C0CB5A30C8DD8302C0772A7E0AD3081BC0FF8865C8D5AB15C08B322A85285F0D40AC9A40D8B0EC01C0E8E4C1E73C911040F8812350953008C0F12B84A5BC5600401C5F8B0683C8F2BF5CEFBF71C259D53F53556692983E06C0FABA6F253C7F1140F9BE38B6CB5D00C0DAE2F6D447ED02406ACCD287C98502C0936E06F1770410C0105EC6A725D1F6BF668582255058C83FB2EBDE1EF430F63F7FD7465B46031BC06325EC4AA237F83FD7A7313125C7F9BF3AD43E7760500EC0B6D5E202C19401C02647FD6FFD24C3BFE81FC1C2BA2310C032A20B402FE41340360DB2DC8ABBF8BFA391009FA5791840688141567CC60E40968CA404EB5100C0DD41E5A3B4D915C0B184E9E7A9370040B26507142132FEBF7C7CA8131E29F13F29ED52F21A33E23F7AD3F779854C1EC02E8F915F56B213C0835849A4C0EE1A409C38A9DF2B220640CCDC7223E52A06C0EAAD19FF92C90FC0F9DEB8317ED4F33FE278C38A467CEA3FA80E9761A92EE7BF8B013A59C8D1F2BFEE23F25349E61DC07D850108187E08C043CCB14727ACC3BF4A936058CE19FABF26A28DDF7BCF16C002817241A056E2BFAE728A4C37A0CE3F3DDD06FFF719D9BFEF5ADE703504F3BF9F40464355240A407ED0CA9D5E55F1BFC64C5F02A1721DC081C8305A654220C0E65C3A57899818408720DF77402A10C08A5DDA3FB1581CC086587FBC4690C2BFC68018566A1EF53F2783E36F6D80CABF66832943808ED1BFC047CFA76460AE3F7CE9A59DD033014032125EB4237BF33FF7443BAA65A0CDBF0C967CFF60870B40529B05B905021440FB02409FA86DFBBFF263FCEBF1740B40E4602A98986006C01BED8952A82704C0C8A824836DAA054018EC96B7D7B2FCBFBAA881BEC93BFFBF383AFD65B8910E40586EF2135B7AE13FA2D763BDBAABF1BFEA6CC61E97C60440055083D37610F2BF4FEB9D02B6431540C56D7538AE0D1540FADBD644FF5FB4BF70566DB9DD4B1CC01DE574F8E7BF17401008A995D16BFBBF0D6AEB68D986D93F4C2C14A1D7C81440C609C7A6FC7700C084C17782ACE0F43F189391551C8F0E403E03146D01B9F5BF5EFFA1046F7A1140F9B707CBDF53E4BF8D8FA64825CB0740BAF6F47A0FA1B4BFA4D171F57A62C7BF2063930F4326D93F8A1E3C83AF1CEEBF08C51A9213B7E1BF727957FAD4BE1AC048534F3D2E38C93FF739E9EADE9AB43FB62E0E63F3D308409BA0B0791E47F03F947BF51087A919409AFFEAC28F6DDBBF8943C532D9DED13FECC70207F35104C0BD3B2938FE1202C03DCB98B6BC4BD03FDA9B2541666CE23FFDA0297EF1A8EF3FB612AE6DF84706C091D76AC6CCD108C0DBEB98F15D5C11C0F9DE3E4D1962F53F24A933D1314E0CC036B84C9FCBC1FBBF14C1E3C15A8D01409A8A074E3CBB01C0EA9254AE5DDB07C09CB487CC11FD0540261B59556A800CC0E4E6FED3E4E817C01F1EBDC6FCB4E73F576CEFD85EABF3BFB6425161471F0E406F09E2D4672A1240E6833F4849D80840D3B0773B88B503C024398646D28FFDBFE8C21F5255F01440584E2E386F37D73F3E8BAF20B8EF16C01EE51D85675806C08AB2402E3634E8BF06940DCBAE4DF9BF66A4B481A4E60AC0EC8BDD0F48C2B03FFE188018FEA517C078761186A723FB3FDF9B24734A57FBBFBE7A0BE8C5D3FCBF360EA47FA596F7BF5038B7BA6FCD1BC0B9D61F7926DD01C0A37CE0660656F53F06AC1006100BA9BF3719E50C2FA207409E0AED85F738F83FE8C830656FAC0A40A64C8E6D874BFEBFC5AFAA62984AEC3FE2FF142D734714C0446BAC3B9765D53F158464847A990840BCA75F16D8160A4012AC70A743B9D93F68D1D22426F90640E8DC730BB9860340D2B3ED2D8BCE0FC08AD6FD2E0327DCBF6CB0736C45969F3FBA2AACE71D4ADEBFC83B90BAC4FC1540C22BF5C9C3A91840E55B6B6E79B7F4BFC2820BADED5E1AC00A2CCD47B126F53F6ACC519D449019C0FADBD66526EA0CC0F25CF62BDB0D08C04B654E87DD3BF83FE4D7D780F6890F40E6D672CBEB92ECBFAF8163704DF4BCBF0B226AC710B9FFBFB2719AF222D90540647008BC249E01C04C878C15F1EC10400A0507F5C84FE3BF6532CF595C2901408F299FEE732AE2BFDC2FE1A37FD0F83FC464E0B7C31F01C0F876196812DB0FC0589424E0F899B4BF48020DF27341FF3F648806CEC87FDD3F6E46825CB04CE33F7FA828F933D7E1BFFED9AC33F614F6BFE6C2E73374EE1240AAA7C8336E0EFD3F1A32153DA4ACE23FA2316107951408C0109764966785B13F61E0133135AA03409F9325E8A4EE06C02690C9CADA64F93F79ED902C9B910340FB0A950B10CCEF3F7E0F8A9CEE3BE3BF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x268AD7954A56F3BFF65739391B3CE33F2D0E1E8D8850BABF47A553188BC5CEBF27A35957CE71EF3FF28271BF29BEBFBF4050D01B18261740577D6D1006CB1AC01F91D5D9FBE8BCBF5EEC033920DCC9BF2A0CC21243E43D40E57214A05822DB3F0106B9E2D944D3BFCB3D060AF4971D40499753F4B429D1BF5351667B7A7BE03FAA50818DE00C05406A08DC4ADC67CEBFEEF6050CE57AC03F8EBDE00EA7F71240F3EB2F82F765E4BF7803F66E8D53C33FEA80DE0AA378E8BFAFC32ED3E038DA3F12DA5C481695C4BFB47CD0EF95B1F0BF18FA4561F53BEB3F5C359FDC3DF0D53FA7A6E2E6738CE53F73351DCCF5D3D1BFB59472CC4F6EFEBF379ECA8D9CE6E1BFF4A2A2E227DE06C00EAE11A4330FB13FC8D8B7124DA0D93F0D498411E352F83F0075A7B8C88FE93FC378E85CD12DDABFD84E97E5608310C0D88E2D9F9343F5BFD6BA1269D10E8FBF57B49BC66EB0E8BF7ED4784C282AF23F53FF64AB068404408B4D6AA356D6D2BF73FF2F37EA6ED23F02F467AC300DFC3FD6C953FA8D1FE8BFE29336A5848B0240434E73853EBA52C011B9ABF902C0ECBF800CCF013E63E7BFAE7BC87F4E30D6BF7CD28D35AA49EE3FBBB9CCC569F9DCBF5FB54A6CC907E43FCA75D743022EE6BF430B672EC11BF3BFAFF55D5B0B3932C00E87FAAFD17B10C099BB6A27471D0EC0F96AEF86F64E1BC037FC3C4965501EC0A0AEAA05872BF3BF5BE3CF105F3EF3BF47B041FD8062F4BF523111221034F13FBE8A60534212E83F5C33CF19BA8AE3BFA7946D110503E4BF651A2D9F1A28DABF648155BC6A30C33FC05D66EBCFEFCBBFE18E88611DC8FC3F2E9B2F09C85216C078CE2BFA6162FABF86170AEE71FEE43F67F042459DFFE2BFE79B4F50C2BCF4BF9121E6B3A70977BFDA62ECCF1544D83F0DC962D84EB213C001660094370215C0398B73F5024BF6BFEBE70503A09C324060542103D258E33FF7B20295F87808C06C3C2596739515402FE9227C1AF5E33F07FB8E3BABF5D4BF9C86EA15F525E8BFD1388532241B064003E48037F4EBB63F3CDA3D402F30E63F9556ED51A5C90740B89F70E575F40F40DBD60DE613CB104006C300FD436A1440C884145D6932054009644C9FF8D4E6BFF7568E1BFE76E53F7CB68C1510CE0540BF38DB43A9550040958D2C709590F3BF200706A4A57ED2BF734EC6F45BD7E2BFFAB7A5909EE9E73FE2FFAB091F51D93FE42A5747E83D6CC00932AE568B170140B0EE59C8A564EB3F9CB2A1780305D0BF72834711557DCE3F9EA06F0B8ED72A4068CF97F25DE32640BDE0BDAC15F8E9BFBEF2B4024B2CC13FD0E46C784850FE3F8B144C8D14AAF83FDACDAEA18E8DC43F739BCCC55798FE3FA0282B7C7CBD08403A911D5ACDF4DEBF9B1866D38D43EE3F5E81C929A949D0BFC5C611FB8616F8BFF6A0EFDEE30B13C04074354D268C04C0E059C55FFADE09C09717B40D58140D401B5692A8BACED6BFF32310CEF0B5E9BFA56ABD9672726BBFB66649C8B35FF53F2B1E723C048702C09CBA590385E4E33F1216FA509D78EC3F22B2100BB7D61140A3AF8886E99D0E404F7706054991B8BFBDED13BF3B3917C05D66AC6BBC21E4BF1BC6C84FB7B8DF3FFFDB2FE92807C93F90DB2524F1382CC0BF5D766DD18AF23F8A030A11A7131EC04DADF7FEF05DCB3F433093AC4372C63F85173380655C51C028AA47A0371FE23F1B18F337CF4FEFBF36B429B1D7F3F03F2E6CD48FC39EB3BF70BFB110CC70134001D7F1198684F03F52927F1A5BFAC5BFBBF4EEF3915F32C0F02417AECB72F8BF144C02FD0E861D40299D43FD1EC90B40938490F14D24CD3FB452C44765E710C09EE78CF9B6C7F0BF51FC486CECD6E83F715375813BF9F53F7CD15353AE5DF53F4B1F22239373D0BF32D24F23E477F4BF61E49223B26401C0B56829E7C235FF3F1D67ECE04D7C3E408307F4EAFBF7E0BF5112677266ABC4BFAEB639B3CC00BFBF40FBA12318230AC07CA05FFD0BBEF2BFCE3F619205F10FC09A0389C5D786ED3FB47CDDB1AE36E8BF39F975608432074013EC6EF0D1B0F33FA00DFA228AB4F6BF933018B88A38B03FDA84FB549D270440D663B58F1D63F03FF88A5A52FD78EDBF42392B01FFFAEC3F2652BB2A206CC13F3CF435AD79450440B0F7418EC390E0BF2C0EEAAA59427C40DEF3F8D8A365F13F888F3C496579E0BF283917C9CDC9F23F755542A56ABEE23F1A043CDD7134F43F99B6933787EEF83F9E980DF3B950BE3FD55792A98F60FFBFBA153FB7ED1603C065D455BAF92DD63FF07F4085392AD83F67A9D89C1EC006409B216DC69B1CFF3F33D8EE242863EFBFC1EE4DCB435DF13F5AA092DF7BB0F2BFEFA554A086711BC0A940AEF390A4C83F950176B80583154080B2DE626341E0BFF3D4A56C8F753140A10AA9D145C93840020879435235E8BFD46AF7634117F63F95ECB37CDD49C3BF39BB88532CE3F3BF65ACC3C9C7040EC0531319A8F7FC43C0416A9463C43BC5BFFA6F9B02EC3EEB3FD50D75F97A8FFF3F920FEEABDD2AF13F25C3A9477C4B00C0DC7B4B72796E08404613E787D268FD3F171B96D73E74E43F945F1B6D32E60BC059FFD514F79A124093F30A0BCCE9DE3F0BD871026D2FD9BF7980A096F6DED83F83231C49368FF1BFF95C01FD943F074090BD48B6CD69F13F5452F1C0A151ECBF6258C54A203603C0853F3B34111504C0F8B310B7A287B43F1BDE5B472FD4C3BFA66C6F73F6813040A6754CF1BFFDE43F45205F076BA6E4BF3B5774825539CF3F0A8F51CD1679DABFFE876242F2E503C01A754A1AB03BC03FE1470471842EFEBF20685F30A4D9FDBF672FA04540470C40C8035E73DA48C1BF9287CA851926F4BFC2DAF98E6E96F0BF6C729D9EE0B1C2BF4C391A8395370F40FC01230510E3CABFA5C71F1FBE02D2BF694DC0BC8769AE3F732F4C1F9972F8BF0B306BE7B3B2054060B07160CD2ACEBF8A88D03A60C3D33F8E77AB625CD90AC044A5F4140DB01B4023A07C244922D33F8DC7B5A45AF5D63F57A186D0F2F3E63F9F70B8BA189DDDBF414D58035BA611400CD3A3F23BF40340837A43A597DAE93F0B7C754BAB73E33FD5524E198BC8FFBF3C971C732B62E3BFD1F3B3B13DEA00C0BE3C1AC36133F7BF32944241360AFABF3D5267EC096BB4BF7AAE55D8572DF0BFC903D073560ED7BF165177049FC61B403C0F5AC7F3F8DA3F73EBE6093D74FEBF1E18022E3B28FE3FFC3DBC7F725E0D40901461985BC9E93F19F7883CA27B12C0D47A039E016A06404FFEB061E396E7BFFDA4859032A1C5BF103F9E6C85ACB4BFF62D8911FCA5C7BF3CE850787D87DA3F449F050432F4F5BF0D107C4F34C7E3BF418D06EC6C4CDBBFB4873B6F0A8DC93F508D248A4AA6B43F4DD6574E6784A3BFAE5B06F58EE5F93F0636E39FFA0AC13F3E343B548D3DDDBFFBB9AEE29259D23F08ECAD5D73F7E53FAB00BFB53E72F33F198C040B4BA8D03F783727CC4FC5E43F04AE9F057558F83FCBFB5649AFD4D73FCBF0EB18430EA43FEBCCB8A8277E04C06319689F50C110404D64F9E73FCDDABF681F61862B2B184069A844117B42F6BF7018A7E1353DF53F2732FFFA9C96C43F92D56239B488DABF621510BF78AADCBF8C49902C9233D43FE7F15B9FB444ED3FCDB57BDAE08206C0033BD6FEF905E73FBD1AF43BA02A17402A465B6C8C6EA2BF2C3A358DE0C4E93F61850F4A76280C4045B3643B9ECBFBBFE8AD6AB9A24AD83FCD6203993E94E33FD89D9F6C6D3FD73F6361AD28BF31EEBFB871C46F596E574044BA8A20DDC2CCBF22FA5FBB6BC8B03FE2922FF12CE7D83F0C79F85679BA1FC00D5D28BD51CC1C4093809D1C9B031140C19A5CA742A824C08213ACC50738E9BF023FC529DF85F43F622F8E7B048A10407C94E01F2E10A9BFB3512BA1AD45C8BF36E006FB2E8F31407382E0AA78F6C83F762E428EC3ED07408837DDFB6A84F33F5E2C2E2F6A6C0540B809A0203B3BD63F20D6D7D79416B1BFA22DB96725C1BE3FA378A7286634DB3FCC6B09344FB5D1BF22E3CFA660FFEABF50813F242EA5F1BF4A61CC9AE31EDEBF72FD6D3FD6989F3F06A590210D63E0BF724B4D57BB07F0BFEF5AA3A56D31BEBF4DDC214AD53E0CC041B2DE3E8B77D4BFEA10FCE9457B0F4099557263BDADBBBFE3D7EB6E845DE0BFD430D601FA5CC13FA2DB46BAECC73140C618F066EB7FF03F840CB45A5FDFF3BF94141B5B1214BDBFD09E341DD74F024027CA465115DCDBBFA1C4577005E1F53F1A2CCB9B7FA8FE3F38F3E668830EE6BF5818A9C3DEB8F8BFFB79CCF41068E4BFC2793D577621494097C4C0A75BFAF83FED3838C516DDF1BF309D450063A5B4BFD9471CC5D9DF03C0FBB0F29B4DC8DF3F4097508FF209E63F5CAB782AB6F3E3BFE211C7EF0BB914C0D02B39624B6A48C05777F51D5FF70FC029CB5DC11621E53F883E35BF6DEFC03F68938BE26B8CB13FBEE6C54BE20FEABF3D2A5548E90FD23F2443DAB05E9F4EC0D99E299830B5EABFF5555FF30D93F83F1DF3DBF346F1E5BF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
