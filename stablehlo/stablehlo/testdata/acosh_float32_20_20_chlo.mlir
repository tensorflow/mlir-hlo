// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = chlo.acosh %0 : tensor<20x20xf32> -> tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xC26887C0A5C9A440606A853DD06F2640C8914F400B6E00406B950BC0F42FC7C039BD883FB827B7BE2D2CFCBFCDDE8140EBC40DC00019D6BF83D48A3F6D2EFEBD3D35413FC1A2C23F7DE755C0FCCDA5BF44BCC5C00588A2C0DA99DFBFF46CD53F770E0040016E9A407779CCBF23FBC03E9F219EBFD4A9823FBA91BC3F3095CABF939DDCBFFBC3B0407C1516C024BBD040D296DD3FF838303F230753C02EDF154082262B4003433E3FAD373E407EDA87C0C01438405CD8F13D65DBB33F0666B3BE1A18493FB69210C0EFF32B3F14A50EC0663AB1BF52E4CB3ED628BC3F366C633FC0F1E53E84494B40F625DC3FA777B440D8594EBF2587504054D489BEC116A9BC06DA2B40A1C7CB408302FDBF0BD9AEC0A82B4540C015933FBBE3D63F7957E5BF14AE30C0AC34C93EBC32214043701A402BDD3740FCBA693F3B2A283E1C55833F2BA0FBBDD5E47540D79728402A95EBBF02E31A40E90A8DC037EA9A3F9713ABC0E8099ABE5AED9BC02BD18740FFB2043F0877983E382A9F40084C55BF1E968F3F4C25A6BF2A4AFC3F0B35B43F7B3A28407B7B7FBF2D49B93E042ACDBFAE0B8E40D8D231409B132540AC5C8EC0FF13D33D367C7ABF3DB6E63FB42B47402B0422C0F19FAEBE74BF0CC0D935FA3FB146FD3FB31A943F61D1C7BE06BB82C083C63BC0CC4EF53FA310493FB3558C40FA5E6C3F5810393F36B451C01DE977405433CE4019F14DC0E4E4084028430740DF8484404C736D3FE9CA6E3FF3C93B3FE33003C0B2B8973F7D4EA83F0F817AC01D473EC0610D1A4056B315407E3AB13FC972AB3FDC58D4BD883BC0BECBAA45C087AC1E4094FE5EC0FB0E994087AEA040AA97D7BFC67AB6BF59FA83BFF8C08F403F31E9BFC1F3E2BFD98C3440863075BF7AF00E40551E4D3D2071DF3FA0CFEFBFD7328B3F64DF513F218B7A3D849F89BF07A368BFBE6D7CC0F49171C03244963F8C39874072EF24BF93C38A3FF9143C3F68F814C0AA55FDC07ADE5E40AD3197400DAFE2BEA54E983E913C7940ED1227C0075AD83E81713AC0275B09C05B7D9F4009F697BFFA7AB83EE6828D3FF75DACC0DEFC26C0DD01DBBFC1568140B73EE0BE9875A4BDA61971C0D687AB3FED095F40B27370C00B554EC0607774C08DD22140500D32409397B8BEB5C49FC00651353ECDBEC93FDEB9903F957C4F3E6099B5BF26F97DC0533269C02E2B50C09B8A36C03FE157C076F157C0B1B26D3FC44A59BF6E0AB0BF63A00C4160BA34BF434C8D3F9DB7F13F067589BEF4041EC0E2E5B140285F9540BDE38F40EEBE104097B2C33FA97144C03FB931BFF5006FC0DD4615C056168D3FB864C1BF238D21C01F1D8940FFC87CC076ED45C06DF40AC0C6F2074186F8303FFF3CA4BF1A78B3BF26971D404D046F405AE2C2C04EE32040EDF992C0A463D13F46588FBF8DE3894054B60CC06D2A5EC0FBBD4340CC14D8BFEAF85F4059410F3F5A5595C048E0903F46B96A40DB6FE7C0E0EF2740B0B782BFA86FFF3F872577BEDB959E3F4430FD3FFBD6E03F2FA429BFE63B60BF7235A2C04FDF3B4027EDBCBEC72671C0DC0CB7C0E050B23FBEA96040D0462C4064B22540FBA88BBFAAD1C5BFA2491240530A7AC0C6EC7DBF195014C0AE1693C03EE0EABFF5054C405A453B406A8744406A79943FD0591ABFB4503C3FA2EC7ABF4EA10440E8BD8BBF79D48BBFB9983BC06FF52D40D9D336C0C635243FEC9B0540026A2240DEDC45C0198C55BF055C4E40F76ACC3C855FBB3FD029B8C085A382C042D88240D9FE48BF219248BFC1825E3FE3514BBFD7AC1BC06FE47B40F744B0BFBBAC063E17004D407CAFDA3FAD33CCC05C20C8BFE93B47C0C79940C04D8FFA4024DD033F37AE833EA1B508BE4D8C53C08178143F60B1DB3FA9B81DC06CE3BEBF1CB06F3F35B832BFC22D6EBF896106C07B2FB94027BD1A3F53B606403C3430403E4BE4BF8845C63FC0E197C0679A8FBE75C97D4006E782BE808D24C0FB2935BE90B21EC09E73BABBBD5B68C06FB4883FAE7EC5405B5522403A88A5BF3DD748BFEEB16840DCD9E5C07EBF4A3F76B77940F047B1BF863F34BEB64B2B407E9A24C07C01C83EBD98F33F062224C014E483C0FAE73CBF19014F4017E0D0BEDA732BBECA033DC0ED6FE8BF780DAFBF08F9B93F459A6B3FC07B8B404AADBFBD108570C068270FC0FAD656408412C83FE5B31CC068E31DC069BC2140AD563CC0CE0C4EC0E858D73F78B724409B5E4A40A1D4154083749CBF3D22FBBEA0002E40"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xFFFFFFFFEEA31440FFFFFFFFE809CE3F312BEC3FDC10A93FFFFFFFFFFFFFFFFF0E23BC3EFFFFFFFFFFFFFFFFB3040540FFFFFFFFFFFFFFFF3E29D13EFFFFFFFFFFFFFFFFD1097B3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF09B18C3FC6A2A83F38661040FFFFFFFFFFFFFFFFFFFFFFFFBF88503E5824703FFFFFFFFFFFFFFFFF50361940FFFFFFFF7C002440ACA2923FFFFFFFFFFFFFFFFF735BBF3FE7E6D13FFFFFFFFF555DE03FFFFFFFFFD5E5DB3FFFFFFFFFBA4A5F3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF07626F3FFFFFFFFFFFFFFFFF4F5CE93F5E9C913F788F1A40FFFFFFFFD8C9EC3FFFFFFFFFFFFFFFFF5177D23F57722240FFFFFFFFFFFFFFFFC93BE53F781D0A3F70C88D3FFFFFFFFFFFFFFFFFFFFFFFFF6E97C93FA297C33F95BCDB3FFFFFFFFFFFFFFFFF0829693EFFFFFFFFDD6401405AD2CF3FFFFFFFFFF2FFC33FFFFFFFFF363C233FFFFFFFFFFFFFFFFFFFFFFFFF87F80740FFFFFFFFFFFFFFFFAF5F1240FFFFFFFF622CFA3EFFFFFFFF5068A63F0000603FA485CF3FFFFFFFFFFFFFFFFFFFFFFFFF7EEB0A403A2AD73F68E6CC3FFFFFFFFFFFFFFFFFFFFFFFFF98E6983F4099E63FFFFFFFFFFFFFFFFFFFFFFFFF272DA53F99FCA63F9CAA0D3FFFFFFFFFFFFFFFFFFFFFFFFFD037A23FFFFFFFFFA71F0A40FFFFFFFFFFFFFFFFFFFFFFFF6DEF014038362340FFFFFFFF3865B23FF4A7B03FCB590640FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0E8B193FAA2C463FFFFFFFFFFFFFFFFF713DC33F0332BF3FA6E2593F8A604D3FFFFFFFFFFFFFFFFFFFFFFFFF1763C73FFFFFFFFFD2D00F404CFE1240FFFFFFFFFFFFFFFFFFFFFFFF72B40B40FFFFFFFFFFFFFFFF0F40D93FFFFFFFFFC29DB83FFFFFFFFF3AF0933FFFFFFFFFD7A3D43EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4FE4143FD7AE0740FFFFFFFFAD87D03EFFFFFFFFFFFFFFFFFFFFFFFF48B4F53F6B030F40FFFFFFFFFFFFFFFFE0490240FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7811240FFFFFFFFFFFFFFFF563AE93EFFFFFFFFFFFFFFFFFFFFFFFF5FBF0440FFFFFFFFFFFFFFFFFFFFFFFFC38F4D3F52CEF53FFFFFFFFFFFFFFFFFFFFFFFFF6221CA3F4C57D73FFFFFFFFFFFFFFFFFFFFFFFFF2189833FB87C013FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2D423740FFFFFFFFD868E73ED6FF9F3FFFFFFFFFFFFFFFFFB0A0194014380E4051C40B404669BA3F2AE27C3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8599E53EFFFFFFFFFFFFFFFFAC980840FFFFFFFFFFFFFFFFFFFFFFFF1C143540FFFFFFFFFFFFFFFFFFFFFFFF8D6DC63F0706FF3FFFFFFFFFA252C93FFFFFFFFFDE9E893FFFFFFFFFA4F70840FFFFFFFFFFFFFFFFC83FE43FFFFFFFFF2C5DF63FFFFFFFFFFFFFFFFFFB0D023F2D9DFC3FFFFFFFFF3148CF3FFFFFFFFF9E3EA83FFFFFFFFF40A02D3F77EFA63F2DE9943FFFFFFFFFFFFFFFFFFFFFFFFF50ADDE3FFFFFFFFFFFFFFFFFFFFFFFFF58245C3F73C6F63F80CED23FAE6BCD3FFFFFFFFFFFFFFFFFDEEBBB3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF13D9E93F8B3DDE3FD9CAE43F76EE0E3FFFFFFFFFFFFFFFFFFFFFFFFFE3CAAD3FFFFFFFFFFFFFFFFFFFFFFFFF2D25D43FFFFFFFFFFFFFFFFFB7DDAE3F8AA3CA3FFFFFFFFFFFFFFFFFBD61EB3FFFFFFFFFE1EA6D3FFFFFFFFFFFFFFFFF09830540FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7DFD0240FFFFFFFFFFFFFFFFE87DEA3F668F903FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2CE2F40FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEB48913FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEF3C1C40FFFFFFFF4810B03FA9E8D53FFFFFFFFF6BA4803FFFFFFFFFFFFFFFFF657C0340FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF67C5BB3E696A2040D291CA3FFFFFFFFFFFFFFFFF6E75FB3FFFFFFFFFFFFFFFFF7E6A0240FFFFFFFFFFFFFFFFE404D23FFFFFFFFFFFFFFFFF922AA13FFFFFFFFFFFFFFFFFFFFFFFFF43CDEB3FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF76476B3FFFFFFFFF3EB90940FFFFFFFFFFFFFFFFFFFFFFFFF7CAF03F1D27823FFFFFFFFFFFFFFFFF4F0ECA3FFFFFFFFFFFFFFFFF301F8E3FCD98CC3F16C0E83F7C51BF3FFFFFFFFFFFFFFFFF082ED43F"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
