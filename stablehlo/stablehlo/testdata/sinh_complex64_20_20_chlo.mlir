// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xcomplex<f32>> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xcomplex<f32>>
    %1 = call @expected() : () -> tensor<20x20xcomplex<f32>>
    %2 = chlo.sinh %0 : tensor<20x20xcomplex<f32>> -> tensor<20x20xcomplex<f32>>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xcomplex<f32>>, tensor<20x20xcomplex<f32>>) -> ()
    return %2 : tensor<20x20xcomplex<f32>>
  }
  func.func private @inputs() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x764D33C01B3DD7BF95D62CBFEC492D40D38AA53F07C8FF3F69E10440E7372A40B083C8BE24A808BEE09AA640147D4DBFB346A0BE1DD9C9BFD0964C3F15CA9E3F65AB2A402A665FC05141F9402683B1BF9E0C503FB6F731C0782839404236BB408DA86DC0A65489BFA972B1BEBF370C4011EEECBE8DE85E3F7A94A5403481BDBF9CC48B40051D0C3F2625033F10986E40F38412C0D641D2BF5919BDBE30710FC0628C2CC08A5FA440D025AEBFBFBB23403213B6BFF1C63D3E3FD434BD4C9DCB40F291933F6FF9B83FD305F0407909884063A557C070C3973F6FABA2C0C3920A40CB6D2440DEBA34C0D8CFBFC0C73CC0BC7A4E52C08E86D23C41C76DBD74823F4063F8E0BE4514B33F5CF59DC0510F21C0AE6CA0405D880440F11A4D402B9E1D3F95B693BF7DFBD6C082E97B3FF45E8A3F8FEF49407E5067C0ED4C4B40F798C03D3770A0BD4C6192BE20FA90C0E258B13E322816C0934601BD27382C3EBAEA25C09045443DFBD0DFBF77650D4005E41A3FBFBECEBFF941A83FB17418BEF830C3BF66D8BE409C8BA84077A3C6BF429517C08C21E83EBB35433E725C553FFF0F26C09BD3B7BF28D283C021BAE03F39FBEABF6FF477BFFE2301407C576B40DA78CFBD177DDABDEA2DFD3EA7DE3DC06E555F3F77CF13BFF63175BF731B943FBAD5C33C3E468CC0955BA23F4C57E3BE136C25C038F070C012EA19BFBC98DD409965AFBFAB03B6C0FB0AE33E1C2BC83F2294ADC0980856C0A86A2C40120BE1BFCF60114059E512BF50C9CABE879FFF3FA09E884037FCC0BF07A958403D3DC43EBB7F49C08737A1BF0E183D3FA2A27140095830C0E00488401FFAF6C020BC12C097D70FBFD16949409BFACEBF5E0EACBF8579F03F7BA63FC0A06CADC0215623C0826246C051D093BF2BA90AC0CCE550BF15ED42C0582975C0F1FF1B3F850942C05D17CABFA2C23AC0BE5B8C3DAE7F9E40F1B005C0EEE22A3F1EBD9DBF97B9323E196A873FA6B9D2BF19CB5340502EF2BF83C68D40F7A690BFCC7D3BC02ED39EC09F1E9BBE53D5013F91A84BC01ED3DC3E5642C8BFB26E194031AD74C0869CCD3FFD96F23C5D85BA400DDD1840C657E43FDDF922BE2D1B813F36BBFF3E6FF733BF4EE8CBBFB5BF8640AE09C5BF41183FC0EA4F8B40AD723140846A8ABE8386543EC6DCAA4016F794C0AFA124C03964144077C6373F10081AC090DEEFBF8830A3BD6DB64FBFE6D126BE17B3CCBFEE74A7BF027E013EA2EFE04093219CC0BCCBD940F3F68C3F59A8FABF53AD4740CBA2A9C01C678D403E000C407D40A4C09E1951C0DDAF324078388AC0674D1BBC70E34940B2A250C08564BBC01D230240132158BF2D3B2840174D55401A240D40A06F58C07A4A1FC089B842BF88CB98C0304239BF17E614BFC8FA1940EB359AC0FAFDE6BF86ACEC3F62CFA5BFB78DE3BFDC6D543F0113ED3F563AFCBEFA7B1340A9834F407A67AAC04E9F0BC02D3D91BF18C8583EBEDA8EC044FE6E4004DD3E3F64F01240D46ABE3F029D89C0854B03C074BF01BF5FCFD7C02CD3EFBEDA69BCBF418F7EC07A37184002F49EC05093B43F48312740EB0607C19A0059C0EE588FC06CE542BF75C0E63E6DC3D3BF24D68840606695406949CEBF20B7DF3F4B86E73FBF10D23FA37F503F68BECBBFEFAD0340C8F71C407B8A07C07C822BC0D9E8633F6DA9B8C0CB529ABFEB854BC0F82AE3BFED52763F489420C0E430574041916EBFCFB3ABC0F42A2940E23155C0532159BFBC428D409F7C73408D8820C0534B8E4060FB84BF72113ABF66A24DBFB11BA240639F88C067AACDBCAE764DC0D384813F87608940D96E7C401F5D624014D7BF40C502EFBE8675833F99BCD1BDCF9283C017264FBFCF13C0BF65BE48408DE37FC03AAEF9BF2BCC68C026AF0FC0C6E67EBF3A59043F54CD8540F35D8FBF20ACACBFA09C03C0ECDCED3F549454C01A3E1140A5341B3EDAAE51C0622919C0C1B354406BA8A13FAB994F4092E80CC073063540E8C6923F091491C00B219FBF2660AFBF5C0853C0188DC5C0F8B84340C23904404FFAFDBF638341C00ECA04C03639AC3FB18B84BF034B1A3FD7926D40B42A09C0E8FA4DC0137EB940FE7066C0B518EFBEA3681C409BA8E3C017F8CCBF48C3613F4E2D883F5B6D0640415EA93FFF4C7A4046CB05BF6789883FA02D6BBF05F32D4049F487402036B8BFA7C9213F118466C0717E843CD1EE2040601734BFD97BB5405053603F033D2A3F5C9F3A40F337A8C0668461C0174B86401F8E5EC0784F40C0CCA037C0B37B36406379823FD20BF1BFE06AE2BFB5687E4046B2E33FC67D824007C18140F1A073BF9D9445402ACA89BD7B0BAEC0BE72B93F20B3263FD47EF7BE2E80BEC0419A8040E72A80BF38CC18C12483A9C02F98EA3FFA902EC0C8B22FC0C6157B4006BE4240A25B8AC063FB383FC263E1BEB0B6A5BF283800C037AAB2C0F76E9EC0737D84C0A5D8E4C036B7CBC0564B153FC18B3E3F88D71F40FFC3A5BF7D9F833F6325803FB8804EC0502FF03ED2348340262363C0D182973F7A787BBF7789803B8840903F7039BC3E80AE623FA55709402CFE993FAF2BCFBFCBF306BF6C6BCF3FC02B1F3F756127404FB553BFE4AC30BDE7D309C18EBA4E3FFCADB0BFCE756AC0D2C376BF056F0DC0C9A4443FD0AA7840896FD1C0FC61983F5053C73F1435BFC0C0178D3F975DA53E4D7FB83FBFC546C0E1AFC2BFBA7D6F401E1C38C0893B88BF89227B4069C036BF8C9B9CC096D113C049981140ED4D95C03FEF9DC0DC8C95BF614D67BF4151B13FA30567408F9B57BF0A2CDCBFDD915440E53B9D3F7BD8A540FA94854096BC693F9796E53FD6E1F63E31A6B93F8AEC353F8104B4BF40DA37BF4A5A88BE6AABAF3E97CD52409FEEB240A5BC99C0532C0BC05C6795C031750940C3C9D3BF58ADE53E3E7FA13FFCF61AC0BB8F683F79598AC023BA5540C4AA9A3E338553C0DA3034C07AB9AF3F08C99940BD4E29BF42E1F53E1271E24006FB0E3D83C70F405CA505402BF801C079E298C0F280A4BEAE520D3FBE1C9BC03DE7713F8244EABE3D2A5CBFB82829BFB8237EC08579AABF32C4C2C0954B713F03A275BFD40DCEBFFE40B4405F4185BF4B1EB73F9DE740C05F353ABF218EED3E6F261E3F849C6AC08B3C58C04F461840C91A39C0CFFADBC02A9227C0BAB9DE40EAAA5FC0230231C01CFA37C0B830AABF303B90BFB0B11EC03185A3BFAE0F0CBF06B002C1EBD9703F51B94BC0C2682AC0AE3BDE3F3F22D93FC48195BF0B0D1840C38DCA3F0C2199BD039411401FDD3EC0EEDF2F40EAFFBAC0232C31C0AD546A3DC36289404ED4493FB7BF63407D2DD0BF8A4F32C0291B874066E92E40930B3CC02216DBBFB7BD8BBEC8178D40E67798C0C7953D400E4643BF9AAF873F64D3A440306D643F22AD463F97A89CC056153240A2CD933F5332B23F99F9A63F5982D9BE1623B8C047892D3FB0315240CD91EDBF23CF32405D8D48C0E3B7D1BFD6164B405B38B9BE5770843FBC400B40C32A894027290EC0A8AFF5BB01D8E5BF6C32513FF7A22AC0E969A2BFAA9E84BFE71F3FBD282406BFD67E8BBFD9636C3F42FCFF3F959E07C0D0EBDF3FAAE53D400FDF453F87AE9EBEA15511BF7B3B55C085DE76C093B3C1BBB0C92C40187874BF2DDA6A3FA9657E40CD0474C09BDCFE3F61593140AA03353F4EDF33BF60528CBE6E862A40F7923340D2A9203F694F953F7A7AA540F88B81BF965AC2BDCCE840C05D6582BFA30296409DE7C63EDA884D40E350BD3FA453AE3F1D941FC05B4D844058D9DDBFB08C49C0C287F040B6FE4AC050360C3E6B0665C03168C3BF8A70AC406CF41CC01B40C23EEB3E49405D65B43E2B0F8F40647E3E3EFD0B56C00D7F5AC0CA6542400AE7AB40D3D8BCBF7A0E2540F22C0FC0DD566DC09AEF22401A0CB0BF27CB68BFDE1E83C014B7A93FB12697C08A6D6B4002E87D3F8C9365BF022BE63D94EBAFC0EE71BD3FA72907C001C68DBF99428640DE12BCC0B5C7A4BFD36EE43F3C79C2BF84C25F4076582040AB60753D1B71023FCFC185BFB9092040A637B440ED17DB3FC5607ABF9DE807BF871563C03261A440B51842BF03AF47C009E302C0D4D87DC0F0B44EBF7B089C40E1078DBF8C4F0241E3432540A6C81140D8F28440213A1740CBE9FCBF9874AB3F581AF7BFEB87ADBF7A83D9BF1417FCBF9E8E5FBF14E68B40C9102CBF3C0EB540C54415C036C80D3FCDB78B3E7DB46DC0224A953F6E130FC02E32C83F962FC8BEDF8EA3BF654154C05642D73EAEC9CDBF82D1833FCB2BBEBFC1F682BFC19B6D4056795D4093A6BB3FD42B12BFCF55A03FDBD45440377FF53FE210543E94B78B3ED45E49C01EF2533FB491E2C0139AC13F047943BFFB20DE3F75E429C0F53787C02A9DBC40110F64C032F596C077438940AAFDB3C0EB8C313C3D77A8C0170043C0809D23403268B1C041F94CBD4FCF6EC03DFEC8BFDE68E23F28495D4047BF043E5769DC40AD3A9A3F1411CCBFD1D4093F5E5BD3BF870AB9C0D80E56C0A41E1240"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
  func.func private @expected() -> (tensor<20x20xcomplex<f32>> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x762B683F8D7103C18101293FF31D053F8BDC32BFDB40E43FB8905EC0D245F03FC2D9CBBEA0D512BE6E7F7D42BE3783C24712003B095286BFAF45933E19DAA13F345AD7C0D1421E40F7DA5C43185B94C4C6CB58BF9FD3F3BE05AD0241C8FD72C05B871CC1AA2690C12464523EA5F95C3FE7269EBE3521593F36E5FE40D4F8AFC25DAB06428631A441CF25E4BE73AB20BFB778B33EC61B9FC01361703EE06A56BF9E5A42C09119D9C0A689C23F6172923F22B7F5BF2804CF3E095034BDB958A33D0605373E5428DD3FB64FC9C365884AC47D7EAEC043BA574158AF344203A98542FB44C5C0F14303C0C47948C3799296C0408655C13A20B03E51446B3D0287183EA5C89EBD1A7D8A3F0AD261423CF422C20F3510C2F6FC8342F5B820413A26E4405DBBA5BF4D0E3CBF34940A3F6832AC3FADC926C1DC32AB402F893E41B345903F5A159ABD5DD690BE4F922EC2CE177C41E984A5C059512ABE8C9713BEBF8307BF1BE20ABC45417CBFD4DD6C40F6CD274063B71CBFCCD221409680E0BBFF4881BF12EFCC42DE6525C3EE84CE3F1B71DCBFA2D0EB3EBF50563E77164CBF101936BF66DE8D3FE9C4EB3FFC383CBF691138C03A80F93E2EEEAD3FA73B9D416D0700C059AEC0BDF45EF43EDD57C7C056B3EE40E4AFB3BE724575BF5263B73FE4182B3DD4D93EC161001942B165C73EFBDC14BFF7408EC1785D43C1399CCA42093AF9C3A25C05C3D1637D4265FBBE3FC79BF13FF9214C41D97CC440D74CE83FBB1F1240A2150FBF63F2E6BE7D66C6BF38EB58C0FD5F0540B95712BF1B13C9BE6263F03B015099BFEF10A43F6F8CA1C1EE8503C12F1598402F070BC2A0B484C0468A2AC0C45F09BF194A3AC18BA80A3FE2CDF93F4F1ECFC0EB97F34001EDCB40683B8ABE294D4D3F46CCB8BFA4CB673F748204BEF71C97C11D2653412059AA3D034326C1374613C1B6B1223FA9420CC2AB0F76C28F32743ED8A694BF2549B03D1578623FA2981D401CE1E5BEA3D0663FFB8150C07E7EAD3F5A33B8BE2A8A88C2BBBDAAC1115C07BFC9F53B3D55D3363B8E168CBF147D87C083755F409B041940CA359D3DD802F8C2AC7DE8428FC936408159F8BE5B8D853F0B753E3F43D28A3CD0E9A0BF6E98873F32CC06C28E025E4052B614C13ABFF540714609C04933FB3D32C753BF6D153142ECA9E2C1B48C7240C1F657400155D23F66D7AAC02EF360BD0C403ABFF15B983B61A681BF07BBD9BFD12D803E0060BB4203310B44A15C4C43E166C9437D375E401126A03DC420E841A6FCBFC2C9EBE53F2FD3834071EA4441C1009040AE4016C21E5FB6BE9FE139C1CE71B13F5EE59B42164F1C43C87D533F4C232D3F83B304C1B6BD34417ECB3A41271F0FC129C255BDB185A63F28AA28BF601B33BF4FEB153F8ED8B1408CDF4F3FFA11404065BCB13E4FEAF5BF08F983BEF7C9A73F3CCDAF3E0CAF553F022AEB404FC42741EA7DECBF6C2282C0049A56BDD5BC7D3F2DE27541EC4A63413418D13E4DFE9F40F857884136C602C2E17FF2BE6FCA00BF1A4744BD3F9B8DBFCC3F9A417FA79341B71E37C1C1CE8D4203A76FC012CAB6C0B9E35A406D57674160E140BF8A6A113FE542883FCA3A1DC0D8240BC030F854C2540228BFB3F937403F2BDA3F3344F93FCFF28C3F11B310400EF63FC0E1F29FC0061E92C0BF33B6406F1265C266CE15C3CA971B40C6B83CC1EDC566BF79FB62BF1E7F0941818B39C17FEABB423E854C426DCD13C1530E28C1B03E02C2736FCBC1B012CD3F3EE9BEC0177C6CBF643D87BFD52E9EBE8FF4A0BF7BE40EC286BB65BF05F9D1C0DB662841D25CCBC16D97D2C183AA834194629CC0673280BEE261733F07846D3D5D4A543FB45481BD57D1ABBF35D7F0C03E760B415AF341409C7EDA3F6B7A22C02E2E80C04F1C8CBEC2E67ABF8B3B9ABEBFB9D3BFA58F8B3F68D573401F5B0E417AED2941A1631ABE6C1A0B3E1FD7AA40BD957FBFB31BCFBFF16447BE2BEE8740D45FB43F9EC680BEF941DA3F072EA2BE7F81EBBF6FBD56C125C1BD3FB183A1C06E2D1641E2C16240383FDFBE2E1E60BFB14C7C4076C781BF7C21663F414D31C1C4BB89C1356E30C1693FBBC0A0B482C1A8FE03C1628D7640402889C03E93C1BF28FCFE3FE80F25BFB719B33F2A69A0BF8F0EB3BF483787BEEE787F3FA5D7753FBFDA183F56FF9240CCD30AC262CC1ABF3D2C093F809756BC0E39163F4EE31FBF83F138BF2F00483F25985E3F2C9698409F7DFD4028AB054160336CC1722C80412F5D0DC0EFA5064122EF2140EDA4BDBE0BC2BEBF9AF8F43F95F70EC06251DABF99FF1CC091D6854110EFBBC13A902E41D6FB3CBF271260C1A87BE44220411E3F561D11BFC118F642B80314C3DE81953F9F52453E01F7CE41FFF9C042D5CDE04063C03DC04F2FC9C110921F407F63E2C19AAAC74167D6FDBDCD4687BF3E2E32C0829C1B40A50219427AA76D420AF21EC4876253C2FF49E83E38C54B3F9E53D23F315CBCC0AC5B283F0BFAA93FCC7E33C12387B6404A96DDC1575E3F417B55523FEC2DBEBF8FC6DC3A0033673F70AA733E74BE533F9508C23FF96781401D0F06C0D1D5A8BF08B5FC3F91D4C33FEE519340C9D5A1C02C92F33CA5AF39BF35252E3EE2F0A8BF82CB31C17B3680C1963F4FC00B184D40940ABC41A19DC9C0E9D7A53C72EAE53F71B6B1C26C932F4336B52D3D999B853FD0FD0DBFA6C132C1D4C2A2C158CBB0C0AFD8673F3C5B92BF20860FBE265C9F3F8D924E40750D7840C5033CC1283F4F42942D66BF9157B1BFBEEFD5BF793E75BF62FE0F3E742FAEBFA69B94407C0051416F9036C21A0099C228936CBE7F95B43F2F8C763D6C228E3FD661013EFD859FBF3F0441BFF903ABBECC10B1BE657C24BE32DB4441AD8505430077413E98758E40630AB5BEEA6E8AC07078103ECA68863FE0DA5BC0DD318F40F9EB1342E95EEDC02CF09ABED83F2E3E3E73D1BF6478034100E24042302316C25E39B33E57DA4B3FB3E6B2BC99DC473FFDC5E1BF9AF76AC0A87861C29F1B96C101DC9F3D11A9923F0ACA7A3FCF7227BFCB0E44BFC4E35ABF2FC6C8C03A2ECEC16A4101C3F8EF3143B4DB313DED6FBFBFDB388D42912DF1C2613FFABFB6D78FBE949935BF423A123F43CA11BFD15F193F27852941D43D224138D6EEC0F34FA1C0591AAAC0FB2B8A4004EE7441EFA6C1C0290007C082160AC1166A8B3F192586BFFDDBB4BFBCBA80BFB4D581C42815B24482FA2A41642EB2C0944FB0BE64C939402100863FF46F9C3F80BF1440F9FF41BE7BFF97C0BC9847BFBD21E140246A5540557DFDC0B51FEA3E5267CE41E5B8CF41928679BF76598CC1557573401EC8E5C0B1F8EFC05BA5C7BF9D1625C00F4E45BFF558094017332442D71EDF403465D6C0CC040A3F1757BBBFB487393F82937F3F96547A4243ECBB41B200823E35B2DB3F951AC73F7FC350BFEAC5F5C2A5E3C54208F86FC02B2E4DC1374302C151CC85BDB6681E408439ADBD4A6041BE36A46A3F68F0E5BF3D0382C07DC391C093390FBD844200C00E6E1040F13908C0EDCFDCC07D7B9DBF3B8E97BD79E181BE3C6A81BFA2DDE1BEBBA5A93F87853A3F26F28440E607DE40BCB6D94023F187BE0C5110BFA1BD2841D31A13419C1AAF3B06E9DA3E51402CBF829B973FA8BAA6C1E88284416D6156C0CAE1AC3F66F1153F9C8A50BF966E7C3E1D04F43E2271D5403CF99B40C65A243FD11ACABFCD2298BFA31D17BE538BAAC0C91A0BC13C0749428195A441344D913FF6024641E218BABFC9BBA0BF1687A1C06398F6C12F8F76C0DD58304125AF3CC156B8D03F8B564ABFD4408FC13BF5A8C2F1378BC280F1C6BEB5F749BB335FB0BD191284BF1AAA3BBEA5EA513ED1837141125CCA3F041A2441D94ED6C27EA281C026C7A6C0EFF886411F353741069B91BF8694D4BFEA6EE9C0BDA4E941686B4142EA53E6C167C2393FCB5D99BFEF0CA33DFA36363F075289BF4C7AFDBF218B2A3FB6D1BABFED9847C2E84D2BC3B181183E91BF43C0011A54C1A6F41C41DB55563D4F30FA3E099F7F3F298F743F33C89CC13F330A4391057CBF12B544BF19CCE4C07E8A7DC1602F553F6996E5BC8A142540C9B238406DD315BE9FBEA9BF2647C43EDDEBCC3FBAB188C041D1A140EC6AB5C1AF14B34199954FBFC6FC64405C5838BF98065CC0025C833F60B626C0E40EA93EBCA6A9BF7C4316BF4AF638BF5EDE8AC0E1042F405ACC6DBE0FE40F3FC8E064BFE464B1BFB62A07409C4973BFF09CD03FDA46AC3E2AE982BC9B628BBFDAA3D43DF35BC9BFFD70823FA15659BF88DDD43F37867D41380341BE06F08D3FBE3397C0B77F51418FAE4D3E8EF58C3E1130FBC0DA420941656F0AC25549144481EC0C3E54E7A43F15CD53404511CA40878D25C35297944219A7B7416D104CC231960AC3773FC03F137DC042274B12C1BC7F974077C98B40E6692A3D02910E3F37ACE73E105F1D40E58A7B419C6E0340995C2F4382DAE443E5B701C06C47A83FE4F70CC0BA0BA63F180E1441F9DE2B41"> : tensor<20x20xcomplex<f32>>
    return %cst : tensor<20x20xcomplex<f32>>
  }
}
