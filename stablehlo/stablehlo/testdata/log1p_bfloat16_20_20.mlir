// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.log_plus_one %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xE73FA9C0E93F4C3E1CC0BFBFDF3E90C008C06AC0B63FBE403FC0ED3E05C0203F43C09F408B4091BFA53FA53F9D3E1BBF7ABF12BFD33F9F3F70408BBE92BFCCC04440534005409840C33FB9C08A3D453FB340F5BF60400140203F9AC09440474083C007BF2140C93F284045C030C0BE3F40C0543F974017C0033E8BBE963F4AC047C0743FD2C03D3F5240F0BF9D3F2CBEB740B5408DBE0740BE40033D893F7B40833C6BBFC83E9D4061C0B83FA8BE913F71BE633FB63FFC3FF440B03EF83F80BE983FCF3FCFBF23C096C088BF7B3EF2C05C3FD63FEC3F2EC03140C7BFF8BF8640C73EBF3F17C04540D3409DBF833F9EC00B3FD7BE26BE933D1B40204027BFB640ED3DC8C041C0963E0040913F58C0DFBFF3BF163F004090C0CFC05DC01F4051C0703FDB3F79BFBAC027C0363C01BED04084BF1640B340E4BF81C0AC3EB0BF533FEF404140724016BE28C0B93F82BED2C0CA40843FA4BED3C0C73F653F8D3FF53E00C130BEE33E8C3E97C03E3F50C00CC004C05F4053406F40983E6340503F27BFD0C0AC3F0C408B3FCEC0A04080C0D3BFE6C0A93F173F36C0DCBF3FBF8FBFA6406BBF20401C40C63D31407A405AC014C0A4403BC049C0314088BE76C0FEBF9440B6BFD440463F7AC09FBF703F99C0B14018C09DBF75C038BF4940ACBE1FBFA3C08CC0F13F2EC0433F18404240B2BF06C02740E53F063F4AC02B40A93E05406DC016BFBF4086BF0FBF303FD9BF2BC0F3BFFCBE2440BEBFCA40C6BF8D40F340223F5740993F28BF10C08A3EA440DEBE733E363F81C017C06740A83E083D453FA64068C041C0B43D4EBF7FC0063F2F4030C0E1BF713FD13F5C3F13C05FBF85BF24C03EBF833FD2BF84BE8AC0BA40A53E62400BC090C093BEFCC0084001C09740D03F56BF04C023C059403BBF07C09B400EC09CBFDEBF57BD21BFEB3F02C01540E9BF85405A400840C23F8140254001C05BC0A540A1C0FE3FD43ECD3EAA3F4BC063C0864004C0A13F89BF9A405F40533D12405DBE653FBDBFB74082BF82C06AC02F4056C023C0533F63BF54C005C06EBF5AC06740C8BF754089C04ABFADC065C042C0ED3F8940E8BF97C0BDBF1EC144C014405C407BC07D4040C05DBEA93F0640A8BE"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x843FFFFF853F3A3EFFFFFFFFB93EFFFFFFFFFFFF623FF83FFFFFC33EFFFFF93EFFFFE53FD73FFFFF543F543F893E6EBF70C058BF793F4F3FC73FA2BEFFFFFFFFB33FBB3F903FE03F6D3FFFFF863D123FF13FFFFFC13F8D3FF93EFFFFDD3FB53FFFFF40BFA13F723FA53FFFFFFFFF693FFFFF1A3FDF3FFFFFF73DA2BE473FFFFFFFFF2B3FFFFF0E3FBA3FFFFF4D3F3CBEF43FF33FA5BE913FF83F013D3A3FCC3F823C20C0A93EE33FFFFF643FCCBE423F89BE233F623F8B3F0A40973E8A3F93BE483F763FFFFFFFFFFFFFFFFF603EFFFF1F3F7C3F863FFFFFAA3FFFFFFFFFD33FA83E6A3FFFFFB43F0240FFFF343FFFFFDE3E0BBF35BE8E3D9D3FA03F87BFF33FE03DFFFFFFFF843E8D3F423FFFFFFFFFFFFFEC3E8D3FFFFFFFFFFFFFA03FFFFF293F7F3F66C0FFFFFFFF353C0ABE0140FFFF9B3FF13FFFFFFFFF943EFFFF1A3F0940B23FC83F22BEFFFF653F96BEFFFFFF3F353FC6BEFFFF703F243F3E3FC83EFFFF41BEBC3E783EFFFF0E3FFFFFFFFFFFFFC03FBB3FC73F853EC23F183F87BFFFFF5A3F943F3C3FFFFFE53FFFFFFFFFFFFF573FED3EFFFFFFFFAFBFFFFFE93F20C0A03F9E3FBD3DAA3FCC3FFFFFFFFFE83FFFFFFFFFAA3F9EBEFFFFFFFFDD3FFFFF0240133FFFFFFFFF293FFFFFF03FFFFFFFFFFFFFA2BFB63FD2BE78BFFFFFFFFF883FFFFF113F9C3FB23FFFFFFFFFA43F833FD83EFFFFA63F923E903FFFFF62BFF93FFFFF51BF063FFFFFFFFFFFFF2DBFA33FFFFFFF3FFFFFD83F0A40FB3EBC3F493F89BFFFFF743EE83F12BF5A3E093FFFFFFFFFC43F913E063D123FE93FFFFFFFFFAD3DD1BFFFFFD83EA93FFFFFFFFF2A3F783F1F3FFFFF03C0FFFFFFFFAEBF343FFFFF99BEFFFFF63F8F3EC13FFFFFFFFFADBEFFFF923FFFFFDF3F773FE7BFFFFFFFFFBD3FA8BFFFFFE23FFFFFFFFFFFFF5DBD7EBF853FFFFF9A3FFFFFD23FBE3F923F6C3FCF3FA33FFFFFFFFFE93FFFFF8C3FB13EAC3E583FFFFFFFFFD33FFFFF503FFFFFE13FC03F4E3D983F79BE243FFFFFF43FFFFFFFFFFFFFA93FFFFFFFFF1A3F0BC0FFFFFFFF2AC0FFFFC43FFFFFCA3FFFFFC7BFFFFFFFFFFFFF863FD53FFFFFFFFFFFFFFFFFFFFF993FBF3FFFFFCD3FFFFF79BE573F913FCCBE"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
