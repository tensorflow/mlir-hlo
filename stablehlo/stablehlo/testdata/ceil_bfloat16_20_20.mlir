// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.ceil %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xEBBDFF3FA73FC0BF9D40AABF2B40E3BEC93FBD40E9BE01BDF73F24C037BF6C402240AA40CB3F943E3CBF52C0B44047C0B03F15C0D43EAC3C05C0E63FD1BF2C40DCBF5A405E408BC078C08E408EC07D3F513EABC05AC0B0C0A7BF9DC015C0A33FFCBEF54007C024C01FC19CBFBB3FB1BF7D40AFC09CBF31C02A3F6DC087BF1BBF6CBE51407E3F78BFBBBF8CC00DC0D4BDB3BF513F6C4079BF86C0CFC07E3FE2C026BE05C089C025C027C0423F07BF16408B4008C082400AC0C9BF7640173F374073BF5C4086C0F8BFACC087BF80BF5840B7BF8A409040693E7640B23EC3BC53400A401A4088407DC0CFBF3FC065BF66C0AE3F8140A0407E409540DBBF84BFD23F08C033C00EBF86BF85409B40383FCD3EE6C0083E03C04E40F5BF7FC08F40ECBF80BF1F3E983FF4BF59C0DF3E27C0463F933D23C0D6BE324042C0C03F0F40E93FB23F21BF0FC067C03C40D0BD2E3FAABF49BC5D402C400040BE3DEABF90C0BEC06EC0023E0BC0C93F5140514007407040F3BF903F2CC0FF40C7BFF1BFDABF32C06E400B4036C027BE66C024C0FDBE71BF5EBF33408940514087402D4081C04DBEB7BF61C040BF25C0A0406BBF744053C02F4017BEFC3F1B403CBF83400CC0C63F02C090BFF03EC9C04C4094C022C06F3E7DC0D9BF24C06CBF34BF43C01C40FEBDFB3FF6BF5EC0073E323FAEC015C0F9BE5E3F8A40A4BD213F7840C33F4DC05D3F60C04DC071402540B5BF4EC034C070C010BE9D40E5BFA74062BFA240FF3FB43F884088409940B93F4C3F78BF083F78C063C0CDBF85C0B4C054BF3A40B53FFEBF6840FEBEAC3FD3BF8940CDBED53F794063C011BFE9C04D3FA5C000C0AF3FC3BFEDBFB03FAAC08E40F63F48C001C00CC0CF3F0440FEBF444081C0B9BEB0C0A13F98BF1EC01240714023403AC0C53F8EBED9BF3CC0B13E0AC09AC0833F293DBEBF06404B3F574035C01F3E22BF19C0A0C0E5BDB1BF0A403D3F12C0A940203FF13FD7BD8B401B3FAD4067C0B73F73400EC033C098C0EEBFC03F253DFFBFC93E91C01DBF9EC0E83F4E40FC3F7B40963F6A408840FE3E2E3ED8BFFDBF9D40D9BFAFBF51C04B3EC13CE83CEEBF85C05CBD763F0140053F643FE2C06CC0424065401DC0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x00800040004080BFA04080BF404000800040C04000800080004000C0008080404040C0400040803F008040C0C04040C0004000C0803F803F00C0004080BF404080BF8040804080C040C0A04080C0803F803FA0C040C0A0C080BF80C000C000400080004100C000C010C180BF004080BF8040A0C080BF00C0803F40C080BF008000808040803F008080BF80C000C0008080BF803F8040008080C0C0C0803FE0C0008000C080C000C000C0803F00804040A04000C0A04000C080BF8040803F40400080804080C080BFA0C080BF80BF804080BFA040A040803F8040803F0080804040404040A04040C080BF00C0008040C00040A040A0408040A04080BF80BF004000C000C0008080BFA040A040803F803FE0C0803F00C0804080BF40C0A04080BF80BF803F004080BF40C0803F00C0803F803F00C00080404040C00040404000400040008000C040C040400080803F80BF0080804040400040803F80BF80C0A0C040C0803F00C00040804080404040804080BF004000C0004180BF80BF80BF00C08040404000C0008040C000C00080008000804040A0408040A040404080C0008080BF40C0008000C0A0400080804040C040400080004040400080A04000C0004000C080BF803FC0C0804080C000C0803F40C080BF00C00080008040C040400080004080BF40C0803F803FA0C000C00080803FA0400080803F8040004040C0803F40C040C08040404080BF40C000C040C00080A04080BFC0400080C04000400040A040A040A0400040803F0080803F40C040C080BF80C0A0C000804040004080BF80400080004080BFA04000800040804040C00080E0C0803FA0C000C0004080BF80BF0040A0C0A040004040C000C000C00040404080BF804080C00080A0C0004080BF00C040408040404000C00040008080BF00C0803F00C080C00040803F80BF4040803F804000C0803F008000C0A0C0008080BF4040803F00C0C040803F00400080A040803FC04040C00040804000C000C080C080BF0040803F80BF803F80C0008080C0004080400040804000408040A040803F803F80BF80BFA04080BF80BF40C0803F803F803F80BF80C00080803F4040803F803FE0C040C08040804000C0"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
