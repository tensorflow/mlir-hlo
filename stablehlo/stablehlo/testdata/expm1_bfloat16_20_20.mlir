// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = stablehlo.exponential_minus_one %0 : tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x1D407ABF1E400F3FAABFCDC006404F3EE63E69C08CBFFFC014BFC83F24400D4021C0E73F57BF86C03AC00D3F863F3340E1BF2F407FC0F34084C0E2BF8F40FB406BBF1540ABBF33C0DF3EDB3E08BF033F83C097C0833EF7BFBBBF08BECDBF97BE30C05BC0A7BFD5BB0CC07BBF30BECDBEEDBF9C40E03FFBBF35408940DE3E2F40DA3D75BF2140AABF4940853F4E3FC2BF0DC042BFF9BE14C0624007BF0D3F863FA940833F65404B408EBFF9BFCB4085BC31C0F0BE2FBFE43F75C000408EC080BD85BFB93F833FA33F8AC0DF40C340A2C0324045BFD63ECA3FCDBFA3C08AC022C0FE3F1C4009C0A03DE63F6640434006BF523F4E404CC0E63FBE4008C0E440A9BDE03F363E72C0A7BB0040C7400F3FD4C05BBFEFBF863F173FFB3FABC0B8BFCA4058BF5CC02F3F243F204092C04F40F53F273FEE3F673FC3BE0C3F0E4026405C3F1DC015C00C40B14083BF80BF533EF0BF2BC00A400B40BE3F21C083C0B4BFAD3F84C0E33FAF3FB8BF3F40B5C0A24066404DC066BFD5BF40C0C140A5BF2B3E174089C0B4BE09BFBA3F31C0773F48C019C007C0004011C04AC036C07E3C7840FD3FE33F653EB23F9E409640E13F52C00640C3BF9740644040C0F5BFFDBF4B4001409A405140A4C036BE70C02AC0943F173E1AC00D40563E7B4024BFFC3E2C3FD23F70BE0BC09B3F1FBE3A3F9DBE58BF0EC0434091BE86BF7F40D1BFE3BCBCBF3EC0B740274037BE61C0863F3DC0803EF43F7940173FC640E23F92BF12C0A33E5E3F07BEA83F77C0F83F05C0073E04C0CDBF0EC05040FCBE5140ABC071C007BF1D402B4012BF6940244024C0333FF4BE3E3F9E3FBABF133FE0BF53C0784028C0BB40FD3EBD40AE3BF93F3240923F8640C6BFAC3E51C0AB407D40AD400E40D9BFFEBF2BC0FA404D405B407FC0C0C0194065C09140AD3F403F044055BFC4409B3B0040B8C052C0B8BFB2BFB3C0CB404A40D4BF493C72409AC02740FD3EE0C0654049BFA8BF24C003C0F4BF50C0833F9BBF8B40EBC02940E8BFC33E79BF79C06F3F36BFC43FC5C06540D63F393EA24005C02740833C76BF7D401C3F1D408A406ABF3CC0754056409C3F4D40AA4091BF0D405D3F78C0294009C1293E8B3D1DBF743EBD40"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2A4120BF2D41403F3CBF80BFE440653E113F79BF2ABF80BFE1BE71403F4101416BBFA24011BF7CBF72BF3C3FED3F764154BF66417BBFF8447CBF54BFAC421F451ABF14413DBF70BF0C3F093FD3BE2B3F7CBF7EBF953E5BBF45BFFFBD4CBF83BE70BF78BF3BBFD4BB63BF20BF22BEA9BE58BF024398405CBF7F418F420B3F6641E63D1EBF36413CBFB141EA3F9E3F48BF64BF08BFC5BE67BF0542D2BE3C3FED3F4443E43F0B42B7412CBF5BBF0E4484BC70BFC0BEFEBE9E407ABFCC407DBF78BD25BF5040E43F25407DBF8544DD437EBF724109BF053F76404CBF7EBF7DBF6CBFC940274162BFA63DA1400D42A041D1BEA33FC04175BFA140BD4361BF9B44A2BD9840473E7ABFA7BBCC40FB43403F80BF13BF58BFED3F4E3FC3407FBF43BF0A4412BF78BF7B3F663F33417DBFC341B9406C3FAD40BC3FA2BE3A3F03414641AE3F6ABF67BFFD407B4324BF22BF6A3E59BF6EBFF440F9405A406BBF7CBF41BF37407CBF9D403B4043BF96417FBF1D430D4276BF18BF50BF73BFD04339BF3A3E19417CBF98BED4BE524070BFD03F75BF69BF61BFCC4065BF75BF71BF803C3D42C7409D40803E41400A43D7429A4076BFE44048BFDE42094273BF5ABF5DBFB741D040F442CA417EBF27BE7ABF6EBF0B40233E69BF01416E3E4642F2BE233F753F854056BE63BF174013BE893F87BE12BF64BFA0417DBE26BF53424EBFE0BC45BF73BF9843494128BE78BFED3F73BF913EB74040424E3FF3439B402EBF66BFC03EB13FFDBD2E407BBFBE4060BF103E5FBF4CBF64BFC641C7BECA417FBF7ABFD2BE2A415741DFBE14423F416CBF823FC2BE8D3F1C4044BF473F54BF77BF3D426DBFAC43243FB743AE3BC04072410840824249BFCC3E76BF50434C425E43034151BF5DBF6EBF1A45BD41ED417BBF7FBF1F4179BFB84237408F3FDC4011BFE4439B3BCC407FBF76BF43BF40BF7FBF0E44B4414FBF4A3C2B427EBF4941243F80BF0B420BBF3BBF6CBF5FBF5ABF76BFE43F34BF984280BF504156BFED3E1FBF7BBFC63F02BF68407FBF0B428A404B3E1D4360BF4941843C1EBF4C42573F2A41934219BF72BF3442DB411940BD414A432EBF0141AF3F7BBF504180BF383E903DEBBE8A3EB743"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
