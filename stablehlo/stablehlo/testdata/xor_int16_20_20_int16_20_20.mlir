// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi16>, tensor<20x20xi16>)
    %1 = call @expected() : () -> tensor<20x20xi16>
    %2 = stablehlo.xor %0#0, %0#1 : tensor<20x20xi16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi16>, tensor<20x20xi16>) -> ()
    return %2 : tensor<20x20xi16>
  }
  func.func private @inputs() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}, tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0000000000000100000000000200FCFF0400FFFF0200FFFFFEFFFDFF0200FEFF030002000100FDFF0100FCFFFCFF00000000FCFFFEFF04000000000000000000040003000000FDFFFAFF040001000000FFFF0300030000000000FDFFFFFF0400000000000000FEFF04000300FEFF0500FDFF000000000400FDFF050004000200020005000000FBFF0000000000000000FBFF0600FFFFFEFF030000000300010000000000FDFF02000300FFFFFDFFFCFF010001000300000003000000FDFF000001000400010000000000000000000300FDFF0100FFFFFDFF01000100FBFF00000300FCFFFFFFFDFFFEFFFFFFFEFF01000000FDFF00000100FCFFFCFF000000000200FCFFFEFF000004000100FDFF000001000000FFFFFCFF0100000007000000000000000000FCFFFCFF0200FEFFFEFFFEFF000000000000000000000200020000000000FFFF00000000000000000000000000000000FFFF0200FFFFFFFF000000000300FFFFFCFF0000FAFFFCFF0700FBFF02000000FCFF02000100000001000000FBFFFFFFFBFF01000100FDFF01000000FDFFFEFFFFFF01000200000003000200000000000000FEFF020004000000FFFF0300000000000400000001000200020000000100FFFF0000FBFF0000000000000100FEFFFFFFF8FFFFFF00000000FBFFFCFFFFFFFCFF0100FDFF0200FFFF060002000100FEFF0000FFFFFCFFF8FF01000200FFFF000002000100FBFF00000600FDFF050005000300FDFFFFFF0000FFFF0000FEFF010000000100000000000100FFFFFFFF00000400FDFFFAFF00000200010004000300000000000100FDFFFFFFFBFF0000FFFFFFFF0200FEFFFEFF0000040000000000FEFF0000FDFF0000050007000000F9FFFFFFFFFF02000400000000000100040002000000FAFFFCFF00000300060004000000FCFF0000000002000100FEFF0100FFFF0000010003000000FBFF090000000400FFFFFFFFFEFFFEFFF9FF0000FFFF000000000000000001000100020008000100FEFF0100FFFF0200FEFF0000010002000100FCFF050003000400040004000000FEFF0000FFFF03000000FFFF010003000000FEFF0300FDFF0000FCFF0000000000000000FEFF"> : tensor<20x20xi16>
    %c_0 = stablehlo.constant dense<"0x010004000100FEFFFFFF0200FDFFFDFF0500FEFFFEFF020000000300010000000600FDFF01000300FAFF0000FBFF00000100FEFF000003000000FDFFFDFFFFFF0000000000000000000003000000FCFF020003000000FEFF01000000FEFF0000FDFFFDFF0000FFFF010000000300FFFF0000FFFFFFFF02000000FBFF0300FEFFFFFF040000000200FDFF000003000300F9FF00000000FFFFFBFF0300030001000000FEFFFEFFFFFF0300FEFFFEFF08000100FCFF0000020004000300FEFF0100000000000100010000000600FDFFFEFF0100010003000200FDFF000002000200020002000000010002000000FCFF0000010002000300FEFFFFFFFBFF0200FFFF0200FEFFFFFF0400020000000200FDFFFFFFFEFF03000000FEFF0500FEFF000004000000000001000600000002000700FFFFFAFF01000000FCFF000002000000020001000100FEFFFEFFFFFF0500FDFF0000FAFF0100F8FFFCFFFFFFFFFFFEFF0000FCFF0000FDFF0500000000000000040000000000FCFF0100FEFFFEFF0200FEFF000000000200FFFF000001000400FFFF0400FFFFFEFFFCFF010006000300FAFF00000000FDFF0000FEFF0200040006000300FEFFFCFF00000000FFFFFFFFFEFF0200050002000000FFFF010001000100FEFF0000FFFF00000200FFFF010002000000FEFFFBFF01000500FEFFFEFF00000100030002000500000002000000000006000000030002000000FFFFFEFF01000300FFFF0100FEFF0400FDFF0200FFFF0000FFFFFDFFFFFFFDFF000007000300FEFFFCFF00000100FBFFFEFF030000000200FFFFFDFF01000300FAFFFFFF0700000000000000FAFF0000FFFF000000000000010002000100020000000000030009000400FFFFFEFF00000100FAFF000002000200FFFFFFFF010002000100FFFF06000000000001000300FEFFFEFF05000400FEFF0000FEFF000001000100000001000100040004000100FEFFFCFF0100010004000100FEFFFEFFFFFFFDFF0000000003000000FFFFFFFF0200030000000100FDFF0000FBFF02000000FCFFFEFF03000000FDFFFDFFFFFF00000000FEFF000007000300FFFF0000FFFF00000300FEFF00000100010000000700FDFF"> : tensor<20x20xi16>
    return %c, %c_0 : tensor<20x20xi16>, tensor<20x20xi16>
  }
  func.func private @expected() -> (tensor<20x20xi16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x010004000100FFFFFFFF0200FFFF010001000100FCFFFDFFFEFFFEFF0300FEFF0500FFFF0000FEFFFBFFFCFF0700000001000200FEFF07000000FDFFFDFFFFFF040003000000FDFFFAFF07000100FCFFFDFF00000300FEFF0100FDFF01000400FDFFFDFF0000010005000300FDFFFAFFFDFFFFFFFFFF0600FDFFFEFF0700FCFFFDFF01000000F9FFFDFF00000300030002000600FFFF0100F8FF0300000000000000FEFF0300FDFF000001000300F4FF0000FDFF030002000700030003000100010004000000010000000600FDFFFDFFFCFF0000FCFFFFFFFCFF0100F9FF02000100FEFFFFFFFCFFFCFFFFFF020001000100FFFF0300FFFF030007000200FFFF000002000100040006000100FFFFFDFFFEFFFEFFFCFFFCFFFFFF0500F9FF0000040000000000FDFFFAFF0200FCFFF9FF0100FAFF01000000FCFF00000000020002000100FEFFFEFFFEFFFFFF0500FDFF0000FAFF01000700FEFF00000000FEFF0000FFFFFFFF01000500FAFFFCFF0700FFFF0200000000000300FFFFFEFF0300FEFFFBFFFFFFF9FFFEFF0100FCFF0500FFFFF9FF01000100FDFF030006000000F8FF00000000FDFFFEFFFCFF06000400F9FF0000FEFFFCFF04000000FEFFFDFFFCFF02000400FDFF00000400010001000100FFFFFEFF0000F8FFFDFFFFFF0100F9FFFCFF010007000000F8FFFCFF0100060003000200FCFF0500FFFFFEFFF8FF01000400FFFF0300000001000400FEFF0700FEFFFAFF0400FDFFF9FF02000200000000000100FCFFFFFFFCFF000007000200010003000000050006000400030002000300FBFFFEFF01000300FBFF0200F8FFFBFF0000FFFF050002000100FEFF0000040001000200FFFF0200FDFF000006000E00040006000100FFFF0300FEFF000002000300FBFFFDFF0100F8FFFDFFFFFF0500060004000100FFFFFEFFFEFF070005000000010001000000000002000000FAFF080004000000FEFF01000200FFFFF8FF0400FEFFFEFFFEFFFFFFFDFF0100010001000800FEFF01000300FCFF0200FFFFFDFF0100F9FF0300FCFFF9FFFDFF07000400F9FFFDFF01000000FFFFFDFF0000F8FF0200FCFF000001000300FEFFFEFFFCFF01000100000007000300"> : tensor<20x20xi16>
    return %c : tensor<20x20xi16>
  }
}
