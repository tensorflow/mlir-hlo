// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = chlo.bessel_i1e %0 : tensor<20x20xf16> -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDC4490C2393EFD4582C446B813C0A540464006B57FC29E3B0043C73F7432862ADF4139C467C50946B3C472B46A268FC4333BA2C50F35C8479EBC8F3AEE4091C4E844673915C5943B1D402E3CEC42C83F4EC513C54C4301C232BF6440293FA9B54248A43DAEC295C55DC20544F3BD36C484C434AE9B48B943353C56BFEE3D5EBE58B8043CD8434EC107438E40F43F6CC182BC492C1E3C12BD993EE5B4B5C20244BF3A15C4CBC062C611430C47D2C3ACC10844593FF2B2EE3BBAC48445AF3A66C2F53B73BDF34067B8DE3C4844A545C6C4E540ABC6EE45F3BC25A714ADD137C13E04C0643B54C19BB93A3B463963C4D3B4463E6642D643CD4061C36C4093C021C659293943723E254462B8EA3F4BC4F1441C397F40CC3CD33301B086C4CD401FC126C383BB49BF453F964215C3C8BF363A35C789BC58B596C4C740124207BA2631C5C53444E2C484C176409EC0294500BCF9C3BD3FB9C0A0C1DAC20E3D523FBDC41FB9EB43EAC00A42463BC34287C4D9440BB95D3F6034A83837454D400D3E02BA463F3ABF8EB872B8014321C5F3BD9DC5CE3487B2F9354CB6713DA0C5E740CBC39D3B8C3D53C4153540461D444244A2C47EBC82BB6B419EBD57C22F2E03B697428346B3BB143D3ABD6445E63DE1B1CB3C53B9B53F83C6ED446EC3BDA9D8BF44C5233E3BC5353FDBC4504482BB5F40DB3B26C08D449E4127BF0B422346CF461A45F03EDD4137C53BB8B6C0FFC19B4005C4ACC068C2B641634163C1DC3919442B3B5E479CB62841273C41412441203F504499C1FC2402BB20BE95BA58B8E339DD37F141D0BB184680C20042BBBC8B470147AC3E3BC132433C39E8B4613F22BC9642CAB60CBD3EBC32C472BF0A3A234132A7283B693E20BD68C2C1BEF3BE99B953A8F9447B44293FA5BE5941B547B5C647431D3FFAB87B3E533B0E45A33BED3C303DA43E9936D0BE5D3AB0C60E449BC81CBF8144F540BEBA013B1A43DD42D7C3093AB3C47CB960B13941FBB9FE3E5D43B743B4382AC67FC63041F3BCA93B9C42A7444EC33EB639C243BABD3C764410C3C5C0D53F032C40C3B84433B8713AC83FF9C3B744C1445ABF293EC043402BF63EB0C14CC468393B3C38457D418C3CDBC42233"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4F3120B20333DF3078B131B1DFB2B832D2326EAF25B29232FF31EA324D2D342657329BB115B1DB3061B1CDAE412271B17832FFB0782F5930D9B24732A23271B14A31D23136B19032DD32B8320532EA321FB137B1E9314CB2F8B2CA32F83209B02D30FF3217B204B130B2B63102B39DB177B1A3A90730CB31BB32F5B2023302B33CB1A932C33184B2FD31BE32E5327BB2D2B20328B332EFB201334BAF15B2B7315632ADB1ACB2BDB0FA318A30C5B167B2B431F432A0ADA4325EB10A3151322DB2A532FBB2A03246B1E7329431FE3058B1A532A7B0E430EBB2F3A2B2A8F130FF32E3B2843282B2E9B17A32C23186B138AF03332D32C331AC32E4B1C832BDB2D2B02125EF310233A53143B1E63292B14631AD31C332E3322C2E14AB76B1AC3293B2F4B18CB2F6B2F6321E32F9B1EAB228327FB0D4B2C3AF6EB1AE32473216B2662CF2B09E314CB173B2C532BAB22E31A7B2BAB1EB32B2B26AB20AB2EF32F5325CB1AEB1BE31A3B249327D32113275B15031A4B1F432B82E6D312931D032033314B2F632F7B25EB14DB1FF3131B102B301B1322F5AAD2F3055B0FB3200B1A432C6B19232FD328EB17E2FC830A931973169B1D1B28CB27B32FEB232B29F2934B01E32B33097B2F032F5B217310233EAACE332C8B1EC32B3B04731E0B17DA5E8B223B1033327B1F7324FB190318CB2CB32A032DAB272316B32F9B24932D2309C303431FC32573229B12AB1B3B24DB2BB32B6B1B6B22CB264327E327EB20532AB317632743077B09032B63288329132F93290316DB2E3206AB203B349B23CB10832F53051329DB2D53025B24C32E0B268308D3000338AB2F131BD314EAFF432B4B21E328BB0EFB2BEB29FB1F2B217329232FFA275320233F2B22CB2FFB2FCB2E9B12EA442317B31F83200B381325D30A4B0EB31F9329BB10233803239319332E932F43200337630FEB23632A5B0B13107B0F9B27831A03256B26A32F8310932C3B1173261B1DBB18FAC8B3212B2FB32E531CC317431CFB0B4B08E32EBB295321D326631E9B14FB03BB22DB2E0327D31FBB1AEB2E8328A27EDB15F3124B13D32EA32BAB15F315B31F4B20333C931DB26FC3265B292B1D231BD3228317532D5324FB1BE2D"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
