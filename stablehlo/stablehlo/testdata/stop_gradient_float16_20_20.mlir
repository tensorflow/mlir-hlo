// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%0, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %0 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x19B8494246C4D439E0C0A9C4DE3F5DC6C1C460C6FBC4FC44DCC33640DEBC49BD32BB91C6CEC28B44E13BB142DEC6663CE83D8545ACB672420DB6163DDDC39E443545C744AB438BB7EBC28AB907C4B0C2D43C53413C436A430BBE6441A44147BE573B82C02C4478BDFFBE9D3ED440773E383B28C06444B23CDFBB55383DC1293AD341793614C492BE23BE8AC587364443174635A10733BAC575C05F3D022CD6BC38B978C4223C6BC0A4B1984145C379370A3A254084435E416E3A24434DBB22BF12BF49C3AABE43C44EBFF8BCF7C41141B8B7E0BED630C9373FC4D0C1374363BAF0B0B1BA7EC3BC452F327541863F062F63B84B34CF3F11BCE937C92608404A3E7F433E4348C389C271C23EC16F3D533DE62FB54159C67843D643FCBEC8367B3FBF43654360C03AB224BEF73FF53C67407D308EBE81BC31440440F6B096C1F3C3644127C30E3CFEB9672EE335FDBB6FBD93418346C53EB7C462415BBEE4BA823787340D42BB464145683A6EBD71BC9E244E45ABBE5B3F4D3983C5323DD6BE20B80CC24FBFA9BC1ABEB9BB4EC0E2C2563710C56DC82EC09FBFD9BD813B8F3E7EB295BE3A3193BEDD3B6D2E7FB930C197B91444F6C2D73A4D2FFBC0A4BE73414946CA21F0B9ECC2D93D55C8A4403A3F374222C190C12828B53FF940A13B3DC41F41EF41AEC6C4BE473926401DB9A7C52BC0BCC31C45BABC03C00FAF7AC6303C0EC5BA46853AB7C84CB873B26544943826AD56C122C48ABC5C3CCB394CC1D2C0BEB71941C5B1CDBC204288BC6C3F3445F4C1BDB7E6BC424061BC66C07635D13DCC4067C1F63CFE3963C54E313E42A74048341DC37838304334415E4038C63B3EE1BD7D4162C453C697BA5B3B0CAE32B4FDBD023774C491C5503E2B3F63BDF8381EC58F43F13F683C2E3B39C14C3D5CC0133E4244B9354FBC9CC1C42E27BAB63683BE0CC7D640813EC445E3B05F3912C285C063BC0E2FD539714511BFDFBCC2C19238E8C3743DD2C13740313FA42CF13EF5BD3E460AC3B4405DC0CB4026C25545ACC5D7C5B146254274BE783E9CC1822F9340D1C41740ECBE09C0494283C03444D8B97F381ABF00BDD43E903509BCD13F18C352C5C538AFC41E3ECB392AC2FA426A34"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x19B8494246C4D439E0C0A9C4DE3F5DC6C1C460C6FBC4FC44DCC33640DEBC49BD32BB91C6CEC28B44E13BB142DEC6663CE83D8545ACB672420DB6163DDDC39E443545C744AB438BB7EBC28AB907C4B0C2D43C53413C436A430BBE6441A44147BE573B82C02C4478BDFFBE9D3ED440773E383B28C06444B23CDFBB55383DC1293AD341793614C492BE23BE8AC587364443174635A10733BAC575C05F3D022CD6BC38B978C4223C6BC0A4B1984145C379370A3A254084435E416E3A24434DBB22BF12BF49C3AABE43C44EBFF8BCF7C41141B8B7E0BED630C9373FC4D0C1374363BAF0B0B1BA7EC3BC452F327541863F062F63B84B34CF3F11BCE937C92608404A3E7F433E4348C389C271C23EC16F3D533DE62FB54159C67843D643FCBEC8367B3FBF43654360C03AB224BEF73FF53C67407D308EBE81BC31440440F6B096C1F3C3644127C30E3CFEB9672EE335FDBB6FBD93418346C53EB7C462415BBEE4BA823787340D42BB464145683A6EBD71BC9E244E45ABBE5B3F4D3983C5323DD6BE20B80CC24FBFA9BC1ABEB9BB4EC0E2C2563710C56DC82EC09FBFD9BD813B8F3E7EB295BE3A3193BEDD3B6D2E7FB930C197B91444F6C2D73A4D2FFBC0A4BE73414946CA21F0B9ECC2D93D55C8A4403A3F374222C190C12828B53FF940A13B3DC41F41EF41AEC6C4BE473926401DB9A7C52BC0BCC31C45BABC03C00FAF7AC6303C0EC5BA46853AB7C84CB873B26544943826AD56C122C48ABC5C3CCB394CC1D2C0BEB71941C5B1CDBC204288BC6C3F3445F4C1BDB7E6BC424061BC66C07635D13DCC4067C1F63CFE3963C54E313E42A74048341DC37838304334415E4038C63B3EE1BD7D4162C453C697BA5B3B0CAE32B4FDBD023774C491C5503E2B3F63BDF8381EC58F43F13F683C2E3B39C14C3D5CC0133E4244B9354FBC9CC1C42E27BAB63683BE0CC7D640813EC445E3B05F3912C285C063BC0E2FD539714511BFDFBCC2C19238E8C3743DD2C13740313FA42CF13EF5BD3E460AC3B4405DC0CB4026C25545ACC5D7C5B146254274BE783E9CC1822F9340D1C41740ECBE09C0494283C03444D8B97F381ABF00BDD43E903509BCD13F18C352C5C538AFC41E3ECB392AC2FA426A34"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
