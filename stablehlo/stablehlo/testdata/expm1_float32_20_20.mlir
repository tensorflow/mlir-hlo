// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf32> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf32>
    %1 = call @expected() : () -> tensor<20x20xf32>
    %2 = stablehlo.exponential_minus_one %0 : tensor<20x20xf32>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf32>, tensor<20x20xf32>) -> ()
    return %2 : tensor<20x20xf32>
  }
  func.func private @inputs() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x0BAA88BF43BA45BF493E533FC354E6BE708A173F068DEFBF808791BFC55F64403DD2C9BF80AD1940308C2DBDD4D4813FDD38BDBFB013B4C0CD8471408C211E409DDC9EC0355C98BE08288CBDC6D3A23FD000DC3FE55943C00872A0BED5379EBF458FC03F0BC22D4019561FC0C9671C40D3B440C0F9B8ABC04EBF81C06341BC3F4BA71540199DB2BEE71528BD6CD76D4045468FBF7DC12CC09B2A383C6AB25A3FF78EE73F292D5DBE66C28540834CF13FECA29C3E25B680BFF5C073C0FC9B66C0040691BE059D74409E274940DEA25E40159C48C0C0A80ABF78CD00C0C66F39C089C34B406B9F01C0FC581BC059C232C047E1B2BF80E44B400D3B55C0487B58C07A31A940C9C1B03FF6405ABF26783CC096B65B3E759B9CC02C3D7FC02CFE1C40569B193F4FC5F33F0042EB405B416BBF01FB254023F5E33FE12A173F3836B13FBA3AD5BD6D57B7BF7FB64ABB939A95C05CBA31C0C20D9B3F492D6FC0F374A4C07022B0BF36E16E40218CBABF0821D0C01CB302417ED4EABF51B1893E1FDE89C069C18D3D34F08A4071991540823829C0A48A0C40479CAB3F230576C0FAC737C0C45942C025053B408A1E1CBFA2114CC0562A71C0DF8EBB3F3475CE3FEF4E51400E26A3BF495E2B4088F4C83E13ADEBBF2B058E3ED39268C04B15683FCA671D4079832D3EEADD1FC07C4A54406A36E1BFB8086C404797EE3F7B93A13EE036093F12ECC23F811DA03FABDF07401522C7BE08802EBF02C528BF6DBD6640A428933F0F6F574022D09E3F9F19E4C075A94040A77F40C0AD26B24069C58140EE22E4BFCAB20040462B76C078C08CC0D9D5A73F873F10BFEB75473E1D6E57BF19E1AC3F438E74BF9D27DCBFB8211140BE00904090C06F40DD1E834092793B40A178243E24A21BC087449AC0ED10DCC0326811C072B49DBF9AC2BD3F5778C3BEE97929C06D984BC0C635E63FE2BFAC407F4984C0BF64A8C04B3F3240C95E29404BA2F1BF8EC823402A8E94BF6B1E2C403E079DC0CB0E7B3F9CA731C0D35B7540E4BE24BF1652E5BEBF85B23FBC4F2B40755BC4BF1870943E2009C73FF41D82BE81C947BF56BA0D40211F1240A4F236C0B748D83F82D7D73FF3BD27405D4A70C0AF2F3EBFE8BC35C057CB05C056C612BFC5460BC0C53D233F013494C0C5B81D40D916953FB4B82740A13BA9C09C1948C06B92173FB64F973E8164604048EA9EC06660E73F0CC26A40857000C001F4274078CC54C03AA29E4047D293C0D1EF914037D1C33F4EDFA1C0C50DA2C0981D56406913803FF0A6ACBE8251B4C06C8C65C03B2F54408B431A3F5740F8BF5CF5F2BFAD3845C0C5551CBF6667B9C0AD1EA53F3382B23FCEEE2240A3E7FDBE2991FB3E87A2B2C0F35F40C01A4D663F57E6B2BE4F8CBA400A7882BF4B8C0CBF411B9C4029560F3FE6B3953F4618FFBF3A8B13C02BD925C0F55553409CE190C0E64911C0265B194139EF08405143E6BF30F9FDBF5B1FC0BFF9B78D3F181D6F400815833F8AC91440DE66AFC05EF584C0206F23C0C334DABFF97DAA3F751773C0B96B17BE09529BC0EADA4140FE183BC07C2FE53C11C58FBF35016540C3FCA33EF012CDC013279DC06A9ED4406A3D3BC024DB1DC0B056C03F3EAC17C0E8AA8BC05C3997C0A6B71040453C4C3F7795A7402AE1A33F82125E4013F81EC0BAACA0C0AC041441B3963C4078A6FEC01A0311C07D39A33D13E202C0B34B7B40AD23C43EA9E4CABE51D9CD3ECE2A9A4054CA0FC03E4E9CBEBB6FE73F53E05F40538D06BE92414140E78D3440603A40C0A37B52C0DE0436C0B9A3A3BE4A709FBF31E7A03F06F7584072CE1040CBF504BF299F46C0AC1AD23E231A733F48BD0ABEB315A0BE3373813FBE98A4BF10368740853ACF3F6AC2A3BF5B366ABDFFFA50C044BD9B3F74AFBEC034C9C0C0D14882C0BAE81B409B596CBE554EA74001E10641BBF4513FB318CAC00511D5BFA88F6F40455C78C07B9008407A63EE4019DA803EA0F5624092877040331851BF27E2C83EF80F6640D7A80D405A977A406B5F22C0B7D269C0502069C0AB87953FCB741D4056F375C0DB6AACBF765133404688C0409A8EEABE8D46393DB3EB37C00B13EFBF1E8289C03CA5C23FBF7CC13D6AFFD2BFD4946CC0CAF9D2BF3D1FDBBF82702DC019C0124050743EC082D7CB3F6B459CC0F585094072865AC024F29040110392BFAC0C69C0F01C3AC058A7C4BE46F59B40C4D2743F356930BF23FABDC0289E4C409A2B49407034303F275B62C0"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
  func.func private @expected() -> (tensor<20x20xf32> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x97FC27BFE8BF09BF5221A43F8E7DB9BEAEB94E3F679A58BF44E02DBFDDD40942FC184BBFCE95204120EC29BD3AF4E03F1FA045BF35147FBF362B2A42604F2D416F367EBF0DC883BED37787BDF15E2440717C92409BE773BF10BD89BE68A035BFBE15604088AA614167C46ABF1E462841F86473BFDECD7EBF738F7BBF028F5640D6D2154149C996BEF4AE24BD90712042A36A2CBF94C86EBF9334393CC2C2AC3F4659A340C3EB46BEA8BA80425FCBB240153DB73E4C5822BF8A527ABF290779BF7C967CBE1ECC3242EC64B1418656FB41DADB74BFFC1ED6BE34C95DBFC8E071BFB81BB941B9385EBFDB6669BF355370BF91B640BF497FB94151DA76BF4B4E77BF7BCE444354A03E4060DC12BF198872BF9210753E08157EBF4F417BBF1EF929418A79523F9CE7B64056C0C244A3DF19BF2A03464106EE9D40140D4E3F5C883F402781CABD8DE142BF51664ABBEA9C7DBF071270BF1FEA1640CAE679BFD57F7EBF4F573FBF0F222342906444BFDE9D7FBFA27D5C457C1F57BF32FC9D3E2E8E7CBFCEC6923DDFB19742F6AE154148CE6DBFF8A2FF40729734401C857ABF0C8271BFD2B673BFC5A78C4196C2E9BEEA7175BF8D167ABF920B55402E9080407C95CA41DD6F38BF1CCF58419719F63E6C6457BF0BACA33E1B3D79BFF0E7BC3F042D2B41B9143D3E46F16ABF51A1D441EDEE53BF4FDD1B42B961AE4085FABD3E908A353F967365404A951F408E67EB40F6F9A4BE9609FDBEDA2CF7BE2F2C0F42290F0A4031BCDF41EE511D406DCB7FBFD85A9A417A5A73BF595A82432AD26242B2ED54BF4E0BCF405F887ABF2EDA7CBFB07B2D40C88DDCBE3C365C3E80A611BF3807374068841DBF3D2852BF12830A41F20CB242536D254241C36C4229B78D41836A323EA18069BFCBEF7DBF6CBC7FBFC29A65BFE95335BF46DA5940197CA2BED6E06DBFDA5D75BF394DA140BD0E5C432CE67BBF4DAC7EBFF639734133A75141353D59BF49CA3E4175CB2FBF228E5B41731B7EBF8E49D53F5B0D70BF48F03442CEFAF2BE6CD8B8BEA2294240339A584159CA48BFCF31AC3E04096F4072CC65BE79B20ABF4D8202419FEB0C416D5171BFEA5F8D40D8C68C400BFC4B41B8017ABFE13606BFB20971BF625A60BF886ADFBE77F362BF705D643F93817DBF701A2C4139210D4004EA4B4119B57EBF0CC574BF1AC84E3F960BB03EE046014232377EBF4212A34067B518425F975DBF27B64C4175CA76BFB2350D43E9797DBF6A44BD42C2826740845F7EBFDF617EBFC702DB417025DC3F4B8E92BEFB157FBF54E978BF7043D44170AC533F2A315BBF5BA359BFC84074BF98FEE9BE5E387FBF7F7F28407A2242405E0F3C41D22EC8BE1E6F223F57097FBF355473BF2CB5BA3FF1FC96BEB09DA9433A9F23BF904FD8BE1E6902439221403F831D0E40B91B5DBFA57866BF44D26CBF9B5CD141BD3B7DBF408E65BF7C3163469EDFEF405EA355BF1FCD5CBFEEEE46BFC6A60140BABE2342806BE43F259813411EEF7EBFF7FB7BBF86156CBF367451BFBC7632406D437ABFE2C10CBEE3007EBFFE689D41663D72BFE96BE83C46BD2CBF653C0B42D84AC13E09947FBF541D7EBFF0DA3F44394572BF36456ABF82965F40F61068BF69BE7CBF16BB7DBFD2830941E03D9C3FA21A3B438E4126402010F9411EA56ABFA34F7EBFC2BD22460058904111E97FBFEF7065BFC3E7A93D5AE15EBF5FEA4642B200EF3EFC83A7BE6F61FD3EE85DF542E4ED64BF3DB386BEA129A340BA340042792CFCBD85DE9B41D0BD7C41C24C73BF977376BF7B1A71BFEB108CBE185536BFADF620408E58E5418ABA0941526ACFBEDE8174BF57E2013F24D8CA3F49C001BE8C7989BE6CE7DF3FF23D39BFFBCB86427188814013C738BF56A463BD873976BF98111840BD567FBF7E617FBF5FA27BBFB2D92641890E53BE4F7A394388298F4532AAA23F82897FBF048C4FBF0CEC24427BB77ABF504EEE40FCC7D6440F84923E1DBB06425E7F2742A6E20EBF60FEF53E699F0D42455A0241B4B1444244C06BBF935E79BFFD4B79BF56D60D4010532B4195837ABF926F3DBFCC9977411499CC439D2CBCBE9F873D3D218A71BFCA7458BF38847CBF5CD1644008ECCA3DE9C14EBF2DA679BFBFBF4EBF2CC951BF69F76EBF3E780E4165F172BF48A17A40D90F7EBFE462F2403D9477BF686FB742662F2EBFEE4979BFCA0672BFB54AA3BE82CD01438213CD3F94F6FEBEF4527FBFCAB3BB417870B1413A867D3F848C78BF"> : tensor<20x20xf32>
    return %cst : tensor<20x20xf32>
  }
}
