// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xui16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xui16>, tensor<20x20xui16>)
    %1 = call @expected() : () -> tensor<20x20xui16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xui16>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xui16>, tensor<20x20xui16>) -> ()
    return %2 : tensor<20x20xui16>
  }
  func.func private @inputs() -> (tensor<20x20xui16> {mhlo.layout_mode = "default"}, tensor<20x20xui16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0200010001000000010004000100060001000200080000000100010001000200060001000000000000000200010001000200060001000100000001000100020003000200050001000000010003000500050000000000020003000100010000000200010000000200000001000000030000000300000005000400020008000200000000000200010005000200000001000200030003000000000000000000000003000400010000000100030002000400020000000200020000000100020000000000060000000200020001000400000001000500030001000000090003000300000002000100020005000100010004000300040000000200010001000000000000000400010005000000000003000000050001000200040002000600080004000400020003000200040002000000030002000100050001000400010002000100030007000100000002000500060005000000050002000000020002000100000002000200050001000000000002000200020001000800000003000300020001000100020001000100020001000100000001000500030000000000020001000500000002000200030003000200010000000000010002000000070001000200020005000000040003000000010001000600020002000000000001000500030001000200020001000000000007000100000003000100000005000000040002000000010006000300000002000100020003000000000002000100010000000000010002000100010003000300030002000000040000000100000005000000070004000500050000000000000000000500010007000000010000000200030002000600010000000000000002000100000000000000030001000000010003000100040000000300000006000000000001000200020003000000040003000300020002000000040000000000010002000200000001000200030001000000000002000000000000000300060003000000000001000200020002000100030003000500040001000500020002000300000002000000010003000100000004000100020001000100010001000300010001000000060001000400000003000000000000000200"> : tensor<20x20xui16>
    %c_0 = stablehlo.constant dense<"0x01000200000000000200020003000600020003000000040000000300000004000200020002000800010004000100000003000A0000000000000001000100020001000400000002000300000003000200000002000300030000000100020002000000020002000200020000000300010005000600000004000000020001000400000004000300010003000000040000000100030003000000010002000000020003000200000001000000020000000000010002000300000000000100030001000000090000000100070000000200000002000200000001000000060001000000020001000100020002000000020005000000010003000000000003000000010003000200030005000300030004000000020002000000050000000200030008000100000001000000040000000200020000000100040001000200000001000100010001000100000000000400010002000600040007000100040002000300030006000300010000000300000003000200010003000000000006000100000000000300000004000000010003000400000001000000020000000400000000000000010007000700010005000000040006000100000004000000020001000100050004000000040003000400000000000100020000000100010002000000020003000100030002000200020002000400010004000200030002000100000001000200030006000100000001000100060004000300010000000500000000000200000001000000000000000100010002000000020000000200000002000300020003000200020002000500010001000300050001000100050002000200000001000300010000000200030002000100030000000200000002000000030000000000010000000000000001000100030002000200000007000200020002000300000005000000010000000000020001000500010006000300020000000100040000000400010004000300080002000000000001000200030004000300030003000100020000000000050002000100020000000100020003000200010003000100010000000100020000000200070002000100010001000200020003000000020000000100"> : tensor<20x20xui16>
    return %c, %c_0 : tensor<20x20xui16>, tensor<20x20xui16>
  }
  func.func private @expected() -> (tensor<20x20xui16> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0100FFFF01000000FFFF0200FEFF0000FFFFFFFF0800FCFF0100FEFF0100FEFF0400FFFFFEFFF8FFFFFFFEFF00000100FFFFFCFF0100010000000000000000000200FEFF0500FFFFFDFF0100000003000500FEFFFDFFFFFF03000000FFFFFEFF0200FFFFFEFF0000FEFF0100FDFF0200FBFFFDFF00000100040000000700FEFF0000FCFFFFFF000002000200FCFF01000100000000000000FFFFFEFF0000FEFF000002000100FFFF01000100020004000100FEFFFFFF020000000000FFFFFFFF0000FDFF00000100FBFF010002000000FFFF0300030000000000030002000300FEFF01000000000003000100FFFFFFFF03000300FDFF02000100FEFF0000FFFFFDFF0200FEFF0000FDFFFDFFFFFF00000300FFFF0200FFFF020004000500FCFF030002000200020000000200FEFF01000200000001000000020001000100000002000600000000000200010005000300FAFF0100FBFFFFFFFEFF0000FEFFFDFFFCFFFFFF04000100FDFF0000FFFF00000100FEFF08000000FDFF020002000100FEFF0200FDFF01000100FEFFFDFF00000000050001000000FCFF020001000500FFFFFBFFFBFF0200FEFF0200FDFFFAFFFFFF0100FEFF0000050000000100FDFF0100000000000000FCFF01000100050000000200FFFFFFFFFFFF05000100FEFF0100FFFFFFFFFEFFFEFF0500FDFFFFFFFFFFFFFFFDFF0300FFFF04000100FEFFFEFF00000200000001000000FCFFFFFFFDFFFFFF0200FCFF01000000FEFF01000100010001000300020002000000000002000000FFFF00000300FDFF0500010003000300FEFFFBFFFFFFFFFF0200FCFF0600FFFFFCFFFEFF000003000100030000000000FEFFFDFF00000000FDFF0000FEFF0300FFFF0000FEFF0300010003000000030000000500FFFFFDFFFFFF00000200FCFFFEFF0200010000000200FDFF0000030000000000FFFF0100FDFFFFFFFBFFFFFF01000100FFFFFCFF0200FCFFFFFFFCFF0000FEFF01000000000000000000FFFFFEFFFEFF000000000400020001000500FDFF00000200FEFF0200FFFFFFFF0000FFFFFFFF01000000010001000000FFFF01000100FAFFFFFFFFFF050000000200FEFF00000000FEFF00000100"> : tensor<20x20xui16>
    return %c : tensor<20x20xui16>
  }
}
