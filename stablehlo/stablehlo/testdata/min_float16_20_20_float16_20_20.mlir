// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.minimum %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x36450BC259BCF03D50B439C0ECC38FBA3C38233CC33FE141323864446F46EEBE0940B0BC1039333C2944D443EA2EA0C5C1408A46C13B8CB9523DEB2DAAC5784420C794BA2DAE9538D0B8383694C241C0E7BE93BC1231D5C1EB3C09C697C3183ECE44CBC143BFC5B87FB1D14170C04C210FC4BB4479C04F37C4462EBCAEB920A914C41E409E419D43D1C0A0C458416BBF92BC4AC29345B7BEBC4455B8D0C526C23ABB3C3EA53CAD3F9EA44B4653C494445FBE1FC40F3D13BCE3BCDAB4943EE331CA37E63A9A406E2287BC33C323400646394247BC9DBA63C3D836D8B8E23EE042613D5B44F7C4983CBB3C7DB5B741843E2F4682C448C242423EC7823D39C6FA3ED5C632C1CB3DD3C3C0BF3340D1322DC098BBCB3EC7C359C6B1442CC09DBA8BC597BDA6405131B23E77C1D24613BD96C5C73B42BD443E0C3AD0BD09B9943CD1309D412C4041445BBC0938BEBD5443EDB4EF40CE3AC9C407C064C07DC0A0A249C5B84378C45D3CA54252C0B1C64FB29EBF17B7FBB72BBB433F99C3A1B6D647C4422F4075C5484117BE0CB9F2BF5C3C8FC2E644C4C4BA3EAB374EBF7E374B42AA3C79B54F4572B898BD3D3C903C683F12C48DBFE8BB693C173A3EC302C7064052C1A43C3DC255C2F5445AC2DFBD0440CB43E2406E449F2CFF38083BFFC2004136AF49B90BBE8EC470C328BBA213EC46BA443FC132429CC4B044C8424D416CC256C05ABF2B37AF3E1D344F419139AB3FEABC153CAB41203FE546E1BF72A98E418B414142A5C161BBBCC4533DD5BCAE455EBC76C3EBC174C1A243AC3C16C0E33C2141A62C62BD633E1FC59B3A8B3CA4BCF845F044E8BF3BBEAF3D7AC502437D372235C5C1F6AF343F0B3E37C343BD5F3E5BBA7BBAC24567BC0DC1DDBF4CBAE13E2540E1BFC7B970C0D540A3C405C1C14238C5AEC184B931B88DBFD63E3BC3A43CBE3BFFC335410C3EC3C093BA47C762AEC7449BB8C5C4F4A94ABD233BBDC18CBF763D25B52E36C63F2D315D46F0C374C34616454471BD4040BA427B42A3338643E63875C37AC06CA724C3E93FAC4221C4EA40FA375F3FFFC27A42AC44AAB404C13CC5B8B261B77DC10FB095C0D8BD99AE0FC0ADBC0F427D4189C42AC1BE3C4CC21F41"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0x6EC25C443FB96BC34B3F5E3E3CB8BD41B33D884329C4673AE3422648ACC1293C92BC55C43C3C03BD9C3D5ABE03BF5DBF55BEEDC272C084BDE0B9A4C0C93DC2BF90C1603D35462FC212BB38BA2BBE26403645FEBDFABE5BBD73373E36F4BEABC42330414279401D3CD1C289BF59C6843A15C5CDB046C601BFD92D853CEB3D90BF9FBABC3D1EB32DB8D0C26EB51D3860B801BDC8C1BBBC9FC37444283BBC3647425FB67CBB14BEDD404BBA78443BC8D2C0CAC4DFBDD5C65C42A4C442383AC18D41BFC4B1BF59BC14ABAC44BF449CC2054471C0283045C3BBBC8EC0E8C08CAF20420BBE163AD1B58841E7394036E84189BC5A42234104C47CC4BDB1003FAB3C82C25E3212BFF5C033C4E5BD26BF9EC281C1284579BB9042FB415F42A9BF724162420AC6FEC37BC64D3234C4E2BA924131BFC83E0844913493C3FFBC6136F1459144FFBD17C38D3DD3C3013C643D6DC04A4345BD0BBC4A423F36EBB82BB9D7B0313D3DC3C2AE063DF94240C6EA3F25405FBF15B732C4F7B9D82A3744944349B98F40D743D8BE45C43A4216C5283B9C3604BAEEAFE4B871C01638CC3389C199C13F4136B4DCC12FC0B743A13F0848ECC1754135388DB3B6BBC33E8BBBBFC22A3F8DC11A38883D38BB4DA5A7C19F45E83C30C41334DE3BF6C41B27EBC2692DD3AAD8C071BDE93A8DC276C6E9C518C049437EAA09BD08BD65439C42ABBF1F43D9C150C0753476C4DE40BB45BB4294C01640E1BF54C62C416145F438DBBC20C1CE43DDC6954050C4A83D6FC19EC34040BFB80D3A32401C42673657C4DBAB9FBFCD3805BB28443A45B040D3440E3D27BE8CC3E03DAA43B4BDDCBE02C5F6B1283F9741C345B0ADA7425C3E563F6BBCF5C30BB78D423744B0C0FABA87A61440BB44D13CB6C4D9AD15B972412AC6A2C064C5FFBD4ABDB2AD4442BBBC3943A7BFE03731C0C0A919B3CA44A9C484C3FCB925BE7EC0D43EBCC04CC092C13FC36EBFEFB39ABDB3407638353AA7C101BC6936D135E4C0A6C3CE444A2C32C1223FE4BAF53DCFBDC8BAA83AB42A16480E3DEF34F638C13DCDC418C236C0ECBF9C433836823C4D391FC0AA4404C3BD41283AB944D24530C16532C43F4FC2A6405DC7A34404421E33B5C0"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x6EC20BC259BC6BC350B439C0ECC38FBA3C38233C29C4673A32386444ACC1EEBE92BC55C4103903BD9C3D5ABE03BFA0C555BEEDC272C084BDE0B9A4C0AAC5C2BF20C794BA2DAE2FC212BB38BA94C241C0E7BEFEBDFABED5C1733709C697C3ABC42330CBC143BFC5B8D1C289BF59C64C2115C5CDB046C601BFD92D2EBCAEB990BF14C4BC3D1EB32DB8D0C2A0C41D386BBF01BD4AC2BBBC9FC3744455B8D0C526C23ABB7CBB14BEAD3F4BBA78443BC8D2C0CAC41FC4D5C613BCA4C4DAB43AC1E331BFC4B1BF59BC14AB87BC33C39CC2054471C047BC45C363C38EC0E8C08CAF20420BBE163AF7C4983CE7397DB5B74189BC5A4282C404C47CC43EC7823D39C682C2D5C632C1F5C033C4C0BF26BF9EC281C198BB79BBC7C359C65F422CC09DBA8BC50AC6FEC37BC64D3234C4E2BA13BD96C5C73B42BD913493C3D0BD09B9943CD130FFBD17C38D3DD3C30938BEBD6DC0EDB445BD0BBCC9C407C064C07DC0D7B049C53DC378C45D3CA54240C6B1C64FB29EBF17B732C42BBBD82A99C3A1B649B98F402F4075C545C417BE16C5F2BF9C368FC2EEAFC4C471C0AB374EBF89C199C1AA3C79B5DCC12FC098BD3D3C903CECC112C48DBFE8BBB6BB173A3EC302C72A3F8DC11A383DC255C24DA55AC2DFBDE83C30C41334DE3BF6C41B27EBC2FFC2D3AAD8C071BD0BBE8EC476C6E9C518C049437EAA3FC108BD9CC49C42ABBF4D416CC256C05ABF76C4AF3E1D344F4194C0AB3FE1BF54C62C41203FF438E1BF20C18E41DDC6954050C461BBBCC49EC3D5BCBFB85EBC76C3EBC174C157C4DBAB16C0CD3805BBA62C62BD633E1FC59B3A27BE8CC3E03DAA43E8BFDCBE02C57AC5283F7D372235C5C1F6AF5C3E0B3E37C3F5C30BB75BBA7BBAB0C067BC0DC1DDBF4CBAD13CB6C4E1BFC7B970C02AC6A3C464C5FFBD38C5AEC184B9BBBC8DBFA7BF3BC331C0C0A9FFC33541A9C484C393BA47C77EC0D43EBCC0C5C492C13FC36EBFBDC18CBF763D25B52E36A7C101BC6936F0C374C3A6C3454471BD32C1223FE4BAA333CFBDC8BA75C37AC06CA724C3EF34F63821C4CDC418C236C0FFC27A423836AAB404C13CC5B8B204C37DC10FB095C0D8BD30C10FC0ADBC4FC2A6405DC72AC1BE3C4CC2B5C0"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
