// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.cosine %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x58A4944FC737E53FB5F40970A894EDBFD411ADA296DBE93F58852912B214E03F04AA4F6FBC8F09C004AABD82C86212C02CBBDB97A826DF3FC740543B0C75BA3F5AFFCF766405E53F0B41995206E803C03EAB6194B05FE8BFD04A17FD5DD32040D94B209DCF49ECBF569DE9AE997E034044E0E43B0C7011C04605C6BBEF160F40BE63AA3F69350540A44BD0C203D215C00225D50C9EBE09403E64B8AFAEFF01C0C574CFA50E6B09C0B8D78BCB758D07C0F3C03D86981B00C09E8F13E561690D40D176A0F755B70540E9BC926A1DBD15C0705DE77DC10CD3BF7552917F570BF4BF30DDB2EE486DC43F37AA16565DABF8BF2DDD8C4EC8DD0040E6E9E56585290D40561E33DDC7110440684EE21707F50D4099D11FD162A5EDBF847028D1FC66E9BFD6C3A88BDD82F1BF46F516F3041AED3FA0C29AF0019B14C00C01D1FAF90B0640B609AC3CA5EDEA3F8A100F9BE093ED3F4CD5147369D6F13F61F1B068127E08C073EBA326F8AAF33F05A8654D97C6F63F4347FFA7273C1CC0F9286CB35AFACDBFAC900A172C59FEBF15713AA268D7DA3F1ECDDB916849FCBF5A5B3B0380D809C0600679B9599E01C0086CF7FD72B80C40176EF3572A3EDB3F54624EFBD0CE0C40581CA573078AFD3FFA3B1941BCD2FE3F98F7419B95B602408856AFEEB85DD73F2C2977320AABAABF4462F17FEE6EF9BF104BDA84E3BD11C02F3706C6D46C0940F0770D35D3D908C0F2A772704C5EF53F41A681A34A541740A05FD3775BD2F6BF187AF4E59EBBA03F89D38E9C5B76C63FA499E520BD34FC3FA734075988D3FFBFF851535E63B2E8BFD2AC7DB13899EF3F959C8155C85710407C03A6AB08E8F53F74FC32F561E81340FE005B23A2BFE2BFDBD7DB65D5B4F23F7698B08A0DB416C09DB46CB31BCB0740F7AB1F61C8C30240E4BDA9F9E7851540D6270D7183A1F7BF0B11990E3DB411C0F6F10D56C7CA004086E9474050C60340426BDEFF000F05C095981230381AD53F1175E14DA18EEABFBC2789C9587AF9BF41A8BFFFAE02F0BF4CB30ED2F28B0540EAAE1CA79AA7FCBF6B9E3DC3DF5CE03FC58FBE31B224DA3FA46B73664B13FC3FB27F5FD22257FCBFF8E17DD6349FF83FD78F91A2C6D908C0CFA4C13D35E9E43F701035590CEAD8BF008E418EE5970CC0075B7ED14F971840127D955A521A00C083EED84B1A43EB3FA802DDEB502408C048F116973C39FBBF5CCFA7DD5509D63F0762211806B4F3BF28838AE2BBC9104010B5DC705FB802C0646E9F3D7A8302C0D2F397296591F63FDE84C2D7907EFFBFECEB678D6668FABF681EBE5F8B61FF3F90890DDAC55FEDBFCA6681C447F6E03F04173DE7FDA6F4BF24040D12CB6D1440622873B27258F63F5B7731CBBB49F53FCC51305D8AA0C73F5A85D30191CF0FC0959AB4C579BFFF3F504D776EF6C21240A421329C84C0DDBFA2EA49521AFCD73F76054776D0FE0140135068B2EAA6E63F66D799D6E7400340093067853EFC1440834BFAAC2E7F0BC08A5BA9D54F700CC04C9CDE4A620AE7BF3AC7B4DFB31612C0AE7162F845CBC73F5EBB251EA23512C0521538C403E5F7BF3A155C3AC94612409A65680A32C1BA3FE04656555BAF0140186BB07CEA6EEABF94B22588D3C607C040DE6603A482F23FF6629C1F80ACDC3F4B16B32906480040D07E45D717AF9CBFBA794731C3CEAFBF5EFECA6065680FC0C652435CD18303C0BE7F097E979B04C0299AC19ACCDD12408CB08C0E88581EC00B5E08640D7CE43F3167DFB5972004C0BA5569DD4FB910C061F27C64E302E53F68C1FE5AE8D90D40FA806286161E1C40CD58B6C9DE2103405EFE49BA53AF0FC09ECB9220C7F30C40E3804B5C9C9308C0E51B1058B4DC0240C5BC88C418D214C0FE0187068A13E83FA05268BFE778FB3F5AAFEA33C39AE53F3C46C18D7F5A09407FEE4BB5706B20C034F089B29FC1F43FAAFC13041D36F5BFD0C76E3210C613C0B4C5319BD10AFDBF7BB0D3847C59EBBF74148F2AB30C11C0E827811343CA01C0FC94B44D90E70DC042161AA4F3A11B40FA7E509B890E0240044B6897847B0540EA2FE17ABD63F5BF56D867ECC75505C0CD4629FDA7F6C03F7C93B54717480640A51CCC3CA2AF10407F65C0F95DE9E5BF703ED458E47EF1BF36B42381EA0F0AC06A39C7888263A03F453DB77C9CB915408F9EDFAC274407C0BF7148AC628BEFBF3D50648A7B7AD3BFB6F525DF56FEFB3F12C051348BA7E83F888F3E5D932801C06E98AE88CCB317C0CA322E3FE66BF83F5835AED2536919C0E4A865C8360E01C0D6CE94628693E93F6B60B8956D0516C010A1411CA9E0104040A092800F1113C0489CC7F25745B5BF8EDA23AC155203C0E3D776E5F7990340C6414BBDA0C3FA3FE240657BB5F5FDBF98AF16F17511FD3F6A06715D6066E33F20DA9FB163C30AC04860F7B0CE3AE7BF386C67E63CD0FABF1131C0F2B3A21540233B832B4A6710C03DD574F0D00602C022356D0435CCFFBF7E0CB40CE7EA12407AE6A684FF03A63F4C566CA623D2104049EDC9C1B3B0F13F10AF579D3BC606C0A6055FC20D8711C08E5553313582DB3F78D4C0B91A7A08406079CF432156F0BFB7C696B7ACE110C050C40770A75CF73F8F9CE9D63326F03F3CD089A9AC68004068064AF97B8110C0080CD5FC020AEEBF2C6E99B038CE09408F7E4BE2FCA71240D64CC979F2571B40D2C36AEEFFC313C000F0BE5308B6F83F87661C66AA160A4040BAB5B83BF5DD3F03CE29EE2729E6BFDC19271EC1420D40D166D0E1323FF93F22654E8ED278F8BFB632A858699704C0883362E91EB90FC03A01D31C0321ECBFFD753892A7CF1DC0C883494AD8FDFEBFDCCBBD66ED521CC00E00D7C49B3618C027613125A06BEB3F1199BD72772DF73FE91F8EA79376E2BF1ED1F2D7A0A608408636F743CE3FFEBF56F0277327C4EF3F2058E873AEC901C08F349A282F0416C0528976749577024029C3DBEF4AB3F43F68A9BAA3B122F83F68E0807F48340BC098EEBDEA586809C0F6F23ED42FAC10C046DBB53F148604C0350DE57D8D1B1740A62C8B41505BE23F0291E2E2F16FF43F257F44C943451040B003DFB201B5CFBF2A6A04D649D90D405336B944F8BDF33F68EA9E5F03730CC06002C1E7717A0A4082220E30A7A919C0E4B1395D5BDE0840A582B53BCB7BC83F76D19847774603C0E29EBDD497F5FABFBF7262E61506F13F47DDEFD3DCFDF7BF25187A18C19DF13FBA920A4C651CF23F26F697D75637F9BFD8E62C4BC6FBF33F05606C87A1F91A40C46A9BA39162C83F3AAF6C15CDE90CC0759EC24D38BB0BC0AA22CE77C9B30540CBF2A4903EE818C0FC62780044E7084041BB02D11389F4BF3097A6374D25C7BF72E3B0DDC773A8BF525DE3AF555C00C0D24A768791D2F0BF2C944D96BBF1E6BF1C6B9549099D0DC07C5D862992AEF83FB6514EE424E6C0BFC6DAA43BD6E1BBBFA99921ABF02C15C06CEC7D41BCA7EF3FD7759799EEFCEDBF4438EA834EED0B40C34AAA957A94F4BF8A43674CF3A309C02AF9E3C055EEDEBFE2564D51B699184076E551F90258E73FE00F085AF08BDE3FF21A073F2330CA3F0004041EC36E0140309C5D4DD9DD07C0121AC3DD55840540BB328BDCCA66C1BF0F0D7802E7FAF43F04D195CE0640FE3FD46C4A510132E9BFE265EB75BA7902C0066BF6360BA20DC040D2A6A82490CBBF6940C889AB0F12C06F3F9D98C1200540785F3A8A7785D53F5A58C3C45EE2FBBF5A4417330A6B06C0C8622EB609C7F83FE6F4A4C55C64F43F08FC60A910D6FF3F1E715534746D07409CA8E652527200C0C821DBC1701AC63FCF0D40667B17F53F1CB93089C99403C0438372B5E674E3BF0C4409B97884F93F94B58A673DF9F9BFC68E2A36C25DE13F2CDFC0CF93C2FB3F544F0DBFF96F13C09544AEC5DD8603405AB26D999409E03F3533DC25E479F7BFB45A5AE8207A13406EDD7FAFC11FD53FCDC63AF2F5C801C014566B455C60C6BF5E7B8446E20600C066CE35C488F609C0362358F2B5600FC047D41D5B9E970240464212153BF8ED3FB2479C4411A7FE3FD2152F29649FF73F7A053BC6F3D3DB3F3C991EC344F008409B0AA67D18AD1140044C2AD3EC460940F1F7A497A958ED3FFFB35F69DDA81EC0339E7741AF85044078C81DBB401806C03CC47ACEADADC13F3FF1C5AF406CFFBF4447C875CAE3FCBFCD2BC493D1591540F41FB1FA4CF60540D1579E824AA6FCBF94715B49DFDDF13F6CC2D347C9A9FDBF89A08148A356C83FAED24808F547C03FC58DAC0538CCD03F2245998120CF0140A42DF22D14A401C01EB8900F703AD63F37D2E546B71C01C054ADDE7CF7C912C0FD46983853F025C0E36418200FB5EBBF382CD32A9A5BE53F8047A861D0321140C6E8CE6B0E02C0BFC1785AF82D27F73F716006A0966DF5BF486602D27F3916C02277C82DDB330840374B3DCA3F2801C0E05B25A6FD3408403EE7D5F6C082CD3FEF2A1E97CDF7E93F95BE28C99AB6D3BF61FBF9012DA5FDBF3C185054A2391840"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xF05D8AE73838E93FBB8036C62C46E33FB1158046E61BE63FA0ACBC1F360BEC3F413BD2373DF4EFBF24D3A25FFE9BBDBFC356202E9F48EC3F54E00B374AD4EF3F055299391D57E93FE0E0BF3A2069E9BFA73378A75C28E73F30465BE674F7E0BF0870C5442E4AE43F4E0848734F60E8BFB029338CAE1FD6BF1F6033040688E7BF02097D8E173AECBF7B6253EA19A4E53F542D2E4F0DE8EFBF8FFC4F7B0219E4BF0173C422C9FAEFBF1F0E9165B760EFBF5DDD8B5D446ADBBFBBDA45E7E387EBBFFA9863E33520EDBFAFC8845DCA27E53FBFE71F86C697EE3F2A67ED492B03D43F9730411DE897EF3FD02BD5EA6FA69D3FDD0C47AE3162E0BF8E58E343A606ECBFE500222249CDE9BFA4E8C0D1025BEABF31CB9BB3CF38E33FF70D1A8D9E6FE63FA57D9E1DA658DD3F4FF1C2FA83A7E33F2DBD07438D33DB3F1237FD110AA6EDBFC8F03532A452E53F0BAC3049CC46E33FFD0432A91F2EDC3FC937A6F9C6E5EFBFDD802D5BE06FD53F0FBEF49AAFC9C23F41EB6BED53D9E63F6AF252125B20EF3F471C24D0AD7ED4BFEA6D1F2A093AED3FD134203DA911C9BFAB685C477DDFEFBF291E86E659E4E2BF6EA0F67DE7D5ECBFCAA21C8DF724ED3FF2517B1CACAEECBF2BDC42D15D67D1BF2A61356BF248D6BF5B2C629A103DE6BFB586C11E10E4ED3F0DD23DE3E3F4EF3F02B88BC2803C93BF84AFF4D6C67FD1BFEE2F4B8C87FAEFBFD8EA817CEAFAEFBF0343297989D6CD3FE1756DBB5CCDEC3FC1ADDE398E6CC23F6E8A0B24A0FBEF3F2670222B2F82EF3F986EDDC66C6FC8BF450855CB0300DABF4E1A9CC9FCEEE63F779106814AA0E13F53C392E929C4E2BFF8BEE410E5A2C93FC901D916F6BBD03F378A1E6FBAA9EA3FBCBE86561505D93F4D03B240F546EA3F7A1E7B04768DEFBF7F861E5AE862E6BF60845B4AB3D4E33F96418FC776FEB73F207B3E7F1814D2BFFE0DB4C8B720E0BF76897ECF4916E9BF31ADEA4F74F0EBBFF4CF2B30B546EE3F4F135DEE1E99E53FBB026404ED1696BF7A2A86A3A345E13FA3C1E53AA8D6ECBF90029FC7DEF2CBBF02114F492BE8EB3F3DEBF70EFA5DED3FA42457F59568C7BF62B22082517DC9BFD6A076B81958A03F6ED0DCB6E8FAEFBF0E88AD844968E93F0108EC54149BED3F0625C2456D0DEDBF2B2B760200B5EF3F249C202D0E61DBBF2AA25FD59F12E53FF15434FD3DC1EFBFBE2A95D9DCADC0BF5AB63C402C1FEE3FC3BF84BEBC4DD53F2040517F278BDFBF40B2B7E03442E6BF6BF8EC2750A8E5BF05E7EEE3396EC43FD4D19F240CC8D8BF596DDDD42C61B4BF2DD4EDF9DB5CD8BF9E45F5A74970E33F6F7AA03ADA9BEB3F426302CD3BB0D13FE3234630249ED83FCD0C4547712FC63F105C99826D76CE3FBFDE62F1D574EF3FAFCFEA91C17BE5BF28357A54A0B6D9BF949982B5998596BFB55339E0A49AEC3F308F83936EC7ED3FFD3442A64E16E4BF308E4A99D44FE83F6BFF71D49FBDE7BF27AB57182B49E03FCE6F7D78E99CEEBFD3A8E738694EEDBF211D9A96B20EE83F903FF2A38E33C8BFBF86A639DE72EF3F2E7F1D78F364C4BFDAFA7F9C69CAB33FFF3DFDF85D46C2BFE9C04C6C4DD3EF3F33886BC0161BE3BF4FC869F37AB0E53F871792D8968AEFBF151DBA4564BDD93FFAE2C71079D7EC3F8F49FE9FC1A9DCBF03FECC48C9FCEF3FA6CE156432F0EF3FC7CCC69280A6E6BF6E5A6C9BCF6DE8BFCBA5900A2604EBBFBE7B23E26A40713F7B118CFB08EBD03F4B75187B11AAE93F01632A4028F0E9BF148D040E5D37E0BF3E85ABA1A458E93F65F67968F197EABFEFC8F3592F7FE73FD15E07F4B069E7BF297EA143A5DAE5BF483C03B9EC6BECBFD1BBC2AA36ECEFBFA2F99AC2B6A9E6BF27242DF3F146DE3F4FE3B9D6A85CE73FAF26201955A6C2BFBAA10328D3FAE83FC17B9C85E1FCEFBFDC1A97AB2B4CD6BFEE656892C249D13F4CBE1D28CA0ECF3F2CF2449C4B4FCD3F326CAED542F7CEBFCB95A158C201E53F4A5216B247D6DBBF4BC4936DFF70E3BF3C5C8AEB6879EABFAFC1EBE98CF3E93FC76925031D47E4BFD65D6B9FEFB9ECBF6513297232ACCD3FBC1AD78A2E76ECBF5C26BB462AB8EF3FE6FE2D9B3AFDEDBF6094F4CCEC79E0BF58D76F1767C9E83F8440C80CC566DD3F215E66BBC6C8EFBFBC3B7EBBCDFBEF3F7B273698BA12E53F10D57ADA0A22EFBF2D8D321ED5ABE13F5A9CAC7F8287EE3F16FF6A9AB1C3C6BF706994978BF6E63F033E9FE85360E1BFBA135B03C5F9ED3F1B217069B7C0A63F992259DA1FECEF3FFD26F1546A07E1BFAB8C251CC74FE63FC18D3195FACBE63FF7D15FD5FA49DEBF0E4804DB02C6AB3F36848FF6BCE3EF3FF566172E7CEBE7BFB604568BACA6E8BF224AECDBC30EBABFF3765F674404D3BF74D573CACE2ACFBF0524ED081F4CEA3F35CA51477156EFBF8A57C1EEA8EEE73F616408FD71D7BABF191291227987E43F320EE0B3215FE2BF7F1160062F2FE4BF82AC36A73AE5D9BF7AC7BA79566A913FE97A8C8C6DF8EF3F7AAE120BDE15DFBF20A390EA3EB5DC3FB07DD3E1999EEEBF8EA59CFFE0C4D4BF67A03BB4DA16ED3F5233143E7EE4EFBFF43C6FA93CB8E03FFFEBBFC6AE3BDEBF92A3FBD47146BC3FF06E571DAC09E13FE415DF425B92DDBFEA8B462908B2E1BF8D806A4BFEE7E23F620826BE0BE3EFBFF45D07E156BDA8BFE3479FB64A3CEB3F95E5CD5C000FCD3F3F621F65F3FB9A3F8A853F3F9AC5EFBF405BFF2BCA8EEC3FDBF05EC0DDA0E83F20BAD0F563D5EBBF23DB774F7D377DBF16A639DC8E23A53FEC2282382CFBEABF21A37A2EF7BDE5BF16C85E59AA69E43F311D99463EFED83F09D6F45746EAD6BF0217EA5F5858E63FB5CEABE88A28EF3F771AFD0510F4E43F000108E75334BF3F722F2C3ADAD1EA3F9EEE812125F1EFBFCA82A3CB741ED4BF50015982657CE13F7CC1BC2D276FE3BFF8E977C6FDC4E63F61173A583285E5BFDEE2E919ED80D13F2215085CECE3AF3F91B80E09E7EEEEBF83AE0B4B2AFBEFBF8D1CF74C8A91E0BFB6653A62A6D5EABF735B7C575BFCEB3F5BB149AFAFE0EA3F82221CE86D83D23F7898DD755D3BE3BFD5E705BCF205EF3F5923D2005299EABF5512CABE3428D53F134565B4104AEDBF28A0A724668CEFBF89A3D43334B8EF3F5C71C6D288FBEFBF7DE30456986AEF3F180020D683CCE7BFDBDD73418A29BDBFEC574F66A610DF3F089409F9F13DB23F86313EDEE7F8DC3F76F39FBCBE31DB3F29901DFC7C5B75BF91806F3B473ED43F927FD80C4CAAEC3FF34125A5CA6BEF3F166067002D7EECBFFB38BEE39D53EEBF16D742CA511AEDBF27C8C447FBF2EF3F80AACC29A2FCEFBF9B6FBEC71B23D23F1646C4FE6E7AEF3F697702CDA8F6EF3FB2B851EDAB3ADDBF33FB345F2EC4DF3F33CA9EB5EC1EE83FDF386FD0571CEBBF7033A87E50D99C3F67FF7CA7B5B8EF3F842BDDA375CFEF3F412A4CB6AB93E13F401B3C962B94E13FE809B7348AF2E23F8A92CBC85C11EEBFE7BCDEBF5AF7D13F57CCB47482EFEFBF021CCB5EC055EC3FCAF389FD91B7EF3FF4937DFE3BDBE73FFD54C69D7B6CEC3F70F4D5D62455EF3F8708FC746B49E2BF57BE663E9D99EFBFD69F967F68C9ECBF0334BAC669B4EF3F411926D6BC6CD03F11C16A7E4B1FD4BFB2FD8F054795E63F23D692D28A8BE5BF0A920E5EAE11EBBF9B84AA5ECD42EF3F314CAE676410C9BF5456830CCE12ECBF2815A1EB2D35EE3FF16E4E995FE7C5BF5DDB26FDE12CEEBFBF258C19EDBB963FBC9B6E6DC2AFD23FF87FEB154509DABF8885F2F39C46EFBFA3211372B7D6DDBF1B08A5172A86EF3FD73D41F04AFCCF3F5B445B7D7099E8BF9DD45FA9D543EA3FD94B1EB3BD9E98BF95EA72D116E5AABFEBC99FFBF866EB3F736795C49DECC4BFED03411957BEC23F6D6A312BAE75E8BFE20A82ED8E10EC3F8455C2F85475BA3F534ECDF77DFFC33FF8F20A98CF45EE3F84C1C4C4DC6CE3BF20786C7E2483EF3FA1D3C9EA2FD4DABF43A6937EEBD3EFBFFEAAF42F2DBCE6BF200238655AE3E5BFD9800FDE53F6E23F57C9069FE2A4D5BF209995CB4420B83F647E2AD8BA05ED3F3968532E96FDEFBF77C0EAFC9C81D2BFC11E7ECEAAFEEFBF6C5D901AEF75E33F4856CEBEBE0EC83F7CE69546CAD4EABF562BF8F660B8EDBF5321CE0BFEB1EF3FDB8BCA347284D8BFF14515EFF4C7CDBF460AE0D345BBE23F16C0342BFE84EDBFE7C6B26E9EE8CBBFB5AF03AA5113DC3F6128CA1379E1D1BF174BA2195B6CEF3F73807625D2BDEF3F0A1EA8CD73E7EE3F15E7D2BD7080E3BF3B008586D3F6E2BFBDD93FD0D916EE3F8406FCEE6A38E1BFAEA129C9B6098FBFB938585F99D09ABF6887759D58BCE43FF31A692D1C22E93FE77673FF59ACD9BF7BC407E904C0EF3FFF92871C2998BF3FAE58041B895FCD3FB06D03A1A5E8E73FAB4EC003B0C8EFBFB807102D3B5FE1BFF42E3A7C36C9EFBF5D5D5CD33D27EF3F7F3BC1E47707E63F1EFB3FDB727EEE3FA225A93EC3CFD1BF71C7A5C9052EEF3F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
