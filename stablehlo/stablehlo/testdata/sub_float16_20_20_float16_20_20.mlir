// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.subtract %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2DBBDC3EFABEAD3D1E401AB41E430F3FF1396F4377380CC3C84204C256BFC74452B57BB88738B53A8B3B0F399AC564B493AC353954B50C3DF945CAC5CF2EE7BB4A32373B1143BBBCDFC731C46C3C1442483D2640E037EDB310C294C133B4BCC0CFBC2540ACBE3946B8402B3E97C4C5C3544524A7E9B695BDB43FDDBE3DBC35BFD9AC2C415F4204C48141993F56447FC4953D0C41F3B42CB74EB02635EB3B5FBF1EC2FABDFE44D0C0CBC4FEC0EC3752C1263E21B83E4127404A3A8FBF39462440923857481CC4704411443BBF32C2B3C289AD22C1DEBDC23C99C1873D0B41EBB9653938A93342EA43DCBF1043B53862BF68BB3E404FBD743400BD01A192C25BC5DEBE16464CC16E398F431EC17DC08941AF4542C5E8BEE541CA351C35CF42B6C26F3B99B9E0C27CB892C1AD449B3FFBB88C40DC3823B9EC3A103FDD44C7C4623915C0053C17466945C731BCC4A23DC93F3F364EBBE341B53FB446B8399EC25B381FB9863C153F8044292ADBC50CC1C0BE1043F9BB0F3CD448354570BB7B4189C4D93C74BEFFB4FAC632C16DBD1EC3583D83C3333932BCEFBBA6C1A0B7272CA7438644443E0A3F5D3F23459CB077C1D03C323CDFC2A5C09FC87A3D4242E4BFA5411E41B72C4D427EC0B1314B366D390235014285C5AAC4D2BD9DBD13C3BBC012B54DBD503530B84242D5431FBD2341D3BFFE3F1ABB72BCB33F06C6023F2E410FC469C0F6C1533C7D42CA31AF33AC3CCEC32BC2C1426243C1389CBF8A3E7CB9FC3DD136ABB72AC13F3C7DBAF4BF55B86D3D0D3775420A453CBBE4C00DC18444744100B3DA3BD83D7543EA3F64AF81419340B8BE82BEB43C443BD0B7B2BF27C0674475BACCC0FBC038BD943D96370645B739033F57C38BBF4A384D3D80C54F474A3D89BDDD3A0F4384C668C438BEC4BCF9B951461A44193DEEC0213EDFB89220EA3F1F3096397DBCEBC2B9BEB0C45940133883B5C4403D385A3F073CA440E643BEC46D396035914759BC88BD82B8F9BE5B3D30BF894363408C39464292C34E3FB1C4F5420B42CEBD43C6B3431E471FBB49BB1444AFC171431FC097317A3E9D42EE3C454410B2A3BE5B3260BD0EC2DC3D4D455B4425476DB81EC761437DC457BD8D39"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0x92BD45338E410940AEBC1AC04C4082C640C2A9415C40AAC447C4FDB8064669C08AC48EB6B628DE41E1C36643C6BD7B3A19427140A639314157C3832F77C249C4AA402DC3C330A0A8E644D9419F44BFBBCCB13BBB44BC24427F3512306AB85AC2B6B8693DC5C3A73BEEC4D740BFC25BBE863DA9C2FA3DE9C2F3B3EEBEFB44633C4543D2BE9738E03FAD44AFC011C438B14DBC84BD92B2D0C0E3B4EF2C062E81BEB2C4E8BA563F3B40333D84440F42EDC2AB9EAFC1D74539C30A3E90C0663A6F369DB7B6B0BDBB7B4437406B3E41C3C8BF11BB09C467BD88B2E038E3BC5C36F13720311E3A03B7C3B59742C8400EC0EB3A454031C8E83B7FC1F13A86BFC6C42AC1973325ACD4C19038AC40713542338D3B04C18EB53E310142F6BABABD04B9EDB916BDAB41CE3F0D44D7B5B5BF9A40243F49C29F3A55C4AF3884BD25BE753A302FB6C27B37A9AAFB3B9B3879BD40400D3D69C255404143D3B98C378EBFAA464041CD40204856BF3347CC42BE45B7BDA3411CB34E40D1C5E73DE24076BDAB3C67C354BF49BC8CBE3AC0E5452B43AB39ABBA47B9773C2EB58B41C346FEC03A3758C4D23AC6C51E4464B8FAC310418BC082B0C6C09EBBE8413C47CF3CFB41B4BC3C3106BB0A44863ADBC258B7AA404D4432BFA6401BC559C0ADC706BD1AC79CC385C249C21BBC35B88BC2463B98C4913519406F3D594294412A409E3938421045EF3F1B43974135B7833B7C42C8C2D9AAA6442CA92AC14A92D6C2AB45CD4171C69CC37D3A06B05D40093C4DC312C107BC54BF02412AC1DDBB7A415F3F07C09D474FB8FCBF3C396B4389C0C9C106B84DC043C16AC42DB880C0223D44C0423F7B3D3DC2E6C11E451C42DC41E7301A3871C3283D3ABF96BE9A3C23C246BF4EBA9C3E3040B6C16D44CE33EAC135BEAA336E44D2402B3C6343203D65B94E3DCFBF8E32D93C63C0D2C4C940FBBD8C312D357EBA2EC1063D6BC17CBC16C026BAC9C10D420BBD9DB8523DFDC261441142D9ADB0BB3447ABA0E8BE2E3CD03E4BBFEF43B9BE39405D3A453C9CBE00430E3CF8BFB2C229442742B5444DC431B27EB10BC10CC5DB396F45323E9E4219395D47913CEF45EF403541FFBDFEC3C3BFC6C210BE8EC4F642"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xEE37F33D86C4CAB875422E3FA43D2348BC43183B7CBE903CAB47C5C0DCC7FC463544D0B03C3831C0E24422C228C456BC3EC248BE28BC56BDD248E8C5AD42984245C07D44C54296BC62CA1EC708C30244023EF5413C3EA3C2C0C2D5C1A134783AE8B8C2396F4044454A4706BBDEBC98C0E5439B42B4BF1E40594040240AC6CCC16CC34A443941FCC5B2BF3E44344855C4F140CE43A8AED53F7831D4332A3BF0B28C3E0CB9514286C418C603C712C16C3A2D3EA74070C2B045CAB944366C45AC3E303C6A4849C280A9D63FD3C23C389EBD603AE03D70AF933DD1C235414040F2BC1D3872BA1343514442C5903C3B416CC11FC24049A2C00E423CC07C3FF43D8CC1D1BF27464034F02EC63DCCC1F1C04C3F1848E9C490BF00ABEE3C013F08443BC1674011C364C59CC4D7C09A4664B6D1C06A450CB361437A344A42664696C57C38423D4C3824466A4452B6BCC2BCB97839314328C278B94F413B463541FCC829C015C21EC7364366C1B3C2CCC961BC82C482434CC2D54617488841F8364B3EACBA164256B84C3DDDC43FC8F1C444C4574031C276B7CDB987C3CBC80A4030B6164858435747B7C0C84090485AC160B7603DDF42F8C046C51ECC5831703060BA5141E042EEC3AC40BA3C1839C1BF3FC339406C39A0B6FBC03846B8B02143C23DE341453F6F3D001966460442A042714001C41E3910C4CDC308B1BAC66EBDF2C00BC6C2C5C6C5203E9C401FC24343E33C46C816C2F6456243034492C710BDC2454D4529B6A8B5C4C4C02AAE4160387237604220C0D045064649C34AC418B832C288421C3F3C357FC0FF45DF443336E744EB4478416CBCDA4200B6943E7AC3E4C28647494084C78CC53CC4F73CF0A85F4899B81E430CC012C236434A42B6C4A8452CBAE33D23C392421EC3B6C12DBF9FC550C246458836009F2ABF9832603D45B2223AA540854508C3DBBF6ABF03C5F841334267BE18459A3EC3431A3F3645643BF6C2053DF4BB884977C56AC48EB742BADDC527BF7E45983C0ABCF644C0C70443CEC65E41D13F7032E2C8AC418E48EA4012C5023C8CC7034878BF8A3524442D480138A8BCF4BEF8C404B75AC82BC478C4AB41023F5248E3422DC51447F2C1704293C1"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
