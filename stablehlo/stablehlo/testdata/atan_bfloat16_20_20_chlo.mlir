// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xbf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xbf16>
    %1 = call @expected() : () -> tensor<20x20xbf16>
    %2 = chlo.atan %0 : tensor<20x20xbf16> -> tensor<20x20xbf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xbf16>, tensor<20x20xbf16>) -> ()
    return %2 : tensor<20x20xbf16>
  }
  func.func private @inputs() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x40BF75BFFD40D4C0F43FD84012BEA3BF09C0E03ECB40ABBF8C4044C0D63FA8C0003FD1BE80C0C03EB43FA9409E40A2C0E7C08640894070C01CC015C0D0BF27C0D53F0FC07CC09C3F06C096401B4086407C404E4096BF544071C09A4036400340923FFDBEB440BBBE04C081C0B0BF85BF7F40D140973E36C0D3400FC0C53F06C0DC3F134071BFBDBF4F3F54C0AC3FDBC0384084BEF53E2BBE30C08F40603E8E3F473FA0BFEBBE293EC4C02DBF53BF3C40353F144073C0B7C08F404AC0A0C0D83EEB400D404C3F16C005C0B8BD7940A8BF9DBD2D3FCD3FB3BF164002C0593F103F423F3140E9C04B40A8BF25BED840E53F2BC02140E5BFF9C0913F4CBEB1C0234022C02E40E2BFA5BF683EEB3E2C40D0BF453F8AC05BC00D400741253F823F24C0553E4B3F683F02BF83C002C0B23E0540244082BF353F573F15400CC0ED3F6CC0DD3FF83F254007C0B53E1E4084C09DC08F408CC00740BBBFBC40B53F0DC0F63FBBBD7F3FCA40CA3F093F5F3F623FDEC00F40B43F9140D3C09FBF3F40574051BF04C08F3FFC40CC4047C074BF023F2440FEBEFC4084C09A40303F6E40303FA03F8A4001C1E1BF9FC0363F093F7B3FB1BF1DBFA33FE4409A3F3E405B3EFF3F6D3F8E3F57C05440BCC0903FF9BF83C0044086C00E4076C0034079BFA0408BBF64BFA4408DC0B33F02BF58C05540A73FA83E71BF4B40CBBF283EAF3F87C01EBF52BF31407F3FF43EE33F29401440BE3F893E1A3FD740DE40F6BFADBFC43ACF3DB0BF9DBF99C0963F01408FC02B40E1BC0C40D2BF56BF68C0C5BD3E40F2C0A6BFDF3FCFBF19BF813F7E3FB63E393E16C0DA3D283F6ABF96C0D53D06408CBE78C06FC0C83F29C0D7BF333EC2BF0A400A40C240544094BF04C0ABC0D93FABBF9ABE84C02FC0D33F96BFD03D4A407F401C3F6940EEBE104133402E4039BEB0C03AC05940F9BF81407F3FA3BFD0BFF6BE1B40893FA6BF3B3F09C088408EBF1FC085BF37BE35C088400CC1D33F74BFC2408E3E4F40EFBA4D408AC0FC3F92C08A3E24C05A403B407EC07F3FABBED5BF3EBFA93F5CC098C02D4002414AC0BBBF90BF7A40923EBB4025C0903F6740C8BE0EC1F03FBF3C18401E40AF3FD1BF87C00B4013403340"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
  func.func private @expected() -> (tensor<20x20xbf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x25BF43BFB93FB6BF8B3FB63F11BE68BF91BFD33EB53F6EBFAC3FA1BF843FB1BFED3EC6BEAABFB83E743FB13FAF3FB0BFB7BFAB3FAC3FA8BF97BF95BF82BF9ABF843F93BFA9BF623F90BFAE3F973FAB3FA93FA33F5DBFA43FA8BFAF3F9E3F8F3F5A3FEBBEB33FB3BE8FBFAABF71BF4EBFAA3FB63F933E9EBFB63F93BF7F3F90BF863F953F41BF7ABF2E3FA4BF6E3FB6BF9E3F81BEE53E29BE9CBFAD3F5D3E563F293F65BFDCBE273EB4BF18BF30BF9F3F1E3F953FA8BFB3BFAD3FA2BFB0BFCC3EB83F933F2C3F95BF90BFB8BDA93F6BBF9DBD183F823F73BF953F8FBF343F033F263F9D3FB8BFA23F6BBF24BEB63F883F9BBF993F88BFB9BF593F49BEB2BF993F99BF9C3F87BF69BF643EDC3E9B3F82BF283FACBFA5BF933FBA3F133F4B3F99BF523E2C3F3C3FF1BEAABF8FBFAB3E903F993F4BBF1E3F333F953F92BF8A3FA7BF863F8C3F9A3F90BFAE3E983FABBFAFBFAD3FACBF903F78BFB33F753F93BF8C3FBABD493FB53F813FFC3E373F393FB7BF933F743FAD3FB6BF65BFA03FA43F2FBF8FBF573FB93FB53FA1BF43BFF13E993FECBEB93FABBFAF3F1A3FA73F1A3F653FAC3FB9BF87BFB0BF1E3FFC3E473F72BF0DBF683FB73F613F9F3F583E8E3F3F3F563FA4BFA43FB3BF583F8CBFAABF8F3FABBF933FA8BF8F3F46BFB03F54BF3ABFB03FACBF733FF1BEA4BFA43F6B3FA23E41BFA23F81BF273E703FABBF0EBF30BF9D3F493FE43E873F9B3F953F7A3F863E0B3FB63FB73F8CBF6FBFC43ACE3D71BF63BFAFBF5D3F8E3FADBF9B3FE1BC923F83BF32BFA7BFC4BD9F3FB8BF6ABF863F82BF0ABF4A3F483FAF3E373E95BFD93D153F3EBFAEBFD43D903F89BEA9BFA8BF803F9BBF84BF313E7DBF913F913FB43FA43F5CBF8FBFB1BF853F6EBF96BEABBF9CBF833F5DBFCF3DA23FAA3F0C3FA73FDFBEBB3F9D3F9C3F37BEB2BF9FBFA43F8CBFAA3F493F68BF82BFE5BE973F523F6ABF223F91BFAB3F56BF98BF4EBF35BE9EBFAB3FBABF833F43BFB43F8B3EA33FEFBAA23FACBF8D3FADBF873E99BFA53F9F3FA9BF493FA5BE84BF23BF6C3FA5BFAFBF9C3FB93FA2BF78BF58BFA93F8E3EB33F9ABF583FA63FBFBEBBBF8A3FBF3C963F983F703F83BFABBF923F953F9D3F"> : tensor<20x20xbf16>
    return %cst : tensor<20x20xbf16>
  }
}
