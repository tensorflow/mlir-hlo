// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.atan2 %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xA5C49444D6BEAA424E389638CA3C14C2DB361AC082BE6E22F73EAABE9EC0754032C1AAC004418DBDF4323740FBC35D3F1344163F08C7DCBC5BC1BD3DD63A52B8743DB9BDCF4162BE0D43333E3E45AB436F442836DFC15EC2E33C45C013C328BE71BFF93007B4593FB43A023809C46B4289C348342FC393BD0FBEB9C3EAC06D479E4470C353A20B3BF0BD934305B9A7C5604402BBA79378C1A746EA34CCC3BB356F370F37EF4113C2AFC16BC0FB41F04049C3F2C19AC432C4CEC6743B89C6D6C1A3361647F9C32C418E434B46293C88441F3B2FC3823A2F3D63C4823DA4BC6FAAD8B1503ED8C3833CC940E73DB5C375B3D247B93DD3C26CC501C059421841D642704513C6F94162B5ED3FDD393546F640ECB8573AADC311416E3E4131004135C399C2A8C569C38D40AA4152B912C414BDD143C53D8345D5B9684057C47B3F3DC1B2BD89359B3E33C09CBC2939313C3943AE4280440F3FD13F7BC8793EE3BC423EBF2D35C1CBC254BC7B3E0145A142C533C643DAC00644B63D623F69BC87C0B92E673B85C270BC8B40A341A03D43B6CBB849C13EA9ABBFB242843EF8C4E32536BDA740B9C466C0913D943F6FC5C2C3D630F4400EBF434166BC5838463DE4C07238AFC4CFC2B3C0FEBF5548CA40BF4056BE25BF50413EC21C442C405138CE3D383D6E441BBF9EC4DAC651C0893C58C464BECA384543A4B6CC35012B62B2A4C0BCC52D30D428BFB46FBEA3C1ED4594464EC459BC1E3E92BE923C88C1FDC32439AE45E8B6E0B9ADB786BEFD3F52B90ABAB53D17C48BB3C3C182BCFF32523C1C48394258C3E146A2C53F46853EE8400FC861466DC08EBD424818ADF43D583EC7C010BFABC156B1ACC590BEA7467441CB3E58C1204309BA1E446AAACB418D47DD3515C007C650BC09BFE745ADBDC2AF0B391FC3A3C06C3B57B7C2C60C411FC2A4C4B7468DBAD4336ABFB23E58C5E0C490C480B9D228783DDBBE99C199BD60C3553801C53FBEB044F3C0C940AEC380C22AC05FC42ABA36426D3CFFB83ABCDE3D183818C1A845FE362334FEC2E0C340410D435E413E44BA411CBD2EC3AD3FBC42333FD84299C571355F3C90BFB22BEA4145BF03444B469E3E3B4423BF58C3E2C548B00544"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0x57C104B9D4C6F4BC3EC2AC3D4240263996C506B4ABC24D3435BC3B44D14467C0C5B739B771C2A6B5CF3AB935D142BC322DC475C1E9C52C40F3C49CBC48BE9939A33756C402C68741C4BEAAC253BB41BD4640463A1C40A9C3A64433BF09BF5AB95D31E74279C440BF7E4172BC09C13238A63D6AC3BA4091C3FC43B1BDA6B8C941B3BF5F404B4382AEE8C37A3D8E38DCC0973C24BDB2C0883F7B461DC08ABBC439EAB86231A54536432AC153C4E7427BC380B8D9437540AA35933C6ABD5A3E31B9DCC0923E15BD88418CBBCABCEEBD283D37B9023A9BC06FC59DC545C346356FBDD1C38FC194BB36BBF24168B7CEC5E0C137BA2CBC49B683392ABF8C381FBA2CC54EB03E40DFC2E2407F4678B2EEBEEF4041441AC3FFC3B0C052326D41E53ED52D69B0293AF6439C2CCCBB073E3145E0C1F4C1A43C04464440FA4449C41E4424B8B0BA43BB92BD88C4804001BD88C3A5BDCDC1123C2F45A4C072C16444FBBCBF43F7C77740B8C004C56D3BD0B89B44883D33C4A93F4CBE42C1324281C2A43776416CBA8040BB434B47C03C5AB99A365FC05645AFBC923E8643E4402020513BC0BFAAB64C3C09C3DDBBE4BB893CDA3D1EC1FB3BCB4289419CBC30C2264655B3AB33B93647420FA946BA4CC11238A7C2D3B894C14BC49542B53F054406C259C0753CC941F8BE713DC2B5A7BD3D4071441BC2DABAF5C0FE443735C233A43BB83D4B46ADC2343E1CBA5B2977B99C46D33CEF414C391E3419C0B83EA3BF48C3743F703C1F2F56C1903A0DC1713BD53F0F2E88BD3B374EBFF9BA80C52B409B3ED1BF17458AC0013B6A3F7BBBDBC6A93B2CC5F13F10B7DEB8414064BFB144B03732C0EA37D64039C0D6C2D9B49C45C844DF423A4017BB723A8A446CC5F43C4F429642903938C29441633E02B3151D73C04B9FF6B0E03A6D4696BB02426BBD553F5D4042BFF82F87C6ADB62744CDC3C7BE5244B93C2CC82DBA6DC0974146C4D7C668C5F6C247C433C2C94622C2B72C644566B5974083C403C611C37D3CC8B943C0B3BC3C44EF3D3AC0DF42E642ADC1B8C43844D23788B779C468C56F3869C0E0AEE5BFD4C08641D13D72B95BB9203D4CC147C59F428FC08C4657C18C43463CB52B00B68FBE"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2FC0D43ECBC1B53FF1412636193873BD2142C5BE60C1FA293A4001B627B7B34006BF0CBFF64048BF00349C3DE9BAD43DBD4022418AC038B84BC17F40494142B9F03CA5C1624130B809406A41FA3E9A3F7D3C4C37AEBBE5C01D348BC011C0ECBFECBDC2292CC2B340BD34704142C0A33DD9BC2442E9BB94C1CDB5B2BF36BFCC3CDD3F28BCF09ABE3E91C1E53CACBAE8BF423D16C148C2BEBB633AFD413BBF6137FD40D33CBE379AB99EC057C1B6391E41E5BE30B97BBCF2BD9EBD144154BD29BFF2415F3D84BF043A433F093F0F412D3D684075BD9B41D141F5C08F412DBD36C231C240413BBF7D406C39803F1CC120C2AE3E6740BEBEC7BD9AC0933D733F1D41623EF0BCDA4062B0BD345C3F5F3F4E3A99B0D841C1C0A240CB3DBD2BBD3B2FBE73BEBEBDFFB9283E9C3FA6B652B978C17240263BEF3945B5AB36B3C0D23610BF34C08E418B406AC193B75541BE41C63F9240653D4035E24077BFA635BBC024364342E5BA5BC0DCC1343CC33EFE389031CA4038BBC63F4A414D38A1C174BDEC289240BCBB79B4D534B03C084012BAC0C15BB737C2E6BAD139B33847BE6F2619C1FE3E63BD2AC15F401A4076BDD7BC2A42C03CAAB7153AC2C0F041C232A8BEA83CEDBD9CBA5ABEC7BF783F723D0B41BDBF25C12D4112BA883CA937EE411B41E93AF03BB1C023BD7EBE4DC0DC3732BA52C1104157404FADB53A1B3397B213BCE9B934423A268BC12EBE3CBFD9398F3DBDBB18BC9E3DEEC0C7385AC09FC05035833D46BDBFC13CB823C18A3C3DB5C9BDAE40D8BD07C275BFE1C1B12EA238383F643840C0C73D03BDE13ED141CB3C47C0143D12BFEFBF4E3D32C2EA341B3D95C031BDEABA20C23AC003BFF63A2538583736BB423F05BAE53944C2AB3CB33C182FF8BC18C0E7B5ABBA6E3E45BE2DC2543E75BEDDBC973062C19CBC204020BC86BC573FAEBD35422BBF223667C09FBF80BA38B846422B40F7C04ABAA6C14BC115425BC095C14F4098B5F54035BE57B8EDBE59BCF2C15441AD4110B857C01441764155B8423DE041CF2C56BA64C045419239903DBA3E2541D2C1ACBDDA40693ECE405F4073BC5A334140A5BF002A9A409FC10C3BAC3FEC33444011B727BD3EBE99C1D53F"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
