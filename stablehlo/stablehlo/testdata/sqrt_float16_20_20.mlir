// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf16>
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.sqrt %0 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x4C3C2A3EA7C12642F1C15FC547A6C642DCBF40C2753882B72E43A73DCD3EF1BDF8C0853D6BB10444C7BA0832C13F203BC4C3703607BFC43C0DC441BCA8BE4DC1A3BCC0BC6AB4D2C5EB3DF2B5B1C099423EC340C5DC43BD3DC641AB43F54008C5312FAD41A446C4C1C341DABD623C743DDC40F9C16BB92FC415BEE0C0AC3EB734FE3C3FB247C2BF40EC44D5B872B07540A0BEF2B7249C1C3F61479B3B40C0283EE1BB0D40143F404899BF6040D33BC63C8C3C0A41D4C01442B2400640A0B2B1BDFA4085C249BF77B77AC1E0421E3D553D5F3EB5BA343EB545E2BAECC61FC61CC3884778BEBEBD06C37EBD44BCAB450EBE4AC4693E1544FAC2DCBA0C4033B097454E445143F2C07BC45E404BBD05435BC426B50D44103F1E3C51C111C2DE3E0C44ACBD4C42ADBC9040E7BCD042C74178C317C1F2C3F225A8B3EA423A4024BF8A364CBA00468D3D9ABF94BDFABEAC4014B2C73FC2C4B7BB1EC4C03D333CDAC609C037408840A6C1DB40F7C49B43143E62B52D3E12C3C9BEECB912C050411EBAFCBEA63C6040B739F64412BE31C13C3692C218C4C3391DC2F24018BACB432941D13EC3BEDAB92C3AB8C40243C5C03E431AC0903DDDC1A93C263E4FC06AC01CB9753CC0C470409C3D24B096BDACBEFD3662C1FC4177B374C21839ED40C7C1C5C04F44D9C3E744CDC3ABC026C399418CB9F940CCC173366C4008C7A9384DC59EC781C25C433E3D373886C0BCBE923DE5C3C33B88C1EA37B03CBB36043CF444F7B626BD58440742A9351F45DB4070B9A840BBC0B344BABE643AE4C272A248401646F840BBBBBCC0FCBCC0C6A53A66359FB0F2BEAE44BD40494236BF243AB244EABD42C6614086BED2409034DF2BC038484210C4A6C42532EB36F8BBEDC00ABA49C18CC0B3C0253DFE3EF7413143D6414441BA416CC50BB84AB358C23DBD55B37E3AF0C42D3DC133543F0E444BBEF236973790412A3A6242C43E61354C30063F41C31A4028B61BB411C46AC661355CBA36C26FBD78BF023EA9B122C5C928F74090C47F43E1315CC78B45F7393EB84E3D63456D425CC53F400F436339683CADBDE5C648C44CB8D6C0CD30B1C145BE66C0DD304CB7FB3812C068C212C53F3DC24325428AC3"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x253CF73C00FE033F00FE00FE00FE5C3F00FE00FEF93900FE943FC13C373D00FE00FEB33C00FE024000FEF236923D8D3B00FE133900FE5E3C00FE00FE00FE00FE00FE00FE00FE00FEDE3C00FE00FE443F00FE00FEEE3FCA3CCC3ED53F4C3E00FE5D35BD3E274100FECA3E00FE303CAC3C3C3E00FE00FE00FE00FE00FE2A3D5838783C00FE00FE293E704000FE00FEF93D00FE00FE00FE553D6F41CD3B00FEF63C00FEB13D523DD54100FEEB3DE93B5F3C443C593E00FEF93E213EAC3D00FE00FE4F3E00FE00FE00FE00FE6B3F863C9E3C0C3D00FEFB3CC74000FE00FE00FE00FE7D4100FE00FE00FE00FE00FEC34000FE00FE103D0A4000FE00FEB13D00FEBB402640A73F00FE00FEE93D00FE7E3F00FE00FE0640513D0F3C00FE00FE3E3D064000FE193F00FE0B3E00FE623FCC3E00FE00FE00FEE03000FE703FD13D00FE1D3900FEE640B63C00FE00FE00FE1D3E00FE943D00FE00FE00FECC3C193C00FE00FECF3D053E00FE3C3E00FECD3FEE3C00FEF83C00FE00FE00FE00FE853E00FE00FE503CEB3DC33A744000FE00FEFE3800FE00FECA3A00FE4A3E00FEE53F6D3E393D00FE00FE073B00FE7D3F00FE9D3F00FEB83C00FE513CF63C00FE00FE00FE393C00FEF53DBD3C00FE00FE00FE493900FEEB3E00FE00FE623A473E00FE00FE274000FE6E4000FE00FE00FEB13E00FE4F3E00FE1439F33D00FE1B3A00FE00FE00FEAC3F943CCF3900FE00FEB83C00FEE13B00FEA039553C3039023C734000FE00FE2B40F23EC23887403C3E00FE1A3E00FE564000FE263B00FE00FEDA3DEF404E3E00FE00FE00FE00FE4A3BA63800FE00FE5440283E173F00FE023B554000FE00FEEB3D00FE363E4638EF332A3A173F00FE00FE0337433900FE00FE00FE00FE00FE00FE893C4A3DE83E963FD53E7E3EC53E00FE00FE00FE00FE00FE00FE353B00FE8D3CE0376A3D074000FE45398339AC3E063B253F343DA338DD354D3D00FEBA3D00FE00FE00FE00FEA33800FE00FE00FE00FEE73C00FE00FE30324D3E00FEBE3FDC3600FEB540E83A00FE9B3CA4402B3F00FED43D843F913A333C00FE00FE00FE00FE00FE333600FE00FE00FE3D3600FE503A00FE00FE00FE953CE13F033F00FE"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
