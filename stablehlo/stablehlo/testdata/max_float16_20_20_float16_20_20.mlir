// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf16> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xf16>, tensor<20x20xf16>)
    %1 = call @expected() : () -> tensor<20x20xf16>
    %2 = stablehlo.maximum %0#0, %0#1 : tensor<20x20xf16>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf16>, tensor<20x20xf16>) -> ()
    return %2 : tensor<20x20xf16>
  }
  func.func private @inputs() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}, tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDB41BB3885BD78B28DBC77C25040384576C108430DC42F42D1C69EC08A4314427ABCD94078B9F943883916C0ACB957ACF1C6EFB8DD4217C4AA2D03452EC49BBC8DBD993A213F8FC24F3E0D44233E50C178C3A73EB943CDBE6F421BC131442E4038400FC48C3316C13644ECBD292B33C63F3B8F417743E0C5A1B0A43EC1C43CC19CC045BA0A408E428E4396C4F3C1693D28B6F5BD0CC0412FA1C44C3CEDBC71BE77453244BABDF9BCB23483B4444316BC323C63C0A331CD3D523546C16440C030A93EBABFE1BC37C4FEC034C123BDC2C1D3C113A124BD61C4C1C49B4256C36D433DC0DFBA6942144644408A383C440D3F7B40CCC62144A0C43DBC14C1B4B8BF4158C7B5BC92338B47BBB7E6B80B45963BE2C01B44B436FD3FACBD13C2CA3360C27FB7E538A5C333B6ED3E2941C5C37E39C13F9544AFB864B9EC3528B57AC44BC282B5604483C6B2B1A23F68C4FE3C44BBA5C0CF465DC43CB346C2A6B7179EEFC370C2CF3EE3C3B8BF78BDFFB9F9B983B926B193C5C8C014BD6039A9C493C08EC16AB69E3CB9C2AE3A8DB4FDBE313B7840013FB4C3E6C0E9414D456D39233DAF328BBDAAC22BC17BC001C59CC11140D9C5832EE934D339A641044264439842AE40CC4296B9F8B8E5425132FBBAAC3BF8B3B5C369BA1E3C10C731404ABCE0C0EAC3F2C042C5563FA0BD3FC05B3129C294468D39C0C13FC355C39746BEBE4640E6BC6FBBFAB5C0C0DAB9E4ADDEB89441F53626B70F4392B478BC32C2B63F98C6413C8B3C0C4421C5BBBB1BC64B40503F72C1FD40923D2F435CBF0D3B1BC69D44E83D352E7BC218C03CC04944CCC287C2A43A8E453C44494472C0FC2E0F3ADE36AD4168B9E4373B4892C16037D23F3842123B4BC56F43423EB640E03E5FB4C9B84C447740C33970BD67C350C227C1D52DABB739C3CBC0F33047C186C1BF3EB3BBAEBD1DC7F842023AB2AFC13EBC42D94001421CBD45C33DC1A5C14F48C43F814216C182C0793DE6C25234003068C48FBD4B439A3E3FC045C29ABDCF3C78BC5BC2F1447942BC44FA40A13AB5C5C8BB9AC09DC250C19BC095BFF63D44B94735DBC0264513C861C21BBF2D4377C0E3B90CBDE8C4D13F56BD294023BDEB44BB3FD0BCF6C2"> : tensor<20x20xf16>
    %cst_0 = stablehlo.constant dense<"0xFD3E0D45B3BD5ABF4C38C2BF1CC22CB90EC5BDBBBBBFF744CEBDE640D03885BAC440373E7DBF9643EBC0C7BCA442F03F56B956C0743EF4311BBB8B3D2335C940293FCBC6B7C470BDB43645394145723F07C0FFB249BC203DEE39B7BA00C5FF3A27BFE63DFE4337B99ABD3BC2D1300DC04C3913BDA345D03FE53D972E80BC7F417144C9444BC084B7AB32D6C46645F542313862BC75C046C0F4C22C4567C23AC7833775B8EFBED5BDA0BF17456BBD36C38C404A3868B603BD8D41D1C69B40303F27AC21413241A53E643A553A42BF13C229C414392E48E1C0393426C1A43EADBFBC468EBFCF3DC4C0824413BC07BC184129BC863C314490BE6D3C75427A42D8B4A5BCA8BCAC40AEC066BBFFC3AB3F64C07B43D140383DD643E33D773A91B97EAA4FC356C5A037823D834267BC1EC382423A48C9C48142F6C19641A339B6BCE4BD0B3EEB3EB5BB674072C2E7BFA74244BA7FC04CC493409BBEDE47C6BD1E4085B9F1C10DC874459FBBCF3182B4474535BF66C4143FFE450DC8E2B2502C31C4912932435CC37D3E463B74BDEFC199BE8DBEA0C30442423FAC3D40410FC0C5B93CC20EBE5C44F43DEC38AFBCE3C3EEBDA33F5AC1BCC2D93DAC3DFBB73A40E640244799BC374492C346BE61BE5DC69BC7D9BBB44101417D4677C40444BFC1423B53BA63400C440BBF0E4041333535EA3FBA3DC344CC3AE9B80D388C38E63D13C49E44C7439ABE10C1F0BA95418A42A24672BE75C04EC2CE438239E342B9B932AF71C2ADB8A1BFE33F1DBE5937B4454BBC513EB1C1BB435839C0403A3706BB2DB3753C023D803ED9C29B47BB441CB391B9BB323FC3A7C0A2BDE83850B7A6C67BC4CE4303423643BA4101C2DE45684270C23AC4084423BF06C0E5B27340093EF4C09742C4BE1BC451C55BBC20C26DC3B33085C58F44E3C4343CBC42F1BC2D45D1C40638F83569C6B03DF2C6923DECBD0DBBA72A41C01A38014149BE41BF6ABCAF38ECC4A4444C3DBB43CCC0E2A1EB4007B6C5C010C1C9BF5BC29FBA21C29240AABC233A164356C5FFC0FE369BB7DC2EC3C52B3E35B466C4D938EA448CC39FC2CB43503E9D43F344DE39D9BEDEC22C40AC3E67C19BC3423A7B3AB3C12F4354C6E4C2A3B8"> : tensor<20x20xf16>
    return %cst, %cst_0 : tensor<20x20xf16>, tensor<20x20xf16>
  }
  func.func private @expected() -> (tensor<20x20xf16> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0xDB410D4585BD78B24C38C2BF5040384576C10843BBBFF744CEBDE6408A431442C440D94078B9F9438839C7BCA442F03F56B9EFB8DD42F431AA2D03452335C940293F993A213F70BD4F3E0D444145723F07C0A73EB943203D6F42B7BA31442E403840E63DFE4337B93644ECBDD1300DC03F3B8F41A345D03FE53DA43E80BC7F417144C9440A408E428E4396C46645F542313862BC0CC0412FF4C22C45EDBC71BE77453244BABDF9BCB2341745444316BC8C404A38A331CD3D8D4146C19B40303FA93E21413241A53E643A553A23BDC2C1D3C114392E48E1C039349B42A43E6D43BC46DFBA6942144682448A383C4418417B40863C314490BE6D3C75427A42BF41A5BCA8BCAC408B47BBB7E6B80B45963B7B431B44383DD643E33D773ACA337EAA7FB7E538A037823D834229411EC382423A489544814264B99641A339B6BCE4BD0B3E6044B5BB6740A23FE7BFA74244BA7FC0CF4693403CB3DE47A6B71E4085B9F1C1CF3E74459FBBCF3182B4474583B926B1143FFE4514BD6039502C93C0912932439E3C7D3E463B8DB4FDBE313B7840013F0442423FE9414D456D39233DAF328BBD5C44F43DEC38AFBC9CC11140A33F832EE934D93DA6410442644398422447CC423744F8B8E5425132FBBAAC3BF8B3B44101417D4677C404444ABC423B53BA63400C44563F0E4041333535EA3F9446C344CC3AE9B80D389746E63D46409E44C743FAB5C0C0DAB995418A42A246F53626B70F43CE438239E342B63F32AF413C8B3C0C44E33FBBBB5937B445503F513EFD40BB432F43C0400D3B06BB9D44E83D023D803E18C09B47BB441CB391B9A43A8E453C444944E838FC2E0F3ADE36CE43034236433B4892C1DE4568423842123B08446F43423EB6407340093EC9B84C447740C33970BD5BBC20C227C1B330ABB78F44CBC0343CBC42F1BC2D45B3BB0638F835F842B03DB2AFC13EBC42D94001421CBD1A38014149BE4F48C43F814216C1A444793DBB4352340030EB4007B64B439A3EC9BF45C29FBACF3C9240AABCF1441643BC44FA40A13A9BB7DC2E9AC02B3E35B49BC0D938EA4444B94735CB4326459D43F344DE392D4377C02C40AC3E67C1D13F423A294023BDEB44BB3FD0BCA3B8"> : tensor<20x20xf16>
    return %cst : tensor<20x20xf16>
  }
}
