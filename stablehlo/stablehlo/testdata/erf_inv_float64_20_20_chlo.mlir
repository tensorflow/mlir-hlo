// RUN: stablehlo-opt --chlo-pre-serialization-pipeline -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s | stablehlo-translate --serialize --target=current | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt --chlo-pre-serialization-pipeline %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = chlo.erf_inv %0 : tensor<20x20xf64> -> tensor<20x20xf64>
    stablehlo.custom_call @check.expect_almost_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x2E9AFEC40E81CEBFB4A1A84DCCC417C0669CDEEC2FD420401C1A063B44B7E83FA6C282AEF5E4E93F6084A5CE5D1505C0F6ABE170356E0340983FD7E5B31E09C0188C86CF97FBED3FAF9517C404D3024046786C22311E00C090F3C8D6383003C0301070F8B3D4E5BF7A223194592505409A42104170BFFDBF96F8374CE0A2DFBFF732A4FEE4041140069C312BD1B609C0B81EF9297023DDBF0D7F0924FE9801407687BD2B92A212C0DF9442C8CDEEE1BFF2D285E108C9D83F04641C05B01F02C0EB71ADAF5A94E03FAE4A6FD5FE5B08C080E3300F190D15C0BE2E3BAB3661FA3F78956F46719EF03F0D3ACB2FF11E1740BF2D556DC587F0BFBE50B1E5FA7111C070F4C1E18FED0040402844222E5EDEBF0246DDA35825BC3FDF9C222DAC53ECBFD4212737D8FE01C0E695E3FBBF7B0F407403D9AEB2FBEDBF0E145D890B710AC052EA3C1FADA10440A97B6F909F12E0BF5D19E4721A07FDBF37D0B9512088124076AF8C95E14FA4BFC66C75B55F8A0440F1727E44FABA0640105850B158E9D2BF140995946225DCBF380253B401B003C0C46ED20274060AC0F84B77B57DAAEF3F082E9C99300B08C0A45E04B0999BFCBFAF02C61843E9F5BF8E25FEBD8985FB3F34BA84FE719B13C08C33F706D871F7BF7A1AEE0047CADF3F1137D77C79A200C0241247F8049202C04856C56B5F9B024072886DA36760074058DA11490EF8EA3FEC3DD205E8FA0D405EB524B8EDCE0AC0597D650853F2084004A4A94E50EE1240C2ABF0BF852AB83F5879D6DEFD5FE83FEBD929FAB227CEBF0CAAEE4A5115C2BF6E22451DEA3D20C0301DBCC1EC2019C020F116CC078019C040A3113D91CC04409637486AF2DE04C034F05F32990FFF3F3CEF7E9C44130F40229F345ECE7F10400D17C04FED2FEBBFD23A97CC80920AC04ABB30CEA1BC1140AAA96905B1A2C53F8934574433ABF93F9D040BB0403812C0B5487280889A0F4074A944986A8401C0E257E170FE50FABF06387F60DB6FEFBF967B2C3B4CFE0DC00584762A550DEFBFA77859416BBA0640C879A02043390BC08B6A3E0F9FD5C53FA1D860AE3ABDF1BF64500491B9A40CC005D7FC1935CE1440942E946A7641EDBFF9DC26A1BC18074069868FD0A673DDBF9ACCEABF7099104078BF066CD49114405B84611A1DA3F4BFE8E001AEF731DEBF92AF727C13F1F1BFCA7420386E02E2BFC0098BFBE0120EC0081A97A7A57AFC3F140A06E0DBF400C0B69AD3B245A7F93FE6C7848F002517C0182E465500E124C0560BFC226516D5BF20D937DDEAC0E53F910EDAB987CC16404B7A2A0EC57CE13FBAEC3EB63281CEBF0B1F0E0857AB1540CBB3C3522926F2BFE0F748C2184B15402A4A9DD504FC0D4010A7C2F92B16FC3F2F7DE5E1EC14FB3F8C2FD5C1B8E2E83FA4BC6FDA29A70340D48912F146630340DE946D09C0FE07C0F675B57B484607C0DF3A93D99BCAF33FA4CBEEBBC2DFF13F37E0C3F3F77F04C02DA111C3AB870440B6F963BF4655FD3F1E3E8DF56CB212C02E0DD9324E4B01C0BCACFB73601D09C0871E94E9B9EE01C02D51A76B51D8F7BF26BF5E23752311C036FB803D0AE70740BE2434BC542AFA3F3F35BDBD21F00F40B438070BF2B1F4BFF515F2E7101FF6BFB8D7A0DE8DAB0140F06ADEF1AF4EFC3F61FA8CD987F5C63FBAB6433383F8E13F3A69ED61B296EA3FAA0171EC1831F0BFCA7807B5994605C06CCD6E6426ACFC3FAAD06F736AFFD3BF5CF7E903C41A0640BE6B47252A121040646F8710EE780840683FEF559FCED93FD629FE9D93A6F0BFD8EC8D564D0C01C0363C6E73D142FA3FFE7D2651B827FF3F0282969E512708C0DCC9EC87A1F21FC03E32DEFEC5C7ECBF608E8EE5F05502C0FDDF93FD4CA8FDBFD027F43756B9DE3FC66EB07B91A5F3BF681F75A061D3E9BF88E085EBA7A3E1BFDB811297E07C02C02A2DA64E97591240A8E578AEEE340A40A5BF0A0E55F8F23FFEFBFDC5A56CF2BFDCDC50E500E40DC0B8F6ECDDB68FFCBF014EDF0B829E0540D8E27BB72FDED83F7EF4E467376CF1BFC84F529F23BB0EC088853C0E24D3034061DDA5C6149EE03FDADB8DEC9F0706C00652E876DC2509C0D1A2D2684709E83F3EA91D71CB2CEEBFE575D70AE47B074034C00FD52C3001C06482D232259908C0ACB5C997547F154017AE08DFAD18064030B6B20E81921E40EA77DC43F085E83FDEA9CCD5EDE107C058C453B4EF3CBE3FBE71E796F4490C4001146AF3651E1BC0574FC263F4FCD33F6F15CCC6FF931B40FFD141E930D2FBBF99ADFF8CDBBFF83FB98F4FCBB5B215C0807FC93DA02919C0E441BE2DCC9CEA3F0DFF32DD9064084075C29DBC5854E13F5327387121230F408683C158CD110640542DCB583DE310C046C97809D0F60D40F02A69EBA17B06C05A782C3532FAFC3F3F5E8FCD45A6164078EA5C84900BFA3F06C50F6BC45ECBBFDF060E51F3AE0B40503A2BDC21E4BABFA3DA995FDBD8CFBF38672833E0D2064098B46798511A08C0DD92D43207FCEE3F7A29B5198F8FF53FB266B216DC3016C0B4DEB64981DA0540AF49A31A53BAF33F01845238DA46E2BFB8AB078C430F154086FD2339B4AC0440E4C14EE0FC030340DE4C5C2B8A010A407B741C8D09F0E33FA0425A661F8C18C0E4D126FF8738FD3F5C74C80CD8E9F53FC6EA3F4AD647CC3FDDD1251D7EC5064092296F65FF5815C0C8450771C19C0B40E9511BBA2EB70EC0E058458D04371040206C35484733E43F785866743E340340102A58ACE3CED63FCEB40F2A061AFB3F1429078915B00C40FC82F841B6A802C013354234F05BF9BF4F9E7D8927D21540729B3EA380A7C73FCE3545853301FABF183DF0E7DE1D0DC0F2F629FF107801C0B981929FF88CF93F2A3EAA8F4FCE0640E28291DBA0C30EC0F3094E9F02BAF4BF26FB4E976C1812C04BA79A2C216914C081689111F23100400CB062AAE2D11A40A2DEA74770BDF5BF40F4951583000E40D81789205A0E084069A11C37F6B5F63F89F98A90E9A3F73F107E5BA76F18DCBF583FB528D88C0540BC9A8E29BA7707C0F36DC941167B06C0FF56C77D8EAAC0BFAFFB631CF6A90C40187AAC6C7915F63F67455314B00FF6BFAE3C48D2F1C31540908457B5272CF03FA64A6939C4A81340C88134C68192DB3F4A6B7A6C9EE8FF3FBCD324F4E593EC3F2B869CFFF2CDCB3F3AC50FB42DA20CC097CCF5522C5920C0E8F6769B2CE2F6BFA2E4D0E309B5FFBF5FE1A54E4242DC3FF0AA18A8A17D0F40587651E36674E9BF7AB35DC8E25FE93F2E2EDC6450AAF53F79A804E68199F6BF9887D026CE6F0340055AB009682CF13FE11AD563462F0640B23C549DB926FE3F2C55BBFDE85301C034BD96B519CEEABF1B92E6A1FEB6FD3F135617539289D3BF207B11D944E7F2BFD67A342A92A41EC0DC365D8AE60E04405F5FC879907EFABF317E36F9F1D1D63F406884DBF23606401BFC913D2B0001401E7A35022B82F7BF22FE05DF51CB06C0717A8A4EA3E2E73F5C2118A5220311C0CA0CB672568C134036E0EEBAA5F225C0C46709CAC66011C072930FBF48651140AE883BFDCB8FF83F32C88F6679CD0BC0F75EA1C97764F0BF3E13CDF3384811C0117EF1EB4B18EDBFD43A48CDD90116C02E934813E65B0E4096EF931E955D15C0BE0135A31A7017C0C1ADA28F97531C40D0CB066D7FC703400C0258D441491A401F5EEE4DFC34E6BF5475B026197BEABF780FF01D0B8B0140409E91BE48D20C404F1A47C7BA1B1440B52B6C254306F13F0336AA063FF105C0DCA80E2E39ECF6BF64D6C325273603C0170E44AAC62FE63F5647DF888CECEFBFF626CC5CC1FE0E40025E648761430CC029ED7A528B1B15C05C6F9509A86FD63FCABA32CD832F0E40BC86A8A11EB3F2BF5445D268CC3FDEBF870C9BD9CF02EF3F4A69A0D93C5A004018088798BE11F7BF4530906E44950840F8A419DB224E0AC06536F61D576AF33F1A2D002DBC2AE63FE8E368BC34A2E23FFB4E7BA5CF201AC0A4BF6BE57908AFBF4B7A0FBEC75202C01816E23EE9EAC73F8619B63F809411403D3F74235F9211C0B92470BD0F6F1B4096F262ED1B73CFBFF0A3E2F6C9E0FFBFB4435442F8021BC0C88CEDB672530240590B57FAF80103C0204634588F990540501429FB146224C06A0768F5276C044028826B8FF5DAF2BF94EFC7499E0216C076EFE543F0CE0BC0F776F19A2D84BD3F138D591158C402C0C2FEDE7E9F2804C08C6A6D86586000C00A6238DCE2341140D95C8E61617C174034982D97F723F63F7C91C1648F5DF6BF23021B17D1FAF23FBE18CC603A030240A2882DA15F51E4BFAF4F6DEF2433F23F75AFA964CB2616C03672982FFA45F13FAEE97A468F8BA7BF0C332A2A0D2F0B4060D23AF4CCCA01C076459D9B58C606C098187F94B233F3BF6A214EAE999EF23F44F5A0748AC2FCBF6045BF04AD0E0D403B1E66A0111806C02E5E7D07109206405656A9B15A5DF4BF68AE0385D8B615C08D03FEA1B7E401403323563D02060240D53C371197910440"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x36A6198AD672CBBF000000000000F8FF000000000000F8FFB83410A0BC4CEB3FCE62C1C7FB99ED3F000000000000F8FF000000000000F8FF000000000000F8FFA333AD990408F53F000000000000F8FF000000000000F8FF000000000000F8FF6113FE4EF09AE6BF000000000000F8FF000000000000F8FF62D9B85DD31EDEBF000000000000F8FF000000000000F8FF87EE47653669DBBF000000000000F8FF000000000000F8FF73AB6B69F17CE1BFAED2E33039E8D63F000000000000F8FFDDD3843C7FD3DF3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF700323FB52BBDCBF2720073FEA05B93FA96EB65699D7F1BF000000000000F8FF000000000000F8FF0C92D39F4708F5BF000000000000F8FF000000000000F8FF2435F8359DAFDEBF000000000000F8FF000000000000F8FF3640F8D52C02A2BF000000000000F8FF000000000000F8FF21E507D29D29D1BFCDCA62599A5CDABF000000000000F8FF000000000000F8FFD837F3DC5AF9FC3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF3416AAD9744ADE3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFF0CA7CBFC800F03F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF1A6052398477B53F0D215A182FAFEA3FC41F39D3F61FCBBF8B6041254D1CC0BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF8C9892C93E45F0BF000000000000F8FF000000000000F8FF9ED0FF05D751C33F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFEEFDD59DE5DBFABF000000000000F8FF286523ABC49BF8BF000000000000F8FF000000000000F8FF6C169C750680C33F000000000000F8FF000000000000F8FF000000000000F8FF6D209F1C7570F3BF000000000000F8FFA11ABCF9CDBEDBBF000000000000F8FF000000000000F8FF000000000000F8FF747BF496748BDCBF000000000000F8FF621D25746D94E1BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC21858B2F240D3BF62219C0B217EE63F000000000000F8FFF063B861EBF5E03F132E3EE4F772CBBF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF38C406D9259DEB3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFF1B68A0F7E85C43F8580F3008D88E13FCFF9DD325B1DEF3F000000000000F8FF000000000000F8FF000000000000F8FFC91CE7E89933D2BF000000000000F8FF000000000000F8FF000000000000F8FFE932E16749F1D73F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF85BB460A6993F2BF000000000000F8FF000000000000F8FFEC4671EA6A1EDD3F000000000000F8FFC173833A7A75EDBF108F54E6B123E1BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF039C49648AFDD63F000000000000F8FF000000000000F8FF000000000000F8FF3FF4A8D596E9DF3F000000000000F8FF000000000000F8FFD406D64C7F17EA3FD47D2C63DE87F5BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF9D38A6850FF3EA3F000000000000F8FF7397B5407AE5BA3F000000000000F8FF000000000000F8FF520874843C31D23F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF93F2A3AF4B2BEF3F000000000000F8FFB51505D59EC6E03F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF036E6D43D88DC8BF000000000000F8FFEB43F88CA2E6B7BF502F41D589B2CCBF000000000000F8FF000000000000F8FF023726F4804CF83F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFA566F264E2E6E1BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFBB45E2B2F7FDE33F000000000000F8FF000000000000F8FF000000000000F8FF446799886964C93F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFB13FD4219C56E43F000000000000F8FF3E570927CBEFD43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF59391BBB7327C53F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF94CE678C024FDABF000000000000F8FF000000000000F8FF000000000000F8FF35FB03C627ACBDBF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF47399314F5C2D93F000000000000F8FF0B64170D103DF23FC038E6D321F4C83F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF00F3A44CF27ADA3F000000000000F8FF724278C336B5ECBF6668A2BCBB8CEC3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFF9AF957EAE9DEFBF000000000000F8FFFF320E2496C2D1BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF8A751ACECEF2D43F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF600382325BD5E93F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC480005A7522F3BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF621F36A33A29E7BFF28449C0DDDEEEBF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFCC0073517021E73F29EFED19CE3001C0000000000000F8FF000000000000F8FF000000000000F8FFA24562830992D43F000000000000F8FF000000000000F8FF825454AA6A9ADCBF6315C570056BF83F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC334BC21E919E73F43A7EF9A7256E23F000000000000F8FF90A8B4DA6487ABBF000000000000F8FFA646B359DD64C53F000000000000F8FF000000000000F8FF000000000000F8FF6D50A794C753CCBF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF5D6F474CF73FBA3F000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FFC9D81542AE7EE4BF000000000000F8FF000000000000F8FF000000000000F8FFE2DA661FBFE0A4BF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF000000000000F8FF"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
