// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xf64> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xf64>
    %1 = call @expected() : () -> tensor<20x20xf64>
    %2 = stablehlo.sign %0 : tensor<20x20xf64>
    stablehlo.custom_call @check.expect_close(%2, %1) {has_side_effect = true} : (tensor<20x20xf64>, tensor<20x20xf64>) -> ()
    return %2 : tensor<20x20xf64>
  }
  func.func private @inputs() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x7D607CACFA741A40CA89AC13BFA30140BA7FEAB18CC50FC03641E0151727D33F8094B75C3F52EFBF3317F04566461140DE2DF2634662E93F28AAFCDD928FC4BFFDACEAC5A7D1FC3F40F8D8B5977A0CC0365D358F4AA1F8BFBF681ED01163FD3F11ED5B47D4B5134004CF0251D3DC07405AC08582F4EB0840D6D80329210F0AC0D6DF695BBE96F5BF4072DBE0664A0CC05E5718183112F4BFEA49C5B4A1EC0EC00E15E21396821C40FE75B59DD350EF3FB49C58010C5CE3BFA8526F9FC4D0D7BF5699CF5F390A02C0987FDB4C521F11C05C11CB160303DEBF0AB4E4F567E013C09D50E634A80B0040BDBF3DBEB6620FC00C13632AD45F13C00CFE54FABA57CFBF575F59CCD955F5BF4CFE46142230E6BF3C72D464B1ADF4BF5A1E557864D403C05C69CA256B1DFC3FDA8D5D0121E909C04AA12AFB576C0A407E45FED386B00640DD1515B1B930F0BFBF750531F0F304C06EB5E4D525B811C000916C5AF75AADBF7A826FA76574F9BF80982305808EF4BF5402D29F01E2F9BF21E0A744E4E9FC3FB104B83B0BFC1140B49FFC7C5F1207409C247F868C8A14C088E94CB20703E5BF1AFA0DC39E5C09C0188E0B223EC502C062FA7DF907810040A68B567A3DB3CFBF027937E6710AE73FC4013C190150014018820DF9B001F0BF7AC8407F79BDCCBF8047736DBAE9E7BF334FF6DCF5B2ECBFE233F98E971D0440F6E0F4344369D2BF50B3AE151BE1054002CDFC2DC8D2E3BFB8730EB00A90F93FFB1FA546317212C0FB9A31D21678D4BF4CBE55F55102F93FCCB0FD1BFF58FC3F47B9C47F319C03C0A65FA6865145EFBFE238A746457CFCBFD0E3D487B0D911403EE5158AF23BC8BF68A70E522211E7BF0D8E0FD55DBD0FC0A0F5D437A322EDBF158B35A8848A0B40FEED7CF4844D11409CBC0822182308C0588B8ED461ACFABFBC04FB29AF90DABF88ED87FC4A8F12C08AAA16C0D38907C0340FACD1D673EABF22259703D04DA9BF6736BFCFD4A3F13F978E316E61B40840990F27ABE0FCF7BFCC8D0D36BB4D05C07CA5AF26258FBA3FA20950654F3B11C050F68FBE011909C044BCE139B28E1740BDD7962A1ABFA3BF111C12ADBB3D114034721CF857A2FD3FFC8F05008438FCBF28066861BDAAFEBFC413B497327201409B6E7123CEE51F404E5F2B5096680DC0567AA6FB89D5C1BFB6FA82408AF6F1BF99C5CE30E02A02402809985C42E7EABF5A0A273E061219C0541876767D5A10C0B8E11FE4D090F2BFA1137CFA9AA4EF3F0BF6C167291C1DC0BC2067BF4C6215C0E8F480AE8F1B14C08AC1C61FA69C8A3FBC615CFB8E07BFBF2BEC10EC29B01140FEF741F09804E4BF13C41337E5ED05C0FABC9A329F3A06409755BE5983A5E73FDE9EB4F174EC0740036DDD7E298513405A683F40E435E9BF3D76D2554E41F13F1C4F37B8A13D08C0D07AB0A996E913C065582C88BC74CD3F498FB35E9F58F5BFA470B2A11D04D7BF3A54F4B1E80AFD3FEA9009462AD0E73FD45990DE33600A40F59283037412F6BF68027D46F516F33FDD3FB31FE68A11C0586C586AFB7F0BC0F9647029CA7A10C00B03235A5C79E33F12AF48FE9AA00AC044DA85DC93F113C071B696A9F82EFC3FCB97DA29547304400483913C933B10C03EAD5A31E078F83F391946BDF46C11409CCAF82BD53010405A0FA929F829F03FE436A3B7CDEAE5BFC2BCD65F877BEF3FFD2E2164C972D83FD658FD18B594EEBF4E54321232C606C049D6C66A184FF6BFA400F7CAC206D93F8BEA62ADCCFAD73F6AF54A3A6C420FC032A1541870F9F23FFEC7779BC42BCEBFABA89B0D4BE103401E52BFE0B85B1BC018FB11384BE3D13F55377AC54B3501C04F449C0A0320FBBFC3997A241D09F23F7273503695C1DE3F1A8C34E110A9C9BF585B4983B1440D4062134742E907FABFEA59E420CABA12C0027FB2074AA5FC3F24584F5FFCD714C0700F308B0C1D16C09314A2AC9E36B3BF3C08A2788471E33FAE5E04AAC6F9FBBF8FA06820318B16C07050EBEB88B5EC3FF2CD20D56D971540BD36873423E105C0D6ABD5E3175DE13F2710FE36720112C0CC815B262FA6F0BFA7E56F155668E0BF3761BAF3595D11402B2B10724AF1C83F9ED785D1CC680B404AC87012856518C07857802D4F3C08C0C05A83BEE2AA06406941E6A1E3FBFD3F9A8BA3A39771F5BF6A0F4D3A4695064030B29AE17FE71340B6E82610B3E9FD3F4896EFA2FE000340D4F696FCABACF8BF5BBDF5C61EF4E23FC9D0294EFA0914C076E9D417DADAF7BFA594E8B822C30AC024AEDA8E24A4FABF9DFC7D4B2C61D8BF3F880133DE4AFABFD2F91A0F4F651E40152376BA8D6C1B40C306E8469D57FB3FE23CF9D89FD115C0609908FC46A2EEBFEA480FE3A8A5FABF944E7C770F25F43F21D4C8D4DB12E8BF3A7506FA8C1206C0672D4AC77F2B12406869A1EF756E15C09469907C53F500408CC7F31F25981940BF5554F55025ECBFBAAE84079DE9EABFB64FF6261F0FE43FFABE3D0B47501340E0942C4E455FE53F9CE7620FB863D43F34CBFECC333C06C0BD593ABA058C12C028EDC463018816C0F68B5CA15C4EE3BF8E59CE98C627DEBF5B7362216730B33FCD84E6344BB4F33F7DACA1C282911740761EED3C74AE00C0E4C9F9A623D2E7BF8E242457E8F5EC3FEA70D58747D700C004750760A7D90540DA85A0A29DCEF23F63D44F6CCB5004C0245D14D41A050840A8BE90C92EFEE4BF24CF64F59E010140019134EC1BF7EBBFD567D186A8020A409487A2AAE933DC3F4D0C154CE9A2FF3FFE8B06BB867D1CC09B3CAE1A2620DCBF5EB92EA202B8F03F543C537ACCFBFC3FF71DFBF3586F10C06E5A3D808833F33FFD03D14D85EAF13F0763A1278B16FCBFEFD553F6244902C082FC874A7CBC0140C86DB6FE74EEF93FDA1F9E92A9DB0E4089F2BB89CA300CC0660D45C81A7BF73FF04DBC927819F2BF03FC9C74C206F5BF04D410A716290CC02801AA09D94DDABF2CE4168365D11040275B533C114205C00A0028C09AA2EA3F3A2F9C34D09C1A40ACE1FAD79A290A401440FF2ECD9E01404632A64643ECFE3FE54DCD53FE19F03F0B0D488E013AF53F84CF5943BDCB09C0E535E032B8EBF03F2E620EF7869506C039A123739D18F6BF5EB938D9201FDE3FA09808083A94F7BFECEA24589CBC0B400626BD46B370E7BF2C89AFA2AF5E0FC0882327CD8C8BF7BFCF1BE11AF193E63FA722D96CDEAC16401CC6626B6C28F53F4C6EF4F9AFACE33F9899BF5FA0FBDCBF2BFA441AE8DA02C0AA4C02B7E9A80A40BD6C939879ABF8BFAA12D36AB1070AC0964D392058AD0A4062DBF9F40E750CC0CBE756C3C267F1BF0CC053FBC6AD1140C61E15D9AFBC0DC0C63F6CAB35F00BC03AE020C6CED0F6BFB40B41523EB405406642A8820A34F3BF509B76D6E32003C0B52536157785DF3F5D8F1749331E05C0E7EB2B1C7B9CCB3FACBD70645BA1DFBFD8907D33A27B03C0D62F2F5BF09913C03251DDE1CE7111408A52D466F1CAFF3F3AD4FD8CEBDE06C06DC4DDD0A5641040EA354EBFE367DBBF7B24059E50CC0B4076DB8793ADDC1340C1E8EFC2898C0AC05280F4C9F2CB14C0D5FCF6D58DF11640F7FD1222EA2513C0AFC301179C2BD63F0CDD752707F508C02DCAA81E8DC1054025961A7C458CB6BFB0A66355DB5316C02D61008F19C0FD3F39B088BE0D4D064068B15CED9664F5BF9E8C1E6AEF1B1240C83C1203BDD6FCBF730AD1FAA7E013404B49F585211BC23F7099855C8E661BC0A0F01CE9BEC213C003124F02AB72DB3F60A01E263CE00AC0E713DFDCAEDBEEBFF8B67E8B167DF53F8DAD47D5D9E010C0638544D2DC290E400EB91E3CFE20D83F4C4ED9BDFFDCCD3FA6FFDCDD5DA3E03F1739AE8E0091C13F486B93B004DE1C40005C1BD28F38F7BF945B0470BA3F0440CBE9867D8A8C13C0121568D9A4BA01C072040E534ABCCBBF8E3DE9624B510BC0A215E246E42BE33F425FAEA4D9FCC6BF10DC6BFCA2930F40F1B272008C89E7BF0D123960C45BFBBF35F77153D9BCE2BFF15FAFCC63460740CFB2B40322B40140EB31B6A6C3E01340B22DF0D2AE76F0BF9E9EC5EC2497EEBF96C621DA760BDDBF5055A8C8E7480FC048E3FE040CCBF8BF98A41CDB70A41DC0A47907352DAC004046FC41765A5C10C020EB6D3E90AB03C08E6F4D793482E13FF70619EFE814F6BF178F7F18703805C01A2451293154DABF33449EAA14B0FA3F1B90BAA71EDEF93FC97C209D4F4FF6BFBC94DEC28F39C63F97D6E1BE219910C01BCABF7B1C5EF6BF70BEA68A464D01401B1EC8505164F7BF623D03C9A058EB3F5634D89B99DD06C062E98FE359F006C025261120CC751140CF54348A530AFABFF2F2177F9F6705C087916B30DB20E4BFFDB0E92F3C4E04407334AB754D2ED9BF76A07434B82109407A30C399312709C0A637A68293E0E73F0DAE05D4053B06C0C84C1FC14013FCBFE57A8F908A68F53F5735DE0E2C8F00C0DBFF8453A30E16C086821487FDD103404DE1437D8362DB3F9EE8EF78CF650F40"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
  func.func private @expected() -> (tensor<20x20xf64> {mhlo.layout_mode = "default"}) {
    %cst = stablehlo.constant dense<"0x000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F0BF000000000000F0BF000000000000F03F000000000000F03F000000000000F03F"> : tensor<20x20xf64>
    return %cst : tensor<20x20xf64>
  }
}
